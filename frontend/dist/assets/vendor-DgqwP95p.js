var t="object"==typeof global&&global&&global.Object===Object&&global,e="object"==typeof self&&self&&self.Object===Object&&self,n=t||e||Function("return this")(),r=n.Symbol,i=Object.prototype,s=i.hasOwnProperty,a=i.toString,o=r?r.toStringTag:void 0;var l=Object.prototype.toString;var c=r?r.toStringTag:void 0;function u(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":c&&c in Object(t)?function(t){var e=s.call(t,o),n=t[o];try{t[o]=void 0;var r=!0}catch(Es){}var i=a.call(t);return r&&(e?t[o]=n:delete t[o]),i}(t):function(t){return l.call(t)}(t)}function h(t){return null!=t&&"object"==typeof t}function d(t){return"symbol"==typeof t||h(t)&&"[object Symbol]"==u(t)}function f(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var p=Array.isArray,m=r?r.prototype:void 0,g=m?m.toString:void 0;function v(t){if("string"==typeof t)return t;if(p(t))return f(t,v)+"";if(d(t))return g?g.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}var y=/\s/;var b=/^\s+/;function w(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&y.test(t.charAt(e)););return e}(t)+1).replace(b,""):t}function _(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var x=/^[-+]0x[0-9a-f]+$/i,E=/^0b[01]+$/i,A=/^0o[0-7]+$/i,S=parseInt;function M(t){if("number"==typeof t)return t;if(d(t))return NaN;if(_(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=_(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=w(t);var n=E.test(t);return n||A.test(t)?S(t.slice(2),n?2:8):x.test(t)?NaN:+t}function T(t){return t}function R(t){if(!_(t))return!1;var e=u(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var C,P=n["__core-js_shared__"],N=(C=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"";var O=Function.prototype.toString;function I(t){if(null!=t){try{return O.call(t)}catch(Es){}try{return t+""}catch(Es){}}return""}var D=/^\[object .+?Constructor\]$/,U=Function.prototype,L=Object.prototype,F=U.toString,k=L.hasOwnProperty,B=RegExp("^"+F.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function z(t){return!(!_(t)||(e=t,N&&N in e))&&(R(t)?B:D).test(I(t));var e}function H(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return z(n)?n:void 0}var G=H(n,"WeakMap"),V=Object.create,j=function(){function t(){}return function(e){if(!_(e))return{};if(V)return V(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function W(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var q=Date.now;var X,K,Y,J=function(){try{var t=H(Object,"defineProperty");return t({},"",{}),t}catch(Es){}}(),Q=J?function(t,e){return J(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:T,Z=(X=Q,K=0,Y=0,function(){var t=q(),e=16-(t-Y);if(Y=t,e>0){if(++K>=800)return arguments[0]}else K=0;return X.apply(void 0,arguments)});function $(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}function tt(t){return t!=t}function et(t,e){return!!(null==t?0:t.length)&&function(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):$(t,tt,n)}(t,e,0)>-1}var nt=/^(?:0|[1-9]\d*)$/;function rt(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&nt.test(t))&&t>-1&&t%1==0&&t<e}function it(t,e,n){"__proto__"==e&&J?J(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function st(t,e){return t===e||t!=t&&e!=e}var at=Object.prototype.hasOwnProperty;function ot(t,e,n){var r=t[e];at.call(t,e)&&st(r,n)&&(void 0!==n||e in t)||it(t,e,n)}function lt(t,e,n,r){var i=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var o=e[s],l=void 0;void 0===l&&(l=t[o]),i?it(n,o,l):ot(n,o,l)}return n}var ct=Math.max;function ut(t,e,n){return e=ct(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=ct(r.length-e,0),a=Array(s);++i<s;)a[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=n(a),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,o)}}function ht(t,e){return Z(ut(t,e,T),t+"")}function dt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function ft(t){return null!=t&&dt(t.length)&&!R(t)}var pt=Object.prototype;function mt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||pt)}function gt(t){return h(t)&&"[object Arguments]"==u(t)}var vt=Object.prototype,yt=vt.hasOwnProperty,bt=vt.propertyIsEnumerable,wt=gt(function(){return arguments}())?gt:function(t){return h(t)&&yt.call(t,"callee")&&!bt.call(t,"callee")};var _t="object"==typeof exports&&exports&&!exports.nodeType&&exports,xt=_t&&"object"==typeof module&&module&&!module.nodeType&&module,Et=xt&&xt.exports===_t?n.Buffer:void 0,At=(Et?Et.isBuffer:void 0)||function(){return!1},St={};function Mt(t){return function(e){return t(e)}}St["[object Float32Array]"]=St["[object Float64Array]"]=St["[object Int8Array]"]=St["[object Int16Array]"]=St["[object Int32Array]"]=St["[object Uint8Array]"]=St["[object Uint8ClampedArray]"]=St["[object Uint16Array]"]=St["[object Uint32Array]"]=!0,St["[object Arguments]"]=St["[object Array]"]=St["[object ArrayBuffer]"]=St["[object Boolean]"]=St["[object DataView]"]=St["[object Date]"]=St["[object Error]"]=St["[object Function]"]=St["[object Map]"]=St["[object Number]"]=St["[object Object]"]=St["[object RegExp]"]=St["[object Set]"]=St["[object String]"]=St["[object WeakMap]"]=!1;var Tt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Rt=Tt&&"object"==typeof module&&module&&!module.nodeType&&module,Ct=Rt&&Rt.exports===Tt&&t.process,Pt=function(){try{var t=Rt&&Rt.require&&Rt.require("util").types;return t||Ct&&Ct.binding&&Ct.binding("util")}catch(Es){}}(),Nt=Pt&&Pt.isTypedArray,Ot=Nt?Mt(Nt):function(t){return h(t)&&dt(t.length)&&!!St[u(t)]},It=Object.prototype.hasOwnProperty;function Dt(t,e){var n=p(t),r=!n&&wt(t),i=!n&&!r&&At(t),s=!n&&!r&&!i&&Ot(t),a=n||r||i||s,o=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],l=o.length;for(var c in t)!e&&!It.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||rt(c,l))||o.push(c);return o}function Ut(t,e){return function(n){return t(e(n))}}var Lt=Ut(Object.keys,Object),Ft=Object.prototype.hasOwnProperty;function kt(t){return ft(t)?Dt(t):function(t){if(!mt(t))return Lt(t);var e=[];for(var n in Object(t))Ft.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}var Bt=Object.prototype.hasOwnProperty;function zt(t){if(!_(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=mt(t),n=[];for(var r in t)("constructor"!=r||!e&&Bt.call(t,r))&&n.push(r);return n}function Ht(t){return ft(t)?Dt(t,!0):zt(t)}var Gt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Vt=/^\w*$/;function jt(t,e){if(p(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!d(t))||(Vt.test(t)||!Gt.test(t)||null!=e&&t in Object(e))}var Wt=H(Object,"create");var qt=Object.prototype.hasOwnProperty;var Xt=Object.prototype.hasOwnProperty;function Kt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Yt(t,e){for(var n=t.length;n--;)if(st(t[n][0],e))return n;return-1}Kt.prototype.clear=function(){this.__data__=Wt?Wt(null):{},this.size=0},Kt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Kt.prototype.get=function(t){var e=this.__data__;if(Wt){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return qt.call(e,t)?e[t]:void 0},Kt.prototype.has=function(t){var e=this.__data__;return Wt?void 0!==e[t]:Xt.call(e,t)},Kt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Wt&&void 0===e?"__lodash_hash_undefined__":e,this};var Jt=Array.prototype.splice;function Qt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Qt.prototype.clear=function(){this.__data__=[],this.size=0},Qt.prototype.delete=function(t){var e=this.__data__,n=Yt(e,t);return!(n<0)&&(n==e.length-1?e.pop():Jt.call(e,n,1),--this.size,!0)},Qt.prototype.get=function(t){var e=this.__data__,n=Yt(e,t);return n<0?void 0:e[n][1]},Qt.prototype.has=function(t){return Yt(this.__data__,t)>-1},Qt.prototype.set=function(t,e){var n=this.__data__,r=Yt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};var Zt=H(n,"Map");function $t(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function te(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}te.prototype.clear=function(){this.size=0,this.__data__={hash:new Kt,map:new(Zt||Qt),string:new Kt}},te.prototype.delete=function(t){var e=$t(this,t).delete(t);return this.size-=e?1:0,e},te.prototype.get=function(t){return $t(this,t).get(t)},te.prototype.has=function(t){return $t(this,t).has(t)},te.prototype.set=function(t,e){var n=$t(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function ee(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=t.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(ee.Cache||te),n}ee.Cache=te;var ne=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,re=/\\(\\)?/g,ie=function(t){var e=ee(t,function(t){return 500===n.size&&n.clear(),t}),n=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ne,function(t,n,r,i){e.push(r?i.replace(re,"$1"):n||t)}),e});function se(t,e){return p(t)?t:jt(t,e)?[t]:ie(function(t){return null==t?"":v(t)}(t))}function ae(t){if("string"==typeof t||d(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function oe(t,e){for(var n=0,r=(e=se(e,t)).length;null!=t&&n<r;)t=t[ae(e[n++])];return n&&n==r?t:void 0}function le(t,e,n){var r=null==t?void 0:oe(t,e);return void 0===r?n:r}function ce(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var ue=r?r.isConcatSpreadable:void 0;function he(t){return p(t)||wt(t)||!!(ue&&t&&t[ue])}function de(t,e,n,r,i){var s=-1,a=t.length;for(n||(n=he),i||(i=[]);++s<a;){var o=t[s];e>0&&n(o)?e>1?de(o,e-1,n,r,i):ce(i,o):r||(i[i.length]=o)}return i}function fe(t){return(null==t?0:t.length)?de(t,1):[]}function pe(t){return Z(ut(t,void 0,fe),t+"")}var me=Ut(Object.getPrototypeOf,Object),ge=Function.prototype,ve=Object.prototype,ye=ge.toString,be=ve.hasOwnProperty,we=ye.call(Object);function _e(t){if(!h(t)||"[object Object]"!=u(t))return!1;var e=me(t);if(null===e)return!0;var n=be.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ye.call(n)==we}function xe(){if(!arguments.length)return[];var t=arguments[0];return p(t)?t:[t]}function Ee(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=M(n))==n?n:0),void 0!==e&&(e=(e=M(e))==e?e:0),function(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}(M(t),e,n)}function Ae(t){var e=this.__data__=new Qt(t);this.size=e.size}Ae.prototype.clear=function(){this.__data__=new Qt,this.size=0},Ae.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Ae.prototype.get=function(t){return this.__data__.get(t)},Ae.prototype.has=function(t){return this.__data__.has(t)},Ae.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Qt){var r=n.__data__;if(!Zt||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new te(r)}return n.set(t,e),this.size=n.size,this};var Se="object"==typeof exports&&exports&&!exports.nodeType&&exports,Me=Se&&"object"==typeof module&&module&&!module.nodeType&&module,Te=Me&&Me.exports===Se?n.Buffer:void 0,Re=Te?Te.allocUnsafe:void 0;function Ce(t,e){if(e)return t.slice();var n=t.length,r=Re?Re(n):new t.constructor(n);return t.copy(r),r}function Pe(){return[]}var Ne=Object.prototype.propertyIsEnumerable,Oe=Object.getOwnPropertySymbols,Ie=Oe?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,s=[];++n<r;){var a=t[n];e(a,n,t)&&(s[i++]=a)}return s}(Oe(t),function(e){return Ne.call(t,e)}))}:Pe;var De=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)ce(e,Ie(t)),t=me(t);return e}:Pe;function Ue(t,e,n){var r=e(t);return p(t)?r:ce(r,n(t))}function Le(t){return Ue(t,kt,Ie)}function Fe(t){return Ue(t,Ht,De)}var ke=H(n,"DataView"),Be=H(n,"Promise"),ze=H(n,"Set"),He="[object Map]",Ge="[object Promise]",Ve="[object Set]",je="[object WeakMap]",We="[object DataView]",qe=I(ke),Xe=I(Zt),Ke=I(Be),Ye=I(ze),Je=I(G),Qe=u;(ke&&Qe(new ke(new ArrayBuffer(1)))!=We||Zt&&Qe(new Zt)!=He||Be&&Qe(Be.resolve())!=Ge||ze&&Qe(new ze)!=Ve||G&&Qe(new G)!=je)&&(Qe=function(t){var e=u(t),n="[object Object]"==e?t.constructor:void 0,r=n?I(n):"";if(r)switch(r){case qe:return We;case Xe:return He;case Ke:return Ge;case Ye:return Ve;case Je:return je}return e});var Ze=Object.prototype.hasOwnProperty;var $e=n.Uint8Array;function tn(t){var e=new t.constructor(t.byteLength);return new $e(e).set(new $e(t)),e}var en=/\w*$/;var nn=r?r.prototype:void 0,rn=nn?nn.valueOf:void 0;function sn(t,e){var n=e?tn(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function an(t,e,n){var r,i,s,a=t.constructor;switch(e){case"[object ArrayBuffer]":return tn(t);case"[object Boolean]":case"[object Date]":return new a(+t);case"[object DataView]":return function(t,e){var n=e?tn(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return sn(t,n);case"[object Map]":case"[object Set]":return new a;case"[object Number]":case"[object String]":return new a(t);case"[object RegExp]":return(s=new(i=t).constructor(i.source,en.exec(i))).lastIndex=i.lastIndex,s;case"[object Symbol]":return r=t,rn?Object(rn.call(r)):{}}}function on(t){return"function"!=typeof t.constructor||mt(t)?{}:j(me(t))}var ln=Pt&&Pt.isMap,cn=ln?Mt(ln):function(t){return h(t)&&"[object Map]"==Qe(t)};var un=Pt&&Pt.isSet,hn=un?Mt(un):function(t){return h(t)&&"[object Set]"==Qe(t)},dn="[object Arguments]",fn="[object Function]",pn="[object Object]",mn={};function gn(t,e,n,r,i,s){var a,o=1&e,l=2&e,c=4&e;if(n&&(a=i?n(t,r,i,s):n(t)),void 0!==a)return a;if(!_(t))return t;var u=p(t);if(u){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Ze.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!o)return W(t,a)}else{var h=Qe(t),d=h==fn||"[object GeneratorFunction]"==h;if(At(t))return Ce(t,o);if(h==pn||h==dn||d&&!i){if(a=l||d?{}:on(t),!o)return l?function(t,e){return lt(t,De(t),e)}(t,function(t,e){return t&&lt(e,Ht(e),t)}(a,t)):function(t,e){return lt(t,Ie(t),e)}(t,function(t,e){return t&&lt(e,kt(e),t)}(a,t))}else{if(!mn[h])return i?t:{};a=an(t,h,o)}}s||(s=new Ae);var f=s.get(t);if(f)return f;s.set(t,a),hn(t)?t.forEach(function(r){a.add(gn(r,e,n,r,t,s))}):cn(t)&&t.forEach(function(r,i){a.set(i,gn(r,e,n,i,t,s))});var m=u?void 0:(c?l?Fe:Le:l?Ht:kt)(t);return function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););}(m||t,function(r,i){m&&(r=t[i=r]),ot(a,i,gn(r,e,n,i,t,s))}),a}mn[dn]=mn["[object Array]"]=mn["[object ArrayBuffer]"]=mn["[object DataView]"]=mn["[object Boolean]"]=mn["[object Date]"]=mn["[object Float32Array]"]=mn["[object Float64Array]"]=mn["[object Int8Array]"]=mn["[object Int16Array]"]=mn["[object Int32Array]"]=mn["[object Map]"]=mn["[object Number]"]=mn[pn]=mn["[object RegExp]"]=mn["[object Set]"]=mn["[object String]"]=mn["[object Symbol]"]=mn["[object Uint8Array]"]=mn["[object Uint8ClampedArray]"]=mn["[object Uint16Array]"]=mn["[object Uint32Array]"]=!0,mn["[object Error]"]=mn[fn]=mn["[object WeakMap]"]=!1;function vn(t){return gn(t,4)}function yn(t){return gn(t,5)}function bn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new te;++e<n;)this.add(t[e])}function wn(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function _n(t,e){return t.has(e)}bn.prototype.add=bn.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},bn.prototype.has=function(t){return this.__data__.has(t)};function xn(t,e,n,r,i,s){var a=1&n,o=t.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var h=-1,d=!0,f=2&n?new bn:void 0;for(s.set(t,e),s.set(e,t);++h<o;){var p=t[h],m=e[h];if(r)var g=a?r(m,p,h,e,t,s):r(p,m,h,t,e,s);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!wn(e,function(t,e){if(!_n(f,e)&&(p===t||i(p,t,n,r,s)))return f.push(e)})){d=!1;break}}else if(p!==m&&!i(p,m,n,r,s)){d=!1;break}}return s.delete(t),s.delete(e),d}function En(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function An(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var Sn=r?r.prototype:void 0,Mn=Sn?Sn.valueOf:void 0;var Tn=Object.prototype.hasOwnProperty;var Rn="[object Arguments]",Cn="[object Array]",Pn="[object Object]",Nn=Object.prototype.hasOwnProperty;function On(t,e,n,r,i,s){var a=p(t),o=p(e),l=a?Cn:Qe(t),c=o?Cn:Qe(e),u=(l=l==Rn?Pn:l)==Pn,h=(c=c==Rn?Pn:c)==Pn,d=l==c;if(d&&At(t)){if(!At(e))return!1;a=!0,u=!1}if(d&&!u)return s||(s=new Ae),a||Ot(t)?xn(t,e,n,r,i,s):function(t,e,n,r,i,s,a){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!s(new $e(t),new $e(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return st(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var o=En;case"[object Set]":var l=1&r;if(o||(o=An),t.size!=e.size&&!l)return!1;var c=a.get(t);if(c)return c==e;r|=2,a.set(t,e);var u=xn(o(t),o(e),r,i,s,a);return a.delete(t),u;case"[object Symbol]":if(Mn)return Mn.call(t)==Mn.call(e)}return!1}(t,e,l,n,r,i,s);if(!(1&n)){var f=u&&Nn.call(t,"__wrapped__"),m=h&&Nn.call(e,"__wrapped__");if(f||m){var g=f?t.value():t,v=m?e.value():e;return s||(s=new Ae),i(g,v,n,r,s)}}return!!d&&(s||(s=new Ae),function(t,e,n,r,i,s){var a=1&n,o=Le(t),l=o.length;if(l!=Le(e).length&&!a)return!1;for(var c=l;c--;){var u=o[c];if(!(a?u in e:Tn.call(e,u)))return!1}var h=s.get(t),d=s.get(e);if(h&&d)return h==e&&d==t;var f=!0;s.set(t,e),s.set(e,t);for(var p=a;++c<l;){var m=t[u=o[c]],g=e[u];if(r)var v=a?r(g,m,u,e,t,s):r(m,g,u,t,e,s);if(!(void 0===v?m===g||i(m,g,n,r,s):v)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var y=t.constructor,b=e.constructor;y==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(f=!1)}return s.delete(t),s.delete(e),f}(t,e,n,r,i,s))}function In(t,e,n,r,i){return t===e||(null==t||null==e||!h(t)&&!h(e)?t!=t&&e!=e:On(t,e,n,r,In,i))}function Dn(t){return t==t&&!_(t)}function Un(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}function Ln(t){var e=function(t){for(var e=kt(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Dn(i)]}return e}(t);return 1==e.length&&e[0][2]?Un(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var i=n.length,s=i;if(null==t)return!s;for(t=Object(t);i--;){var a=n[i];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<s;){var o=(a=n[i])[0],l=t[o],c=a[1];if(a[2]){if(void 0===l&&!(o in t))return!1}else if(!In(c,l,3,r,new Ae))return!1}return!0}(n,0,e)}}function Fn(t,e){return null!=t&&e in Object(t)}function kn(t,e){return null!=t&&function(t,e,n){for(var r=-1,i=(e=se(e,t)).length,s=!1;++r<i;){var a=ae(e[r]);if(!(s=null!=t&&n(t,a)))break;t=t[a]}return s||++r!=i?s:!!(i=null==t?0:t.length)&&dt(i)&&rt(a,i)&&(p(t)||wt(t))}(t,e,Fn)}function Bn(t){return jt(t)?(e=ae(t),function(t){return null==t?void 0:t[e]}):function(t){return function(e){return oe(e,t)}}(t);var e}function zn(t){return"function"==typeof t?t:null==t?T:"object"==typeof t?p(t)?(e=t[0],n=t[1],jt(e)&&Dn(n)?Un(ae(e),n):function(t){var r=le(t,e);return void 0===r&&r===n?kn(t,e):In(n,r,3)}):Ln(t):Bn(t);var e,n}var Hn=function(t,e,n){for(var r=-1,i=Object(t),s=n(t),a=s.length;a--;){var o=s[++r];if(!1===e(i[o],o,i))break}return t};var Gn,Vn=(Gn=function(t,e){return t&&Hn(t,e,kt)},function(t,e){if(null==t)return t;if(!ft(t))return Gn(t,e);for(var n=t.length,r=-1,i=Object(t);++r<n&&!1!==e(i[r],r,i););return t}),jn=function(){return n.Date.now()},Wn=Math.max,qn=Math.min;function Xn(t,e,n){var r,i,s,a,o,l,c=0,u=!1,h=!1,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var n=r,s=i;return r=i=void 0,c=e,a=t.apply(s,n)}function p(t){var n=t-l;return void 0===l||n>=e||n<0||h&&t-c>=s}function m(){var t=jn();if(p(t))return g(t);o=setTimeout(m,function(t){var n=e-(t-l);return h?qn(n,s-(t-c)):n}(t))}function g(t){return o=void 0,d&&r?f(t):(r=i=void 0,a)}function v(){var t=jn(),n=p(t);if(r=arguments,i=this,l=t,n){if(void 0===o)return function(t){return c=t,o=setTimeout(m,e),u?f(t):a}(l);if(h)return clearTimeout(o),o=setTimeout(m,e),f(l)}return void 0===o&&(o=setTimeout(m,e)),a}return e=M(e)||0,_(n)&&(u=!!n.leading,s=(h="maxWait"in n)?Wn(M(n.maxWait)||0,e):s,d="trailing"in n?!!n.trailing:d),v.cancel=function(){void 0!==o&&clearTimeout(o),c=0,r=l=i=o=void 0},v.flush=function(){return void 0===o?a:g(jn())},v}function Kn(t,e,n){(void 0!==n&&!st(t[e],n)||void 0===n&&!(e in t))&&it(t,e,n)}function Yn(t){return h(t)&&ft(t)}function Jn(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}function Qn(t,e,n,r,i,s,a){var o=Jn(t,n),l=Jn(e,n),c=a.get(l);if(c)Kn(t,n,c);else{var u,h=s?s(o,l,n+"",t,e,a):void 0,d=void 0===h;if(d){var f=p(l),m=!f&&At(l),g=!f&&!m&&Ot(l);h=l,f||m||g?p(o)?h=o:Yn(o)?h=W(o):m?(d=!1,h=Ce(l,!0)):g?(d=!1,h=sn(l,!0)):h=[]:_e(l)||wt(l)?(h=o,wt(o)?h=lt(u=o,Ht(u)):_(o)&&!R(o)||(h=on(l))):d=!1}d&&(a.set(l,h),i(h,l,r,s,a),a.delete(l)),Kn(t,n,h)}}function Zn(t,e,n,r,i){t!==e&&Hn(e,function(s,a){if(i||(i=new Ae),_(s))Qn(t,e,a,n,Zn,r,i);else{var o=r?r(Jn(t,a),s,a+"",t,e,i):void 0;void 0===o&&(o=s),Kn(t,a,o)}},Ht)}function $n(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return $(t,zn(e),i,!0)}function tr(t,e){var n=-1,r=ft(t)?Array(t.length):[];return Vn(t,function(t,i,s){r[++n]=e(t,i,s)}),r}function er(t,e){return de(function(t,e){return(p(t)?f:tr)(t,zn(e))}(t,e),1)}var nr=1/0;function rr(t){return(null==t?0:t.length)?de(t,nr):[]}function ir(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r}function sr(t,e){return e.length<2?t:oe(t,function(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=t[r+e];return s}(e,0,-1))}function ar(t,e){return In(t,e)}function or(t){return null==t}function lr(t){return null===t}function cr(t){return void 0===t}var ur,hr=(ur=function(t,e,n){Zn(t,e,n)},ht(function(t,e){var n=-1,r=e.length,i=r>1?e[r-1]:void 0,s=r>2?e[2]:void 0;for(i=ur.length>3&&"function"==typeof i?(r--,i):void 0,s&&function(t,e,n){if(!_(n))return!1;var r=typeof e;return!!("number"==r?ft(n)&&rt(e,n.length):"string"==r&&e in n)&&st(n[e],t)}(e[0],e[1],s)&&(i=r<3?void 0:i,r=1),t=Object(t);++n<r;){var a=e[n];a&&ur(t,a,n,i)}return t})),dr=Object.prototype.hasOwnProperty;function fr(t,e){var n=-1,r=(e=se(e,t)).length;if(!r)return!0;for(var i=null==t||"object"!=typeof t&&"function"!=typeof t;++n<r;){var s=e[n];if("string"==typeof s){if("__proto__"===s&&!dr.call(t,"__proto__"))return!1;if("constructor"===s&&n+1<r&&"string"==typeof e[n+1]&&"prototype"===e[n+1]){if(i&&0===n)continue;return!1}}}var a=sr(t,e);return null==a||delete a[ae(function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}(e))]}function pr(t){return _e(t)?void 0:t}var mr=pe(function(t,e){var n={};if(null==t)return n;var r=!1;e=f(e,function(e){return e=se(e,t),r||(r=e.length>1),e}),lt(t,Fe(t),n),r&&(n=gn(n,7,pr));for(var i=e.length;i--;)fr(n,e[i]);return n});function gr(t,e,n,r){if(!_(t))return t;for(var i=-1,s=(e=se(e,t)).length,a=s-1,o=t;null!=o&&++i<s;){var l=ae(e[i]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(i!=a){var u=o[l];void 0===(c=void 0)&&(c=_(u)?u:rt(e[i+1])?[]:{})}ot(o,l,c),o=o[l]}return t}function vr(t,e){return function(t,e,n){for(var r=-1,i=e.length,s={};++r<i;){var a=e[r],o=oe(t,a);n(o,a)&&gr(s,se(a,t),o)}return s}(t,e,function(e,n){return kn(t,n)})}var yr=pe(function(t,e){return null==t?{}:vr(t,e)});function br(t,e,n){return null==t?t:gr(t,e,n)}function wr(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return _(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Xn(t,e,{leading:r,maxWait:e,trailing:i})}var _r=ze&&1/An(new ze([,-0]))[1]==1/0?function(t){return new ze(t)}:function(){};var xr=ht(function(t){return function(t,e,n){var r=-1,i=et,s=t.length,a=!0,o=[],l=o;if(s>=200){var c=_r(t);if(c)return An(c);a=!1,i=_n,l=new bn}else l=o;t:for(;++r<s;){var u=t[r],h=u;if(u=0!==u?u:0,a&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue t;o.push(u)}else i(l,h,n)||(l!==o&&l.push(h),o.push(u))}return o}(de(t,1,Yn,!0))}),Er="top",Ar="bottom",Sr="right",Mr="left",Tr="auto",Rr=[Er,Ar,Sr,Mr],Cr="start",Pr="end",Nr="viewport",Or="popper",Ir=Rr.reduce(function(t,e){return t.concat([e+"-"+Cr,e+"-"+Pr])},[]),Dr=[].concat(Rr,[Tr]).reduce(function(t,e){return t.concat([e,e+"-"+Cr,e+"-"+Pr])},[]),Ur=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Lr(t){return t?(t.nodeName||"").toLowerCase():null}function Fr(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function kr(t){return t instanceof Fr(t).Element||t instanceof Element}function Br(t){return t instanceof Fr(t).HTMLElement||t instanceof HTMLElement}function zr(t){return"undefined"!=typeof ShadowRoot&&(t instanceof Fr(t).ShadowRoot||t instanceof ShadowRoot)}var Hr={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach(function(t){var n=e.styles[t]||{},r=e.attributes[t]||{},i=e.elements[t];!Br(i)||!Lr(i)||(Object.assign(i.style,n),Object.keys(r).forEach(function(t){var e=r[t];!1===e?i.removeAttribute(t):i.setAttribute(t,!0===e?"":e)}))})},effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(t){var r=e.elements[t],i=e.attributes[t]||{},s=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:n[t]).reduce(function(t,e){return t[e]="",t},{});!Br(r)||!Lr(r)||(Object.assign(r.style,s),Object.keys(i).forEach(function(t){r.removeAttribute(t)}))})}},requires:["computeStyles"]};function Gr(t){return t.split("-")[0]}var Vr=Math.max,jr=Math.min,Wr=Math.round;function qr(t,e){void 0===e&&(e=!1);var n=t.getBoundingClientRect(),r=1,i=1;if(Br(t)&&e){var s=t.offsetHeight,a=t.offsetWidth;a>0&&(r=Wr(n.width)/a||1),s>0&&(i=Wr(n.height)/s||1)}return{width:n.width/r,height:n.height/i,top:n.top/i,right:n.right/r,bottom:n.bottom/i,left:n.left/r,x:n.left/r,y:n.top/i}}function Xr(t){var e=qr(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function Kr(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&zr(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Yr(t){return Fr(t).getComputedStyle(t)}function Jr(t){return["table","td","th"].indexOf(Lr(t))>=0}function Qr(t){return((kr(t)?t.ownerDocument:t.document)||window.document).documentElement}function Zr(t){return"html"===Lr(t)?t:t.assignedSlot||t.parentNode||(zr(t)?t.host:null)||Qr(t)}function $r(t){return Br(t)&&"fixed"!==Yr(t).position?t.offsetParent:null}function ti(t){for(var e=Fr(t),n=$r(t);n&&Jr(n)&&"static"===Yr(n).position;)n=$r(n);return n&&("html"===Lr(n)||"body"===Lr(n)&&"static"===Yr(n).position)?e:n||function(t){var e=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&Br(t)&&"fixed"===Yr(t).position)return null;var n=Zr(t);for(zr(n)&&(n=n.host);Br(n)&&["html","body"].indexOf(Lr(n))<0;){var r=Yr(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||e&&"filter"===r.willChange||e&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(t)||e}function ei(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function ni(t,e,n){return Vr(t,jr(e,n))}function ri(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function ii(t,e){return e.reduce(function(e,n){return e[n]=t,e},{})}var si={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,n=t.state,r=t.name,i=t.options,s=n.elements.arrow,a=n.modifiersData.popperOffsets,o=Gr(n.placement),l=ei(o),c=[Mr,Sr].indexOf(o)>=0?"height":"width";if(s&&a){var u=function(t,e){return ri("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:ii(t,Rr))}(i.padding,n),h=Xr(s),d="y"===l?Er:Mr,f="y"===l?Ar:Sr,p=n.rects.reference[c]+n.rects.reference[l]-a[l]-n.rects.popper[c],m=a[l]-n.rects.reference[l],g=ti(s),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=p/2-m/2,b=u[d],w=v-h[c]-u[f],_=v/2-h[c]/2+y,x=ni(b,_,w),E=l;n.modifiersData[r]=((e={})[E]=x,e.centerOffset=x-_,e)}},effect:function(t){var e=t.state,n=t.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"==typeof r&&!(r=e.elements.popper.querySelector(r))||!Kr(e.elements.popper,r)||(e.elements.arrow=r))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ai(t){return t.split("-")[1]}var oi={top:"auto",right:"auto",bottom:"auto",left:"auto"};function li(t){var e,n=t.popper,r=t.popperRect,i=t.placement,s=t.variation,a=t.offsets,o=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,h=t.isFixed,d=a.x,f=void 0===d?0:d,p=a.y,m=void 0===p?0:p,g="function"==typeof u?u({x:f,y:m}):{x:f,y:m};f=g.x,m=g.y;var v=a.hasOwnProperty("x"),y=a.hasOwnProperty("y"),b=Mr,w=Er,_=window;if(c){var x=ti(n),E="clientHeight",A="clientWidth";if(x===Fr(n)&&("static"!==Yr(x=Qr(n)).position&&"absolute"===o&&(E="scrollHeight",A="scrollWidth")),i===Er||(i===Mr||i===Sr)&&s===Pr)w=Ar,m-=(h&&x===_&&_.visualViewport?_.visualViewport.height:x[E])-r.height,m*=l?1:-1;if(i===Mr||(i===Er||i===Ar)&&s===Pr)b=Sr,f-=(h&&x===_&&_.visualViewport?_.visualViewport.width:x[A])-r.width,f*=l?1:-1}var S,M=Object.assign({position:o},c&&oi),T=!0===u?function(t){var e=t.x,n=t.y,r=window.devicePixelRatio||1;return{x:Wr(e*r)/r||0,y:Wr(n*r)/r||0}}({x:f,y:m}):{x:f,y:m};return f=T.x,m=T.y,l?Object.assign({},M,((S={})[w]=y?"0":"",S[b]=v?"0":"",S.transform=(_.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",S)):Object.assign({},M,((e={})[w]=y?m+"px":"",e[b]=v?f+"px":"",e.transform="",e))}var ci={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=void 0===r||r,s=n.adaptive,a=void 0===s||s,o=n.roundOffsets,l=void 0===o||o,c={placement:Gr(e.placement),variation:ai(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,li(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,li(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},ui={passive:!0};var hi={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,s=void 0===i||i,a=r.resize,o=void 0===a||a,l=Fr(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(t){t.addEventListener("scroll",n.update,ui)}),o&&l.addEventListener("resize",n.update,ui),function(){s&&c.forEach(function(t){t.removeEventListener("scroll",n.update,ui)}),o&&l.removeEventListener("resize",n.update,ui)}},data:{}},di={left:"right",right:"left",bottom:"top",top:"bottom"};function fi(t){return t.replace(/left|right|bottom|top/g,function(t){return di[t]})}var pi={start:"end",end:"start"};function mi(t){return t.replace(/start|end/g,function(t){return pi[t]})}function gi(t){var e=Fr(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function vi(t){return qr(Qr(t)).left+gi(t).scrollLeft}function yi(t){var e=Yr(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function bi(t){return["html","body","#document"].indexOf(Lr(t))>=0?t.ownerDocument.body:Br(t)&&yi(t)?t:bi(Zr(t))}function wi(t,e){var n;void 0===e&&(e=[]);var r=bi(t),i=r===(null==(n=t.ownerDocument)?void 0:n.body),s=Fr(r),a=i?[s].concat(s.visualViewport||[],yi(r)?r:[]):r,o=e.concat(a);return i?o:o.concat(wi(Zr(a)))}function _i(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function xi(t,e){return e===Nr?_i(function(t){var e=Fr(t),n=Qr(t),r=e.visualViewport,i=n.clientWidth,s=n.clientHeight,a=0,o=0;return r&&(i=r.width,s=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=r.offsetLeft,o=r.offsetTop)),{width:i,height:s,x:a+vi(t),y:o}}(t)):kr(e)?function(t){var e=qr(t);return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}(e):_i(function(t){var e,n=Qr(t),r=gi(t),i=null==(e=t.ownerDocument)?void 0:e.body,s=Vr(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Vr(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-r.scrollLeft+vi(t),l=-r.scrollTop;return"rtl"===Yr(i||n).direction&&(o+=Vr(n.clientWidth,i?i.clientWidth:0)-s),{width:s,height:a,x:o,y:l}}(Qr(t)))}function Ei(t,e,n){var r="clippingParents"===e?function(t){var e=wi(Zr(t)),n=["absolute","fixed"].indexOf(Yr(t).position)>=0&&Br(t)?ti(t):t;return kr(n)?e.filter(function(t){return kr(t)&&Kr(t,n)&&"body"!==Lr(t)}):[]}(t):[].concat(e),i=[].concat(r,[n]),s=i[0],a=i.reduce(function(e,n){var r=xi(t,n);return e.top=Vr(r.top,e.top),e.right=jr(r.right,e.right),e.bottom=jr(r.bottom,e.bottom),e.left=Vr(r.left,e.left),e},xi(t,s));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Ai(t){var e,n=t.reference,r=t.element,i=t.placement,s=i?Gr(i):null,a=i?ai(i):null,o=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(s){case Er:e={x:o,y:n.y-r.height};break;case Ar:e={x:o,y:n.y+n.height};break;case Sr:e={x:n.x+n.width,y:l};break;case Mr:e={x:n.x-r.width,y:l};break;default:e={x:n.x,y:n.y}}var c=s?ei(s):null;if(null!=c){var u="y"===c?"height":"width";switch(a){case Cr:e[c]=e[c]-(n[u]/2-r[u]/2);break;case Pr:e[c]=e[c]+(n[u]/2-r[u]/2)}}return e}function Si(t,e){void 0===e&&(e={});var n=e,r=n.placement,i=void 0===r?t.placement:r,s=n.boundary,a=void 0===s?"clippingParents":s,o=n.rootBoundary,l=void 0===o?Nr:o,c=n.elementContext,u=void 0===c?Or:c,h=n.altBoundary,d=void 0!==h&&h,f=n.padding,p=void 0===f?0:f,m=ri("number"!=typeof p?p:ii(p,Rr)),g=u===Or?"reference":Or,v=t.rects.popper,y=t.elements[d?g:u],b=Ei(kr(y)?y:y.contextElement||Qr(t.elements.popper),a,l),w=qr(t.elements.reference),_=Ai({reference:w,element:v,placement:i}),x=_i(Object.assign({},v,_)),E=u===Or?x:w,A={top:b.top-E.top+m.top,bottom:E.bottom-b.bottom+m.bottom,left:b.left-E.left+m.left,right:E.right-b.right+m.right},S=t.modifiersData.offset;if(u===Or&&S){var M=S[i];Object.keys(A).forEach(function(t){var e=[Sr,Ar].indexOf(t)>=0?1:-1,n=[Er,Ar].indexOf(t)>=0?"y":"x";A[t]+=M[n]*e})}return A}var Mi={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,s=void 0===i||i,a=n.altAxis,o=void 0===a||a,l=n.fallbackPlacements,c=n.padding,u=n.boundary,h=n.rootBoundary,d=n.altBoundary,f=n.flipVariations,p=void 0===f||f,m=n.allowedAutoPlacements,g=e.options.placement,v=Gr(g),y=l||(v===g||!p?[fi(g)]:function(t){if(Gr(t)===Tr)return[];var e=fi(t);return[mi(t),e,mi(e)]}(g)),b=[g].concat(y).reduce(function(t,n){return t.concat(Gr(n)===Tr?function(t,e){void 0===e&&(e={});var n=e,r=n.placement,i=n.boundary,s=n.rootBoundary,a=n.padding,o=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?Dr:l,u=ai(r),h=u?o?Ir:Ir.filter(function(t){return ai(t)===u}):Rr,d=h.filter(function(t){return c.indexOf(t)>=0});0===d.length&&(d=h);var f=d.reduce(function(e,n){return e[n]=Si(t,{placement:n,boundary:i,rootBoundary:s,padding:a})[Gr(n)],e},{});return Object.keys(f).sort(function(t,e){return f[t]-f[e]})}(e,{placement:n,boundary:u,rootBoundary:h,padding:c,flipVariations:p,allowedAutoPlacements:m}):n)},[]),w=e.rects.reference,_=e.rects.popper,x=new Map,E=!0,A=b[0],S=0;S<b.length;S++){var M=b[S],T=Gr(M),R=ai(M)===Cr,C=[Er,Ar].indexOf(T)>=0,P=C?"width":"height",N=Si(e,{placement:M,boundary:u,rootBoundary:h,altBoundary:d,padding:c}),O=C?R?Sr:Mr:R?Ar:Er;w[P]>_[P]&&(O=fi(O));var I=fi(O),D=[];if(s&&D.push(N[T]<=0),o&&D.push(N[O]<=0,N[I]<=0),D.every(function(t){return t})){A=M,E=!1;break}x.set(M,D)}if(E)for(var U=function(t){var e=b.find(function(e){var n=x.get(e);if(n)return n.slice(0,t).every(function(t){return t})});if(e)return A=e,"break"},L=p?3:1;L>0;L--){if("break"===U(L))break}e.placement!==A&&(e.modifiersData[r]._skip=!0,e.placement=A,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Ti(t,e,n){return void 0===n&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function Ri(t){return[Er,Sr,Ar,Mr].some(function(e){return t[e]>=0})}var Ci={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,a=Si(e,{elementContext:"reference"}),o=Si(e,{altBoundary:!0}),l=Ti(a,r),c=Ti(o,i,s),u=Ri(l),h=Ri(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}};var Pi={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,n=t.options,r=t.name,i=n.offset,s=void 0===i?[0,0]:i,a=Dr.reduce(function(t,n){return t[n]=function(t,e,n){var r=Gr(t),i=[Mr,Er].indexOf(r)>=0?-1:1,s="function"==typeof n?n(Object.assign({},e,{placement:t})):n,a=s[0],o=s[1];return a=a||0,o=(o||0)*i,[Mr,Sr].indexOf(r)>=0?{x:o,y:a}:{x:a,y:o}}(n,e.rects,s),t},{}),o=a[e.placement],l=o.x,c=o.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=a}};var Ni={name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,n=t.name;e.modifiersData[n]=Ai({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})},data:{}};var Oi={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,s=void 0===i||i,a=n.altAxis,o=void 0!==a&&a,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,h=n.padding,d=n.tether,f=void 0===d||d,p=n.tetherOffset,m=void 0===p?0:p,g=Si(e,{boundary:l,rootBoundary:c,padding:h,altBoundary:u}),v=Gr(e.placement),y=ai(e.placement),b=!y,w=ei(v),_=function(t){return"x"===t?"y":"x"}(w),x=e.modifiersData.popperOffsets,E=e.rects.reference,A=e.rects.popper,S="function"==typeof m?m(Object.assign({},e.rects,{placement:e.placement})):m,M="number"==typeof S?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),T=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,R={x:0,y:0};if(x){if(s){var C,P="y"===w?Er:Mr,N="y"===w?Ar:Sr,O="y"===w?"height":"width",I=x[w],D=I+g[P],U=I-g[N],L=f?-A[O]/2:0,F=y===Cr?E[O]:A[O],k=y===Cr?-A[O]:-E[O],B=e.elements.arrow,z=f&&B?Xr(B):{width:0,height:0},H=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},G=H[P],V=H[N],j=ni(0,E[O],z[O]),W=b?E[O]/2-L-j-G-M.mainAxis:F-j-G-M.mainAxis,q=b?-E[O]/2+L+j+V+M.mainAxis:k+j+V+M.mainAxis,X=e.elements.arrow&&ti(e.elements.arrow),K=X?"y"===w?X.clientTop||0:X.clientLeft||0:0,Y=null!=(C=null==T?void 0:T[w])?C:0,J=I+q-Y,Q=ni(f?jr(D,I+W-Y-K):D,I,f?Vr(U,J):U);x[w]=Q,R[w]=Q-I}if(o){var Z,$="x"===w?Er:Mr,tt="x"===w?Ar:Sr,et=x[_],nt="y"===_?"height":"width",rt=et+g[$],it=et-g[tt],st=-1!==[Er,Mr].indexOf(v),at=null!=(Z=null==T?void 0:T[_])?Z:0,ot=st?rt:et-E[nt]-A[nt]-at+M.altAxis,lt=st?et+E[nt]+A[nt]-at-M.altAxis:it,ct=f&&st?function(t,e,n){var r=ni(t,e,n);return r>n?n:r}(ot,et,lt):ni(f?ot:rt,et,f?lt:it);x[_]=ct,R[_]=ct-et}e.modifiersData[r]=R}},requiresIfExists:["offset"]};function Ii(t,e,n){void 0===n&&(n=!1);var r=Br(e),i=Br(e)&&function(t){var e=t.getBoundingClientRect(),n=Wr(e.width)/t.offsetWidth||1,r=Wr(e.height)/t.offsetHeight||1;return 1!==n||1!==r}(e),s=Qr(e),a=qr(t,i),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&(("body"!==Lr(e)||yi(s))&&(o=function(t){return t!==Fr(t)&&Br(t)?function(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}(t):gi(t)}(e)),Br(e)?((l=qr(e,!0)).x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=vi(s))),{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function Di(t){var e=new Map,n=new Set,r=[];function i(t){n.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach(function(t){if(!n.has(t)){var r=e.get(t);r&&i(r)}}),r.push(t)}return t.forEach(function(t){e.set(t.name,t)}),t.forEach(function(t){n.has(t.name)||i(t)}),r}function Ui(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}var Li={placement:"bottom",modifiers:[],strategy:"absolute"};function Fi(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(t){return!(t&&"function"==typeof t.getBoundingClientRect)})}function ki(t){void 0===t&&(t={});var e=t,n=e.defaultModifiers,r=void 0===n?[]:n,i=e.defaultOptions,s=void 0===i?Li:i;return function(t,e,n){void 0===n&&(n=s);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},Li,s),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},a=[],o=!1,l={state:i,setOptions:function(n){var o="function"==typeof n?n(i.options):n;c(),i.options=Object.assign({},s,i.options,o),i.scrollParents={reference:kr(t)?wi(t):t.contextElement?wi(t.contextElement):[],popper:wi(e)};var u=function(t){var e=Di(t);return Ur.reduce(function(t,n){return t.concat(e.filter(function(t){return t.phase===n}))},[])}(function(t){var e=t.reduce(function(t,e){var n=t[e.name];return t[e.name]=n?Object.assign({},n,e,{options:Object.assign({},n.options,e.options),data:Object.assign({},n.data,e.data)}):e,t},{});return Object.keys(e).map(function(t){return e[t]})}([].concat(r,i.options.modifiers)));return i.orderedModifiers=u.filter(function(t){return t.enabled}),i.orderedModifiers.forEach(function(t){var e=t.name,n=t.options,r=void 0===n?{}:n,s=t.effect;if("function"==typeof s){var o=s({state:i,name:e,instance:l,options:r}),c=function(){};a.push(o||c)}}),l.update()},forceUpdate:function(){if(!o){var t=i.elements,e=t.reference,n=t.popper;if(Fi(e,n)){i.rects={reference:Ii(e,ti(n),"fixed"===i.options.strategy),popper:Xr(n)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach(function(t){return i.modifiersData[t.name]=Object.assign({},t.data)});for(var r=0;r<i.orderedModifiers.length;r++)if(!0!==i.reset){var s=i.orderedModifiers[r],a=s.fn,c=s.options,u=void 0===c?{}:c,h=s.name;"function"==typeof a&&(i=a({state:i,options:u,name:h,instance:l})||i)}else i.reset=!1,r=-1}}},update:Ui(function(){return new Promise(function(t){l.forceUpdate(),t(i)})}),destroy:function(){c(),o=!0}};if(!Fi(t,e))return l;function c(){a.forEach(function(t){return t()}),a=[]}return l.setOptions(n).then(function(t){!o&&n.onFirstUpdate&&n.onFirstUpdate(t)}),l}}ki(),ki({defaultModifiers:[hi,Ni,ci,Hr]});var Bi=ki({defaultModifiers:[hi,Ni,ci,Hr,Pi,Mi,Oi,si,Ci]});function zi(t,e){(function(t){return"string"==typeof t&&-1!==t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var n=function(t){return"string"==typeof t&&-1!==t.indexOf("%")}(t);return t=360===e?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:t=360===e?(t<0?t%e+e:t%e)/parseFloat(String(e)):t%e/parseFloat(String(e))}function Hi(t){return Math.min(1,Math.max(0,t))}function Gi(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Vi(t){return t<=1?"".concat(100*Number(t),"%"):t}function ji(t){return 1===t.length?"0"+t:String(t)}function Wi(t,e,n){t=zi(t,255),e=zi(e,255),n=zi(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),s=0,a=0,o=(r+i)/2;if(r===i)a=0,s=0;else{var l=r-i;switch(a=o>.5?l/(2-r-i):l/(r+i),r){case t:s=(e-n)/l+(e<n?6:0);break;case e:s=(n-t)/l+2;break;case n:s=(t-e)/l+4}s/=6}return{h:s,s:a,l:o}}function qi(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*n*(e-t):n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Xi(t,e,n){t=zi(t,255),e=zi(e,255),n=zi(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),s=0,a=r,o=r-i,l=0===r?0:o/r;if(r===i)s=0;else{switch(r){case t:s=(e-n)/o+(e<n?6:0);break;case e:s=(n-t)/o+2;break;case n:s=(t-e)/o+4}s/=6}return{h:s,s:l,v:a}}function Ki(t,e,n,r){var i=[ji(Math.round(t).toString(16)),ji(Math.round(e).toString(16)),ji(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function Yi(t){return Ji(t)/255}function Ji(t){return parseInt(t,16)}var Qi={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Zi(t){var e,n,r,i={r:0,g:0,b:0},s=1,a=null,o=null,l=null,c=!1,u=!1;return"string"==typeof t&&(t=function(t){if(t=t.trim().toLowerCase(),0===t.length)return!1;var e=!1;if(Qi[t])t=Qi[t],e=!0;else if("transparent"===t)return{r:0,g:0,b:0,a:0,format:"name"};var n=ns.rgb.exec(t);if(n)return{r:n[1],g:n[2],b:n[3]};if(n=ns.rgba.exec(t),n)return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=ns.hsl.exec(t),n)return{h:n[1],s:n[2],l:n[3]};if(n=ns.hsla.exec(t),n)return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=ns.hsv.exec(t),n)return{h:n[1],s:n[2],v:n[3]};if(n=ns.hsva.exec(t),n)return{h:n[1],s:n[2],v:n[3],a:n[4]};if(n=ns.hex8.exec(t),n)return{r:Ji(n[1]),g:Ji(n[2]),b:Ji(n[3]),a:Yi(n[4]),format:e?"name":"hex8"};if(n=ns.hex6.exec(t),n)return{r:Ji(n[1]),g:Ji(n[2]),b:Ji(n[3]),format:e?"name":"hex"};if(n=ns.hex4.exec(t),n)return{r:Ji(n[1]+n[1]),g:Ji(n[2]+n[2]),b:Ji(n[3]+n[3]),a:Yi(n[4]+n[4]),format:e?"name":"hex8"};if(n=ns.hex3.exec(t),n)return{r:Ji(n[1]+n[1]),g:Ji(n[2]+n[2]),b:Ji(n[3]+n[3]),format:e?"name":"hex"};return!1}(t)),"object"==typeof t&&(rs(t.r)&&rs(t.g)&&rs(t.b)?(e=t.r,n=t.g,r=t.b,i={r:255*zi(e,255),g:255*zi(n,255),b:255*zi(r,255)},c=!0,u="%"===String(t.r).substr(-1)?"prgb":"rgb"):rs(t.h)&&rs(t.s)&&rs(t.v)?(a=Vi(t.s),o=Vi(t.v),i=function(t,e,n){t=6*zi(t,360),e=zi(e,100),n=zi(n,100);var r=Math.floor(t),i=t-r,s=n*(1-e),a=n*(1-i*e),o=n*(1-(1-i)*e),l=r%6;return{r:255*[n,a,s,s,o,n][l],g:255*[o,n,n,a,s,s][l],b:255*[s,s,o,n,n,a][l]}}(t.h,a,o),c=!0,u="hsv"):rs(t.h)&&rs(t.s)&&rs(t.l)&&(a=Vi(t.s),l=Vi(t.l),i=function(t,e,n){var r,i,s;if(t=zi(t,360),e=zi(e,100),n=zi(n,100),0===e)i=n,s=n,r=n;else{var a=n<.5?n*(1+e):n+e-n*e,o=2*n-a;r=qi(o,a,t+1/3),i=qi(o,a,t),s=qi(o,a,t-1/3)}return{r:255*r,g:255*i,b:255*s}}(t.h,a,l),c=!0,u="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(s=t.a)),s=Gi(s),{ok:c,format:t.format||u,r:Math.min(255,Math.max(i.r,0)),g:Math.min(255,Math.max(i.g,0)),b:Math.min(255,Math.max(i.b,0)),a:s}}var $i="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),ts="[\\s|\\(]+(".concat($i,")[,|\\s]+(").concat($i,")[,|\\s]+(").concat($i,")\\s*\\)?"),es="[\\s|\\(]+(".concat($i,")[,|\\s]+(").concat($i,")[,|\\s]+(").concat($i,")[,|\\s]+(").concat($i,")\\s*\\)?"),ns={CSS_UNIT:new RegExp($i),rgb:new RegExp("rgb"+ts),rgba:new RegExp("rgba"+es),hsl:new RegExp("hsl"+ts),hsla:new RegExp("hsla"+es),hsv:new RegExp("hsv"+ts),hsva:new RegExp("hsva"+es),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function rs(t){return Boolean(ns.CSS_UNIT.exec(String(t)))}var is=function(){function t(e,n){var r;if(void 0===e&&(e=""),void 0===n&&(n={}),e instanceof t)return e;"number"==typeof e&&(e=function(t){return{r:t>>16,g:(65280&t)>>8,b:255&t}}(e)),this.originalInput=e;var i=Zi(e);this.originalInput=e,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(r=n.format)&&void 0!==r?r:i.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},t.prototype.getLuminance=function(){var t=this.toRgb(),e=t.r/255,n=t.g/255,r=t.b/255;return.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(t){return this.a=Gi(t),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){return 0===this.toHsl().s},t.prototype.toHsv=function(){var t=Xi(this.r,this.g,this.b);return{h:360*t.h,s:t.s,v:t.v,a:this.a}},t.prototype.toHsvString=function(){var t=Xi(this.r,this.g,this.b),e=Math.round(360*t.h),n=Math.round(100*t.s),r=Math.round(100*t.v);return 1===this.a?"hsv(".concat(e,", ").concat(n,"%, ").concat(r,"%)"):"hsva(".concat(e,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var t=Wi(this.r,this.g,this.b);return{h:360*t.h,s:t.s,l:t.l,a:this.a}},t.prototype.toHslString=function(){var t=Wi(this.r,this.g,this.b),e=Math.round(360*t.h),n=Math.round(100*t.s),r=Math.round(100*t.l);return 1===this.a?"hsl(".concat(e,", ").concat(n,"%, ").concat(r,"%)"):"hsla(".concat(e,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(t){return void 0===t&&(t=!1),Ki(this.r,this.g,this.b,t)},t.prototype.toHexString=function(t){return void 0===t&&(t=!1),"#"+this.toHex(t)},t.prototype.toHex8=function(t){return void 0===t&&(t=!1),function(t,e,n,r,i){var s,a=[ji(Math.round(t).toString(16)),ji(Math.round(e).toString(16)),ji(Math.round(n).toString(16)),ji((s=r,Math.round(255*parseFloat(s)).toString(16)))];return i&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}(this.r,this.g,this.b,this.a,t)},t.prototype.toHex8String=function(t){return void 0===t&&(t=!1),"#"+this.toHex8(t)},t.prototype.toHexShortString=function(t){return void 0===t&&(t=!1),1===this.a?this.toHexString(t):this.toHex8String(t)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var t=Math.round(this.r),e=Math.round(this.g),n=Math.round(this.b);return 1===this.a?"rgb(".concat(t,", ").concat(e,", ").concat(n,")"):"rgba(".concat(t,", ").concat(e,", ").concat(n,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var t=function(t){return"".concat(Math.round(100*zi(t,255)),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var t=function(t){return Math.round(100*zi(t,255))};return 1===this.a?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var t="#"+Ki(this.r,this.g,this.b,!1),e=0,n=Object.entries(Qi);e<n.length;e++){var r=n[e],i=r[0];if(t===r[1])return i}return!1},t.prototype.toString=function(t){var e=Boolean(t);t=null!=t?t:this.format;var n=!1,r=this.a<1&&this.a>=0;return e||!r||!t.startsWith("hex")&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString()):"name"===t&&0===this.a?this.toName():this.toRgbString()},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){void 0===e&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=Hi(n.l),new t(n)},t.prototype.brighten=function(e){void 0===e&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-e/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-e/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-e/100*255))),new t(n)},t.prototype.darken=function(e){void 0===e&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=Hi(n.l),new t(n)},t.prototype.tint=function(t){return void 0===t&&(t=10),this.mix("white",t)},t.prototype.shade=function(t){return void 0===t&&(t=10),this.mix("black",t)},t.prototype.desaturate=function(e){void 0===e&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=Hi(n.s),new t(n)},t.prototype.saturate=function(e){void 0===e&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=Hi(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,new t(n)},t.prototype.mix=function(e,n){void 0===n&&(n=50);var r=this.toRgb(),i=new t(e).toRgb(),s=n/100;return new t({r:(i.r-r.r)*s+r.r,g:(i.g-r.g)*s+r.g,b:(i.b-r.b)*s+r.b,a:(i.a-r.a)*s+r.a})},t.prototype.analogous=function(e,n){void 0===e&&(e=6),void 0===n&&(n=30);var r=this.toHsl(),i=360/n,s=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,s.push(new t(r));return s},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){void 0===e&&(e=6);for(var n=this.toHsv(),r=n.h,i=n.s,s=n.v,a=[],o=1/e;e--;)a.push(new t({h:r,s:i,v:s})),s=(s+o)%1;return a},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),r=new t(e).toRgb(),i=n.a+r.a*(1-n.a);return new t({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),r=n.h,i=[this],s=360/e,a=1;a<e;a++)i.push(new t({h:(r+a*s)%360,s:n.s,l:n.l}));return i},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}();function ss(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var as,os={exports:{}};var ls=(as||(as=1,os.exports=function(){var t=1e3,e=6e4,n=36e5,r="millisecond",i="second",s="minute",a="hour",o="day",l="week",c="month",u="quarter",h="year",d="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},v=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},y={s:v,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+v(r,2,"0")+":"+v(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,c),s=n-i<0,a=e.clone().add(r+(s?-1:1),c);return+(-(r+(n-i)/(s?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:h,w:l,d:o,D:d,h:a,m:s,s:i,ms:r,Q:u}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},b="en",w={};w[b]=g;var _="$isDayjsObject",x=function(t){return t instanceof M||!(!t||!t[_])},E=function t(e,n,r){var i;if(!e)return b;if("string"==typeof e){var s=e.toLowerCase();w[s]&&(i=s),n&&(w[s]=n,i=s);var a=e.split("-");if(!i&&a.length>1)return t(a[0])}else{var o=e.name;w[o]=e,i=o}return!r&&i&&(b=i),i||!r&&b},A=function(t,e){if(x(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new M(n)},S=y;S.l=E,S.i=x,S.w=function(t,e){return A(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var M=function(){function g(t){this.$L=E(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[_]=!0}var v=g.prototype;return v.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(S.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(p);if(r){var i=r[2]-1||0,s=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.init()},v.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},v.$utils=function(){return S},v.isValid=function(){return!(this.$d.toString()===f)},v.isSame=function(t,e){var n=A(t);return this.startOf(e)<=n&&n<=this.endOf(e)},v.isAfter=function(t,e){return A(t)<this.startOf(e)},v.isBefore=function(t,e){return this.endOf(e)<A(t)},v.$g=function(t,e,n){return S.u(t)?this[e]:this.set(n,t)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(t,e){var n=this,r=!!S.u(e)||e,u=S.p(t),f=function(t,e){var i=S.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(o)},p=function(t,e){return S.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(u){case h:return r?f(1,0):f(31,11);case c:return r?f(1,g):f(0,g+1);case l:var b=this.$locale().weekStart||0,w=(m<b?m+7:m)-b;return f(r?v-w:v+(6-w),g);case o:case d:return p(y+"Hours",0);case a:return p(y+"Minutes",1);case s:return p(y+"Seconds",2);case i:return p(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(t){return this.startOf(t,!1)},v.$set=function(t,e){var n,l=S.p(t),u="set"+(this.$u?"UTC":""),f=(n={},n[o]=u+"Date",n[d]=u+"Date",n[c]=u+"Month",n[h]=u+"FullYear",n[a]=u+"Hours",n[s]=u+"Minutes",n[i]=u+"Seconds",n[r]=u+"Milliseconds",n)[l],p=l===o?this.$D+(e-this.$W):e;if(l===c||l===h){var m=this.clone().set(d,1);m.$d[f](p),m.init(),this.$d=m.set(d,Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},v.set=function(t,e){return this.clone().$set(t,e)},v.get=function(t){return this[S.p(t)]()},v.add=function(r,u){var d,f=this;r=Number(r);var p=S.p(u),m=function(t){var e=A(f);return S.w(e.date(e.date()+Math.round(t*r)),f)};if(p===c)return this.set(c,this.$M+r);if(p===h)return this.set(h,this.$y+r);if(p===o)return m(1);if(p===l)return m(7);var g=(d={},d[s]=e,d[a]=n,d[i]=t,d)[p]||1,v=this.$d.getTime()+r*g;return S.w(v,this)},v.subtract=function(t,e){return this.add(-1*t,e)},v.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=S.z(this),s=this.$H,a=this.$m,o=this.$M,l=n.weekdays,c=n.months,u=n.meridiem,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].slice(0,s)},d=function(t){return S.s(s%12||12,t,"0")},p=u||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(m,function(t,r){return r||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return S.s(e.$y,4,"0");case"M":return o+1;case"MM":return S.s(o+1,2,"0");case"MMM":return h(n.monthsShort,o,c,3);case"MMMM":return h(c,o);case"D":return e.$D;case"DD":return S.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return h(n.weekdaysMin,e.$W,l,2);case"ddd":return h(n.weekdaysShort,e.$W,l,3);case"dddd":return l[e.$W];case"H":return String(s);case"HH":return S.s(s,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return p(s,a,!0);case"A":return p(s,a,!1);case"m":return String(a);case"mm":return S.s(a,2,"0");case"s":return String(e.$s);case"ss":return S.s(e.$s,2,"0");case"SSS":return S.s(e.$ms,3,"0");case"Z":return i}return null}(t)||i.replace(":","")})},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,d,f){var p,m=this,g=S.p(d),v=A(r),y=(v.utcOffset()-this.utcOffset())*e,b=this-v,w=function(){return S.m(m,v)};switch(g){case h:p=w()/12;break;case c:p=w();break;case u:p=w()/3;break;case l:p=(b-y)/6048e5;break;case o:p=(b-y)/864e5;break;case a:p=b/n;break;case s:p=b/e;break;case i:p=b/t;break;default:p=b}return f?p:S.a(p)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return w[this.$L]},v.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=E(t,e,!0);return r&&(n.$L=r),n},v.clone=function(){return S.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),T=M.prototype;return A.prototype=T,[["$ms",r],["$s",i],["$m",s],["$H",a],["$W",o],["$M",c],["$y",h],["$D",d]].forEach(function(t){T[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),A.extend=function(t,e){return t.$i||(t(e,M,A),t.$i=!0),A},A.locale=E,A.isDayjs=x,A.unix=function(t){return A(1e3*t)},A.en=w[b],A.Ls=w,A.p={},A}()),os.exports);const cs=ss(ls);var us,hs={exports:{}};var ds=us?hs.exports:(us=1,hs.exports=function(t,e,n){var r=e.prototype,i=function(t){return t&&(t.indexOf?t:t.s)},s=function(t,e,n,r,s){var a=t.name?t:t.$locale(),o=i(a[e]),l=i(a[n]),c=o||l.map(function(t){return t.slice(0,r)});if(!s)return c;var u=a.weekStart;return c.map(function(t,e){return c[(e+(u||0))%7]})},a=function(){return n.Ls[n.locale()]},o=function(t,e){return t.formats[e]||t.formats[e.toUpperCase()].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(t,e,n){return e||n.slice(1)})},l=function(){var t=this;return{months:function(e){return e?e.format("MMMM"):s(t,"months")},monthsShort:function(e){return e?e.format("MMM"):s(t,"monthsShort","months",3)},firstDayOfWeek:function(){return t.$locale().weekStart||0},weekdays:function(e){return e?e.format("dddd"):s(t,"weekdays")},weekdaysMin:function(e){return e?e.format("dd"):s(t,"weekdaysMin","weekdays",2)},weekdaysShort:function(e){return e?e.format("ddd"):s(t,"weekdaysShort","weekdays",3)},longDateFormat:function(e){return o(t.$locale(),e)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};r.localeData=function(){return l.bind(this)()},n.localeData=function(){var t=a();return{firstDayOfWeek:function(){return t.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(e){return o(t,e)},meridiem:t.meridiem,ordinal:t.ordinal}},n.months=function(){return s(a(),"months")},n.monthsShort=function(){return s(a(),"monthsShort","months",3)},n.weekdays=function(t){return s(a(),"weekdays",null,null,t)},n.weekdaysShort=function(t){return s(a(),"weekdaysShort","weekdays",3,t)},n.weekdaysMin=function(t){return s(a(),"weekdaysMin","weekdays",2,t)}});const fs=ss(ds);var ps,ms={exports:{}};var gs=ps?ms.exports:(ps=1,ms.exports=function(){var t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},e=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\d/,r=/\d\d/,i=/\d\d?/,s=/\d*[^-_:/,()\s\d]+/,a={},o=function(t){return(t=+t)+(t>68?1900:2e3)},l=function(t){return function(e){this[t]=+e}},c=[/[+-]\d\d:?(\d\d)?|Z/,function(t){(this.zone||(this.zone={})).offset=function(t){if(!t)return 0;if("Z"===t)return 0;var e=t.match(/([+-]|\d\d)/g),n=60*e[1]+(+e[2]||0);return 0===n?0:"+"===e[0]?-n:n}(t)}],u=function(t){var e=a[t];return e&&(e.indexOf?e:e.s.concat(e.f))},h=function(t,e){var n,r=a.meridiem;if(r){for(var i=1;i<=24;i+=1)if(t.indexOf(r(i,0,e))>-1){n=i>12;break}}else n=t===(e?"pm":"PM");return n},d={A:[s,function(t){this.afternoon=h(t,!1)}],a:[s,function(t){this.afternoon=h(t,!0)}],Q:[n,function(t){this.month=3*(t-1)+1}],S:[n,function(t){this.milliseconds=100*+t}],SS:[r,function(t){this.milliseconds=10*+t}],SSS:[/\d{3}/,function(t){this.milliseconds=+t}],s:[i,l("seconds")],ss:[i,l("seconds")],m:[i,l("minutes")],mm:[i,l("minutes")],H:[i,l("hours")],h:[i,l("hours")],HH:[i,l("hours")],hh:[i,l("hours")],D:[i,l("day")],DD:[r,l("day")],Do:[s,function(t){var e=a.ordinal,n=t.match(/\d+/);if(this.day=n[0],e)for(var r=1;r<=31;r+=1)e(r).replace(/\[|\]/g,"")===t&&(this.day=r)}],w:[i,l("week")],ww:[r,l("week")],M:[i,l("month")],MM:[r,l("month")],MMM:[s,function(t){var e=u("months"),n=(u("monthsShort")||e.map(function(t){return t.slice(0,3)})).indexOf(t)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[s,function(t){var e=u("months").indexOf(t)+1;if(e<1)throw new Error;this.month=e%12||e}],Y:[/[+-]?\d+/,l("year")],YY:[r,function(t){this.year=o(t)}],YYYY:[/\d{4}/,l("year")],Z:c,ZZ:c};function f(n){var r,i;r=n,i=a&&a.formats;for(var s=(n=r.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(e,n,r){var s=r&&r.toUpperCase();return n||i[r]||t[r]||i[s].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(t,e,n){return e||n.slice(1)})})).match(e),o=s.length,l=0;l<o;l+=1){var c=s[l],u=d[c],h=u&&u[0],f=u&&u[1];s[l]=f?{regex:h,parser:f}:c.replace(/^\[|\]$/g,"")}return function(t){for(var e={},n=0,r=0;n<o;n+=1){var i=s[n];if("string"==typeof i)r+=i.length;else{var a=i.regex,l=i.parser,c=t.slice(r),u=a.exec(c)[0];l.call(e,u),t=t.replace(u,"")}}return function(t){var e=t.afternoon;if(void 0!==e){var n=t.hours;e?n<12&&(t.hours+=12):12===n&&(t.hours=0),delete t.afternoon}}(e),e}}return function(t,e,n){n.p.customParseFormat=!0,t&&t.parseTwoDigitYear&&(o=t.parseTwoDigitYear);var r=e.prototype,i=r.parse;r.parse=function(t){var e=t.date,r=t.utc,s=t.args;this.$u=r;var o=s[1];if("string"==typeof o){var l=!0===s[2],c=!0===s[3],u=l||c,h=s[2];c&&(h=s[2]),a=this.$locale(),!l&&h&&(a=n.Ls[h]),this.$d=function(t,e,n,r){try{if(["x","X"].indexOf(e)>-1)return new Date(("X"===e?1e3:1)*t);var i=f(e)(t),s=i.year,a=i.month,o=i.day,l=i.hours,c=i.minutes,u=i.seconds,h=i.milliseconds,d=i.zone,p=i.week,m=new Date,g=o||(s||a?1:m.getDate()),v=s||m.getFullYear(),y=0;s&&!a||(y=a>0?a-1:m.getMonth());var b,w=l||0,_=c||0,x=u||0,E=h||0;return d?new Date(Date.UTC(v,y,g,w,_,x,E+60*d.offset*1e3)):n?new Date(Date.UTC(v,y,g,w,_,x,E)):(b=new Date(v,y,g,w,_,x,E),p&&(b=r(b).week(p).toDate()),b)}catch(A){return new Date("")}}(e,o,r,n),this.init(),h&&!0!==h&&(this.$L=this.locale(h).$L),u&&e!=this.format(o)&&(this.$d=new Date("")),a={}}else if(o instanceof Array)for(var d=o.length,p=1;p<=d;p+=1){s[1]=o[p-1];var m=n.apply(this,s);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}p===d&&(this.$d=new Date(""))}else i.call(this,t)}}}());const vs=ss(gs);var ys,bs={exports:{}};var ws=ys?bs.exports:(ys=1,bs.exports=function(t,e){var n=e.prototype,r=n.format;n.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return r.bind(this)(t);var i=this.$utils(),s=(t||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(t){switch(t){case"Q":return Math.ceil((e.$M+1)/3);case"Do":return n.ordinal(e.$D);case"gggg":return e.weekYear();case"GGGG":return e.isoWeekYear();case"wo":return n.ordinal(e.week(),"W");case"w":case"ww":return i.s(e.week(),"w"===t?1:2,"0");case"W":case"WW":return i.s(e.isoWeek(),"W"===t?1:2,"0");case"k":case"kk":return i.s(String(0===e.$H?24:e.$H),"k"===t?1:2,"0");case"X":return Math.floor(e.$d.getTime()/1e3);case"x":return e.$d.getTime();case"z":return"["+e.offsetName()+"]";case"zzz":return"["+e.offsetName("long")+"]";default:return t}});return r.bind(this)(s)}});const _s=ss(ws);var xs,Es,As,Ss={exports:{}};const Ms=ss(xs?Ss.exports:(xs=1,Ss.exports=(Es="week",As="year",function(t,e,n){var r=e.prototype;r.week=function(t){if(void 0===t&&(t=null),null!==t)return this.add(7*(t-this.week()),"day");var e=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var r=n(this).startOf(As).add(1,As).date(e),i=n(this).endOf(Es);if(r.isBefore(i))return 1}var s=n(this).startOf(As).date(e).startOf(Es).subtract(1,"millisecond"),a=this.diff(s,Es,!0);return a<0?n(this).startOf("week").week():Math.ceil(a)},r.weeks=function(t){return void 0===t&&(t=null),this.week(t)}})));var Ts,Rs={exports:{}};var Cs=(Ts||(Ts=1,Rs.exports=function(t,e){e.prototype.weekYear=function(){var t=this.month(),e=this.week(),n=this.year();return 1===e&&11===t?n+1:0===t&&e>=52?n-1:n}}),Rs.exports);const Ps=ss(Cs);var Ns,Os={exports:{}};var Is=(Ns||(Ns=1,Os.exports=function(t,e,n){e.prototype.dayOfYear=function(t){var e=Math.round((n(this).startOf("day")-n(this).startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"day")}}),Os.exports);const Ds=ss(Is);var Us,Ls={exports:{}};var Fs=(Us||(Us=1,Ls.exports=function(t,e){e.prototype.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)}}),Ls.exports);const ks=ss(Fs);var Bs,zs={exports:{}};const Hs=ss(Bs?zs.exports:(Bs=1,zs.exports=function(t,e){e.prototype.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)}}));function Gs(){return Gs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gs.apply(this,arguments)}function Vs(t){return(Vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function js(t,e){return(js=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ws(t,e,n){return(Ws=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Es){return!1}}()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&js(i,n.prototype),i}).apply(null,arguments)}function qs(t){var e="function"==typeof Map?new Map:void 0;return qs=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Ws(t,arguments,Vs(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),js(r,t)},qs(t)}var Xs=/%[sdj%]/g;function Ks(t){if(!t||!t.length)return null;var e={};return t.forEach(function(t){var n=t.field;e[n]=e[n]||[],e[n].push(t)}),e}function Ys(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=0,s=n.length;return"function"==typeof t?t.apply(null,n):"string"==typeof t?t.replace(Xs,function(t){if("%%"===t)return"%";if(i>=s)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}break;default:return t}}):t}function Js(t,e){return null==t||(!("array"!==e||!Array.isArray(t)||t.length)||!(!function(t){return"string"===t||"url"===t||"hex"===t||"email"===t||"date"===t||"pattern"===t}(e)||"string"!=typeof t||t))}function Qs(t,e,n){var r=0,i=t.length;!function s(a){if(a&&a.length)n(a);else{var o=r;r+=1,o<i?e(t[o],s):n([])}}([])}var Zs=function(t){var e,n;function r(e,n){var r;return(r=t.call(this,"Async Validation Error")||this).errors=e,r.fields=n,r}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,js(e,n),r}(qs(Error));function $s(t,e,n,r,i){if(e.first){var s=new Promise(function(e,s){var a=function(t){var e=[];return Object.keys(t).forEach(function(n){e.push.apply(e,t[n]||[])}),e}(t);Qs(a,n,function(t){return r(t),t.length?s(new Zs(t,Ks(t))):e(i)})});return s.catch(function(t){return t}),s}var a=!0===e.firstFields?Object.keys(t):e.firstFields||[],o=Object.keys(t),l=o.length,c=0,u=[],h=new Promise(function(e,s){var h=function(t){if(u.push.apply(u,t),++c===l)return r(u),u.length?s(new Zs(u,Ks(u))):e(i)};o.length||(r(u),e(i)),o.forEach(function(e){var r=t[e];-1!==a.indexOf(e)?Qs(r,n,h):function(t,e,n){var r=[],i=0,s=t.length;function a(t){r.push.apply(r,t||[]),++i===s&&n(r)}t.forEach(function(t){e(t,a)})}(r,n,h)})});return h.catch(function(t){return t}),h}function ta(t,e){return function(n){var r,i;return r=t.fullFields?function(t,e){for(var n=t,r=0;r<e.length;r++){if(null==n)return n;n=n[e[r]]}return n}(e,t.fullFields):e[n.field||t.fullField],(i=n)&&void 0!==i.message?(n.field=n.field||t.fullField,n.fieldValue=r,n):{message:"function"==typeof n?n():n,fieldValue:r,field:n.field||t.fullField}}}function ea(t,e){if(e)for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];"object"==typeof r&&"object"==typeof t[n]?t[n]=Gs({},t[n],r):t[n]=r}return t}var na,ra=function(t,e,n,r,i,s){!t.required||n.hasOwnProperty(t.field)&&!Js(e,s||t.type)||r.push(Ys(i.messages.required,t.fullField))},ia=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,sa=/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i,aa={integer:function(t){return aa.number(t)&&parseInt(t,10)===t},float:function(t){return aa.number(t)&&!aa.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch(Es){return!1}},date:function(t){return"function"==typeof t.getTime&&"function"==typeof t.getMonth&&"function"==typeof t.getYear&&!isNaN(t.getTime())},number:function(t){return!isNaN(t)&&"number"==typeof t},object:function(t){return"object"==typeof t&&!aa.array(t)},method:function(t){return"function"==typeof t},email:function(t){return"string"==typeof t&&t.length<=320&&!!t.match(ia)},url:function(t){return"string"==typeof t&&t.length<=2048&&!!t.match(function(){if(na)return na;var t="[a-fA-F\\d:]",e=function(e){return e&&e.includeBoundaries?"(?:(?<=\\s|^)(?="+t+")|(?<="+t+")(?=\\s|$))":""},n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",r="[a-fA-F\\d]{1,4}",i=("\n(?:\n(?:"+r+":){7}(?:"+r+"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:"+r+":){6}(?:"+n+"|:"+r+"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:"+r+":){5}(?::"+n+"|(?::"+r+"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:"+r+":){4}(?:(?::"+r+"){0,1}:"+n+"|(?::"+r+"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:"+r+":){3}(?:(?::"+r+"){0,2}:"+n+"|(?::"+r+"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:"+r+":){2}(?:(?::"+r+"){0,3}:"+n+"|(?::"+r+"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:"+r+":){1}(?:(?::"+r+"){0,4}:"+n+"|(?::"+r+"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::"+r+"){0,5}:"+n+"|(?::"+r+"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),s=new RegExp("(?:^"+n+"$)|(?:^"+i+"$)"),a=new RegExp("^"+n+"$"),o=new RegExp("^"+i+"$"),l=function(t){return t&&t.exact?s:new RegExp("(?:"+e(t)+n+e(t)+")|(?:"+e(t)+i+e(t)+")","g")};l.v4=function(t){return t&&t.exact?a:new RegExp(""+e(t)+n+e(t),"g")},l.v6=function(t){return t&&t.exact?o:new RegExp(""+e(t)+i+e(t),"g")};var c=l.v4().source,u=l.v6().source;return na=new RegExp("(?:^(?:(?:(?:[a-z]+:)?//)|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|"+c+"|"+u+'|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#][^\\s"]*)?$)',"i")}())},hex:function(t){return"string"==typeof t&&!!t.match(sa)}},oa="enum",la={required:ra,whitespace:function(t,e,n,r,i){(/^\s+$/.test(e)||""===e)&&r.push(Ys(i.messages.whitespace,t.fullField))},type:function(t,e,n,r,i){if(t.required&&void 0===e)ra(t,e,n,r,i);else{var s=t.type;["integer","float","array","regexp","object","method","email","number","date","url","hex"].indexOf(s)>-1?aa[s](e)||r.push(Ys(i.messages.types[s],t.fullField,t.type)):s&&typeof e!==t.type&&r.push(Ys(i.messages.types[s],t.fullField,t.type))}},range:function(t,e,n,r,i){var s="number"==typeof t.len,a="number"==typeof t.min,o="number"==typeof t.max,l=e,c=null,u="number"==typeof e,h="string"==typeof e,d=Array.isArray(e);if(u?c="number":h?c="string":d&&(c="array"),!c)return!1;d&&(l=e.length),h&&(l=e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length),s?l!==t.len&&r.push(Ys(i.messages[c].len,t.fullField,t.len)):a&&!o&&l<t.min?r.push(Ys(i.messages[c].min,t.fullField,t.min)):o&&!a&&l>t.max?r.push(Ys(i.messages[c].max,t.fullField,t.max)):a&&o&&(l<t.min||l>t.max)&&r.push(Ys(i.messages[c].range,t.fullField,t.min,t.max))},enum:function(t,e,n,r,i){t[oa]=Array.isArray(t[oa])?t[oa]:[],-1===t[oa].indexOf(e)&&r.push(Ys(i.messages[oa],t.fullField,t[oa].join(", ")))},pattern:function(t,e,n,r,i){if(t.pattern)if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(e)||r.push(Ys(i.messages.pattern.mismatch,t.fullField,e,t.pattern));else if("string"==typeof t.pattern){new RegExp(t.pattern).test(e)||r.push(Ys(i.messages.pattern.mismatch,t.fullField,e,t.pattern))}}},ca=function(t,e,n,r,i){var s=t.type,a=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e,s)&&!t.required)return n();la.required(t,e,r,a,i,s),Js(e,s)||la.type(t,e,r,a,i)}n(a)},ua={string:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e,"string")&&!t.required)return n();la.required(t,e,r,s,i,"string"),Js(e,"string")||(la.type(t,e,r,s,i),la.range(t,e,r,s,i),la.pattern(t,e,r,s,i),!0===t.whitespace&&la.whitespace(t,e,r,s,i))}n(s)},method:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e)&&!t.required)return n();la.required(t,e,r,s,i),void 0!==e&&la.type(t,e,r,s,i)}n(s)},number:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(""===e&&(e=void 0),Js(e)&&!t.required)return n();la.required(t,e,r,s,i),void 0!==e&&(la.type(t,e,r,s,i),la.range(t,e,r,s,i))}n(s)},boolean:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e)&&!t.required)return n();la.required(t,e,r,s,i),void 0!==e&&la.type(t,e,r,s,i)}n(s)},regexp:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e)&&!t.required)return n();la.required(t,e,r,s,i),Js(e)||la.type(t,e,r,s,i)}n(s)},integer:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e)&&!t.required)return n();la.required(t,e,r,s,i),void 0!==e&&(la.type(t,e,r,s,i),la.range(t,e,r,s,i))}n(s)},float:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e)&&!t.required)return n();la.required(t,e,r,s,i),void 0!==e&&(la.type(t,e,r,s,i),la.range(t,e,r,s,i))}n(s)},array:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(null==e&&!t.required)return n();la.required(t,e,r,s,i,"array"),null!=e&&(la.type(t,e,r,s,i),la.range(t,e,r,s,i))}n(s)},object:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e)&&!t.required)return n();la.required(t,e,r,s,i),void 0!==e&&la.type(t,e,r,s,i)}n(s)},enum:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e)&&!t.required)return n();la.required(t,e,r,s,i),void 0!==e&&la.enum(t,e,r,s,i)}n(s)},pattern:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e,"string")&&!t.required)return n();la.required(t,e,r,s,i),Js(e,"string")||la.pattern(t,e,r,s,i)}n(s)},date:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e,"date")&&!t.required)return n();var a;if(la.required(t,e,r,s,i),!Js(e,"date"))a=e instanceof Date?e:new Date(e),la.type(t,a,r,s,i),a&&la.range(t,a.getTime(),r,s,i)}n(s)},url:ca,hex:ca,email:ca,required:function(t,e,n,r,i){var s=[],a=Array.isArray(e)?"array":typeof e;la.required(t,e,r,s,i,a),n(s)},any:function(t,e,n,r,i){var s=[];if(t.required||!t.required&&r.hasOwnProperty(t.field)){if(Js(e)&&!t.required)return n();la.required(t,e,r,s,i)}n(s)}};function ha(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var da=ha(),fa=function(){function t(t){this.rules=null,this._messages=da,this.define(t)}var e=t.prototype;return e.define=function(t){var e=this;if(!t)throw new Error("Cannot configure a schema with no rules");if("object"!=typeof t||Array.isArray(t))throw new Error("Rules must be an object");this.rules={},Object.keys(t).forEach(function(n){var r=t[n];e.rules[n]=Array.isArray(r)?r:[r]})},e.messages=function(t){return t&&(this._messages=ea(ha(),t)),this._messages},e.validate=function(e,n,r){var i=this;void 0===n&&(n={}),void 0===r&&(r=function(){});var s=e,a=n,o=r;if("function"==typeof a&&(o=a,a={}),!this.rules||0===Object.keys(this.rules).length)return o&&o(null,s),Promise.resolve(s);if(a.messages){var l=this.messages();l===da&&(l=ha()),ea(l,a.messages),a.messages=l}else a.messages=this.messages();var c={};(a.keys||Object.keys(this.rules)).forEach(function(t){var n=i.rules[t],r=s[t];n.forEach(function(n){var a=n;"function"==typeof a.transform&&(s===e&&(s=Gs({},s)),r=s[t]=a.transform(r)),(a="function"==typeof a?{validator:a}:Gs({},a)).validator=i.getValidationMethod(a),a.validator&&(a.field=t,a.fullField=a.fullField||t,a.type=i.getType(a),c[t]=c[t]||[],c[t].push({rule:a,value:r,source:s,field:t}))})});var u={};return $s(c,a,function(e,n){var r,i=e.rule,o=!("object"!==i.type&&"array"!==i.type||"object"!=typeof i.fields&&"object"!=typeof i.defaultField);function l(t,e){return Gs({},e,{fullField:i.fullField+"."+t,fullFields:i.fullFields?[].concat(i.fullFields,[t]):[t]})}function c(r){void 0===r&&(r=[]);var c=Array.isArray(r)?r:[r];!a.suppressWarning&&c.length&&t.warning("async-validator:",c),c.length&&void 0!==i.message&&(c=[].concat(i.message));var h=c.map(ta(i,s));if(a.first&&h.length)return u[i.field]=1,n(h);if(o){if(i.required&&!e.value)return void 0!==i.message?h=[].concat(i.message).map(ta(i,s)):a.error&&(h=[a.error(i,Ys(a.messages.required,i.field))]),n(h);var d={};i.defaultField&&Object.keys(e.value).map(function(t){d[t]=i.defaultField}),d=Gs({},d,e.rule.fields);var f={};Object.keys(d).forEach(function(t){var e=d[t],n=Array.isArray(e)?e:[e];f[t]=n.map(l.bind(null,t))});var p=new t(f);p.messages(a.messages),e.rule.options&&(e.rule.options.messages=a.messages,e.rule.options.error=a.error),p.validate(e.value,e.rule.options||a,function(t){var e=[];h&&h.length&&e.push.apply(e,h),t&&t.length&&e.push.apply(e,t),n(e.length?e:null)})}else n(h)}if(o=o&&(i.required||!i.required&&e.value),i.field=e.field,i.asyncValidator)r=i.asyncValidator(i,e.value,c,e.source,a);else if(i.validator){try{r=i.validator(i,e.value,c,e.source,a)}catch(h){null==console.error||console.error(h),a.suppressValidatorError||setTimeout(function(){throw h},0),c(h.message)}!0===r?c():!1===r?c("function"==typeof i.message?i.message(i.fullField||i.field):i.message||(i.fullField||i.field)+" fails"):r instanceof Array?c(r):r instanceof Error&&c(r.message)}r&&r.then&&r.then(function(){return c()},function(t){return c(t)})},function(t){!function(t){var e=[],n={};function r(t){var n;Array.isArray(t)?e=(n=e).concat.apply(n,t):e.push(t)}for(var i=0;i<t.length;i++)r(t[i]);e.length?(n=Ks(e),o(e,n)):o(null,s)}(t)},s)},e.getType=function(t){if(void 0===t.type&&t.pattern instanceof RegExp&&(t.type="pattern"),"function"!=typeof t.validator&&t.type&&!ua.hasOwnProperty(t.type))throw new Error(Ys("Unknown rule type %s",t.type));return t.type||"string"},e.getValidationMethod=function(t){if("function"==typeof t.validator)return t.validator;var e=Object.keys(t),n=e.indexOf("message");return-1!==n&&e.splice(n,1),1===e.length&&"required"===e[0]?ua.required:ua[this.getType(t)]||void 0},t}();fa.register=function(t,e){if("function"!=typeof e)throw new Error("Cannot register a validator by type, validator is not a function");ua[t]=e},fa.warning=function(){},fa.messages=da,fa.validators=ua;var pa=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function ma(t,e){return t===e||!(!pa(t)||!pa(e))}function ga(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!ma(t[n],e[n]))return!1;return!0}function va(t,e){void 0===e&&(e=ga);var n=null;function r(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(n&&n.lastThis===this&&e(r,n.lastArgs))return n.lastResult;var s=t.apply(this,r);return n={lastResult:s,lastArgs:r,lastThis:this},s}return r.clear=function(){n=null},r}var ya,ba,wa,_a,xa,Ea,Aa,Sa,Ma,Ta,Ra,Ca,Pa,Na,Oa,Ia=!1;function Da(){if(!Ia){Ia=!0;var t=navigator.userAgent,e=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),n=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(Ca=/\b(iPhone|iP[ao]d)/.exec(t),Pa=/\b(iP[ao]d)/.exec(t),Ta=/Android/i.exec(t),Na=/FBAN\/\w+;/i.exec(t),Oa=/Mobile/i.exec(t),Ra=!!/Win64/.exec(t),e){(ya=e[1]?parseFloat(e[1]):e[5]?parseFloat(e[5]):NaN)&&document&&document.documentMode&&(ya=document.documentMode);var r=/(?:Trident\/(\d+.\d+))/.exec(t);Ea=r?parseFloat(r[1])+4:ya,ba=e[2]?parseFloat(e[2]):NaN,wa=e[3]?parseFloat(e[3]):NaN,(_a=e[4]?parseFloat(e[4]):NaN)?(e=/(?:Chrome\/(\d+\.\d+))/.exec(t),xa=e&&e[1]?parseFloat(e[1]):NaN):xa=NaN}else ya=ba=wa=xa=_a=NaN;if(n){if(n[1]){var i=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);Aa=!i||parseFloat(i[1].replace("_","."))}else Aa=!1;Sa=!!n[2],Ma=!!n[3]}else Aa=Sa=Ma=!1}}var Ua,La={ie:function(){return Da()||ya},ieCompatibilityMode:function(){return Da()||Ea>ya},ie64:function(){return La.ie()&&Ra},firefox:function(){return Da()||ba},opera:function(){return Da()||wa},webkit:function(){return Da()||_a},safari:function(){return La.webkit()},chrome:function(){return Da()||xa},windows:function(){return Da()||Sa},osx:function(){return Da()||Aa},linux:function(){return Da()||Ma},iphone:function(){return Da()||Ca},mobile:function(){return Da()||Ca||Pa||Ta||Oa},nativeApp:function(){return Da()||Na},android:function(){return Da()||Ta},ipad:function(){return Da()||Pa}},Fa=La,ka={canUseDOM:!!(typeof window<"u"&&window.document&&window.document.createElement)};ka.canUseDOM&&(Ua=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""));var Ba=function(t,e){if(!ka.canUseDOM||e&&!("addEventListener"in document))return!1;var n="on"+t,r=n in document;if(!r){var i=document.createElement("div");i.setAttribute(n,"return;"),r="function"==typeof i[n]}return!r&&Ua&&"wheel"===t&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r};function za(t){var e=0,n=0,r=0,i=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=n,n=0),r=10*e,i=10*n,"deltaY"in t&&(i=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||i)&&t.deltaMode&&(1==t.deltaMode?(r*=40,i*=40):(r*=800,i*=800)),r&&!e&&(e=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:e,spinY:n,pixelX:r,pixelY:i}}za.getEventType=function(){return Fa.firefox()?"DOMMouseScroll":Ba("wheel")?"wheel":"mousewheel"};var Ha=za;const Ga=Math.min,Va=Math.max,ja=Math.round,Wa=Math.floor,qa=t=>({x:t,y:t}),Xa={left:"right",right:"left",bottom:"top",top:"bottom"},Ka={start:"end",end:"start"};function Ya(t,e,n){return Va(t,Ga(e,n))}function Ja(t,e){return"function"==typeof t?t(e):t}function Qa(t){return t.split("-")[0]}function Za(t){return t.split("-")[1]}function $a(t){return"x"===t?"y":"x"}function to(t){return"y"===t?"height":"width"}const eo=new Set(["top","bottom"]);function no(t){return eo.has(Qa(t))?"y":"x"}function ro(t){return $a(no(t))}function io(t){return t.replace(/start|end/g,t=>Ka[t])}const so=["left","right"],ao=["right","left"],oo=["top","bottom"],lo=["bottom","top"];function co(t,e,n,r){const i=Za(t);let s=function(t,e,n){switch(t){case"top":case"bottom":return n?e?ao:so:e?so:ao;case"left":case"right":return e?oo:lo;default:return[]}}(Qa(t),"start"===n,r);return i&&(s=s.map(t=>t+"-"+i),e&&(s=s.concat(s.map(io)))),s}function uo(t){return t.replace(/left|right|bottom|top/g,t=>Xa[t])}function ho(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function fo(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function po(t,e,n){let{reference:r,floating:i}=t;const s=no(e),a=ro(e),o=to(a),l=Qa(e),c="y"===s,u=r.x+r.width/2-i.width/2,h=r.y+r.height/2-i.height/2,d=r[o]/2-i[o]/2;let f;switch(l){case"top":f={x:u,y:r.y-i.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:h};break;case"left":f={x:r.x-i.width,y:h};break;default:f={x:r.x,y:r.y}}switch(Za(e)){case"start":f[a]-=d*(n&&c?-1:1);break;case"end":f[a]+=d*(n&&c?-1:1)}return f}async function mo(t,e){var n;void 0===e&&(e={});const{x:r,y:i,platform:s,rects:a,elements:o,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=Ja(e,t),p=ho(f),m=o[d?"floating"===h?"reference":"floating":h],g=fo(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(m)))||n?m:m.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),v="floating"===h?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,y=await(null==s.getOffsetParent?void 0:s.getOffsetParent(o.floating)),b=await(null==s.isElement?void 0:s.isElement(y))&&await(null==s.getScale?void 0:s.getScale(y))||{x:1,y:1},w=fo(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-w.top+p.top)/b.y,bottom:(w.bottom-g.bottom+p.bottom)/b.y,left:(g.left-w.left+p.left)/b.x,right:(w.right-g.right+p.right)/b.x}}const go=new Set(["left","top"]);function vo(){return"undefined"!=typeof window}function yo(t){return _o(t)?(t.nodeName||"").toLowerCase():"#document"}function bo(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function wo(t){var e;return null==(e=(_o(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function _o(t){return!!vo()&&(t instanceof Node||t instanceof bo(t).Node)}function xo(t){return!!vo()&&(t instanceof Element||t instanceof bo(t).Element)}function Eo(t){return!!vo()&&(t instanceof HTMLElement||t instanceof bo(t).HTMLElement)}function Ao(t){return!(!vo()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof bo(t).ShadowRoot)}const So=new Set(["inline","contents"]);function Mo(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=ko(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!So.has(i)}const To=new Set(["table","td","th"]);function Ro(t){return To.has(yo(t))}const Co=[":popover-open",":modal"];function Po(t){return Co.some(e=>{try{return t.matches(e)}catch(n){return!1}})}const No=["transform","translate","scale","rotate","perspective"],Oo=["transform","translate","scale","rotate","perspective","filter"],Io=["paint","layout","strict","content"];function Do(t){const e=Uo(),n=xo(t)?ko(t):t;return No.some(t=>!!n[t]&&"none"!==n[t])||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||Oo.some(t=>(n.willChange||"").includes(t))||Io.some(t=>(n.contain||"").includes(t))}function Uo(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const Lo=new Set(["html","body","#document"]);function Fo(t){return Lo.has(yo(t))}function ko(t){return bo(t).getComputedStyle(t)}function Bo(t){return xo(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function zo(t){if("html"===yo(t))return t;const e=t.assignedSlot||t.parentNode||Ao(t)&&t.host||wo(t);return Ao(e)?e.host:e}function Ho(t){const e=zo(t);return Fo(e)?t.ownerDocument?t.ownerDocument.body:t.body:Eo(e)&&Mo(e)?e:Ho(e)}function Go(t,e,n){var r;void 0===e&&(e=[]),void 0===n&&(n=!0);const i=Ho(t),s=i===(null==(r=t.ownerDocument)?void 0:r.body),a=bo(i);if(s){const t=Vo(a);return e.concat(a,a.visualViewport||[],Mo(i)?i:[],t&&n?Go(t):[])}return e.concat(i,Go(i,[],n))}function Vo(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function jo(t){const e=ko(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Eo(t),s=i?t.offsetWidth:n,a=i?t.offsetHeight:r,o=ja(n)!==s||ja(r)!==a;return o&&(n=s,r=a),{width:n,height:r,$:o}}function Wo(t){return xo(t)?t:t.contextElement}function qo(t){const e=Wo(t);if(!Eo(e))return qa(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=jo(e);let a=(s?ja(n.width):n.width)/r,o=(s?ja(n.height):n.height)/i;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}const Xo=qa(0);function Ko(t){const e=bo(t);return Uo()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:Xo}function Yo(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=!1);const i=t.getBoundingClientRect(),s=Wo(t);let a=qa(1);e&&(r?xo(r)&&(a=qo(r)):a=qo(t));const o=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==bo(t))&&e}(s,n,r)?Ko(s):qa(0);let l=(i.left+o.x)/a.x,c=(i.top+o.y)/a.y,u=i.width/a.x,h=i.height/a.y;if(s){const t=bo(s),e=r&&xo(r)?bo(r):r;let n=t,i=Vo(n);for(;i&&r&&e!==n;){const t=qo(i),e=i.getBoundingClientRect(),r=ko(i),s=e.left+(i.clientLeft+parseFloat(r.paddingLeft))*t.x,a=e.top+(i.clientTop+parseFloat(r.paddingTop))*t.y;l*=t.x,c*=t.y,u*=t.x,h*=t.y,l+=s,c+=a,n=bo(i),i=Vo(n)}}return fo({width:u,height:h,x:l,y:c})}function Jo(t,e){const n=Bo(t).scrollLeft;return e?e.left+n:Yo(wo(t)).left+n}function Qo(t,e){const n=t.getBoundingClientRect();return{x:n.left+e.scrollLeft-Jo(t,n),y:n.top+e.scrollTop}}const Zo=new Set(["absolute","fixed"]);function $o(t,e,n){let r;if("viewport"===e)r=function(t,e){const n=bo(t),r=wo(t),i=n.visualViewport;let s=r.clientWidth,a=r.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const t=Uo();(!t||t&&"fixed"===e)&&(o=i.offsetLeft,l=i.offsetTop)}const c=Jo(r);if(c<=0){const t=r.ownerDocument,e=t.body,n=getComputedStyle(e),i="CSS1Compat"===t.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,a=Math.abs(r.clientWidth-e.clientWidth-i);a<=25&&(s-=a)}else c<=25&&(s+=c);return{width:s,height:a,x:o,y:l}}(t,n);else if("document"===e)r=function(t){const e=wo(t),n=Bo(t),r=t.ownerDocument.body,i=Va(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Va(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+Jo(t);const o=-n.scrollTop;return"rtl"===ko(r).direction&&(a+=Va(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:a,y:o}}(wo(t));else if(xo(e))r=function(t,e){const n=Yo(t,!0,"fixed"===e),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=Eo(t)?qo(t):qa(1);return{width:t.clientWidth*s.x,height:t.clientHeight*s.y,x:i*s.x,y:r*s.y}}(e,n);else{const n=Ko(t);r={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return fo(r)}function tl(t,e){const n=zo(t);return!(n===e||!xo(n)||Fo(n))&&("fixed"===ko(n).position||tl(n,e))}function el(t,e,n){const r=Eo(e),i=wo(e),s="fixed"===n,a=Yo(t,!0,s,e);let o={scrollLeft:0,scrollTop:0};const l=qa(0);function c(){l.x=Jo(i)}if(r||!r&&!s)if(("body"!==yo(e)||Mo(i))&&(o=Bo(e)),r){const t=Yo(e,!0,s,e);l.x=t.x+e.clientLeft,l.y=t.y+e.clientTop}else i&&c();s&&!r&&i&&c();const u=!i||r||s?qa(0):Qo(i,o);return{x:a.left+o.scrollLeft-l.x-u.x,y:a.top+o.scrollTop-l.y-u.y,width:a.width,height:a.height}}function nl(t){return"static"===ko(t).position}function rl(t,e){if(!Eo(t)||"fixed"===ko(t).position)return null;if(e)return e(t);let n=t.offsetParent;return wo(t)===n&&(n=n.ownerDocument.body),n}function il(t,e){const n=bo(t);if(Po(t))return n;if(!Eo(t)){let e=zo(t);for(;e&&!Fo(e);){if(xo(e)&&!nl(e))return e;e=zo(e)}return n}let r=rl(t,e);for(;r&&Ro(r)&&nl(r);)r=rl(r,e);return r&&Fo(r)&&nl(r)&&!Do(r)?n:r||function(t){let e=zo(t);for(;Eo(e)&&!Fo(e);){if(Do(e))return e;if(Po(e))return null;e=zo(e)}return null}(t)||n}const sl={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const s="fixed"===i,a=wo(r),o=!!e&&Po(e.floating);if(r===a||o&&s)return n;let l={scrollLeft:0,scrollTop:0},c=qa(1);const u=qa(0),h=Eo(r);if((h||!h&&!s)&&(("body"!==yo(r)||Mo(a))&&(l=Bo(r)),Eo(r))){const t=Yo(r);c=qo(r),u.x=t.x+r.clientLeft,u.y=t.y+r.clientTop}const d=!a||h||s?qa(0):Qo(a,l);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:n.y*c.y-l.scrollTop*c.y+u.y+d.y}},getDocumentElement:wo,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[..."clippingAncestors"===n?Po(e)?[]:function(t,e){const n=e.get(t);if(n)return n;let r=Go(t,[],!1).filter(t=>xo(t)&&"body"!==yo(t)),i=null;const s="fixed"===ko(t).position;let a=s?zo(t):t;for(;xo(a)&&!Fo(a);){const e=ko(a),n=Do(a);n||"fixed"!==e.position||(i=null),(s?!n&&!i:!n&&"static"===e.position&&i&&Zo.has(i.position)||Mo(a)&&!n&&tl(t,a))?r=r.filter(t=>t!==a):i=e,a=zo(a)}return e.set(t,r),r}(e,this._c):[].concat(n),r],a=s[0],o=s.reduce((t,n)=>{const r=$o(e,n,i);return t.top=Va(r.top,t.top),t.right=Ga(r.right,t.right),t.bottom=Ga(r.bottom,t.bottom),t.left=Va(r.left,t.left),t},$o(e,a,i));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:il,getElementRects:async function(t){const e=this.getOffsetParent||il,n=this.getDimensions,r=await n(t.floating);return{reference:el(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:n}=jo(t);return{width:e,height:n}},getScale:qo,isElement:xo,isRTL:function(t){return"rtl"===ko(t).direction}};function al(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function ol(t,e,n,r){void 0===r&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a="function"==typeof ResizeObserver,layoutShift:o="function"==typeof IntersectionObserver,animationFrame:l=!1}=r,c=Wo(t),u=i||s?[...c?Go(c):[],...Go(e)]:[];u.forEach(t=>{i&&t.addEventListener("scroll",n,{passive:!0}),s&&t.addEventListener("resize",n)});const h=c&&o?function(t,e){let n,r=null;const i=wo(t);function s(){var t;clearTimeout(n),null==(t=r)||t.disconnect(),r=null}return function a(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),s();const c=t.getBoundingClientRect(),{left:u,top:h,width:d,height:f}=c;if(o||e(),!d||!f)return;const p={rootMargin:-Wa(h)+"px "+-Wa(i.clientWidth-(u+d))+"px "+-Wa(i.clientHeight-(h+f))+"px "+-Wa(u)+"px",threshold:Va(0,Ga(1,l))||1};let m=!0;function g(e){const r=e[0].intersectionRatio;if(r!==l){if(!m)return a();r?a(!1,r):n=setTimeout(()=>{a(!1,1e-7)},1e3)}1!==r||al(c,t.getBoundingClientRect())||a(),m=!1}try{r=new IntersectionObserver(g,{...p,root:i.ownerDocument})}catch(v){r=new IntersectionObserver(g,p)}r.observe(t)}(!0),s}(c,n):null;let d,f=-1,p=null;a&&(p=new ResizeObserver(t=>{let[r]=t;r&&r.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var t;null==(t=p)||t.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let m=l?Yo(t):null;return l&&function e(){const r=Yo(t);m&&!al(m,r)&&n();m=r,d=requestAnimationFrame(e)}(),n(),()=>{var t;u.forEach(t=>{i&&t.removeEventListener("scroll",n),s&&t.removeEventListener("resize",n)}),null==h||h(),null==(t=p)||t.disconnect(),p=null,l&&cancelAnimationFrame(d)}}const ll=mo,cl=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:s,placement:a,middlewareData:o}=e,l=await async function(t,e){const{placement:n,platform:r,elements:i}=t,s=await(null==r.isRTL?void 0:r.isRTL(i.floating)),a=Qa(n),o=Za(n),l="y"===no(n),c=go.has(a)?-1:1,u=s&&l?-1:1,h=Ja(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:p}="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&"number"==typeof p&&(f="end"===o?-1*p:p),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}(e,t);return a===(null==(n=o.offset)?void 0:n.placement)&&null!=(r=o.arrow)&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},ul=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...l}=Ja(t,e),c={x:n,y:r},u=await mo(e,l),h=no(Qa(i)),d=$a(h);let f=c[d],p=c[h];if(s){const t="y"===d?"bottom":"right";f=Ya(f+u["y"===d?"top":"left"],f,f-u[t])}if(a){const t="y"===h?"bottom":"right";p=Ya(p+u["y"===h?"top":"left"],p,p-u[t])}const m=o.fn({...e,[d]:f,[h]:p});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[d]:s,[h]:a}}}}}},hl=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=Ja(t,e);if(null!=(n=s.arrow)&&n.alignmentOffset)return{};const v=Qa(i),y=no(o),b=Qa(o)===o,w=await(null==l.isRTL?void 0:l.isRTL(c.floating)),_=d||(b||!m?[uo(o)]:function(t){const e=uo(t);return[io(t),e,io(e)]}(o)),x="none"!==p;!d&&x&&_.push(...co(o,m,p,w));const E=[o,..._],A=await mo(e,g),S=[];let M=(null==(r=s.flip)?void 0:r.overflows)||[];if(u&&S.push(A[v]),h){const t=function(t,e,n){void 0===n&&(n=!1);const r=Za(t),i=ro(t),s=to(i);let a="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=uo(a)),[a,uo(a)]}(i,a,w);S.push(A[t[0]],A[t[1]])}if(M=[...M,{placement:i,overflows:S}],!S.every(t=>t<=0)){var T,R;const t=((null==(T=s.flip)?void 0:T.index)||0)+1,e=E[t];if(e){if(!("alignment"===h&&y!==no(e))||M.every(t=>no(t.placement)!==y||t.overflows[0]>0))return{data:{index:t,overflows:M},reset:{placement:e}}}let n=null==(R=M.filter(t=>t.overflows[0]<=0).sort((t,e)=>t.overflows[1]-e.overflows[1])[0])?void 0:R.placement;if(!n)switch(f){case"bestFit":{var C;const t=null==(C=M.filter(t=>{if(x){const e=no(t.placement);return e===y||"y"===e}return!0}).map(t=>[t.placement,t.overflows.filter(t=>t>0).reduce((t,e)=>t+e,0)]).sort((t,e)=>t[1]-e[1])[0])?void 0:C[0];t&&(n=t);break}case"initialPlacement":n=o}if(i!==n)return{reset:{placement:n}}}return{}}}},dl=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:s,platform:a,elements:o,middlewareData:l}=e,{element:c,padding:u=0}=Ja(t,e)||{};if(null==c)return{};const h=ho(u),d={x:n,y:r},f=ro(i),p=to(f),m=await a.getDimensions(c),g="y"===f,v=g?"top":"left",y=g?"bottom":"right",b=g?"clientHeight":"clientWidth",w=s.reference[p]+s.reference[f]-d[f]-s.floating[p],_=d[f]-s.reference[f],x=await(null==a.getOffsetParent?void 0:a.getOffsetParent(c));let E=x?x[b]:0;E&&await(null==a.isElement?void 0:a.isElement(x))||(E=o.floating[b]||s.floating[p]);const A=w/2-_/2,S=E/2-m[p]/2-1,M=Ga(h[v],S),T=Ga(h[y],S),R=M,C=E-m[p]-T,P=E/2-m[p]/2+A,N=Ya(R,P,C),O=!l.arrow&&null!=Za(i)&&P!==N&&s.reference[p]/2-(P<R?M:T)-m[p]/2<0,I=O?P<R?P-R:P-C:0;return{[f]:d[f]+I,data:{[f]:N,centerOffset:P-N-I,...O&&{alignmentOffset:I}},reset:O}}}),fl=(t,e,n)=>{const r=new Map,i={platform:sl,...n},s={...i.platform,_c:r};return(async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(null==a.isRTL?void 0:a.isRTL(e));let c=await a.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:h}=po(c,r,l),d=r,f={},p=0;for(let m=0;m<o.length;m++){const{name:n,fn:s}=o[m],{x:g,y:v,data:y,reset:b}=await s({x:u,y:h,initialPlacement:r,placement:d,strategy:i,middlewareData:f,rects:c,platform:a,elements:{reference:t,floating:e}});u=null!=g?g:u,h=null!=v?v:h,f={...f,[n]:{...f[n],...y}},b&&p<=50&&(p++,"object"==typeof b&&(b.placement&&(d=b.placement),b.rects&&(c=!0===b.rects?await a.getElementRects({reference:t,floating:e,strategy:i}):b.rects),({x:u,y:h}=po(c,d,l))),m=-1)}return{x:u,y:h,placement:d,strategy:i,middlewareData:f}})(t,e,{...i,platform:s})},pl="182",ml=1,gl=3,vl=0,yl=1,bl=2,wl=2,_l=100,xl=101,El=102,Al=200,Sl=201,Ml=202,Tl=203,Rl=204,Cl=205,Pl=206,Nl=207,Ol=208,Il=209,Dl=210,Ul=211,Ll=212,Fl=213,kl=214,Bl=0,zl=1,Hl=2,Gl=3,Vl=4,jl=5,Wl=6,ql=7,Xl=0,Kl=1,Yl=2,Jl=1,Ql=2,Zl=3,$l=4,tc=5,ec=6,nc=7,rc=301,ic=302,sc=306,ac=1e3,oc=1001,lc=1002,cc=1003,uc=1004,hc=1005,dc=1006,fc=1007,pc=1008,mc=1009,gc=1010,vc=1011,yc=1012,bc=1013,wc=1014,_c=1015,xc=1016,Ec=1017,Ac=1018,Sc=1020,Mc=35902,Tc=35899,Rc=1023,Cc=1026,Pc=1027,Nc=1029,Oc=1030,Ic=1031,Dc=1033,Uc=33776,Lc=33777,Fc=33778,kc=33779,Bc=35840,zc=35841,Hc=35842,Gc=35843,Vc=36196,jc=37492,Wc=37496,qc=37488,Xc=37489,Kc=37490,Yc=37491,Jc=37808,Qc=37809,Zc=37810,$c=37811,tu=37812,eu=37813,nu=37814,ru=37815,iu=37816,su=37817,au=37818,ou=37819,lu=37820,cu=37821,uu=36492,hu=36494,du=36495,fu=36283,pu=36284,mu=36285,gu=36286,vu="",yu="srgb",bu="srgb-linear",wu="linear",_u="srgb",xu=7680,Eu=512,Au=513,Su=514,Mu=515,Tu=516,Ru=517,Cu=518,Pu=519,Nu="300 es",Ou=2e3,Iu=2001;function Du(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function Uu(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Lu(){const t=Uu("canvas");return t.style.display="block",t}const Fu={};function ku(...t){const e="THREE."+t.shift();console.log(e,...t)}function Bu(...t){const e="THREE."+t.shift();console.warn(e,...t)}function zu(...t){const e="THREE."+t.shift();console.error(e,...t)}function Hu(...t){const e=t.join(" ");e in Fu||(Fu[e]=!0,Bu(...t))}class Gu{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){const n=this._listeners;return void 0!==n&&(void 0!==n[t]&&-1!==n[t].indexOf(e))}removeEventListener(t,e){const n=this._listeners;if(void 0===n)return;const r=n[t];if(void 0!==r){const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}dispatchEvent(t){const e=this._listeners;if(void 0===e)return;const n=e[t.type];if(void 0!==n){t.target=this;const e=n.slice(0);for(let n=0,r=e.length;n<r;n++)e[n].call(this,t);t.target=null}}}const Vu=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],ju=Math.PI/180,Wu=180/Math.PI;function qu(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Vu[255&t]+Vu[t>>8&255]+Vu[t>>16&255]+Vu[t>>24&255]+"-"+Vu[255&e]+Vu[e>>8&255]+"-"+Vu[e>>16&15|64]+Vu[e>>24&255]+"-"+Vu[63&n|128]+Vu[n>>8&255]+"-"+Vu[n>>16&255]+Vu[n>>24&255]+Vu[255&r]+Vu[r>>8&255]+Vu[r>>16&255]+Vu[r>>24&255]).toLowerCase()}function Xu(t,e,n){return Math.max(e,Math.min(n,t))}function Ku(t,e,n){return(1-n)*t+n*e}function Yu(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Ju(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}class Qu{constructor(t=0,e=0){Qu.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Xu(this.x,t.x,e.x),this.y=Xu(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=Xu(this.x,t,e),this.y=Xu(this.y,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Xu(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Xu(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,s=this.y-t.y;return this.x=i*n-s*r+t.x,this.y=i*r+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Zu{constructor(t=0,e=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerpFlat(t,e,n,r,i,s,a){let o=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3],h=i[s+0],d=i[s+1],f=i[s+2],p=i[s+3];if(a<=0)return t[e+0]=o,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(a>=1)return t[e+0]=h,t[e+1]=d,t[e+2]=f,void(t[e+3]=p);if(u!==p||o!==h||l!==d||c!==f){let t=o*h+l*d+c*f+u*p;t<0&&(h=-h,d=-d,f=-f,p=-p,t=-t);let e=1-a;if(t<.9995){const n=Math.acos(t),r=Math.sin(n);e=Math.sin(e*n)/r,o=o*e+h*(a=Math.sin(a*n)/r),l=l*e+d*a,c=c*e+f*a,u=u*e+p*a}else{o=o*e+h*a,l=l*e+d*a,c=c*e+f*a,u=u*e+p*a;const t=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=t,l*=t,c*=t,u*=t}}t[e]=o,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,r,i,s){const a=n[r],o=n[r+1],l=n[r+2],c=n[r+3],u=i[s],h=i[s+1],d=i[s+2],f=i[s+3];return t[e]=a*f+c*u+o*d-l*h,t[e+1]=o*f+c*h+l*u-a*d,t[e+2]=l*f+c*d+a*h-o*u,t[e+3]=c*f-a*u-o*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const n=t._x,r=t._y,i=t._z,s=t._order,a=Math.cos,o=Math.sin,l=a(n/2),c=a(r/2),u=a(i/2),h=o(n/2),d=o(r/2),f=o(i/2);switch(s){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:Bu("Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],s=e[1],a=e[5],o=e[9],l=e[2],c=e[6],u=e[10],h=n+a+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-o)*t,this._y=(i-l)*t,this._z=(s-r)*t}else if(n>a&&n>u){const t=2*Math.sqrt(1+n-a-u);this._w=(c-o)/t,this._x=.25*t,this._y=(r+s)/t,this._z=(i+l)/t}else if(a>u){const t=2*Math.sqrt(1+a-n-u);this._w=(i-l)/t,this._x=(r+s)/t,this._y=.25*t,this._z=(o+c)/t}else{const t=2*Math.sqrt(1+u-n-a);this._w=(s-r)/t,this._x=(i+l)/t,this._y=(o+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<1e-8?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Xu(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,s=t._w,a=e._x,o=e._y,l=e._z,c=e._w;return this._x=n*c+s*a+r*l-i*o,this._y=r*c+s*o+i*a-n*l,this._z=i*c+s*l+n*o-r*a,this._w=s*c-n*a-r*o-i*l,this._onChangeCallback(),this}slerp(t,e){if(e<=0)return this;if(e>=1)return this.copy(t);let n=t._x,r=t._y,i=t._z,s=t._w,a=this.dot(t);a<0&&(n=-n,r=-r,i=-i,s=-s,a=-a);let o=1-e;if(a<.9995){const t=Math.acos(a),l=Math.sin(t);o=Math.sin(o*t)/l,e=Math.sin(e*t)/l,this._x=this._x*o+n*e,this._y=this._y*o+r*e,this._z=this._z*o+i*e,this._w=this._w*o+s*e,this._onChangeCallback()}else this._x=this._x*o+n*e,this._y=this._y*o+r*e,this._z=this._z*o+i*e,this._w=this._w*o+s*e,this.normalize();return this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(t),r*Math.cos(t),i*Math.sin(e),i*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class $u{constructor(t=0,e=0,n=0){$u.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(eh.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(eh.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,s=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*s,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*s,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,s=t.y,a=t.z,o=t.w,l=2*(s*r-a*n),c=2*(a*e-i*r),u=2*(i*n-s*e);return this.x=e+o*l+s*u-a*c,this.y=n+o*c+a*l-i*u,this.z=r+o*u+i*c-s*l,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Xu(this.x,t.x,e.x),this.y=Xu(this.y,t.y,e.y),this.z=Xu(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=Xu(this.x,t,e),this.y=Xu(this.y,t,e),this.z=Xu(this.z,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Xu(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,s=e.x,a=e.y,o=e.z;return this.x=r*o-i*a,this.y=i*s-n*o,this.z=n*a-r*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return th.copy(this).projectOnVector(t),this.sub(th)}reflect(t){return this.sub(th.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Xu(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=2*Math.random()-1,n=Math.sqrt(1-e*e);return this.x=n*Math.cos(t),this.y=e,this.z=n*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const th=new $u,eh=new Zu;class nh{constructor(t,e,n,r,i,s,a,o,l){nh.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,n,r,i,s,a,o,l)}set(t,e,n,r,i,s,a,o,l){const c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=i,c[5]=o,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],w=r[2],_=r[5],x=r[8];return i[0]=s*p+a*v+o*w,i[3]=s*m+a*y+o*_,i[6]=s*g+a*b+o*x,i[1]=l*p+c*v+u*w,i[4]=l*m+c*y+u*_,i[7]=l*g+c*b+u*x,i[2]=h*p+d*v+f*w,i[5]=h*m+d*y+f*_,i[8]=h*g+d*b+f*x,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8];return e*s*c-e*a*l-n*i*c+n*a*o+r*i*l-r*s*o}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],u=c*s-a*l,h=a*o-c*i,d=l*i-s*o,f=e*u+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return t[0]=u*p,t[1]=(r*l-c*n)*p,t[2]=(a*n-r*s)*p,t[3]=h*p,t[4]=(c*e-r*o)*p,t[5]=(r*i-a*e)*p,t[6]=d*p,t[7]=(n*o-l*e)*p,t[8]=(s*e-n*i)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,i,s,a){const o=Math.cos(i),l=Math.sin(i);return this.set(n*o,n*l,-n*(o*s+l*a)+s+t,-r*l,r*o,-r*(-l*s+o*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(rh.makeScale(t,e)),this}rotate(t){return this.premultiply(rh.makeRotation(-t)),this}translate(t,e){return this.premultiply(rh.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const rh=new nh,ih=(new nh).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),sh=(new nh).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function ah(){const t={enabled:!0,workingColorSpace:bu,spaces:{},convert:function(t,e,n){return!1!==this.enabled&&e!==n&&e&&n?(this.spaces[e].transfer===_u&&(t.r=lh(t.r),t.g=lh(t.g),t.b=lh(t.b)),this.spaces[e].primaries!==this.spaces[n].primaries&&(t.applyMatrix3(this.spaces[e].toXYZ),t.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===_u&&(t.r=ch(t.r),t.g=ch(t.g),t.b=ch(t.b)),t):t},workingToColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},colorSpaceToWorking:function(t,e){return this.convert(t,e,this.workingColorSpace)},getPrimaries:function(t){return this.spaces[t].primaries},getTransfer:function(t){return t===vu?wu:this.spaces[t].transfer},getToneMappingMode:function(t){return this.spaces[t].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(t,e=this.workingColorSpace){return t.fromArray(this.spaces[e].luminanceCoefficients)},define:function(t){Object.assign(this.spaces,t)},_getMatrix:function(t,e,n){return t.copy(this.spaces[e].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(t){return this.spaces[t].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(t=this.workingColorSpace){return this.spaces[t].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(e,n){return Hu("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),t.workingToColorSpace(e,n)},toWorkingColorSpace:function(e,n){return Hu("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),t.colorSpaceToWorking(e,n)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return t.define({[bu]:{primaries:e,whitePoint:r,transfer:wu,toXYZ:ih,fromXYZ:sh,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:yu},outputColorSpaceConfig:{drawingBufferColorSpace:yu}},[yu]:{primaries:e,whitePoint:r,transfer:_u,toXYZ:ih,fromXYZ:sh,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:yu}}}),t}const oh=ah();function lh(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function ch(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let uh;class hh{static getDataURL(t,e="image/png"){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let n;if(t instanceof HTMLCanvasElement)n=t;else{void 0===uh&&(uh=Uu("canvas")),uh.width=t.width,uh.height=t.height;const e=uh.getContext("2d");t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),n=uh}return n.toDataURL(e)}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=Uu("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),i=r.data;for(let t=0;t<i.length;t++)i[t]=255*lh(i[t]/255);return n.putImageData(r,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*lh(e[t]/255)):e[t]=lh(e[t]);return{data:e,width:t.width,height:t.height}}return Bu("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let dh=0;class fh{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:dh++}),this.uuid=qu(),this.data=t,this.dataReady=!0,this.version=0}getSize(t){const e=this.data;return"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?t.set(e.videoWidth,e.videoHeight,0):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?t.set(e.displayHeight,e.displayWidth,0):null!==e?t.set(e.width,e.height,e.depth||0):t.set(0,0,0),t}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let t;if(Array.isArray(r)){t=[];for(let e=0,n=r.length;e<n;e++)r[e].isDataTexture?t.push(ph(r[e].image)):t.push(ph(r[e]))}else t=ph(r);n.url=t}return e||(t.images[this.uuid]=n),n}}function ph(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?hh.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(Bu("Texture: Unable to serialize Texture."),{})}let mh=0;const gh=new $u;class vh extends Gu{constructor(t=vh.DEFAULT_IMAGE,e=vh.DEFAULT_MAPPING,n=1001,r=1001,i=1006,s=1008,a=1023,o=mc,l=vh.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:mh++}),this.uuid=qu(),this.name="",this.source=new fh(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new Qu(0,0),this.repeat=new Qu(1,1),this.center=new Qu(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new nh,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(gh).x}get height(){return this.source.getSize(gh).y}get depth(){return this.source.getSize(gh).z}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(const e in t){const n=t[e];if(void 0===n){Bu(`Texture.setValues(): parameter '${e}' has value of undefined.`);continue}const r=this[e];void 0!==r?r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[e]=n:Bu(`Texture.setValues(): property '${e}' does not exist.`)}}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ac:t.x=t.x-Math.floor(t.x);break;case oc:t.x=t.x<0?0:1;break;case lc:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case ac:t.y=t.y-Math.floor(t.y);break;case oc:t.y=t.y<0?0:1;break;case lc:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}vh.DEFAULT_IMAGE=null,vh.DEFAULT_MAPPING=300,vh.DEFAULT_ANISOTROPY=1;class yh{constructor(t=0,e=0,n=0,r=1){yh.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r+s[12]*i,this.y=s[1]*e+s[5]*n+s[9]*r+s[13]*i,this.z=s[2]*e+s[6]*n+s[10]*r+s[14]*i,this.w=s[3]*e+s[7]*n+s[11]*r+s[15]*i,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,i;const s=.01,a=.1,o=t.elements,l=o[0],c=o[4],u=o[8],h=o[1],d=o[5],f=o[9],p=o[2],m=o[6],g=o[10];if(Math.abs(c-h)<s&&Math.abs(u-p)<s&&Math.abs(f-m)<s){if(Math.abs(c+h)<a&&Math.abs(u+p)<a&&Math.abs(f+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,o=(d+1)/2,v=(g+1)/2,y=(c+h)/4,b=(u+p)/4,w=(f+m)/4;return t>o&&t>v?t<s?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(t),r=y/n,i=b/n):o>v?o<s?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(o),n=y/r,i=w/r):v<s?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=b/i,r=w/i),this.set(n,r,i,e),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Xu(this.x,t.x,e.x),this.y=Xu(this.y,t.y,e.y),this.z=Xu(this.z,t.z,e.z),this.w=Xu(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=Xu(this.x,t,e),this.y=Xu(this.y,t,e),this.z=Xu(this.z,t,e),this.w=Xu(this.w,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Xu(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class bh extends Gu{constructor(t=1,e=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:dc,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=t,this.height=e,this.depth=n.depth,this.scissor=new yh(0,0,t,e),this.scissorTest=!1,this.viewport=new yh(0,0,t,e);const r={width:t,height:e,depth:n.depth},i=new vh(r);this.textures=[];const s=n.count;for(let a=0;a<s;a++)this.textures[a]=i.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(t={}){const e={minFilter:dc,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==t.mapping&&(e.mapping=t.mapping),void 0!==t.wrapS&&(e.wrapS=t.wrapS),void 0!==t.wrapT&&(e.wrapT=t.wrapT),void 0!==t.wrapR&&(e.wrapR=t.wrapR),void 0!==t.magFilter&&(e.magFilter=t.magFilter),void 0!==t.minFilter&&(e.minFilter=t.minFilter),void 0!==t.format&&(e.format=t.format),void 0!==t.type&&(e.type=t.type),void 0!==t.anisotropy&&(e.anisotropy=t.anisotropy),void 0!==t.colorSpace&&(e.colorSpace=t.colorSpace),void 0!==t.flipY&&(e.flipY=t.flipY),void 0!==t.generateMipmaps&&(e.generateMipmaps=t.generateMipmaps),void 0!==t.internalFormat&&(e.internalFormat=t.internalFormat);for(let n=0;n<this.textures.length;n++){this.textures[n].setValues(e)}}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}set depthTexture(t){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==t&&(t.renderTarget=this),this._depthTexture=t}get depthTexture(){return this._depthTexture}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=t,this.textures[r].image.height=e,this.textures[r].image.depth=n,!0!==this.textures[r].isData3DTexture&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.textures.length=0;for(let e=0,n=t.textures.length;e<n;e++){this.textures[e]=t.textures[e].clone(),this.textures[e].isRenderTargetTexture=!0,this.textures[e].renderTarget=this;const n=Object.assign({},t.textures[e].image);this.textures[e].source=new fh(n)}return this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.resolveDepthBuffer=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class wh extends bh{constructor(t=1,e=1,n={}){super(t,e,n),this.isWebGLRenderTarget=!0}}class _h extends vh{constructor(t=null,e=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=cc,this.minFilter=cc,this.wrapR=oc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class xh extends vh{constructor(t=null,e=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=cc,this.minFilter=cc,this.wrapR=oc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Eh{constructor(t=new $u(1/0,1/0,1/0),e=new $u(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(Sh.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(Sh.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Sh.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===e&&void 0!==r&&!0!==t.isInstancedMesh)for(let e=0,n=r.count;e<n;e++)!0===t.isMesh?t.getVertexPosition(e,Sh):Sh.fromBufferAttribute(r,e),Sh.applyMatrix4(t.matrixWorld),this.expandByPoint(Sh);else void 0!==t.boundingBox?(null===t.boundingBox&&t.computeBoundingBox(),Mh.copy(t.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Mh.copy(n.boundingBox)),Mh.applyMatrix4(t.matrixWorld),this.union(Mh)}const r=t.children;for(let i=0,s=r.length;i<s;i++)this.expandByObject(r[i],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,Sh),Sh.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Ih),Dh.subVectors(this.max,Ih),Th.subVectors(t.a,Ih),Rh.subVectors(t.b,Ih),Ch.subVectors(t.c,Ih),Ph.subVectors(Rh,Th),Nh.subVectors(Ch,Rh),Oh.subVectors(Th,Ch);let e=[0,-Ph.z,Ph.y,0,-Nh.z,Nh.y,0,-Oh.z,Oh.y,Ph.z,0,-Ph.x,Nh.z,0,-Nh.x,Oh.z,0,-Oh.x,-Ph.y,Ph.x,0,-Nh.y,Nh.x,0,-Oh.y,Oh.x,0];return!!Fh(e,Th,Rh,Ch,Dh)&&(e=[1,0,0,0,1,0,0,0,1],!!Fh(e,Th,Rh,Ch,Dh)&&(Uh.crossVectors(Ph,Nh),e=[Uh.x,Uh.y,Uh.z],Fh(e,Th,Rh,Ch,Dh)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,Sh).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(Sh).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Ah[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ah[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ah[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ah[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ah[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ah[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ah[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ah[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ah)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(t){return this.min.fromArray(t.min),this.max.fromArray(t.max),this}}const Ah=[new $u,new $u,new $u,new $u,new $u,new $u,new $u,new $u],Sh=new $u,Mh=new Eh,Th=new $u,Rh=new $u,Ch=new $u,Ph=new $u,Nh=new $u,Oh=new $u,Ih=new $u,Dh=new $u,Uh=new $u,Lh=new $u;function Fh(t,e,n,r,i){for(let s=0,a=t.length-3;s<=a;s+=3){Lh.fromArray(t,s);const a=i.x*Math.abs(Lh.x)+i.y*Math.abs(Lh.y)+i.z*Math.abs(Lh.z),o=e.dot(Lh),l=n.dot(Lh),c=r.dot(Lh);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}const kh=new Eh,Bh=new $u,zh=new $u;class Hh{constructor(t=new $u,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):kh.setFromPoints(t).getCenter(n);let r=0;for(let i=0,s=t.length;i<s;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Bh.subVectors(t,this.center);const e=Bh.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.addScaledVector(Bh,n/t),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(zh.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Bh.copy(t.center).add(zh)),this.expandByPoint(Bh.copy(t.center).sub(zh))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(t){return this.radius=t.radius,this.center.fromArray(t.center),this}}const Gh=new $u,Vh=new $u,jh=new $u,Wh=new $u,qh=new $u,Xh=new $u,Kh=new $u;class Yh{constructor(t=new $u,e=new $u(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Gh)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Gh.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Gh.copy(this.origin).addScaledVector(this.direction,e),Gh.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){Vh.copy(t).add(e).multiplyScalar(.5),jh.copy(e).sub(t).normalize(),Wh.copy(this.origin).sub(Vh);const i=.5*t.distanceTo(e),s=-this.direction.dot(jh),a=Wh.dot(this.direction),o=-Wh.dot(jh),l=Wh.lengthSq(),c=Math.abs(1-s*s);let u,h,d,f;if(c>0)if(u=s*o-a,h=s*a-o,f=i*c,u>=0)if(h>=-f)if(h<=f){const t=1/c;u*=t,h*=t,d=u*(u+s*h+2*a)+h*(s*u+h+2*o)+l}else h=i,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h=-i,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h<=-f?(u=Math.max(0,-(-s*i+a)),h=u>0?-i:Math.min(Math.max(-i,-o),i),d=-u*u+h*(h+2*o)+l):h<=f?(u=0,h=Math.min(Math.max(-i,-o),i),d=h*(h+2*o)+l):(u=Math.max(0,-(s*i+a)),h=u>0?i:Math.min(Math.max(-i,-o),i),d=-u*u+h*(h+2*o)+l);else h=s>0?-i:i,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(Vh).addScaledVector(jh,h),d}intersectSphere(t,e){Gh.subVectors(t.center,this.origin);const n=Gh.dot(this.direction),r=Gh.dot(Gh)-n*n,i=t.radius*t.radius;if(r>i)return null;const s=Math.sqrt(i-r),a=n-s,o=n+s;return o<0?null:a<0?this.at(o,e):this.at(a,e)}intersectsSphere(t){return!(t.radius<0)&&this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,i,s,a,o;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),c>=0?(i=(t.min.y-h.y)*c,s=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,s=(t.min.y-h.y)*c),n>s||i>r?null:((i>n||isNaN(n))&&(n=i),(s<r||isNaN(r))&&(r=s),u>=0?(a=(t.min.z-h.z)*u,o=(t.max.z-h.z)*u):(a=(t.max.z-h.z)*u,o=(t.min.z-h.z)*u),n>o||a>r?null:((a>n||n!=n)&&(n=a),(o<r||r!=r)&&(r=o),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return null!==this.intersectBox(t,Gh)}intersectTriangle(t,e,n,r,i){qh.subVectors(e,t),Xh.subVectors(n,t),Kh.crossVectors(qh,Xh);let s,a=this.direction.dot(Kh);if(a>0){if(r)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}Wh.subVectors(this.origin,t);const o=s*this.direction.dot(Xh.crossVectors(Wh,Xh));if(o<0)return null;const l=s*this.direction.dot(qh.cross(Wh));if(l<0)return null;if(o+l>a)return null;const c=-s*Wh.dot(Kh);return c<0?null:this.at(c/a,i)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Jh{constructor(t,e,n,r,i,s,a,o,l,c,u,h,d,f,p,m){Jh.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,n,r,i,s,a,o,l,c,u,h,d,f,p,m)}set(t,e,n,r,i,s,a,o,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Jh).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return 0===this.determinant()?(t.set(1,0,0),e.set(0,1,0),n.set(0,0,1),this):(t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){if(0===t.determinant())return this.identity();const e=this.elements,n=t.elements,r=1/Qh.setFromMatrixColumn(t,0).length(),i=1/Qh.setFromMatrixColumn(t,1).length(),s=1/Qh.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,r=t.y,i=t.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){const t=s*c,n=s*u,r=a*c,i=a*u;e[0]=o*c,e[4]=-o*u,e[8]=l,e[1]=n+r*l,e[5]=t-i*l,e[9]=-a*o,e[2]=i-t*l,e[6]=r+n*l,e[10]=s*o}else if("YXZ"===t.order){const t=o*c,n=o*u,r=l*c,i=l*u;e[0]=t+i*a,e[4]=r*a-n,e[8]=s*l,e[1]=s*u,e[5]=s*c,e[9]=-a,e[2]=n*a-r,e[6]=i+t*a,e[10]=s*o}else if("ZXY"===t.order){const t=o*c,n=o*u,r=l*c,i=l*u;e[0]=t-i*a,e[4]=-s*u,e[8]=r+n*a,e[1]=n+r*a,e[5]=s*c,e[9]=i-t*a,e[2]=-s*l,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){const t=s*c,n=s*u,r=a*c,i=a*u;e[0]=o*c,e[4]=r*l-n,e[8]=t*l+i,e[1]=o*u,e[5]=i*l+t,e[9]=n*l-r,e[2]=-l,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){const t=s*o,n=s*l,r=a*o,i=a*l;e[0]=o*c,e[4]=i-t*u,e[8]=r*u+n,e[1]=u,e[5]=s*c,e[9]=-a*c,e[2]=-l*c,e[6]=n*u+r,e[10]=t-i*u}else if("XZY"===t.order){const t=s*o,n=s*l,r=a*o,i=a*l;e[0]=o*c,e[4]=-u,e[8]=l*c,e[1]=t*u+i,e[5]=s*c,e[9]=n*u-r,e[2]=r*u-n,e[6]=a*c,e[10]=i*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose($h,t,td)}lookAt(t,e,n){const r=this.elements;return rd.subVectors(t,e),0===rd.lengthSq()&&(rd.z=1),rd.normalize(),ed.crossVectors(n,rd),0===ed.lengthSq()&&(1===Math.abs(n.z)?rd.x+=1e-4:rd.z+=1e-4,rd.normalize(),ed.crossVectors(n,rd)),ed.normalize(),nd.crossVectors(rd,ed),r[0]=ed.x,r[4]=nd.x,r[8]=rd.x,r[1]=ed.y,r[5]=nd.y,r[9]=rd.y,r[2]=ed.z,r[6]=nd.z,r[10]=rd.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],w=n[15],_=r[0],x=r[4],E=r[8],A=r[12],S=r[1],M=r[5],T=r[9],R=r[13],C=r[2],P=r[6],N=r[10],O=r[14],I=r[3],D=r[7],U=r[11],L=r[15];return i[0]=s*_+a*S+o*C+l*I,i[4]=s*x+a*M+o*P+l*D,i[8]=s*E+a*T+o*N+l*U,i[12]=s*A+a*R+o*O+l*L,i[1]=c*_+u*S+h*C+d*I,i[5]=c*x+u*M+h*P+d*D,i[9]=c*E+u*T+h*N+d*U,i[13]=c*A+u*R+h*O+d*L,i[2]=f*_+p*S+m*C+g*I,i[6]=f*x+p*M+m*P+g*D,i[10]=f*E+p*T+m*N+g*U,i[14]=f*A+p*R+m*O+g*L,i[3]=v*_+y*S+b*C+w*I,i[7]=v*x+y*M+b*P+w*D,i[11]=v*E+y*T+b*N+w*U,i[15]=v*A+y*R+b*O+w*L,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],s=t[1],a=t[5],o=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14],f=t[3],p=t[7],m=t[11],g=t[15],v=o*d-l*h,y=a*d-l*u,b=a*h-o*u,w=s*d-l*c,_=s*h-o*c,x=s*u-a*c;return e*(p*v-m*y+g*b)-n*(f*v-m*w+g*_)+r*(f*y-p*w+g*x)-i*(f*b-p*_+m*x)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],v=u*m*l-p*h*l+p*o*d-a*m*d-u*o*g+a*h*g,y=f*h*l-c*m*l-f*o*d+s*m*d+c*o*g-s*h*g,b=c*p*l-f*u*l+f*a*d-s*p*d-c*a*g+s*u*g,w=f*u*o-c*p*o-f*a*h+s*p*h+c*a*m-s*u*m,_=e*v+n*y+r*b+i*w;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/_;return t[0]=v*x,t[1]=(p*h*i-u*m*i-p*r*d+n*m*d+u*r*g-n*h*g)*x,t[2]=(a*m*i-p*o*i+p*r*l-n*m*l-a*r*g+n*o*g)*x,t[3]=(u*o*i-a*h*i-u*r*l+n*h*l+a*r*d-n*o*d)*x,t[4]=y*x,t[5]=(c*m*i-f*h*i+f*r*d-e*m*d-c*r*g+e*h*g)*x,t[6]=(f*o*i-s*m*i-f*r*l+e*m*l+s*r*g-e*o*g)*x,t[7]=(s*h*i-c*o*i+c*r*l-e*h*l-s*r*d+e*o*d)*x,t[8]=b*x,t[9]=(f*u*i-c*p*i-f*n*d+e*p*d+c*n*g-e*u*g)*x,t[10]=(s*p*i-f*a*i+f*n*l-e*p*l-s*n*g+e*a*g)*x,t[11]=(c*a*i-s*u*i-c*n*l+e*u*l+s*n*d-e*a*d)*x,t[12]=w*x,t[13]=(c*p*r-f*u*r+f*n*h-e*p*h-c*n*m+e*u*m)*x,t[14]=(f*a*r-s*p*r-f*n*o+e*p*o+s*n*m-e*a*m)*x,t[15]=(s*u*r-c*a*r+c*n*o-e*u*o-s*n*h+e*a*h)*x,this}scale(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,s=t.x,a=t.y,o=t.z,l=i*s,c=i*a;return this.set(l*s+n,l*a-r*o,l*o+r*a,0,l*a+r*o,c*a+n,c*o-r*s,0,l*o-r*a,c*o+r*s,i*o*o+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,i,s){return this.set(1,n,i,0,t,1,s,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,i=e._x,s=e._y,a=e._z,o=e._w,l=i+i,c=s+s,u=a+a,h=i*l,d=i*c,f=i*u,p=s*c,m=s*u,g=a*u,v=o*l,y=o*c,b=o*u,w=n.x,_=n.y,x=n.z;return r[0]=(1-(p+g))*w,r[1]=(d+b)*w,r[2]=(f-y)*w,r[3]=0,r[4]=(d-b)*_,r[5]=(1-(h+g))*_,r[6]=(m+v)*_,r[7]=0,r[8]=(f+y)*x,r[9]=(m-v)*x,r[10]=(1-(h+p))*x,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;if(t.x=r[12],t.y=r[13],t.z=r[14],0===this.determinant())return n.set(1,1,1),e.identity(),this;let i=Qh.set(r[0],r[1],r[2]).length();const s=Qh.set(r[4],r[5],r[6]).length(),a=Qh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),Zh.copy(this);const o=1/i,l=1/s,c=1/a;return Zh.elements[0]*=o,Zh.elements[1]*=o,Zh.elements[2]*=o,Zh.elements[4]*=l,Zh.elements[5]*=l,Zh.elements[6]*=l,Zh.elements[8]*=c,Zh.elements[9]*=c,Zh.elements[10]*=c,e.setFromRotationMatrix(Zh),n.x=i,n.y=s,n.z=a,this}makePerspective(t,e,n,r,i,s,a=2e3,o=!1){const l=this.elements,c=2*i/(e-t),u=2*i/(n-r),h=(e+t)/(e-t),d=(n+r)/(n-r);let f,p;if(o)f=i/(s-i),p=s*i/(s-i);else if(a===Ou)f=-(s+i)/(s-i),p=-2*s*i/(s-i);else{if(a!==Iu)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-s/(s-i),p=-s*i/(s-i)}return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,e,n,r,i,s,a=2e3,o=!1){const l=this.elements,c=2/(e-t),u=2/(n-r),h=-(e+t)/(e-t),d=-(n+r)/(n-r);let f,p;if(o)f=1/(s-i),p=s/(s-i);else if(a===Ou)f=-2/(s-i),p=-(s+i)/(s-i);else{if(a!==Iu)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);f=-1/(s-i),p=-i/(s-i)}return l[0]=c,l[4]=0,l[8]=0,l[12]=h,l[1]=0,l[5]=u,l[9]=0,l[13]=d,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const Qh=new $u,Zh=new Jh,$h=new $u(0,0,0),td=new $u(1,1,1),ed=new $u,nd=new $u,rd=new $u,id=new Jh,sd=new Zu;class ad{constructor(t=0,e=0,n=0,r=ad.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,i=r[0],s=r[4],a=r[8],o=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(e){case"XYZ":this._y=Math.asin(Xu(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Xu(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(Xu(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,i));break;case"ZYX":this._y=Math.asin(-Xu(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,i)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Xu(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Xu(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:Bu("Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return id.makeRotationFromQuaternion(t),this.setFromRotationMatrix(id,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return sd.setFromEuler(this),this.setFromQuaternion(sd,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ad.DEFAULT_ORDER="XYZ";class od{constructor(){this.mask=1}set(t){this.mask=1<<t>>>0}enable(t){this.mask|=1<<t}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t}disable(t){this.mask&=~(1<<t)}disableAll(){this.mask=0}test(t){return 0!==(this.mask&t.mask)}isEnabled(t){return!!(this.mask&1<<t)}}let ld=0;const cd=new $u,ud=new Zu,hd=new Jh,dd=new $u,fd=new $u,pd=new $u,md=new Zu,gd=new $u(1,0,0),vd=new $u(0,1,0),yd=new $u(0,0,1),bd={type:"added"},wd={type:"removed"},_d={type:"childadded",child:null},xd={type:"childremoved",child:null};class Ed extends Gu{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ld++}),this.uuid=qu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ed.DEFAULT_UP.clone();const t=new $u,e=new ad,n=new Zu,r=new $u(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Jh},normalMatrix:{value:new nh}}),this.matrix=new Jh,this.matrixWorld=new Jh,this.matrixAutoUpdate=Ed.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ed.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new od,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return ud.setFromAxisAngle(t,e),this.quaternion.multiply(ud),this}rotateOnWorldAxis(t,e){return ud.setFromAxisAngle(t,e),this.quaternion.premultiply(ud),this}rotateX(t){return this.rotateOnAxis(gd,t)}rotateY(t){return this.rotateOnAxis(vd,t)}rotateZ(t){return this.rotateOnAxis(yd,t)}translateOnAxis(t,e){return cd.copy(t).applyQuaternion(this.quaternion),this.position.add(cd.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(gd,t)}translateY(t){return this.translateOnAxis(vd,t)}translateZ(t){return this.translateOnAxis(yd,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(hd.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?dd.copy(t):dd.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),fd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?hd.lookAt(fd,dd,this.up):hd.lookAt(dd,fd,this.up),this.quaternion.setFromRotationMatrix(hd),r&&(hd.extractRotation(r.matrixWorld),ud.setFromRotationMatrix(hd),this.quaternion.premultiply(ud.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(zu("Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(bd),_d.child=t,this.dispatchEvent(_d),_d.child=null):zu("Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(wd),xd.child=t,this.dispatchEvent(xd),xd.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),hd.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),hd.multiply(t.parent.matrixWorld)),t.applyMatrix4(hd),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(bd),_d.child=t,this.dispatchEvent(_d),_d.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}}getObjectsByProperty(t,e,n=[]){this[t]===e&&n.push(this);const r=this.children;for(let i=0,s=r.length;i<s;i++)r[i].getObjectsByProperty(t,e,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fd,t,pd),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fd,md,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++){e[n].updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++){t[e].updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox?t.boundingBox.toJSON():void 0,boundingSphere:t.boundingSphere?t.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(t=>({...t})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(t),r.indirectTexture=this._indirectTexture.toJSON(t),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(r.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(r.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++){const r=n[e];i(t.shapes,r)}else i(t.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];r.animations.push(i(t.animations,n))}}if(e){const e=s(t.geometries),r=s(t.materials),i=s(t.textures),a=s(t.images),o=s(t.shapes),l=s(t.skeletons),c=s(t.animations),u=s(t.nodes);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function s(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}Ed.DEFAULT_UP=new $u(0,1,0),Ed.DEFAULT_MATRIX_AUTO_UPDATE=!0,Ed.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ad=new $u,Sd=new $u,Md=new $u,Td=new $u,Rd=new $u,Cd=new $u,Pd=new $u,Nd=new $u,Od=new $u,Id=new $u,Dd=new yh,Ud=new yh,Ld=new yh;class Fd{constructor(t=new $u,e=new $u,n=new $u){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),Ad.subVectors(t,e),r.cross(Ad);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(t,e,n,r,i){Ad.subVectors(r,e),Sd.subVectors(n,e),Md.subVectors(t,e);const s=Ad.dot(Ad),a=Ad.dot(Sd),o=Ad.dot(Md),l=Sd.dot(Sd),c=Sd.dot(Md),u=s*l-a*a;if(0===u)return i.set(0,0,0),null;const h=1/u,d=(l*o-a*c)*h,f=(s*c-a*o)*h;return i.set(1-d-f,f,d)}static containsPoint(t,e,n,r){return null!==this.getBarycoord(t,e,n,r,Td)&&(Td.x>=0&&Td.y>=0&&Td.x+Td.y<=1)}static getInterpolation(t,e,n,r,i,s,a,o){return null===this.getBarycoord(t,e,n,r,Td)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(i,Td.x),o.addScaledVector(s,Td.y),o.addScaledVector(a,Td.z),o)}static getInterpolatedAttribute(t,e,n,r,i,s){return Dd.setScalar(0),Ud.setScalar(0),Ld.setScalar(0),Dd.fromBufferAttribute(t,e),Ud.fromBufferAttribute(t,n),Ld.fromBufferAttribute(t,r),s.setScalar(0),s.addScaledVector(Dd,i.x),s.addScaledVector(Ud,i.y),s.addScaledVector(Ld,i.z),s}static isFrontFacing(t,e,n,r){return Ad.subVectors(n,e),Sd.subVectors(t,e),Ad.cross(Sd).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Ad.subVectors(this.c,this.b),Sd.subVectors(this.a,this.b),.5*Ad.cross(Sd).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Fd.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Fd.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,n,r,i){return Fd.getInterpolation(t,this.a,this.b,this.c,e,n,r,i)}containsPoint(t){return Fd.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Fd.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,i=this.c;let s,a;Rd.subVectors(r,n),Cd.subVectors(i,n),Nd.subVectors(t,n);const o=Rd.dot(Nd),l=Cd.dot(Nd);if(o<=0&&l<=0)return e.copy(n);Od.subVectors(t,r);const c=Rd.dot(Od),u=Cd.dot(Od);if(c>=0&&u<=c)return e.copy(r);const h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return s=o/(o-c),e.copy(n).addScaledVector(Rd,s);Id.subVectors(t,i);const d=Rd.dot(Id),f=Cd.dot(Id);if(f>=0&&d<=f)return e.copy(i);const p=d*l-o*f;if(p<=0&&l>=0&&f<=0)return a=l/(l-f),e.copy(n).addScaledVector(Cd,a);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return Pd.subVectors(i,r),a=(u-c)/(u-c+(d-f)),e.copy(r).addScaledVector(Pd,a);const g=1/(m+p+h);return s=p*g,a=h*g,e.copy(n).addScaledVector(Rd,s).addScaledVector(Cd,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const kd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Bd={h:0,s:0,l:0},zd={h:0,s:0,l:0};function Hd(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}class Gd{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(void 0===e&&void 0===n){const e=t;e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=yu){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,oh.colorSpaceToWorking(this,e),this}setRGB(t,e,n,r=oh.workingColorSpace){return this.r=t,this.g=e,this.b=n,oh.colorSpaceToWorking(this,r),this}setHSL(t,e,n,r=oh.workingColorSpace){var i;if(t=(t%(i=1)+i)%i,e=Xu(e,0,1),n=Xu(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=Hd(i,r,t+1/3),this.g=Hd(i,r,t),this.b=Hd(i,r,t-1/3)}return oh.colorSpaceToWorking(this,r),this}setStyle(t,e=yu){function n(e){void 0!==e&&parseFloat(e)<1&&Bu("Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(t)){let i;const s=r[1],a=r[2];switch(s){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,e);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,e);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,e);break;default:Bu("Color: Unknown color model "+t)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const n=r[1],i=n.length;if(3===i)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,e);if(6===i)return this.setHex(parseInt(n,16),e);Bu("Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=yu){const n=kd[t.toLowerCase()];return void 0!==n?this.setHex(n,e):Bu("Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=lh(t.r),this.g=lh(t.g),this.b=lh(t.b),this}copyLinearToSRGB(t){return this.r=ch(t.r),this.g=ch(t.g),this.b=ch(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=yu){return oh.workingToColorSpace(Vd.copy(this),t),65536*Math.round(Xu(255*Vd.r,0,255))+256*Math.round(Xu(255*Vd.g,0,255))+Math.round(Xu(255*Vd.b,0,255))}getHexString(t=yu){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=oh.workingColorSpace){oh.workingToColorSpace(Vd.copy(this),e);const n=Vd.r,r=Vd.g,i=Vd.b,s=Math.max(n,r,i),a=Math.min(n,r,i);let o,l;const c=(a+s)/2;if(a===s)o=0,l=0;else{const t=s-a;switch(l=c<=.5?t/(s+a):t/(2-s-a),s){case n:o=(r-i)/t+(r<i?6:0);break;case r:o=(i-n)/t+2;break;case i:o=(n-r)/t+4}o/=6}return t.h=o,t.s=l,t.l=c,t}getRGB(t,e=oh.workingColorSpace){return oh.workingToColorSpace(Vd.copy(this),e),t.r=Vd.r,t.g=Vd.g,t.b=Vd.b,t}getStyle(t=yu){oh.workingToColorSpace(Vd.copy(this),t);const e=Vd.r,n=Vd.g,r=Vd.b;return t!==yu?`color(${t} ${e.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*e)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(t,e,n){return this.getHSL(Bd),this.setHSL(Bd.h+t,Bd.s+e,Bd.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Bd),t.getHSL(zd);const n=Ku(Bd.h,zd.h,e),r=Ku(Bd.s,zd.s,e),i=Ku(Bd.l,zd.l,e);return this.setHSL(n,r,i),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,r=this.b,i=t.elements;return this.r=i[0]*e+i[3]*n+i[6]*r,this.g=i[1]*e+i[4]*n+i[7]*r,this.b=i[2]*e+i[5]*n+i[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Vd=new Gd;Gd.NAMES=kd;let jd=0;class Wd extends Gu{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:jd++}),this.uuid=qu(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=_l,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Gd(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=xu,this.stencilZFail=xu,this.stencilZPass=xu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){Bu(`Material: parameter '${e}' has value of undefined.`);continue}const r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:Bu(`Material: '${e}' is not a property of THREE.${this.type}.`)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function r(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(t).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(t).uuid),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),204!==this.blendSrc&&(n.blendSrc=this.blendSrc),205!==this.blendDst&&(n.blendDst=this.blendDst),this.blendEquation!==_l&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==xu&&(n.stencilFail=this.stencilFail),this.stencilZFail!==xu&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==xu&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!1===this.allowOverride&&(n.allowOverride=!1),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),e){const e=r(t.textures),i=r(t.images);e.length>0&&(n.textures=e),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let r=0;r!==t;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.allowOverride=t.allowOverride,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class qd extends Wd{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Gd(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ad,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Xd=new $u,Kd=new Qu;let Yd=0;class Jd{constructor(t,e,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Yd++}),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n,this.usage=35044,this.updateRanges=[],this.gpuType=_c,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Kd.fromBufferAttribute(this,e),Kd.applyMatrix3(t),this.setXY(e,Kd.x,Kd.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Xd.fromBufferAttribute(this,e),Xd.applyMatrix3(t),this.setXYZ(e,Xd.x,Xd.y,Xd.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Xd.fromBufferAttribute(this,e),Xd.applyMatrix4(t),this.setXYZ(e,Xd.x,Xd.y,Xd.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Xd.fromBufferAttribute(this,e),Xd.applyNormalMatrix(t),this.setXYZ(e,Xd.x,Xd.y,Xd.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Xd.fromBufferAttribute(this,e),Xd.transformDirection(t),this.setXYZ(e,Xd.x,Xd.y,Xd.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let n=this.array[t*this.itemSize+e];return this.normalized&&(n=Yu(n,this.array)),n}setComponent(t,e,n){return this.normalized&&(n=Ju(n,this.array)),this.array[t*this.itemSize+e]=n,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Yu(e,this.array)),e}setX(t,e){return this.normalized&&(e=Ju(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Yu(e,this.array)),e}setY(t,e){return this.normalized&&(e=Ju(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Yu(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Ju(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Yu(e,this.array)),e}setW(t,e){return this.normalized&&(e=Ju(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=Ju(e,this.array),n=Ju(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.normalized&&(e=Ju(e,this.array),n=Ju(n,this.array),r=Ju(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t*=this.itemSize,this.normalized&&(e=Ju(e,this.array),n=Ju(n,this.array),r=Ju(r,this.array),i=Ju(i,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),35044!==this.usage&&(t.usage=this.usage),t}}class Qd extends Jd{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Zd extends Jd{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class $d extends Jd{constructor(t,e,n){super(new Float32Array(t),e,n)}}let tf=0;const ef=new Jh,nf=new Ed,rf=new $u,sf=new Eh,af=new Eh,of=new $u;class lf extends Gu{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:tf++}),this.uuid=qu(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Du(t)?Zd:Qd)(t,1):this.index=t,this}setIndirect(t,e=0){return this.indirect=t,this.indirectOffset=e,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new nh).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return ef.makeRotationFromQuaternion(t),this.applyMatrix4(ef),this}rotateX(t){return ef.makeRotationX(t),this.applyMatrix4(ef),this}rotateY(t){return ef.makeRotationY(t),this.applyMatrix4(ef),this}rotateZ(t){return ef.makeRotationZ(t),this.applyMatrix4(ef),this}translate(t,e,n){return ef.makeTranslation(t,e,n),this.applyMatrix4(ef),this}scale(t,e,n){return ef.makeScale(t,e,n),this.applyMatrix4(ef),this}lookAt(t){return nf.lookAt(t),nf.updateMatrix(),this.applyMatrix4(nf.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(rf).negate(),this.translate(rf.x,rf.y,rf.z),this}setFromPoints(t){const e=this.getAttribute("position");if(void 0===e){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}this.setAttribute("position",new $d(e,3))}else{const n=Math.min(t.length,e.count);for(let r=0;r<n;r++){const n=t[r];e.setXYZ(r,n.x,n.y,n.z||0)}t.length>e.count&&Bu("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),e.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Eh);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return zu("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new $u(-1/0,-1/0,-1/0),new $u(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++){const t=e[n];sf.setFromBufferAttribute(t),this.morphTargetsRelative?(of.addVectors(this.boundingBox.min,sf.min),this.boundingBox.expandByPoint(of),of.addVectors(this.boundingBox.max,sf.max),this.boundingBox.expandByPoint(of)):(this.boundingBox.expandByPoint(sf.min),this.boundingBox.expandByPoint(sf.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&zu('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Hh);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return zu("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new $u,1/0);if(t){const n=this.boundingSphere.center;if(sf.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const n=e[t];af.setFromBufferAttribute(n),this.morphTargetsRelative?(of.addVectors(sf.min,af.min),sf.expandByPoint(of),of.addVectors(sf.max,af.max),sf.expandByPoint(of)):(sf.expandByPoint(af.min),sf.expandByPoint(af.max))}sf.getCenter(n);let r=0;for(let e=0,i=t.count;e<i;e++)of.fromBufferAttribute(t,e),r=Math.max(r,n.distanceToSquared(of));if(e)for(let i=0,s=e.length;i<s;i++){const s=e[i],a=this.morphTargetsRelative;for(let e=0,i=s.count;e<i;e++)of.fromBufferAttribute(s,e),a&&(rf.fromBufferAttribute(t,e),of.add(rf)),r=Math.max(r,n.distanceToSquared(of))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&zu('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void zu("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.position,r=e.normal,i=e.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Jd(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),a=[],o=[];for(let E=0;E<n.count;E++)a[E]=new $u,o[E]=new $u;const l=new $u,c=new $u,u=new $u,h=new Qu,d=new Qu,f=new Qu,p=new $u,m=new $u;function g(t,e,r){l.fromBufferAttribute(n,t),c.fromBufferAttribute(n,e),u.fromBufferAttribute(n,r),h.fromBufferAttribute(i,t),d.fromBufferAttribute(i,e),f.fromBufferAttribute(i,r),c.sub(l),u.sub(l),d.sub(h),f.sub(h);const s=1/(d.x*f.y-f.x*d.y);isFinite(s)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(u,-d.y).multiplyScalar(s),m.copy(u).multiplyScalar(d.x).addScaledVector(c,-f.x).multiplyScalar(s),a[t].add(p),a[e].add(p),a[r].add(p),o[t].add(m),o[e].add(m),o[r].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:t.count}]);for(let E=0,A=v.length;E<A;++E){const e=v[E],n=e.start;for(let r=n,i=n+e.count;r<i;r+=3)g(t.getX(r+0),t.getX(r+1),t.getX(r+2))}const y=new $u,b=new $u,w=new $u,_=new $u;function x(t){w.fromBufferAttribute(r,t),_.copy(w);const e=a[t];y.copy(e),y.sub(w.multiplyScalar(w.dot(e))).normalize(),b.crossVectors(_,e);const n=b.dot(o[t])<0?-1:1;s.setXYZW(t,y.x,y.y,y.z,n)}for(let E=0,A=v.length;E<A;++E){const e=v[E],n=e.start;for(let r=n,i=n+e.count;r<i;r+=3)x(t.getX(r+0)),x(t.getX(r+1)),x(t.getX(r+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Jd(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const r=new $u,i=new $u,s=new $u,a=new $u,o=new $u,l=new $u,c=new $u,u=new $u;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),f=t.getX(h+1),p=t.getX(h+2);r.fromBufferAttribute(e,d),i.fromBufferAttribute(e,f),s.fromBufferAttribute(e,p),c.subVectors(s,i),u.subVectors(r,i),c.cross(u),a.fromBufferAttribute(n,d),o.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),a.add(c),o.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(f,o.x,o.y,o.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let t=0,h=e.count;t<h;t+=3)r.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),c.subVectors(s,i),u.subVectors(r,i),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)of.fromBufferAttribute(t,e),of.normalize(),t.setXYZ(e,of.x,of.y,of.z)}toNonIndexed(){function t(t,e){const n=t.array,r=t.itemSize,i=t.normalized,s=new n.constructor(e.length*r);let a=0,o=0;for(let l=0,c=e.length;l<c;l++){a=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*r;for(let t=0;t<r;t++)s[o++]=n[a++]}return new Jd(s,r,i)}if(null===this.index)return Bu("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new lf,n=this.index.array,r=this.attributes;for(const a in r){const i=t(r[a],n);e.setAttribute(a,i)}const i=this.morphAttributes;for(const a in i){const r=[],s=i[a];for(let e=0,i=s.length;e<i;e++){const i=t(s[e],n);r.push(i)}e.morphAttributes[a]=r}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,o=s.length;a<o;a++){const t=s[a];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const o in n){const e=n[o];t.data.attributes[o]=e.toJSON(t.data)}const r={};let i=!1;for(const o in this.morphAttributes){const e=this.morphAttributes[o],n=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];n.push(i.toJSON(t.data))}n.length>0&&(r[o]=n,i=!0)}i&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere=a.toJSON()),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone());const r=t.attributes;for(const l in r){const t=r[l];this.setAttribute(l,t.clone(e))}const i=t.morphAttributes;for(const l in i){const t=[],n=i[l];for(let r=0,i=n.length;r<i;r++)t.push(n[r].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let l=0,c=s.length;l<c;l++){const t=s[l];this.addGroup(t.start,t.count,t.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=t.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const cf=new Jh,uf=new Yh,hf=new Hh,df=new $u,ff=new $u,pf=new $u,mf=new $u,gf=new $u,vf=new $u,yf=new $u,bf=new $u;class wf extends Ed{constructor(t=new lf,e=new qd){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,s=n.morphTargetsRelative;e.fromBufferAttribute(r,t);const a=this.morphTargetInfluences;if(i&&a){vf.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=a[n],o=i[n];0!==r&&(gf.fromBufferAttribute(o,t),s?vf.addScaledVector(gf,r):vf.addScaledVector(gf.sub(e),r))}e.add(vf)}return e}raycast(t,e){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),hf.copy(n.boundingSphere),hf.applyMatrix4(i),uf.copy(t.ray).recast(t.near),!1===hf.containsPoint(uf.origin)){if(null===uf.intersectSphere(hf,df))return;if(uf.origin.distanceToSquared(df)>(t.far-t.near)**2)return}cf.copy(i).invert(),uf.copy(t.ray).applyMatrix4(cf),null!==n.boundingBox&&!1===uf.intersectsBox(n.boundingBox)||this._computeIntersections(t,e,uf)}}_computeIntersections(t,e,n){let r;const i=this.geometry,s=this.material,a=i.index,o=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,u=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==a)if(Array.isArray(s))for(let f=0,p=h.length;f<p;f++){const i=h[f],o=s[i.materialIndex];for(let s=Math.max(i.start,d.start),h=Math.min(a.count,Math.min(i.start+i.count,d.start+d.count));s<h;s+=3){r=_f(this,o,t,n,l,c,u,a.getX(s),a.getX(s+1),a.getX(s+2)),r&&(r.faceIndex=Math.floor(s/3),r.face.materialIndex=i.materialIndex,e.push(r))}}else{for(let i=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);i<o;i+=3){r=_f(this,s,t,n,l,c,u,a.getX(i),a.getX(i+1),a.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),e.push(r))}}else if(void 0!==o)if(Array.isArray(s))for(let f=0,p=h.length;f<p;f++){const i=h[f],a=s[i.materialIndex];for(let s=Math.max(i.start,d.start),h=Math.min(o.count,Math.min(i.start+i.count,d.start+d.count));s<h;s+=3){r=_f(this,a,t,n,l,c,u,s,s+1,s+2),r&&(r.faceIndex=Math.floor(s/3),r.face.materialIndex=i.materialIndex,e.push(r))}}else{for(let i=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);i<a;i+=3){r=_f(this,s,t,n,l,c,u,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),e.push(r))}}}}function _f(t,e,n,r,i,s,a,o,l,c){t.getVertexPosition(o,ff),t.getVertexPosition(l,pf),t.getVertexPosition(c,mf);const u=function(t,e,n,r,i,s,a,o){let l;if(l=1===e.side?r.intersectTriangle(a,s,i,!0,o):r.intersectTriangle(i,s,a,0===e.side,o),null===l)return null;bf.copy(o),bf.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(bf);return c<n.near||c>n.far?null:{distance:c,point:bf.clone(),object:t}}(t,e,n,r,ff,pf,mf,yf);if(u){const t=new $u;Fd.getBarycoord(yf,ff,pf,mf,t),i&&(u.uv=Fd.getInterpolatedAttribute(i,o,l,c,t,new Qu)),s&&(u.uv1=Fd.getInterpolatedAttribute(s,o,l,c,t,new Qu)),a&&(u.normal=Fd.getInterpolatedAttribute(a,o,l,c,t,new $u),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const e={a:o,b:l,c:c,normal:new $u,materialIndex:0};Fd.getNormal(ff,pf,mf,e.normal),u.face=e,u.barycoord=t}return u}class xf extends lf{constructor(t=1,e=1,n=1,r=1,i=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:s};const a=this;r=Math.floor(r),i=Math.floor(i),s=Math.floor(s);const o=[],l=[],c=[],u=[];let h=0,d=0;function f(t,e,n,r,i,s,f,p,m,g,v){const y=s/m,b=f/g,w=s/2,_=f/2,x=p/2,E=m+1,A=g+1;let S=0,M=0;const T=new $u;for(let a=0;a<A;a++){const s=a*b-_;for(let o=0;o<E;o++){const h=o*y-w;T[t]=h*r,T[e]=s*i,T[n]=x,l.push(T.x,T.y,T.z),T[t]=0,T[e]=0,T[n]=p>0?1:-1,c.push(T.x,T.y,T.z),u.push(o/m),u.push(1-a/g),S+=1}}for(let a=0;a<g;a++)for(let t=0;t<m;t++){const e=h+t+E*a,n=h+t+E*(a+1),r=h+(t+1)+E*(a+1),i=h+(t+1)+E*a;o.push(e,n,i),o.push(n,r,i),M+=6}a.addGroup(d,M,v),d+=M,h+=S}f("z","y","x",-1,-1,n,e,t,s,i,0),f("z","y","x",1,-1,n,e,-t,s,i,1),f("x","z","y",1,1,t,n,e,r,s,2),f("x","z","y",1,-1,t,n,-e,r,s,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(o),this.setAttribute("position",new $d(l,3)),this.setAttribute("normal",new $d(c,3)),this.setAttribute("uv",new $d(u,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new xf(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Ef(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(Bu("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function Af(t){const e={};for(let n=0;n<t.length;n++){const r=Ef(t[n]);for(const t in r)e[t]=r[t]}return e}function Sf(t){const e=t.getRenderTarget();return null===e?t.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:oh.workingColorSpace}const Mf={clone:Ef,merge:Af};class Tf extends Wd{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ef(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this.defaultAttributeValues=Object.assign({},t.defaultAttributeValues),this.index0AttributeName=t.index0AttributeName,this.uniformsNeedUpdate=t.uniformsNeedUpdate,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?e.uniforms[r]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[r]={type:"m4",value:n.toArray()}:e.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class Rf extends Ed{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Jh,this.projectionMatrix=new Jh,this.projectionMatrixInverse=new Jh,this.coordinateSystem=Ou,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Cf=new $u,Pf=new Qu,Nf=new Qu;class Of extends Rf{constructor(t=50,e=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*Wu*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*ju*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*Wu*Math.atan(Math.tan(.5*ju*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,e,n){Cf.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(Cf.x,Cf.y).multiplyScalar(-t/Cf.z),Cf.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Cf.x,Cf.y).multiplyScalar(-t/Cf.z)}getViewSize(t,e){return this.getViewBounds(t,Pf,Nf),e.subVectors(Nf,Pf)}setViewOffset(t,e,n,r,i,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*ju*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,a=s.fullHeight;i+=s.offsetX*r/t,e-=s.offsetY*n/a,r*=s.width/t,n*=s.height/a}const a=this.filmOffset;0!==a&&(i+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const If=-90;class Df extends Ed{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Of(If,1,t,e);r.layers=this.layers,this.add(r);const i=new Of(If,1,t,e);i.layers=this.layers,this.add(i);const s=new Of(If,1,t,e);s.layers=this.layers,this.add(s);const a=new Of(If,1,t,e);a.layers=this.layers,this.add(a);const o=new Of(If,1,t,e);o.layers=this.layers,this.add(o);const l=new Of(If,1,t,e);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[n,r,i,s,a,o]=e;for(const l of e)this.remove(l);if(t===Ou)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(t!==Iu)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of e)this.add(l),l.updateMatrixWorld()}update(t,e){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[i,s,a,o,l,c]=this.children,u=t.getRenderTarget(),h=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),f=t.xr.enabled;t.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0,r),t.render(e,i),t.setRenderTarget(n,1,r),t.render(e,s),t.setRenderTarget(n,2,r),t.render(e,a),t.setRenderTarget(n,3,r),t.render(e,o),t.setRenderTarget(n,4,r),t.render(e,l),n.texture.generateMipmaps=p,t.setRenderTarget(n,5,r),t.render(e,c),t.setRenderTarget(u,h,d),t.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}class Uf extends vh{constructor(t=[],e=301,n,r,i,s,a,o,l,c){super(t,e,n,r,i,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class Lf extends wh{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},r=[n,n,n,n,n,n];this.texture=new Uf(r),this._setTextureOptions(e),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new xf(5,5,5),i=new Tf({name:"CubemapFromEquirect",uniforms:Ef(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=e;const s=new wf(r,i),a=e.minFilter;e.minFilter===pc&&(e.minFilter=dc);return new Df(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e=!0,n=!0,r=!0){const i=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,r);t.setRenderTarget(i)}}class Ff extends Ed{constructor(){super(),this.isGroup=!0,this.type="Group"}}const kf={type:"move"};class Bf{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Ff,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Ff,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new $u,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new $u),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Ff,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new $u,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new $u),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let r=null,i=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(l&&t.hand){s=!0;for(const s of t.hand.values()){const t=e.getJointPose(s,n),r=this._getHandJoint(l,s);null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=t.radius),r.visible=null!==t}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],a=r.position.distanceTo(i.position),o=.02,c=.005;l.inputState.pinching&&a>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&a<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&t.gripSpace&&(i=e.getPose(t.gripSpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(r=e.getPose(t.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(kf)))}return null!==a&&(a.visible=null!==r),null!==o&&(o.visible=null!==i),null!==l&&(l.visible=null!==s),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const n=new Ff;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}}class zf{constructor(t,e=25e-5){this.isFogExp2=!0,this.name="",this.color=new Gd(t),this.density=e}clone(){return new zf(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Hf extends Ed{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ad,this.environmentIntensity=1,this.environmentRotation=new ad,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}}class Gf extends vh{constructor(t=null,e=1,n=1,r,i,s,a,o,l=1003,c=1003,u,h){super(null,s,a,o,l,c,r,i,u,h),this.isDataTexture=!0,this.image={data:t,width:e,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Vf=new $u,jf=new $u,Wf=new nh;class qf{constructor(t=new $u(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=Vf.subVectors(n,e).cross(jf.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const n=t.delta(Vf),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:e.copy(t.start).addScaledVector(n,i)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Wf.getNormalMatrix(t),r=this.coplanarPoint(Vf).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Xf=new Hh,Kf=new Qu(.5,.5),Yf=new $u;class Jf{constructor(t=new qf,e=new qf,n=new qf,r=new qf,i=new qf,s=new qf){this.planes=[t,e,n,r,i,s]}set(t,e,n,r,i,s){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t,e=2e3,n=!1){const r=this.planes,i=t.elements,s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],f=i[8],p=i[9],m=i[10],g=i[11],v=i[12],y=i[13],b=i[14],w=i[15];if(r[0].setComponents(l-s,d-c,g-f,w-v).normalize(),r[1].setComponents(l+s,d+c,g+f,w+v).normalize(),r[2].setComponents(l+a,d+u,g+p,w+y).normalize(),r[3].setComponents(l-a,d-u,g-p,w-y).normalize(),n)r[4].setComponents(o,h,m,b).normalize(),r[5].setComponents(l-o,d-h,g-m,w-b).normalize();else if(r[4].setComponents(l-o,d-h,g-m,w-b).normalize(),e===Ou)r[5].setComponents(l+o,d+h,g+m,w+b).normalize();else{if(e!==Iu)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);r[5].setComponents(o,h,m,b).normalize()}return this}intersectsObject(t){if(void 0!==t.boundingSphere)null===t.boundingSphere&&t.computeBoundingSphere(),Xf.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),Xf.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Xf)}intersectsSprite(t){Xf.center.set(0,0,0);const e=Kf.distanceTo(t.center);return Xf.radius=.7071067811865476+e,Xf.applyMatrix4(t.matrixWorld),this.intersectsSphere(Xf)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(Yf.x=r.normal.x>0?t.max.x:t.min.x,Yf.y=r.normal.y>0?t.max.y:t.min.y,Yf.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Yf)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class Qf extends Wd{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Gd(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const Zf=new Jh,$f=new Yh,tp=new Hh,ep=new $u;class np extends Ed{constructor(t=new lf,e=new Qf){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),tp.copy(n.boundingSphere),tp.applyMatrix4(r),tp.radius+=i,!1===t.ray.intersectsSphere(tp))return;Zf.copy(r).invert(),$f.copy(t.ray).applyMatrix4(Zf);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,s.start),i=Math.min(l.count,s.start+s.count);n<i;n++){const i=l.getX(n);ep.fromBufferAttribute(c,i),rp(ep,i,o,r,t,e,this)}}else{for(let n=Math.max(0,s.start),i=Math.min(c.count,s.start+s.count);n<i;n++)ep.fromBufferAttribute(c,n),rp(ep,n,o,r,t,e,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}function rp(t,e,n,r,i,s,a){const o=$f.distanceSqToPoint(t);if(o<n){const n=new $u;$f.closestPointToPoint(t,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;s.push({distance:l,distanceToRay:Math.sqrt(o),point:n,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class ip extends vh{constructor(t,e,n=1014,r,i,s,a=1003,o=1003,l,c=1026,u=1){if(c!==Cc&&c!==Pc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:t,height:e,depth:u},r,i,s,a,o,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.source=new fh(Object.assign({},t.image)),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return null!==this.compareFunction&&(e.compareFunction=this.compareFunction),e}}class sp extends ip{constructor(t,e=1014,n=301,r,i,s=1003,a=1003,o,l=1026){const c={width:t,height:t,depth:1},u=[c,c,c,c,c,c];super(t,t,e,n,r,i,s,a,o,l),this.image=u,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(t){this.image=t}}class ap extends vh{constructor(t=null){super(),this.sourceTexture=t,this.isExternalTexture=!0}copy(t){return super.copy(t),this.sourceTexture=t.sourceTexture,this}}class op extends lf{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const i=t/2,s=e/2,a=Math.floor(n),o=Math.floor(r),l=a+1,c=o+1,u=t/a,h=e/o,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const t=g*h-s;for(let e=0;e<l;e++){const n=e*u-i;f.push(n,-t,0),p.push(0,0,1),m.push(e/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let t=0;t<a;t++){const e=t+l*g,n=t+l*(g+1),r=t+1+l*(g+1),i=t+1+l*g;d.push(e,n,i),d.push(n,r,i)}this.setIndex(d),this.setAttribute("position",new $d(f,3)),this.setAttribute("normal",new $d(p,3)),this.setAttribute("uv",new $d(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new op(t.width,t.height,t.widthSegments,t.heightSegments)}}class lp extends Tf{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class cp extends Wd{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class up extends Wd{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}class hp extends Rf{constructor(t=-1,e=1,n=1,r=-1,i=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=i,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,i,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-t,s=n+t,a=r+e,o=r-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,s=i+t*this.view.width,a-=e*this.view.offsetY,o=a-e*this.view.height}this.projectionMatrix.makeOrthographic(i,s,a,o,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}class dp extends Of{constructor(t=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=t}}function fp(t,e,n,r){const i=function(t){switch(t){case mc:case gc:return{byteLength:1,components:1};case yc:case vc:case xc:return{byteLength:2,components:1};case Ec:case Ac:return{byteLength:2,components:4};case wc:case bc:case _c:return{byteLength:4,components:1};case Mc:case Tc:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}(r);switch(n){case 1021:return t*e;case 1028:case Nc:return t*e/i.components*i.byteLength;case Oc:case Ic:return t*e*2/i.components*i.byteLength;case 1022:return t*e*3/i.components*i.byteLength;case Rc:case Dc:return t*e*4/i.components*i.byteLength;case Uc:case Lc:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case Fc:case kc:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case zc:case Gc:return Math.max(t,16)*Math.max(e,8)/4;case Bc:case Hc:return Math.max(t,8)*Math.max(e,8)/2;case Vc:case jc:case qc:case Xc:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case Wc:case Kc:case Yc:case Jc:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case Qc:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case Zc:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case $c:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case tu:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case eu:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case nu:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case ru:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case iu:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case su:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case au:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case ou:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case lu:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case cu:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case uu:case hu:case du:return Math.ceil(t/4)*Math.ceil(e/4)*16;case fu:case pu:return Math.ceil(t/4)*Math.ceil(e/4)*8;case mu:case gu:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function pp(){let t=null,e=!1,n=null,r=null;function i(e,s){n(e,s),r=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==n&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function mp(t){const e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=e.get(n);r&&(t.deleteBuffer(r.buffer),e.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const t=e.get(n);return void((!t||t.version<n.version)&&e.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const i=e.get(n);if(void 0===i)e.set(n,function(e,n){const r=e.array,i=e.usage,s=r.byteLength,a=t.createBuffer();let o;if(t.bindBuffer(n,a),t.bufferData(n,r,i),e.onUploadCallback(),r instanceof Float32Array)o=t.FLOAT;else if("undefined"!=typeof Float16Array&&r instanceof Float16Array)o=t.HALF_FLOAT;else if(r instanceof Uint16Array)o=e.isFloat16BufferAttribute?t.HALF_FLOAT:t.UNSIGNED_SHORT;else if(r instanceof Int16Array)o=t.SHORT;else if(r instanceof Uint32Array)o=t.UNSIGNED_INT;else if(r instanceof Int32Array)o=t.INT;else if(r instanceof Int8Array)o=t.BYTE;else if(r instanceof Uint8Array)o=t.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);o=t.UNSIGNED_BYTE}return{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version,size:s}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(e,n,r){const i=n.array,s=n.updateRanges;if(t.bindBuffer(r,e),0===s.length)t.bufferSubData(r,0,i);else{s.sort((t,e)=>t.start-e.start);let e=0;for(let t=1;t<s.length;t++){const n=s[e],r=s[t];r.start<=n.start+n.count+1?n.count=Math.max(n.count,r.start+r.count-n.start):(++e,s[e]=r)}s.length=e+1;for(let n=0,a=s.length;n<a;n++){const e=s[n];t.bufferSubData(r,e.start*i.BYTES_PER_ELEMENT,i,e.start,e.count)}n.clearUpdateRanges()}n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:pl}})),"undefined"!=typeof window&&(window.__THREE__?Bu("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=pl);const gp={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.metalness = metalnessFactor;\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = vec3( 0.04 );\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"uniform sampler2D dfgLUT;\nstruct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tvec3 diffuseContribution;\n\tvec3 specularColor;\n\tvec3 specularColorBlended;\n\tfloat roughness;\n\tfloat metalness;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t\tvec3 iridescenceFresnelDielectric;\n\t\tvec3 iridescenceFresnelMetallic;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn v;\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColorBlended;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat rInv = 1.0 / ( roughness + 0.1 );\n\tfloat a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;\n\tfloat b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;\n\tfloat DG = exp( a * dotNV + b );\n\treturn saturate( DG );\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nvec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;\n\tvec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;\n\tvec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;\n\tvec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;\n\tfloat Ess_V = dfgV.x + dfgV.y;\n\tfloat Ess_L = dfgL.x + dfgL.y;\n\tfloat Ems_V = 1.0 - Ess_V;\n\tfloat Ems_L = 1.0 - Ess_L;\n\tvec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;\n\tvec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );\n\tfloat compensationFactor = Ems_V * Ems_L;\n\tvec3 multiScatter = Fms * compensationFactor;\n\treturn singleScatter + multiScatter;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n \n \t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n \n \t\tfloat sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n \t\tfloat sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );\n \n \t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );\n \n \t\tirradiance *= sheenEnergyComp;\n \n \t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tdiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectDiffuse += diffuse;\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;\n \t#endif\n\tvec3 singleScatteringDielectric = vec3( 0.0 );\n\tvec3 multiScatteringDielectric = vec3( 0.0 );\n\tvec3 singleScatteringMetallic = vec3( 0.0 );\n\tvec3 multiScatteringMetallic = vec3( 0.0 );\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#endif\n\tvec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );\n\tvec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );\n\tvec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;\n\tvec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tvec3 indirectSpecular = radiance * singleScattering;\n\tindirectSpecular += multiScattering * cosineWeightedIrradiance;\n\tvec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tindirectSpecular *= sheenEnergyComp;\n\t\tindirectDiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectSpecular += indirectSpecular;\n\treflectedLight.indirectDiffuse += indirectDiffuse;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );\n\t\tmaterial.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\t\t\tuniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat interleavedGradientNoise( vec2 position ) {\n\t\t\treturn fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );\n\t\t}\n\t\tvec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {\n\t\t\tconst float goldenAngle = 2.399963229728653;\n\t\t\tfloat r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );\n\t\t\tfloat theta = float( sampleIndex ) * goldenAngle + phi;\n\t\t\treturn vec2( cos( theta ), sin( theta ) ) * r;\n\t\t}\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\t\tfloat radius = shadowRadius * texelSize.x;\n\t\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )\n\t\t\t\t) * 0.2;\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;\n\t\t\t\tfloat mean = distribution.x;\n\t\t\t\tfloat variance = distribution.y * distribution.y;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tfloat hard_shadow = step( mean, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tfloat hard_shadow = step( shadowCoord.z, mean );\n\t\t\t\t#endif\n\t\t\t\tif ( hard_shadow == 1.0 ) {\n\t\t\t\t\tshadow = 1.0;\n\t\t\t\t} else {\n\t\t\t\t\tvariance = max( variance, 0.0000001 );\n\t\t\t\t\tfloat d = shadowCoord.z - mean;\n\t\t\t\t\tfloat p_max = variance / ( variance + d * d );\n\t\t\t\t\tp_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );\n\t\t\t\t\tshadow = max( hard_shadow, p_max );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#else\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tfloat depth = texture2D( shadowMap, shadowCoord.xy ).r;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tshadow = step( depth, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tshadow = step( shadowCoord.z, depth );\n\t\t\t\t#endif\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\tfloat getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat texelSize = shadowRadius / shadowMapSize.x;\n\t\t\tvec3 absDir = abs( bd3D );\n\t\t\tvec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );\n\t\t\ttangent = normalize( cross( bd3D, tangent ) );\n\t\t\tvec3 bitangent = cross( bd3D, tangent );\n\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\tshadow = (\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )\n\t\t\t) * 0.2;\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\tfloat getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat depth = textureCube( shadowMap, bd3D ).r;\n\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\tshadow = step( depth, dp );\n\t\t\t#else\n\t\t\t\tshadow = step( dp, depth );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#endif\n\t#endif\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distance_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distance_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n \n\t\toutgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;\n \n \t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},vp={common:{diffuse:{value:new Gd(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new nh},alphaMap:{value:null},alphaMapTransform:{value:new nh},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new nh}},envmap:{envMap:{value:null},envMapRotation:{value:new nh},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new nh}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new nh}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new nh},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new nh},normalScale:{value:new Qu(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new nh},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new nh}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new nh}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new nh}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Gd(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Gd(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new nh},alphaTest:{value:0},uvTransform:{value:new nh}},sprite:{diffuse:{value:new Gd(16777215)},opacity:{value:1},center:{value:new Qu(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new nh},alphaMap:{value:null},alphaMapTransform:{value:new nh},alphaTest:{value:0}}},yp={basic:{uniforms:Af([vp.common,vp.specularmap,vp.envmap,vp.aomap,vp.lightmap,vp.fog]),vertexShader:gp.meshbasic_vert,fragmentShader:gp.meshbasic_frag},lambert:{uniforms:Af([vp.common,vp.specularmap,vp.envmap,vp.aomap,vp.lightmap,vp.emissivemap,vp.bumpmap,vp.normalmap,vp.displacementmap,vp.fog,vp.lights,{emissive:{value:new Gd(0)}}]),vertexShader:gp.meshlambert_vert,fragmentShader:gp.meshlambert_frag},phong:{uniforms:Af([vp.common,vp.specularmap,vp.envmap,vp.aomap,vp.lightmap,vp.emissivemap,vp.bumpmap,vp.normalmap,vp.displacementmap,vp.fog,vp.lights,{emissive:{value:new Gd(0)},specular:{value:new Gd(1118481)},shininess:{value:30}}]),vertexShader:gp.meshphong_vert,fragmentShader:gp.meshphong_frag},standard:{uniforms:Af([vp.common,vp.envmap,vp.aomap,vp.lightmap,vp.emissivemap,vp.bumpmap,vp.normalmap,vp.displacementmap,vp.roughnessmap,vp.metalnessmap,vp.fog,vp.lights,{emissive:{value:new Gd(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:gp.meshphysical_vert,fragmentShader:gp.meshphysical_frag},toon:{uniforms:Af([vp.common,vp.aomap,vp.lightmap,vp.emissivemap,vp.bumpmap,vp.normalmap,vp.displacementmap,vp.gradientmap,vp.fog,vp.lights,{emissive:{value:new Gd(0)}}]),vertexShader:gp.meshtoon_vert,fragmentShader:gp.meshtoon_frag},matcap:{uniforms:Af([vp.common,vp.bumpmap,vp.normalmap,vp.displacementmap,vp.fog,{matcap:{value:null}}]),vertexShader:gp.meshmatcap_vert,fragmentShader:gp.meshmatcap_frag},points:{uniforms:Af([vp.points,vp.fog]),vertexShader:gp.points_vert,fragmentShader:gp.points_frag},dashed:{uniforms:Af([vp.common,vp.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:gp.linedashed_vert,fragmentShader:gp.linedashed_frag},depth:{uniforms:Af([vp.common,vp.displacementmap]),vertexShader:gp.depth_vert,fragmentShader:gp.depth_frag},normal:{uniforms:Af([vp.common,vp.bumpmap,vp.normalmap,vp.displacementmap,{opacity:{value:1}}]),vertexShader:gp.meshnormal_vert,fragmentShader:gp.meshnormal_frag},sprite:{uniforms:Af([vp.sprite,vp.fog]),vertexShader:gp.sprite_vert,fragmentShader:gp.sprite_frag},background:{uniforms:{uvTransform:{value:new nh},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:gp.background_vert,fragmentShader:gp.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new nh}},vertexShader:gp.backgroundCube_vert,fragmentShader:gp.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:gp.cube_vert,fragmentShader:gp.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:gp.equirect_vert,fragmentShader:gp.equirect_frag},distance:{uniforms:Af([vp.common,vp.displacementmap,{referencePosition:{value:new $u},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:gp.distance_vert,fragmentShader:gp.distance_frag},shadow:{uniforms:Af([vp.lights,vp.fog,{color:{value:new Gd(0)},opacity:{value:1}}]),vertexShader:gp.shadow_vert,fragmentShader:gp.shadow_frag}};yp.physical={uniforms:Af([yp.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new nh},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new nh},clearcoatNormalScale:{value:new Qu(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new nh},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new nh},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new nh},sheen:{value:0},sheenColor:{value:new Gd(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new nh},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new nh},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new nh},transmissionSamplerSize:{value:new Qu},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new nh},attenuationDistance:{value:0},attenuationColor:{value:new Gd(0)},specularColor:{value:new Gd(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new nh},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new nh},anisotropyVector:{value:new Qu},anisotropyMap:{value:null},anisotropyMapTransform:{value:new nh}}]),vertexShader:gp.meshphysical_vert,fragmentShader:gp.meshphysical_frag};const bp={r:0,b:0,g:0},wp=new ad,_p=new Jh;function xp(t,e,n,r,i,s,a){const o=new Gd(0);let l,c,u=!0===s?0:1,h=null,d=0,f=null;function p(t){let r=!0===t.isScene?t.background:null;if(r&&r.isTexture){r=(t.backgroundBlurriness>0?n:e).get(r)}return r}function m(e,n){e.getRGB(bp,Sf(t)),r.buffers.color.setClear(bp.r,bp.g,bp.b,n,a)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),u=e,m(o,u)},getClearAlpha:function(){return u},setClearAlpha:function(t){u=t,m(o,u)},render:function(e){let n=!1;const i=p(e);null===i?m(o,u):i&&i.isColor&&(m(i,1),n=!0);const s=t.xr.getEnvironmentBlendMode();"additive"===s?r.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===s&&r.buffers.color.setClear(0,0,0,0,a),(t.autoClear||n)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))},addToRenderList:function(e,n){const r=p(n);r&&(r.isCubeTexture||r.mapping===sc)?(void 0===c&&(c=new wf(new xf(1,1,1),new Tf({name:"BackgroundCubeMaterial",uniforms:Ef(yp.backgroundCube.uniforms),vertexShader:yp.backgroundCube.vertexShader,fragmentShader:yp.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),wp.copy(n.backgroundRotation),wp.x*=-1,wp.y*=-1,wp.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(wp.y*=-1,wp.z*=-1),c.material.uniforms.envMap.value=r,c.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(_p.makeRotationFromEuler(wp)),c.material.toneMapped=oh.getTransfer(r.colorSpace)!==_u,h===r&&d===r.version&&f===t.toneMapping||(c.material.needsUpdate=!0,h=r,d=r.version,f=t.toneMapping),c.layers.enableAll(),e.unshift(c,c.geometry,c.material,0,0,null)):r&&r.isTexture&&(void 0===l&&(l=new wf(new op(2,2),new Tf({name:"BackgroundMaterial",uniforms:Ef(yp.background.uniforms),vertexShader:yp.background.vertexShader,fragmentShader:yp.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=r,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=oh.getTransfer(r.colorSpace)!==_u,!0===r.matrixAutoUpdate&&r.updateMatrix(),l.material.uniforms.uvTransform.value.copy(r.matrix),h===r&&d===r.version&&f===t.toneMapping||(l.material.needsUpdate=!0,h=r,d=r.version,f=t.toneMapping),l.layers.enableAll(),e.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function Ep(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r={},i=c(null);let s=i,a=!1;function o(e){return t.bindVertexArray(e)}function l(e){return t.deleteVertexArray(e)}function c(t){const e=[],r=[],i=[];for(let s=0;s<n;s++)e[s]=0,r[s]=0,i[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:r,attributeDivisors:i,object:t,attributes:{},index:null}}function u(){const t=s.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function h(t){d(t,0)}function d(e,n){const r=s.newAttributes,i=s.enabledAttributes,a=s.attributeDivisors;r[e]=1,0===i[e]&&(t.enableVertexAttribArray(e),i[e]=1),a[e]!==n&&(t.vertexAttribDivisor(e,n),a[e]=n)}function f(){const e=s.newAttributes,n=s.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==e[r]&&(t.disableVertexAttribArray(r),n[r]=0)}function p(e,n,r,i,s,a,o){!0===o?t.vertexAttribIPointer(e,n,r,s,a):t.vertexAttribPointer(e,n,r,i,s,a)}function m(){g(),a=!0,s!==i&&(s=i,o(s.object))}function g(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(n,i,l,m,g){let v=!1;const y=function(e,n,i){const s=!0===i.wireframe;let a=r[e.id];void 0===a&&(a={},r[e.id]=a);let o=a[n.id];void 0===o&&(o={},a[n.id]=o);let l=o[s];void 0===l&&(l=c(t.createVertexArray()),o[s]=l);return l}(m,l,i);s!==y&&(s=y,o(s.object)),v=function(t,e,n,r){const i=s.attributes,a=e.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){const e=i[s];let n=a[s];if(void 0===n&&("instanceMatrix"===s&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===s&&t.instanceColor&&(n=t.instanceColor)),void 0===e)return!0;if(e.attribute!==n)return!0;if(n&&e.data!==n.data)return!0;o++}}return s.attributesNum!==o||s.index!==r}(n,m,l,g),v&&function(t,e,n,r){const i={},a=e.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){let e=a[s];void 0===e&&("instanceMatrix"===s&&t.instanceMatrix&&(e=t.instanceMatrix),"instanceColor"===s&&t.instanceColor&&(e=t.instanceColor));const n={};n.attribute=e,e&&e.data&&(n.data=e.data),i[s]=n,o++}}s.attributes=i,s.attributesNum=o,s.index=r}(n,m,l,g),null!==g&&e.update(g,t.ELEMENT_ARRAY_BUFFER),(v||a)&&(a=!1,function(n,r,i,s){u();const a=s.attributes,o=i.getAttributes(),l=r.defaultAttributeValues;for(const c in o){const r=o[c];if(r.location>=0){let i=a[c];if(void 0===i&&("instanceMatrix"===c&&n.instanceMatrix&&(i=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(i=n.instanceColor)),void 0!==i){const a=i.normalized,o=i.itemSize,l=e.get(i);if(void 0===l)continue;const c=l.buffer,u=l.type,f=l.bytesPerElement,m=u===t.INT||u===t.UNSIGNED_INT||i.gpuType===bc;if(i.isInterleavedBufferAttribute){const e=i.data,l=e.stride,g=i.offset;if(e.isInstancedInterleavedBuffer){for(let t=0;t<r.locationSize;t++)d(r.location+t,e.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=e.meshPerAttribute*e.count)}else for(let t=0;t<r.locationSize;t++)h(r.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<r.locationSize;t++)p(r.location+t,o/r.locationSize,u,a,l*f,(g+o/r.locationSize*t)*f,m)}else{if(i.isInstancedBufferAttribute){for(let t=0;t<r.locationSize;t++)d(r.location+t,i.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let t=0;t<r.locationSize;t++)h(r.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<r.locationSize;t++)p(r.location+t,o/r.locationSize,u,a,o*f,o/r.locationSize*t*f,m)}}else if(void 0!==l){const e=l[c];if(void 0!==e)switch(e.length){case 2:t.vertexAttrib2fv(r.location,e);break;case 3:t.vertexAttrib3fv(r.location,e);break;case 4:t.vertexAttrib4fv(r.location,e);break;default:t.vertexAttrib1fv(r.location,e)}}}}f()}(n,i,l,m),null!==g&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const t in r){const e=r[t];for(const t in e){const n=e[t];for(const t in n)l(n[t].object),delete n[t];delete e[t]}delete r[t]}},releaseStatesOfGeometry:function(t){if(void 0===r[t.id])return;const e=r[t.id];for(const n in e){const t=e[n];for(const e in t)l(t[e].object),delete t[e];delete e[n]}delete r[t.id]},releaseStatesOfProgram:function(t){for(const e in r){const n=r[e];if(void 0===n[t.id])continue;const i=n[t.id];for(const t in i)l(i[t].object),delete i[t];delete n[t.id]}},initAttributes:u,enableAttribute:h,disableUnusedAttributes:f}}function Ap(t,e,n){let r;function i(e,i,s){0!==s&&(t.drawArraysInstanced(r,e,i,s),n.update(i,r,s))}this.setMode=function(t){r=t},this.render=function(e,i){t.drawArrays(r,e,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(t,i,s){if(0===s)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,t,0,i,0,s);let a=0;for(let e=0;e<s;e++)a+=i[e];n.update(a,r,1)},this.renderMultiDrawInstances=function(t,s,a,o){if(0===a)return;const l=e.get("WEBGL_multi_draw");if(null===l)for(let e=0;e<t.length;e++)i(t[e],s[e],o[e]);else{l.multiDrawArraysInstancedWEBGL(r,t,0,s,0,o,0,a);let e=0;for(let t=0;t<a;t++)e+=s[t]*o[t];n.update(e,r,1)}}}function Sp(t,e,n,r){let i;function s(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a=void 0!==n.precision?n.precision:"highp";const o=s(a);o!==a&&(Bu("WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,textureFormatReadable:function(e){return e===Rc||r.convert(e)===t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const i=n===xc&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(n!==mc&&r.convert(n)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==_c&&!i)},precision:a,logarithmicDepthBuffer:!0===n.logarithmicDepthBuffer,reversedDepthBuffer:!0===n.reversedDepthBuffer&&e.has("EXT_clip_control"),maxTextures:t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),maxVertexTextures:t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:t.getParameter(t.MAX_TEXTURE_SIZE),maxCubemapSize:t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:t.getParameter(t.MAX_VERTEX_ATTRIBS),maxVertexUniforms:t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:t.getParameter(t.MAX_VARYING_VECTORS),maxFragmentUniforms:t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),maxSamples:t.getParameter(t.MAX_SAMPLES),samples:t.getParameter(t.SAMPLES)}}function Mp(t){const e=this;let n=null,r=0,i=!1,s=!1;const a=new qf,o=new nh,l={value:null,needsUpdate:!1};function c(t,n,r,i){const s=null!==t?t.length:0;let c=null;if(0!==s){if(c=l.value,!0!==i||null===c){const e=r+4*s,i=n.matrixWorldInverse;o.getNormalMatrix(i),(null===c||c.length<e)&&(c=new Float32Array(e));for(let n=0,l=r;n!==s;++n,l+=4)a.copy(t[n]).applyMatrix4(i,o),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e){const n=0!==t.length||e||0!==r||i;return i=e,r=t.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(t,e){n=c(t,e,0)},this.setState=function(a,o,u){const h=a.clippingPlanes,d=a.clipIntersection,f=a.clipShadows,p=t.get(a);if(!i||null===h||0===h.length||s&&!f)s?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=r>0);e.numPlanes=r,e.numIntersection=0}();else{const t=s?0:r,e=4*t;let i=p.clippingState||null;l.value=i,i=c(h,o,e,u);for(let r=0;r!==e;++r)i[r]=n[r];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function Tp(t){let e=new WeakMap;function n(t,e){return 303===e?t.mapping=rc:304===e&&(t.mapping=ic),t}function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const s=i.mapping;if(303===s||304===s){if(e.has(i)){return n(e.get(i).texture,i.mapping)}{const s=i.image;if(s&&s.height>0){const a=new Lf(s.height);return a.fromEquirectangularTexture(t,i),e.set(i,a),i.addEventListener("dispose",r),n(a.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}const Rp=[.125,.215,.35,.446,.526,.582],Cp=20,Pp=new hp,Np=new Gd;let Op=null,Ip=0,Dp=0,Up=!1;const Lp=new $u;class Fp{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(t,e=0,n=.1,r=100,i={}){const{size:s=256,position:a=Lp}=i;Op=this._renderer.getRenderTarget(),Ip=this._renderer.getActiveCubeFace(),Dp=this._renderer.getActiveMipmapLevel(),Up=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(s);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(t,n,r,o,a),e>0&&this._blur(o,0,0,e),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Hp(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=zp(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._ggxMaterial&&this._ggxMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodMeshes.length;t++)this._lodMeshes[t].geometry.dispose()}_cleanup(t){this._renderer.setRenderTarget(Op,Ip,Dp),this._renderer.xr.enabled=Up,t.scissorTest=!1,Bp(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===rc||t.mapping===ic?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),Op=this._renderer.getRenderTarget(),Ip=this._renderer.getActiveCubeFace(),Dp=this._renderer.getActiveMipmapLevel(),Up=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:dc,minFilter:dc,generateMipmaps:!1,type:xc,format:Rc,colorSpace:bu,depthBuffer:!1},r=kp(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=kp(t,e,n);const{_lodMax:r}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=function(t){const e=[],n=[],r=[];let i=t;const s=t-4+1+Rp.length;for(let a=0;a<s;a++){const s=Math.pow(2,i);e.push(s);let o=1/s;a>t-4?o=Rp[a-t+4-1]:0===a&&(o=0),n.push(o);const l=1/(s-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*d),y=new Float32Array(m*f*d),b=new Float32Array(g*f*d);for(let t=0;t<d;t++){const e=t%3*2/3-1,n=t>2?0:-1,r=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];v.set(r,p*f*t),y.set(h,m*f*t);const i=[t,t,t,t,t,t];b.set(i,g*f*t)}const w=new lf;w.setAttribute("position",new Jd(v,p)),w.setAttribute("uv",new Jd(y,m)),w.setAttribute("faceIndex",new Jd(b,g)),r.push(new wf(w,null)),i>4&&i--}return{lodMeshes:r,sizeLods:e,sigmas:n}}(r)),this._blurMaterial=function(t,e,n){const r=new Float32Array(Cp),i=new $u(0,1,0),s=new Tf({name:"SphericalGaussianBlur",defines:{n:Cp,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Gp(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return s}(r,t,e),this._ggxMaterial=function(t,e,n){const r=new Tf({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:256,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:Gp(),fragmentShader:'\n\n\t\t\tprecision highp float;\n\t\t\tprecision highp int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform float roughness;\n\t\t\tuniform float mipInt;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\t#define PI 3.14159265359\n\n\t\t\t// Van der Corput radical inverse\n\t\t\tfloat radicalInverse_VdC(uint bits) {\n\t\t\t\tbits = (bits << 16u) | (bits >> 16u);\n\t\t\t\tbits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n\t\t\t\tbits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n\t\t\t\tbits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n\t\t\t\tbits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n\t\t\t\treturn float(bits) * 2.3283064365386963e-10; // / 0x100000000\n\t\t\t}\n\n\t\t\t// Hammersley sequence\n\t\t\tvec2 hammersley(uint i, uint N) {\n\t\t\t\treturn vec2(float(i) / float(N), radicalInverse_VdC(i));\n\t\t\t}\n\n\t\t\t// GGX VNDF importance sampling (Eric Heitz 2018)\n\t\t\t// "Sampling the GGX Distribution of Visible Normals"\n\t\t\t// https://jcgt.org/published/0007/04/01/\n\t\t\tvec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {\n\t\t\t\tfloat alpha = roughness * roughness;\n\n\t\t\t\t// Section 3.2: Transform view direction to hemisphere configuration\n\t\t\t\tvec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));\n\n\t\t\t\t// Section 4.1: Orthonormal basis\n\t\t\t\tfloat lensq = Vh.x * Vh.x + Vh.y * Vh.y;\n\t\t\t\tvec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 T2 = cross(Vh, T1);\n\n\t\t\t\t// Section 4.2: Parameterization of projected area\n\t\t\t\tfloat r = sqrt(Xi.x);\n\t\t\t\tfloat phi = 2.0 * PI * Xi.y;\n\t\t\t\tfloat t1 = r * cos(phi);\n\t\t\t\tfloat t2 = r * sin(phi);\n\t\t\t\tfloat s = 0.5 * (1.0 + Vh.z);\n\t\t\t\tt2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;\n\n\t\t\t\t// Section 4.3: Reprojection onto hemisphere\n\t\t\t\tvec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;\n\n\t\t\t\t// Section 3.4: Transform back to ellipsoid configuration\n\t\t\t\treturn normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\tvec3 N = normalize(vOutputDirection);\n\t\t\t\tvec3 V = N; // Assume view direction equals normal for pre-filtering\n\n\t\t\t\tvec3 prefilteredColor = vec3(0.0);\n\t\t\t\tfloat totalWeight = 0.0;\n\n\t\t\t\t// For very low roughness, just sample the environment directly\n\t\t\t\tif (roughness < 0.001) {\n\t\t\t\t\tgl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Tangent space basis for VNDF sampling\n\t\t\t\tvec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 tangent = normalize(cross(up, N));\n\t\t\t\tvec3 bitangent = cross(N, tangent);\n\n\t\t\t\tfor(uint i = 0u; i < uint(GGX_SAMPLES); i++) {\n\t\t\t\t\tvec2 Xi = hammersley(i, uint(GGX_SAMPLES));\n\n\t\t\t\t\t// For PMREM, V = N, so in tangent space V is always (0, 0, 1)\n\t\t\t\t\tvec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);\n\n\t\t\t\t\t// Transform H back to world space\n\t\t\t\t\tvec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);\n\t\t\t\t\tvec3 L = normalize(2.0 * dot(V, H) * H - V);\n\n\t\t\t\t\tfloat NdotL = max(dot(N, L), 0.0);\n\n\t\t\t\t\tif(NdotL > 0.0) {\n\t\t\t\t\t\t// Sample environment at fixed mip level\n\t\t\t\t\t\t// VNDF importance sampling handles the distribution filtering\n\t\t\t\t\t\tvec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);\n\n\t\t\t\t\t\t// Weight by NdotL for the split-sum approximation\n\t\t\t\t\t\t// VNDF PDF naturally accounts for the visible microfacet distribution\n\t\t\t\t\t\tprefilteredColor += sampleColor * NdotL;\n\t\t\t\t\t\ttotalWeight += NdotL;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (totalWeight > 0.0) {\n\t\t\t\t\tprefilteredColor = prefilteredColor / totalWeight;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = vec4(prefilteredColor, 1.0);\n\t\t\t}\n\t\t',blending:0,depthTest:!1,depthWrite:!1});return r}(r,t,e)}return r}_compileMaterial(t){const e=new wf(new lf,t);this._renderer.compile(e,Pp)}_sceneToCubeUV(t,e,n,r,i){const s=new Of(90,1,e,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(Np),l.toneMapping=0,l.autoClear=!1;l.state.buffers.depth.getReversed()&&(l.setRenderTarget(r),l.clearDepth(),l.setRenderTarget(null)),null===this._backgroundBox&&(this._backgroundBox=new wf(new xf,new qd({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1})));const h=this._backgroundBox,d=h.material;let f=!1;const p=t.background;p?p.isColor&&(d.color.copy(p),t.background=null,f=!0):(d.color.copy(Np),f=!0);for(let m=0;m<6;m++){const e=m%3;0===e?(s.up.set(0,a[m],0),s.position.set(i.x,i.y,i.z),s.lookAt(i.x+o[m],i.y,i.z)):1===e?(s.up.set(0,0,a[m]),s.position.set(i.x,i.y,i.z),s.lookAt(i.x,i.y+o[m],i.z)):(s.up.set(0,a[m],0),s.position.set(i.x,i.y,i.z),s.lookAt(i.x,i.y,i.z+o[m]));const n=this._cubeSize;Bp(r,e*n,m>2?n:0,n,n),l.setRenderTarget(r),f&&l.render(h,s),l.render(t,s)}l.toneMapping=u,l.autoClear=c,t.background=p}_textureToCubeUV(t,e){const n=this._renderer,r=t.mapping===rc||t.mapping===ic;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=Hp()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=zp());const i=r?this._cubemapMaterial:this._equirectMaterial,s=this._lodMeshes[0];s.material=i;i.uniforms.envMap.value=t;const a=this._cubeSize;Bp(e,0,0,3*a,2*a),n.setRenderTarget(e),n.render(s,Pp)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;const r=this._lodMeshes.length;for(let i=1;i<r;i++)this._applyGGXFilter(t,i-1,i);e.autoClear=n}_applyGGXFilter(t,e,n){const r=this._renderer,i=this._pingPongRenderTarget,s=this._ggxMaterial,a=this._lodMeshes[n];a.material=s;const o=s.uniforms,l=n/(this._lodMeshes.length-1),c=e/(this._lodMeshes.length-1),u=Math.sqrt(l*l-c*c)*(0+1.25*l),{_lodMax:h}=this,d=this._sizeLods[n],f=3*d*(n>h-4?n-h+4:0),p=4*(this._cubeSize-d);o.envMap.value=t.texture,o.roughness.value=u,o.mipInt.value=h-e,Bp(i,f,p,3*d,2*d),r.setRenderTarget(i),r.render(a,Pp),o.envMap.value=i.texture,o.roughness.value=0,o.mipInt.value=h-n,Bp(t,f,p,3*d,2*d),r.setRenderTarget(t),r.render(a,Pp)}_blur(t,e,n,r,i){const s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,r,"latitudinal",i),this._halfBlur(s,t,n,n,r,"longitudinal",i)}_halfBlur(t,e,n,r,i,s,a){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&zu("blur direction must be either latitudinal or longitudinal!");const c=this._lodMeshes[r];c.material=l;const u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/d,p=isFinite(i)?1+Math.floor(3*f):Cp;p>Cp&&Bu(`sigmaRadians, ${i}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);const m=[];let g=0;for(let b=0;b<Cp;++b){const t=b/f,e=Math.exp(-t*t/2);m.push(e),0===b?g+=e:b<p&&(g+=2*e)}for(let b=0;b<m.length;b++)m[b]=m[b]/g;u.envMap.value=t.texture,u.samples.value=p,u.weights.value=m,u.latitudinal.value="latitudinal"===s,a&&(u.poleAxis.value=a);const{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-n;const y=this._sizeLods[r];Bp(e,3*y*(r>v-4?r-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(e),o.render(c,Pp)}}function kp(t,e,n){const r=new wh(t,e,n);return r.texture.mapping=sc,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Bp(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function zp(){return new Tf({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Gp(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Hp(){return new Tf({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Gp(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Gp(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function Vp(t){let e=new WeakMap,n=null;function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const s=i.mapping,a=303===s||304===s,o=s===rc||s===ic;if(a||o){let s=e.get(i);const l=void 0!==s?s.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==l)return null===n&&(n=new Fp(t)),s=a?n.fromEquirectangular(i,s):n.fromCubemap(i,s),s.texture.pmremVersion=i.pmremVersion,e.set(i,s),s.texture;if(void 0!==s)return s.texture;{const l=i.image;return a&&l&&l.height>0||o&&l&&function(t){let e=0;const n=6;for(let r=0;r<n;r++)void 0!==t[r]&&e++;return e===n}(l)?(null===n&&(n=new Fp(t)),s=a?n.fromEquirectangular(i):n.fromCubemap(i),s.texture.pmremVersion=i.pmremVersion,e.set(i,s),i.addEventListener("dispose",r),s.texture):null}}}return i},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function jp(t){const e={};function n(n){if(void 0!==e[n])return e[n];const r=t.getExtension(n);return e[n]=r,r}return{has:function(t){return null!==n(t)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(t){const e=n(t);return null===e&&Hu("WebGLRenderer: "+t+" extension not supported."),e}}}function Wp(t,e,n,r){const i={},s=new WeakMap;function a(t){const o=t.target;null!==o.index&&e.remove(o.index);for(const n in o.attributes)e.remove(o.attributes[n]);o.removeEventListener("dispose",a),delete i[o.id];const l=s.get(o);l&&(e.remove(l),s.delete(o)),r.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(t){const n=[],r=t.index,i=t.attributes.position;let a=0;if(null!==r){const t=r.array;a=r.version;for(let e=0,r=t.length;e<r;e+=3){const r=t[e+0],i=t[e+1],s=t[e+2];n.push(r,i,i,s,s,r)}}else{if(void 0===i)return;{const t=i.array;a=i.version;for(let e=0,r=t.length/3-1;e<r;e+=3){const t=e+0,r=e+1,i=e+2;n.push(t,r,r,i,i,t)}}}const o=new(Du(n)?Zd:Qd)(n,1);o.version=a;const l=s.get(t);l&&e.remove(l),s.set(t,o)}return{get:function(t,e){return!0===i[e.id]||(e.addEventListener("dispose",a),i[e.id]=!0,n.memory.geometries++),e},update:function(n){const r=n.attributes;for(const i in r)e.update(r[i],t.ARRAY_BUFFER)},getWireframeAttribute:function(t){const e=s.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&o(t)}else o(t);return s.get(t)}}}function qp(t,e,n){let r,i,s;function a(e,a,o){0!==o&&(t.drawElementsInstanced(r,a,i,e*s,o),n.update(a,r,o))}this.setMode=function(t){r=t},this.setIndex=function(t){i=t.type,s=t.bytesPerElement},this.render=function(e,a){t.drawElements(r,a,i,e*s),n.update(a,r,1)},this.renderInstances=a,this.renderMultiDraw=function(t,s,a){if(0===a)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,s,0,i,t,0,a);let o=0;for(let e=0;e<a;e++)o+=s[e];n.update(o,r,1)},this.renderMultiDrawInstances=function(t,o,l,c){if(0===l)return;const u=e.get("WEBGL_multi_draw");if(null===u)for(let e=0;e<t.length;e++)a(t[e]/s,o[e],c[e]);else{u.multiDrawElementsInstancedWEBGL(r,o,0,i,t,0,c,0,l);let e=0;for(let t=0;t<l;t++)e+=o[t]*c[t];n.update(e,r,1)}}}function Xp(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(n,r,i){switch(e.calls++,r){case t.TRIANGLES:e.triangles+=i*(n/3);break;case t.LINES:e.lines+=i*(n/2);break;case t.LINE_STRIP:e.lines+=i*(n-1);break;case t.LINE_LOOP:e.lines+=i*n;break;case t.POINTS:e.points+=i*n;break;default:zu("WebGLInfo: Unknown draw mode:",r)}}}}function Kp(t,e,n){const r=new WeakMap,i=new yh;return{update:function(s,a,o){const l=s.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,u=void 0!==c?c.length:0;let h=r.get(a);if(void 0===h||h.count!==u){let t=function(){v.dispose(),r.delete(a),a.removeEventListener("dispose",t)};void 0!==h&&h.texture.dispose();const n=void 0!==a.morphAttributes.position,s=void 0!==a.morphAttributes.normal,o=void 0!==a.morphAttributes.color,l=a.morphAttributes.position||[],c=a.morphAttributes.normal||[],d=a.morphAttributes.color||[];let f=0;!0===n&&(f=1),!0===s&&(f=2),!0===o&&(f=3);let p=a.attributes.position.count*f,m=1;p>e.maxTextureSize&&(m=Math.ceil(p/e.maxTextureSize),p=e.maxTextureSize);const g=new Float32Array(p*m*4*u),v=new _h(g,p,m,u);v.type=_c,v.needsUpdate=!0;const y=4*f;for(let e=0;e<u;e++){const t=l[e],r=c[e],a=d[e],u=p*m*4*e;for(let e=0;e<t.count;e++){const l=e*y;!0===n&&(i.fromBufferAttribute(t,e),g[u+l+0]=i.x,g[u+l+1]=i.y,g[u+l+2]=i.z,g[u+l+3]=0),!0===s&&(i.fromBufferAttribute(r,e),g[u+l+4]=i.x,g[u+l+5]=i.y,g[u+l+6]=i.z,g[u+l+7]=0),!0===o&&(i.fromBufferAttribute(a,e),g[u+l+8]=i.x,g[u+l+9]=i.y,g[u+l+10]=i.z,g[u+l+11]=4===a.itemSize?i.w:1)}}h={count:u,texture:v,size:new Qu(p,m)},r.set(a,h),a.addEventListener("dispose",t)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)o.getUniforms().setValue(t,"morphTexture",s.morphTexture,n);else{let e=0;for(let t=0;t<l.length;t++)e+=l[t];const n=a.morphTargetsRelative?1:1-e;o.getUniforms().setValue(t,"morphTargetBaseInfluence",n),o.getUniforms().setValue(t,"morphTargetInfluences",l)}o.getUniforms().setValue(t,"morphTargetsTexture",h.texture,n),o.getUniforms().setValue(t,"morphTargetsTextureSize",h.size)}}}function Yp(t,e,n,r){let i=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(a){const o=r.render.frame,l=a.geometry,c=e.get(a,l);if(i.get(c)!==o&&(e.update(c),i.set(c,o)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",s)&&a.addEventListener("dispose",s),i.get(a)!==o&&(n.update(a.instanceMatrix,t.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,t.ARRAY_BUFFER),i.set(a,o))),a.isSkinnedMesh){const t=a.skeleton;i.get(t)!==o&&(t.update(),i.set(t,o))}return c},dispose:function(){i=new WeakMap}}}const Jp={[Jl]:"LINEAR_TONE_MAPPING",[Ql]:"REINHARD_TONE_MAPPING",[Zl]:"CINEON_TONE_MAPPING",[$l]:"ACES_FILMIC_TONE_MAPPING",[ec]:"AGX_TONE_MAPPING",[nc]:"NEUTRAL_TONE_MAPPING",[tc]:"CUSTOM_TONE_MAPPING"};function Qp(t,e,n,r,i){const s=new wh(e,n,{type:t,depthBuffer:r,stencilBuffer:i}),a=new wh(e,n,{type:xc,depthBuffer:!1,stencilBuffer:!1}),o=new lf;o.setAttribute("position",new $d([-1,3,0,-1,-1,0,3,-1,0],3)),o.setAttribute("uv",new $d([0,2,0,0,2,0],2));const l=new lp({uniforms:{tDiffuse:{value:null}},vertexShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform mat4 modelViewMatrix;\n\t\t\tuniform mat4 projectionMatrix;\n\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main() {\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t}",fragmentShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform sampler2D tDiffuse;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\t#include <tonemapping_pars_fragment>\n\t\t\t#include <colorspace_pars_fragment>\n\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\t\t\t\t#ifdef LINEAR_TONE_MAPPING\n\t\t\t\t\tgl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( AGX_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( NEUTRAL_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CUSTOM_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );\n\t\t\t\t#endif\n\n\t\t\t\t#ifdef SRGB_TRANSFER\n\t\t\t\t\tgl_FragColor = sRGBTransferOETF( gl_FragColor );\n\t\t\t\t#endif\n\t\t\t}",depthTest:!1,depthWrite:!1}),c=new wf(o,l),u=new hp(-1,1,1,-1,0,1);let h,d=null,f=null,p=!1,m=null,g=[],v=!1;this.setSize=function(t,e){s.setSize(t,e),a.setSize(t,e);for(let n=0;n<g.length;n++){const r=g[n];r.setSize&&r.setSize(t,e)}},this.setEffects=function(t){g=t,v=g.length>0&&!0===g[0].isRenderPass;const e=s.width,n=s.height;for(let r=0;r<g.length;r++){const t=g[r];t.setSize&&t.setSize(e,n)}},this.begin=function(t,e){if(p)return!1;if(0===t.toneMapping&&0===g.length)return!1;if(m=e,null!==e){const t=e.width,n=e.height;s.width===t&&s.height===n||this.setSize(t,n)}return!1===v&&t.setRenderTarget(s),h=t.toneMapping,t.toneMapping=0,!0},this.hasRenderPass=function(){return v},this.end=function(t,e){t.toneMapping=h,p=!0;let n=s,r=a;for(let i=0;i<g.length;i++){const s=g[i];if(!1!==s.enabled&&(s.render(t,r,n,e),!1!==s.needsSwap)){const t=n;n=r,r=t}}if(d!==t.outputColorSpace||f!==t.toneMapping){d=t.outputColorSpace,f=t.toneMapping,l.defines={},oh.getTransfer(d)===_u&&(l.defines.SRGB_TRANSFER="");const e=Jp[f];e&&(l.defines[e]=""),l.needsUpdate=!0}l.uniforms.tDiffuse.value=n.texture,t.setRenderTarget(m),t.render(c,u),m=null,p=!1},this.isCompositing=function(){return p},this.dispose=function(){s.dispose(),a.dispose(),o.dispose(),l.dispose()}}const Zp=new vh,$p=new ip(1,1),tm=new _h,em=new xh,nm=new Uf,rm=[],im=[],sm=new Float32Array(16),am=new Float32Array(9),om=new Float32Array(4);function lm(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let s=rm[i];if(void 0===s&&(s=new Float32Array(i),rm[i]=s),0!==e){r.toArray(s,0);for(let r=1,i=0;r!==e;++r)i+=n,t[r].toArray(s,i)}return s}function cm(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function um(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function hm(t,e){let n=im[e];void 0===n&&(n=new Int32Array(e),im[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function dm(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function fm(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(cm(n,e))return;t.uniform2fv(this.addr,e),um(n,e)}}function pm(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(cm(n,e))return;t.uniform3fv(this.addr,e),um(n,e)}}function mm(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(cm(n,e))return;t.uniform4fv(this.addr,e),um(n,e)}}function gm(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(cm(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),um(n,e)}else{if(cm(n,r))return;om.set(r),t.uniformMatrix2fv(this.addr,!1,om),um(n,r)}}function vm(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(cm(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),um(n,e)}else{if(cm(n,r))return;am.set(r),t.uniformMatrix3fv(this.addr,!1,am),um(n,r)}}function ym(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(cm(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),um(n,e)}else{if(cm(n,r))return;sm.set(r),t.uniformMatrix4fv(this.addr,!1,sm),um(n,r)}}function bm(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function wm(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(cm(n,e))return;t.uniform2iv(this.addr,e),um(n,e)}}function _m(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(cm(n,e))return;t.uniform3iv(this.addr,e),um(n,e)}}function xm(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(cm(n,e))return;t.uniform4iv(this.addr,e),um(n,e)}}function Em(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Am(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(cm(n,e))return;t.uniform2uiv(this.addr,e),um(n,e)}}function Sm(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(cm(n,e))return;t.uniform3uiv(this.addr,e),um(n,e)}}function Mm(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(cm(n,e))return;t.uniform4uiv(this.addr,e),um(n,e)}}function Tm(t,e,n){const r=this.cache,i=n.allocateTextureUnit();let s;r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),this.type===t.SAMPLER_2D_SHADOW?($p.compareFunction=n.isReversedDepthBuffer()?518:515,s=$p):s=Zp,n.setTexture2D(e||s,i)}function Rm(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||em,i)}function Cm(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||nm,i)}function Pm(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||tm,i)}function Nm(t,e){t.uniform1fv(this.addr,e)}function Om(t,e){const n=lm(e,this.size,2);t.uniform2fv(this.addr,n)}function Im(t,e){const n=lm(e,this.size,3);t.uniform3fv(this.addr,n)}function Dm(t,e){const n=lm(e,this.size,4);t.uniform4fv(this.addr,n)}function Um(t,e){const n=lm(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Lm(t,e){const n=lm(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Fm(t,e){const n=lm(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function km(t,e){t.uniform1iv(this.addr,e)}function Bm(t,e){t.uniform2iv(this.addr,e)}function zm(t,e){t.uniform3iv(this.addr,e)}function Hm(t,e){t.uniform4iv(this.addr,e)}function Gm(t,e){t.uniform1uiv(this.addr,e)}function Vm(t,e){t.uniform2uiv(this.addr,e)}function jm(t,e){t.uniform3uiv(this.addr,e)}function Wm(t,e){t.uniform4uiv(this.addr,e)}function qm(t,e,n){const r=this.cache,i=e.length,s=hm(n,i);let a;cm(r,s)||(t.uniform1iv(this.addr,s),um(r,s)),a=this.type===t.SAMPLER_2D_SHADOW?$p:Zp;for(let o=0;o!==i;++o)n.setTexture2D(e[o]||a,s[o])}function Xm(t,e,n){const r=this.cache,i=e.length,s=hm(n,i);cm(r,s)||(t.uniform1iv(this.addr,s),um(r,s));for(let a=0;a!==i;++a)n.setTexture3D(e[a]||em,s[a])}function Km(t,e,n){const r=this.cache,i=e.length,s=hm(n,i);cm(r,s)||(t.uniform1iv(this.addr,s),um(r,s));for(let a=0;a!==i;++a)n.setTextureCube(e[a]||nm,s[a])}function Ym(t,e,n){const r=this.cache,i=e.length,s=hm(n,i);cm(r,s)||(t.uniform1iv(this.addr,s),um(r,s));for(let a=0;a!==i;++a)n.setTexture2DArray(e[a]||tm,s[a])}class Jm{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.setValue=function(t){switch(t){case 5126:return dm;case 35664:return fm;case 35665:return pm;case 35666:return mm;case 35674:return gm;case 35675:return vm;case 35676:return ym;case 5124:case 35670:return bm;case 35667:case 35671:return wm;case 35668:case 35672:return _m;case 35669:case 35673:return xm;case 5125:return Em;case 36294:return Am;case 36295:return Sm;case 36296:return Mm;case 35678:case 36198:case 36298:case 36306:case 35682:return Tm;case 35679:case 36299:case 36307:return Rm;case 35680:case 36300:case 36308:case 36293:return Cm;case 36289:case 36303:case 36311:case 36292:return Pm}}(e.type)}}class Qm{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Nm;case 35664:return Om;case 35665:return Im;case 35666:return Dm;case 35674:return Um;case 35675:return Lm;case 35676:return Fm;case 5124:case 35670:return km;case 35667:case 35671:return Bm;case 35668:case 35672:return zm;case 35669:case 35673:return Hm;case 5125:return Gm;case 36294:return Vm;case 36295:return jm;case 36296:return Wm;case 35678:case 36198:case 36298:case 36306:case 35682:return qm;case 35679:case 36299:case 36307:return Xm;case 35680:case 36300:case 36308:case 36293:return Km;case 36289:case 36303:case 36311:case 36292:return Ym}}(e.type)}}class Zm{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const r=this.seq;for(let i=0,s=r.length;i!==s;++i){const s=r[i];s.setValue(t,e[s.id],n)}}}const $m=/(\w+)(\])?(\[|\.)?/g;function tg(t,e){t.seq.push(e),t.map[e.id]=e}function eg(t,e,n){const r=t.name,i=r.length;for($m.lastIndex=0;;){const s=$m.exec(r),a=$m.lastIndex;let o=s[1];const l="]"===s[2],c=s[3];if(l&&(o|=0),void 0===c||"["===c&&a+2===i){tg(n,void 0===c?new Jm(o,t,e):new Qm(o,t,e));break}{let t=n.map[o];void 0===t&&(t=new Zm(o),tg(n,t)),n=t}}}class ng{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){const n=t.getActiveUniform(e,s);eg(n,t.getUniformLocation(e,n.name),this)}const r=[],i=[];for(const s of this.seq)s.type===t.SAMPLER_2D_SHADOW||s.type===t.SAMPLER_CUBE_SHADOW||s.type===t.SAMPLER_2D_ARRAY_SHADOW?r.push(s):i.push(s);r.length>0&&(this.seq=r.concat(i))}setValue(t,e,n,r){const i=this.map[e];void 0!==i&&i.setValue(t,n,r)}setOptional(t,e,n){const r=e[n];void 0!==r&&this.setValue(t,n,r)}static upload(t,e,n,r){for(let i=0,s=e.length;i!==s;++i){const s=e[i],a=n[s.id];!1!==a.needsUpdate&&s.setValue(t,a.value,r)}}static seqWithValue(t,e){const n=[];for(let r=0,i=t.length;r!==i;++r){const i=t[r];i.id in e&&n.push(i)}return n}}function rg(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}let ig=0;const sg=new nh;function ag(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),i=(t.getShaderInfoLog(e)||"").trim();if(r&&""===i)return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const r=parseInt(s[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(t,e){const n=t.split("\n"),r=[],i=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let a=i;a<s;a++){const t=a+1;r.push(`${t===e?">":" "} ${t}: ${n[a]}`)}return r.join("\n")}(t.getShaderSource(e),r)}return i}function og(t,e){const n=function(t){oh._getMatrix(sg,oh.workingColorSpace,t);const e=`mat3( ${sg.elements.map(t=>t.toFixed(4))} )`;switch(oh.getTransfer(t)){case wu:return[e,"LinearTransferOETF"];case _u:return[e,"sRGBTransferOETF"];default:return Bu("WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}(e);return[`vec4 ${t}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}const lg={[Jl]:"Linear",[Ql]:"Reinhard",[Zl]:"Cineon",[$l]:"ACESFilmic",[ec]:"AgX",[nc]:"Neutral",[tc]:"Custom"};function cg(t,e){const n=lg[e];return void 0===n?(Bu("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+t+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const ug=new $u;function hg(){oh.getLuminanceCoefficients(ug);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${ug.x.toFixed(4)}, ${ug.y.toFixed(4)}, ${ug.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function dg(t){return""!==t}function fg(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function pg(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const mg=/^[ \t]*#include +<([\w\d./]+)>/gm;function gg(t){return t.replace(mg,yg)}const vg=new Map;function yg(t,e){let n=gp[e];if(void 0===n){const t=vg.get(e);if(void 0===t)throw new Error("Can not resolve #include <"+e+">");n=gp[t],Bu('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,t)}return gg(n)}const bg=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wg(t){return t.replace(bg,_g)}function _g(t,e,n,r){let i="";for(let s=parseInt(e);s<parseInt(n);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function xg(t){let e=`precision ${t.precision} float;\n\tprecision ${t.precision} int;\n\tprecision ${t.precision} sampler2D;\n\tprecision ${t.precision} samplerCube;\n\tprecision ${t.precision} sampler3D;\n\tprecision ${t.precision} sampler2DArray;\n\tprecision ${t.precision} sampler2DShadow;\n\tprecision ${t.precision} samplerCubeShadow;\n\tprecision ${t.precision} sampler2DArrayShadow;\n\tprecision ${t.precision} isampler2D;\n\tprecision ${t.precision} isampler3D;\n\tprecision ${t.precision} isamplerCube;\n\tprecision ${t.precision} isampler2DArray;\n\tprecision ${t.precision} usampler2D;\n\tprecision ${t.precision} usampler3D;\n\tprecision ${t.precision} usamplerCube;\n\tprecision ${t.precision} usampler2DArray;\n\t`;return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}const Eg={[ml]:"SHADOWMAP_TYPE_PCF",[gl]:"SHADOWMAP_TYPE_VSM"};const Ag={[rc]:"ENVMAP_TYPE_CUBE",[ic]:"ENVMAP_TYPE_CUBE",[sc]:"ENVMAP_TYPE_CUBE_UV"};const Sg={[ic]:"ENVMAP_MODE_REFRACTION"};const Mg={[Xl]:"ENVMAP_BLENDING_MULTIPLY",[Kl]:"ENVMAP_BLENDING_MIX",[Yl]:"ENVMAP_BLENDING_ADD"};function Tg(t,e,n,r){const i=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const l=function(t){return Eg[t.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}(n),c=function(t){return!1===t.envMap?"ENVMAP_TYPE_CUBE":Ag[t.envMapMode]||"ENVMAP_TYPE_CUBE"}(n),u=function(t){return!1===t.envMap?"ENVMAP_MODE_REFLECTION":Sg[t.envMapMode]||"ENVMAP_MODE_REFLECTION"}(n),h=function(t){return!1===t.envMap?"ENVMAP_BLENDING_NONE":Mg[t.combine]||"ENVMAP_BLENDING_NONE"}(n),d=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),f=function(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(dg).join("\n")}(n),p=function(t){const e=[];for(const n in t){const r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(s),m=i.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(dg).join("\n"),g.length>0&&(g+="\n"),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(dg).join("\n"),v.length>0&&(v+="\n")):(g=[xg(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(dg).join("\n"),v=[xg(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?gp.tonemapping_pars_fragment:"",0!==n.toneMapping?cg("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",gp.colorspace_pars_fragment,og("linearToOutputTexel",n.outputColorSpace),hg(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(dg).join("\n")),a=gg(a),a=fg(a,n),a=pg(a,n),o=gg(o),o=fg(o,n),o=pg(o,n),a=wg(a),o=wg(o),!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=[f,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===Nu?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Nu?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const b=y+g+a,w=y+v+o,_=rg(i,i.VERTEX_SHADER,b),x=rg(i,i.FRAGMENT_SHADER,w);function E(e){if(t.debug.checkShaderErrors){const n=i.getProgramInfoLog(m)||"",r=i.getShaderInfoLog(_)||"",s=i.getShaderInfoLog(x)||"",a=n.trim(),o=r.trim(),l=s.trim();let c=!0,u=!0;if(!1===i.getProgramParameter(m,i.LINK_STATUS))if(c=!1,"function"==typeof t.debug.onShaderError)t.debug.onShaderError(i,m,_,x);else{const t=ag(i,_,"vertex"),n=ag(i,x,"fragment");zu("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,i.VALIDATE_STATUS)+"\n\nMaterial Name: "+e.name+"\nMaterial Type: "+e.type+"\n\nProgram Info Log: "+a+"\n"+t+"\n"+n)}else""!==a?Bu("WebGLProgram: Program Info Log:",a):""!==o&&""!==l||(u=!1);u&&(e.diagnostics={runnable:c,programLog:a,vertexShader:{log:o,prefix:g},fragmentShader:{log:l,prefix:v}})}i.deleteShader(_),i.deleteShader(x),A=new ng(i,m),S=function(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i),s=r.name;let a=1;r.type===t.FLOAT_MAT2&&(a=2),r.type===t.FLOAT_MAT3&&(a=3),r.type===t.FLOAT_MAT4&&(a=4),n[s]={type:r.type,location:t.getAttribLocation(e,s),locationSize:a}}return n}(i,m)}let A,S;i.attachShader(m,_),i.attachShader(m,x),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),this.getUniforms=function(){return void 0===A&&E(this),A},this.getAttributes=function(){return void 0===S&&E(this),S};let M=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===M&&(M=i.getProgramParameter(m,37297)),M},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=ig++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=_,this.fragmentShader=x,this}let Rg=0;class Cg{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,r=this._getShaderStage(e),i=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return!1===s.has(r)&&(s.add(r),r.usedTimes++),!1===s.has(i)&&(s.add(i),i.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let n=e.get(t);return void 0===n&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){const e=this.shaderCache;let n=e.get(t);return void 0===n&&(n=new Pg(t),e.set(t,n)),n}}class Pg{constructor(t){this.id=Rg++,this.code=t,this.usedTimes=0}}function Ng(t,e,n,r,i,s,a){const o=new od,l=new Cg,c=new Set,u=[],h=new Map,d=i.logarithmicDepthBuffer;let f=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(t){return c.add(t),0===t?"uv":`uv${t}`}return{getParameters:function(s,o,u,h,g){const v=h.fog,y=g.geometry,b=s.isMeshStandardMaterial?h.environment:null,w=(s.isMeshStandardMaterial?n:e).get(s.envMap||b),_=w&&w.mapping===sc?w.image.height:null,x=p[s.type];null!==s.precision&&(f=i.getMaxPrecision(s.precision),f!==s.precision&&Bu("WebGLProgram.getParameters:",s.precision,"not supported, using",f,"instead."));const E=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,A=void 0!==E?E.length:0;let S,M,T,R,C=0;if(void 0!==y.morphAttributes.position&&(C=1),void 0!==y.morphAttributes.normal&&(C=2),void 0!==y.morphAttributes.color&&(C=3),x){const t=yp[x];S=t.vertexShader,M=t.fragmentShader}else S=s.vertexShader,M=s.fragmentShader,l.update(s),T=l.getVertexShaderID(s),R=l.getFragmentShaderID(s);const P=t.getRenderTarget(),N=t.state.buffers.depth.getReversed(),O=!0===g.isInstancedMesh,I=!0===g.isBatchedMesh,D=!!s.map,U=!!s.matcap,L=!!w,F=!!s.aoMap,k=!!s.lightMap,B=!!s.bumpMap,z=!!s.normalMap,H=!!s.displacementMap,G=!!s.emissiveMap,V=!!s.metalnessMap,j=!!s.roughnessMap,W=s.anisotropy>0,q=s.clearcoat>0,X=s.dispersion>0,K=s.iridescence>0,Y=s.sheen>0,J=s.transmission>0,Q=W&&!!s.anisotropyMap,Z=q&&!!s.clearcoatMap,$=q&&!!s.clearcoatNormalMap,tt=q&&!!s.clearcoatRoughnessMap,et=K&&!!s.iridescenceMap,nt=K&&!!s.iridescenceThicknessMap,rt=Y&&!!s.sheenColorMap,it=Y&&!!s.sheenRoughnessMap,st=!!s.specularMap,at=!!s.specularColorMap,ot=!!s.specularIntensityMap,lt=J&&!!s.transmissionMap,ct=J&&!!s.thicknessMap,ut=!!s.gradientMap,ht=!!s.alphaMap,dt=s.alphaTest>0,ft=!!s.alphaHash,pt=!!s.extensions;let mt=0;s.toneMapped&&(null!==P&&!0!==P.isXRRenderTarget||(mt=t.toneMapping));const gt={shaderID:x,shaderType:s.type,shaderName:s.name,vertexShader:S,fragmentShader:M,defines:s.defines,customVertexShaderID:T,customFragmentShaderID:R,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:f,batching:I,batchingColor:I&&null!==g._colorsTexture,instancing:O,instancingColor:O&&null!==g.instanceColor,instancingMorph:O&&null!==g.morphTexture,outputColorSpace:null===P?t.outputColorSpace:!0===P.isXRRenderTarget?P.texture.colorSpace:bu,alphaToCoverage:!!s.alphaToCoverage,map:D,matcap:U,envMap:L,envMapMode:L&&w.mapping,envMapCubeUVHeight:_,aoMap:F,lightMap:k,bumpMap:B,normalMap:z,displacementMap:H,emissiveMap:G,normalMapObjectSpace:z&&1===s.normalMapType,normalMapTangentSpace:z&&0===s.normalMapType,metalnessMap:V,roughnessMap:j,anisotropy:W,anisotropyMap:Q,clearcoat:q,clearcoatMap:Z,clearcoatNormalMap:$,clearcoatRoughnessMap:tt,dispersion:X,iridescence:K,iridescenceMap:et,iridescenceThicknessMap:nt,sheen:Y,sheenColorMap:rt,sheenRoughnessMap:it,specularMap:st,specularColorMap:at,specularIntensityMap:ot,transmission:J,transmissionMap:lt,thicknessMap:ct,gradientMap:ut,opaque:!1===s.transparent&&1===s.blending&&!1===s.alphaToCoverage,alphaMap:ht,alphaTest:dt,alphaHash:ft,combine:s.combine,mapUv:D&&m(s.map.channel),aoMapUv:F&&m(s.aoMap.channel),lightMapUv:k&&m(s.lightMap.channel),bumpMapUv:B&&m(s.bumpMap.channel),normalMapUv:z&&m(s.normalMap.channel),displacementMapUv:H&&m(s.displacementMap.channel),emissiveMapUv:G&&m(s.emissiveMap.channel),metalnessMapUv:V&&m(s.metalnessMap.channel),roughnessMapUv:j&&m(s.roughnessMap.channel),anisotropyMapUv:Q&&m(s.anisotropyMap.channel),clearcoatMapUv:Z&&m(s.clearcoatMap.channel),clearcoatNormalMapUv:$&&m(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:tt&&m(s.clearcoatRoughnessMap.channel),iridescenceMapUv:et&&m(s.iridescenceMap.channel),iridescenceThicknessMapUv:nt&&m(s.iridescenceThicknessMap.channel),sheenColorMapUv:rt&&m(s.sheenColorMap.channel),sheenRoughnessMapUv:it&&m(s.sheenRoughnessMap.channel),specularMapUv:st&&m(s.specularMap.channel),specularColorMapUv:at&&m(s.specularColorMap.channel),specularIntensityMapUv:ot&&m(s.specularIntensityMap.channel),transmissionMapUv:lt&&m(s.transmissionMap.channel),thicknessMapUv:ct&&m(s.thicknessMap.channel),alphaMapUv:ht&&m(s.alphaMap.channel),vertexTangents:!!y.attributes.tangent&&(z||W),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,pointsUvs:!0===g.isPoints&&!!y.attributes.uv&&(D||ht),fog:!!v,useFog:!0===s.fog,fogExp2:!!v&&v.isFogExp2,flatShading:!0===s.flatShading&&!1===s.wireframe,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:d,reversedDepthBuffer:N,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:A,morphTextureStride:C,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:t.shadowMap.enabled&&u.length>0,shadowMapType:t.shadowMap.type,toneMapping:mt,decodeVideoTexture:D&&!0===s.map.isVideoTexture&&oh.getTransfer(s.map.colorSpace)===_u,decodeVideoTextureEmissive:G&&!0===s.emissiveMap.isVideoTexture&&oh.getTransfer(s.emissiveMap.colorSpace)===_u,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:1===s.side,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionClipCullDistance:pt&&!0===s.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(pt&&!0===s.extensions.multiDraw||I)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return gt.vertexUv1s=c.has(1),gt.vertexUv2s=c.has(2),gt.vertexUv3s=c.has(3),c.clear(),gt},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputColorSpace),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.mapUv),t.push(e.alphaMapUv),t.push(e.lightMapUv),t.push(e.aoMapUv),t.push(e.bumpMapUv),t.push(e.normalMapUv),t.push(e.displacementMapUv),t.push(e.emissiveMapUv),t.push(e.metalnessMapUv),t.push(e.roughnessMapUv),t.push(e.anisotropyMapUv),t.push(e.clearcoatMapUv),t.push(e.clearcoatNormalMapUv),t.push(e.clearcoatRoughnessMapUv),t.push(e.iridescenceMapUv),t.push(e.iridescenceThicknessMapUv),t.push(e.sheenColorMapUv),t.push(e.sheenRoughnessMapUv),t.push(e.specularMapUv),t.push(e.specularColorMapUv),t.push(e.specularIntensityMapUv),t.push(e.transmissionMapUv),t.push(e.thicknessMapUv),t.push(e.combine),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.numLightProbes),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(n,e),function(t,e){o.disableAll(),e.instancing&&o.enable(0);e.instancingColor&&o.enable(1);e.instancingMorph&&o.enable(2);e.matcap&&o.enable(3);e.envMap&&o.enable(4);e.normalMapObjectSpace&&o.enable(5);e.normalMapTangentSpace&&o.enable(6);e.clearcoat&&o.enable(7);e.iridescence&&o.enable(8);e.alphaTest&&o.enable(9);e.vertexColors&&o.enable(10);e.vertexAlphas&&o.enable(11);e.vertexUv1s&&o.enable(12);e.vertexUv2s&&o.enable(13);e.vertexUv3s&&o.enable(14);e.vertexTangents&&o.enable(15);e.anisotropy&&o.enable(16);e.alphaHash&&o.enable(17);e.batching&&o.enable(18);e.dispersion&&o.enable(19);e.batchingColor&&o.enable(20);e.gradientMap&&o.enable(21);t.push(o.mask),o.disableAll(),e.fog&&o.enable(0);e.useFog&&o.enable(1);e.flatShading&&o.enable(2);e.logarithmicDepthBuffer&&o.enable(3);e.reversedDepthBuffer&&o.enable(4);e.skinning&&o.enable(5);e.morphTargets&&o.enable(6);e.morphNormals&&o.enable(7);e.morphColors&&o.enable(8);e.premultipliedAlpha&&o.enable(9);e.shadowMapEnabled&&o.enable(10);e.doubleSided&&o.enable(11);e.flipSided&&o.enable(12);e.useDepthPacking&&o.enable(13);e.dithering&&o.enable(14);e.transmission&&o.enable(15);e.sheen&&o.enable(16);e.opaque&&o.enable(17);e.pointsUvs&&o.enable(18);e.decodeVideoTexture&&o.enable(19);e.decodeVideoTextureEmissive&&o.enable(20);e.alphaToCoverage&&o.enable(21);t.push(o.mask)}(n,e),n.push(t.outputColorSpace)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=p[t.type];let n;if(e){const t=yp[e];n=Mf.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let r=h.get(n);return void 0!==r?++r.usedTimes:(r=new Tg(t,n,e,s),u.push(r),h.set(n,r)),r},releaseProgram:function(t){if(0===--t.usedTimes){const e=u.indexOf(t);u[e]=u[u.length-1],u.pop(),h.delete(t.cacheKey),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:u,dispose:function(){l.dispose()}}}function Og(){let t=new WeakMap;return{has:function(e){return t.has(e)},get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function Ig(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Dg(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Ug(){const t=[];let e=0;const n=[],r=[],i=[];function s(n,r,i,s,a,o){let l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:s,renderOrder:n.renderOrder,z:a,group:o},t[e]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=a,l.group=o),e++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){e=0,n.length=0,r.length=0,i.length=0},push:function(t,e,a,o,l,c){const u=s(t,e,a,o,l,c);a.transmission>0?r.push(u):!0===a.transparent?i.push(u):n.push(u)},unshift:function(t,e,a,o,l,c){const u=s(t,e,a,o,l,c);a.transmission>0?r.unshift(u):!0===a.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=e,r=t.length;n<r;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){n.length>1&&n.sort(t||Ig),r.length>1&&r.sort(e||Dg),i.length>1&&i.sort(e||Dg)}}}function Lg(){let t=new WeakMap;return{get:function(e,n){const r=t.get(e);let i;return void 0===r?(i=new Ug,t.set(e,[i])):n>=r.length?(i=new Ug,r.push(i)):i=r[n],i},dispose:function(){t=new WeakMap}}}function Fg(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new $u,color:new Gd};break;case"SpotLight":n={position:new $u,direction:new $u,color:new Gd,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new $u,color:new Gd,distance:0,decay:0};break;case"HemisphereLight":n={direction:new $u,skyColor:new Gd,groundColor:new Gd};break;case"RectAreaLight":n={color:new Gd,position:new $u,halfWidth:new $u,halfHeight:new $u}}return t[e.id]=n,n}}}let kg=0;function Bg(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function zg(t){const e=new Fg,n=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qu};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qu,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let o=0;o<9;o++)r.probe.push(new $u);const i=new $u,s=new Jh,a=new Jh;return{setup:function(i){let s=0,a=0,o=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let l=0,c=0,u=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0;i.sort(Bg);for(let t=0,w=i.length;t<w;t++){const b=i[t],w=b.color,_=b.intensity,x=b.distance;let E=null;if(b.shadow&&b.shadow.map&&(E=b.shadow.map.texture.format===Oc?b.shadow.map.texture:b.shadow.map.depthTexture||b.shadow.map.texture),b.isAmbientLight)s+=w.r*_,a+=w.g*_,o+=w.b*_;else if(b.isLightProbe){for(let t=0;t<9;t++)r.probe[t].addScaledVector(b.sh.coefficients[t],_);y++}else if(b.isDirectionalLight){const t=e.get(b);if(t.color.copy(b.color).multiplyScalar(b.intensity),b.castShadow){const t=b.shadow,e=n.get(b);e.shadowIntensity=t.intensity,e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,r.directionalShadow[l]=e,r.directionalShadowMap[l]=E,r.directionalShadowMatrix[l]=b.shadow.matrix,f++}r.directional[l]=t,l++}else if(b.isSpotLight){const t=e.get(b);t.position.setFromMatrixPosition(b.matrixWorld),t.color.copy(w).multiplyScalar(_),t.distance=x,t.coneCos=Math.cos(b.angle),t.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),t.decay=b.decay,r.spot[u]=t;const i=b.shadow;if(b.map&&(r.spotLightMap[g]=b.map,g++,i.updateMatrices(b),b.castShadow&&v++),r.spotLightMatrix[u]=i.matrix,b.castShadow){const t=n.get(b);t.shadowIntensity=i.intensity,t.shadowBias=i.bias,t.shadowNormalBias=i.normalBias,t.shadowRadius=i.radius,t.shadowMapSize=i.mapSize,r.spotShadow[u]=t,r.spotShadowMap[u]=E,m++}u++}else if(b.isRectAreaLight){const t=e.get(b);t.color.copy(w).multiplyScalar(_),t.halfWidth.set(.5*b.width,0,0),t.halfHeight.set(0,.5*b.height,0),r.rectArea[h]=t,h++}else if(b.isPointLight){const t=e.get(b);if(t.color.copy(b.color).multiplyScalar(b.intensity),t.distance=b.distance,t.decay=b.decay,b.castShadow){const t=b.shadow,e=n.get(b);e.shadowIntensity=t.intensity,e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,e.shadowCameraNear=t.camera.near,e.shadowCameraFar=t.camera.far,r.pointShadow[c]=e,r.pointShadowMap[c]=E,r.pointShadowMatrix[c]=b.shadow.matrix,p++}r.point[c]=t,c++}else if(b.isHemisphereLight){const t=e.get(b);t.skyColor.copy(b.color).multiplyScalar(_),t.groundColor.copy(b.groundColor).multiplyScalar(_),r.hemi[d]=t,d++}}h>0&&(!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=vp.LTC_FLOAT_1,r.rectAreaLTC2=vp.LTC_FLOAT_2):(r.rectAreaLTC1=vp.LTC_HALF_1,r.rectAreaLTC2=vp.LTC_HALF_2)),r.ambient[0]=s,r.ambient[1]=a,r.ambient[2]=o;const b=r.hash;b.directionalLength===l&&b.pointLength===c&&b.spotLength===u&&b.rectAreaLength===h&&b.hemiLength===d&&b.numDirectionalShadows===f&&b.numPointShadows===p&&b.numSpotShadows===m&&b.numSpotMaps===g&&b.numLightProbes===y||(r.directional.length=l,r.spot.length=u,r.rectArea.length=h,r.point.length=c,r.hemi.length=d,r.directionalShadow.length=f,r.directionalShadowMap.length=f,r.pointShadow.length=p,r.pointShadowMap.length=p,r.spotShadow.length=m,r.spotShadowMap.length=m,r.directionalShadowMatrix.length=f,r.pointShadowMatrix.length=p,r.spotLightMatrix.length=m+g-v,r.spotLightMap.length=g,r.numSpotLightShadowsWithMaps=v,r.numLightProbes=y,b.directionalLength=l,b.pointLength=c,b.spotLength=u,b.rectAreaLength=h,b.hemiLength=d,b.numDirectionalShadows=f,b.numPointShadows=p,b.numSpotShadows=m,b.numSpotMaps=g,b.numLightProbes=y,r.version=kg++)},setupView:function(t,e){let n=0,o=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let d=0,f=t.length;d<f;d++){const e=t[d];if(e.isDirectionalLight){const t=r.directional[n];t.direction.setFromMatrixPosition(e.matrixWorld),i.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(i),t.direction.transformDirection(h),n++}else if(e.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(e.matrixWorld),i.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(i),t.direction.transformDirection(h),l++}else if(e.isRectAreaLight){const t=r.rectArea[c];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),a.identity(),s.copy(e.matrixWorld),s.premultiply(h),a.extractRotation(s),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(e.isPointLight){const t=r.point[o];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),o++}else if(e.isHemisphereLight){const t=r.hemi[u];t.direction.setFromMatrixPosition(e.matrixWorld),t.direction.transformDirection(h),u++}}},state:r}}function Hg(t){const e=new zg(t),n=[],r=[];const i={lightsArray:n,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function(t){i.camera=t,n.length=0,r.length=0},state:i,setupLights:function(){e.setup(n)},setupLightsView:function(t){e.setupView(n,t)},pushLight:function(t){n.push(t)},pushShadow:function(t){r.push(t)}}}function Gg(t){let e=new WeakMap;return{get:function(n,r=0){const i=e.get(n);let s;return void 0===i?(s=new Hg(t),e.set(n,[s])):r>=i.length?(s=new Hg(t),i.push(s)):s=i[r],s},dispose:function(){e=new WeakMap}}}const Vg=[new $u(1,0,0),new $u(-1,0,0),new $u(0,1,0),new $u(0,-1,0),new $u(0,0,1),new $u(0,0,-1)],jg=[new $u(0,-1,0),new $u(0,-1,0),new $u(0,0,1),new $u(0,0,-1),new $u(0,-1,0),new $u(0,-1,0)],Wg=new Jh,qg=new $u,Xg=new $u;function Kg(t,e,n){let r=new Jf;const i=new Qu,s=new Qu,a=new yh,o=new cp,l=new up,c={},u=n.maxTextureSize,h={[vl]:1,[yl]:0,[bl]:2},d=new Tf({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Qu},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );\n\tgl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new lf;p.setAttribute("position",new Jd(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new wf(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let v=this.type;function y(n,r){const s=e.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new wh(i.x,i.y,{format:Oc,type:xc})),d.uniforms.shadow_pass.value=n.map.depthTexture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,s,d,m,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,s,f,m,null)}function b(e,n,r,i){let s=null;const a=!0===r.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==a)s=a;else if(s=!0===r.isPointLight?l:o,t.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const t=s.uuid,e=n.uuid;let r=c[t];void 0===r&&(r={},c[t]=r);let i=r[e];void 0===i&&(i=s.clone(),r[e]=i,n.addEventListener("dispose",_)),s=i}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=3===i?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],s.alphaMap=n.alphaMap,s.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===r.isPointLight&&!0===s.isMeshDistanceMaterial){t.properties.get(s).light=r}return s}function w(n,i,s,a,o){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===o)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const r=e.update(n),l=n.material;if(Array.isArray(l)){const e=r.groups;for(let c=0,u=e.length;c<u;c++){const u=e[c],h=l[u.materialIndex];if(h&&h.visible){const e=b(n,h,a,o);n.onBeforeShadow(t,n,i,s,r,e,u),t.renderBufferDirect(s,null,r,e,n,u),n.onAfterShadow(t,n,i,s,r,e,u)}}}else if(l.visible){const e=b(n,l,a,o);n.onBeforeShadow(t,n,i,s,r,e,null),t.renderBufferDirect(s,null,r,e,n,null),n.onAfterShadow(t,n,i,s,r,e,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)w(l[t],i,s,a,o)}function _(t){t.target.removeEventListener("dispose",_);for(const e in c){const n=c[e],r=t.target.uuid;if(r in n){n[r].dispose(),delete n[r]}}}this.render=function(e,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;2===e.type&&(Bu("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),e.type=1);const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),!0===d.buffers.depth.getReversed()?d.buffers.color.setClear(0,0,0,0):d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const f=v!==this.type;f&&n.traverse(function(t){t.material&&(Array.isArray(t.material)?t.material.forEach(t=>t.needsUpdate=!0):t.material.needsUpdate=!0)});for(let p=0,m=e.length;p<m;p++){const l=e[p],c=l.shadow;if(void 0===c){Bu("WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);const h=c.getFrameExtents();if(i.multiply(h),s.copy(c.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/h.x),i.x=s.x*h.x,c.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/h.y),i.y=s.y*h.y,c.mapSize.y=s.y)),null===c.map||!0===f){if(null!==c.map&&(null!==c.map.depthTexture&&(c.map.depthTexture.dispose(),c.map.depthTexture=null),c.map.dispose()),3===this.type){if(l.isPointLight){Bu("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}c.map=new wh(i.x,i.y,{format:Oc,type:xc,minFilter:dc,magFilter:dc,generateMipmaps:!1}),c.map.texture.name=l.name+".shadowMap",c.map.depthTexture=new ip(i.x,i.y,_c),c.map.depthTexture.name=l.name+".shadowMapDepth",c.map.depthTexture.format=Cc,c.map.depthTexture.compareFunction=null,c.map.depthTexture.minFilter=cc,c.map.depthTexture.magFilter=cc}else{l.isPointLight?(c.map=new Lf(i.x),c.map.depthTexture=new sp(i.x,wc)):(c.map=new wh(i.x,i.y),c.map.depthTexture=new ip(i.x,i.y,wc)),c.map.depthTexture.name=l.name+".shadowMap",c.map.depthTexture.format=Cc;const e=t.state.buffers.depth.getReversed();1===this.type?(c.map.depthTexture.compareFunction=e?518:515,c.map.depthTexture.minFilter=dc,c.map.depthTexture.magFilter=dc):(c.map.depthTexture.compareFunction=null,c.map.depthTexture.minFilter=cc,c.map.depthTexture.magFilter=cc)}c.camera.updateProjectionMatrix()}const m=c.map.isWebGLCubeRenderTarget?6:1;for(let e=0;e<m;e++){if(c.map.isWebGLCubeRenderTarget)t.setRenderTarget(c.map,e),t.clear();else{0===e&&(t.setRenderTarget(c.map),t.clear());const n=c.getViewport(e);a.set(s.x*n.x,s.y*n.y,s.x*n.z,s.y*n.w),d.viewport(a)}if(l.isPointLight){const t=c.camera,n=c.matrix,r=l.distance||t.far;r!==t.far&&(t.far=r,t.updateProjectionMatrix()),qg.setFromMatrixPosition(l.matrixWorld),t.position.copy(qg),Xg.copy(t.position),Xg.add(Vg[e]),t.up.copy(jg[e]),t.lookAt(Xg),t.updateMatrixWorld(),n.makeTranslation(-qg.x,-qg.y,-qg.z),Wg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),c._frustum.setFromProjectionMatrix(Wg,t.coordinateSystem,t.reversedDepth)}else c.updateMatrices(l);r=c.getFrustum(),w(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&y(c,o),c.needsUpdate=!1}v=this.type,g.needsUpdate=!1,t.setRenderTarget(l,c,h)}}const Yg={[Bl]:1,[Hl]:6,[Vl]:7,[Gl]:5,[zl]:0,[Wl]:2,[ql]:4,[jl]:3};function Jg(t,e){const n=new function(){let e=!1;const n=new yh;let r=null;const i=new yh(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,s,a,o){!0===o&&(e*=a,r*=a,s*=a),n.set(e,r,s,a),!1===i.equals(n)&&(t.clearColor(e,r,s,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},r=new function(){let n=!1,r=!1,i=null,s=null,a=null;return{setReversed:function(t){if(r!==t){const n=e.get("EXT_clip_control");t?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),r=t;const i=a;a=null,this.setClear(i)}},getReversed:function(){return r},setTest:function(e){e?z(t.DEPTH_TEST):H(t.DEPTH_TEST)},setMask:function(e){i===e||n||(t.depthMask(e),i=e)},setFunc:function(e){if(r&&(e=Yg[e]),s!==e){switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}s=e}},setLocked:function(t){n=t},setClear:function(e){a!==e&&(r&&(e=1-e),t.clearDepth(e),a=e)},reset:function(){n=!1,i=null,s=null,a=null,r=!1}}},i=new function(){let e=!1,n=null,r=null,i=null,s=null,a=null,o=null,l=null,c=null;return{setTest:function(n){e||(n?z(t.STENCIL_TEST):H(t.STENCIL_TEST))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&s===a||(t.stencilFunc(e,n,a),r=e,i=n,s=a)},setOp:function(e,n,r){a===e&&o===n&&l===r||(t.stencilOp(e,n,r),a=e,o=n,l=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,s=null,a=null,o=null,l=null,c=null}}},s=new WeakMap,a=new WeakMap;let o={},l={},c=new WeakMap,u=[],h=null,d=!1,f=null,p=null,m=null,g=null,v=null,y=null,b=null,w=new Gd(0,0,0),_=0,x=!1,E=null,A=null,S=null,M=null,T=null;const R=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let C=!1,P=0;const N=t.getParameter(t.VERSION);-1!==N.indexOf("WebGL")?(P=parseFloat(/^WebGL (\d)/.exec(N)[1]),C=P>=1):-1!==N.indexOf("OpenGL ES")&&(P=parseFloat(/^OpenGL ES (\d)/.exec(N)[1]),C=P>=2);let O=null,I={};const D=t.getParameter(t.SCISSOR_BOX),U=t.getParameter(t.VIEWPORT),L=(new yh).fromArray(D),F=(new yh).fromArray(U);function k(e,n,r,i){const s=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let o=0;o<r;o++)e===t.TEXTURE_3D||e===t.TEXTURE_2D_ARRAY?t.texImage3D(n,0,t.RGBA,1,1,i,0,t.RGBA,t.UNSIGNED_BYTE,s):t.texImage2D(n+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,s);return a}const B={};function z(e){!0!==o[e]&&(t.enable(e),o[e]=!0)}function H(e){!1!==o[e]&&(t.disable(e),o[e]=!1)}B[t.TEXTURE_2D]=k(t.TEXTURE_2D,t.TEXTURE_2D,1),B[t.TEXTURE_CUBE_MAP]=k(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),B[t.TEXTURE_2D_ARRAY]=k(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),B[t.TEXTURE_3D]=k(t.TEXTURE_3D,t.TEXTURE_3D,1,1),n.setClear(0,0,0,1),r.setClear(1),i.setClear(0),z(t.DEPTH_TEST),r.setFunc(3),W(!1),q(1),z(t.CULL_FACE),j(0);const G={[_l]:t.FUNC_ADD,[xl]:t.FUNC_SUBTRACT,[El]:t.FUNC_REVERSE_SUBTRACT};G[103]=t.MIN,G[104]=t.MAX;const V={[Al]:t.ZERO,[Sl]:t.ONE,[Ml]:t.SRC_COLOR,[Rl]:t.SRC_ALPHA,[Dl]:t.SRC_ALPHA_SATURATE,[Ol]:t.DST_COLOR,[Pl]:t.DST_ALPHA,[Tl]:t.ONE_MINUS_SRC_COLOR,[Cl]:t.ONE_MINUS_SRC_ALPHA,[Il]:t.ONE_MINUS_DST_COLOR,[Nl]:t.ONE_MINUS_DST_ALPHA,[Ul]:t.CONSTANT_COLOR,[Ll]:t.ONE_MINUS_CONSTANT_COLOR,[Fl]:t.CONSTANT_ALPHA,[kl]:t.ONE_MINUS_CONSTANT_ALPHA};function j(e,n,r,i,s,a,o,l,c,u){if(0!==e){if(!1===d&&(z(t.BLEND),d=!0),5===e)s=s||n,a=a||r,o=o||i,n===p&&s===v||(t.blendEquationSeparate(G[n],G[s]),p=n,v=s),r===m&&i===g&&a===y&&o===b||(t.blendFuncSeparate(V[r],V[i],V[a],V[o]),m=r,g=i,y=a,b=o),!1!==l.equals(w)&&c===_||(t.blendColor(l.r,l.g,l.b,c),w.copy(l),_=c),f=e,x=!1;else if(e!==f||u!==x){if(p===_l&&v===_l||(t.blendEquation(t.FUNC_ADD),p=_l,v=_l),u)switch(e){case 1:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFunc(t.ONE,t.ONE);break;case 3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case 4:t.blendFuncSeparate(t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ZERO,t.ONE);break;default:zu("WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE,t.ONE,t.ONE);break;case 3:zu("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:zu("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:zu("WebGLState: Invalid blending: ",e)}m=null,g=null,y=null,b=null,w.set(0,0,0),_=0,f=e,x=u}}else!0===d&&(H(t.BLEND),d=!1)}function W(e){E!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),E=e)}function q(e){0!==e?(z(t.CULL_FACE),e!==A&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):H(t.CULL_FACE),A=e}function X(e,n,r){e?(z(t.POLYGON_OFFSET_FILL),M===n&&T===r||(t.polygonOffset(n,r),M=n,T=r)):H(t.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:r,stencil:i},enable:z,disable:H,bindFramebuffer:function(e,n){return l[e]!==n&&(t.bindFramebuffer(e,n),l[e]=n,e===t.DRAW_FRAMEBUFFER&&(l[t.FRAMEBUFFER]=n),e===t.FRAMEBUFFER&&(l[t.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(e,n){let r=u,i=!1;if(e){r=c.get(n),void 0===r&&(r=[],c.set(n,r));const s=e.textures;if(r.length!==s.length||r[0]!==t.COLOR_ATTACHMENT0){for(let e=0,n=s.length;e<n;e++)r[e]=t.COLOR_ATTACHMENT0+e;r.length=s.length,i=!0}}else r[0]!==t.BACK&&(r[0]=t.BACK,i=!0);i&&t.drawBuffers(r)},useProgram:function(e){return h!==e&&(t.useProgram(e),h=e,!0)},setBlending:j,setMaterial:function(e,s){2===e.side?H(t.CULL_FACE):z(t.CULL_FACE);let a=1===e.side;s&&(a=!a),W(a),1===e.blending&&!1===e.transparent?j(0):j(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.blendColor,e.blendAlpha,e.premultipliedAlpha),r.setFunc(e.depthFunc),r.setTest(e.depthTest),r.setMask(e.depthWrite),n.setMask(e.colorWrite);const o=e.stencilWrite;i.setTest(o),o&&(i.setMask(e.stencilWriteMask),i.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),i.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),X(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?z(t.SAMPLE_ALPHA_TO_COVERAGE):H(t.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:W,setCullFace:q,setLineWidth:function(e){e!==S&&(C&&t.lineWidth(e),S=e)},setPolygonOffset:X,setScissorTest:function(e){e?z(t.SCISSOR_TEST):H(t.SCISSOR_TEST)},activeTexture:function(e){void 0===e&&(e=t.TEXTURE0+R-1),O!==e&&(t.activeTexture(e),O=e)},bindTexture:function(e,n,r){void 0===r&&(r=null===O?t.TEXTURE0+R-1:O);let i=I[r];void 0===i&&(i={type:void 0,texture:void 0},I[r]=i),i.type===e&&i.texture===n||(O!==r&&(t.activeTexture(r),O=r),t.bindTexture(e,n||B[e]),i.type=e,i.texture=n)},unbindTexture:function(){const e=I[O];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D(...arguments)}catch(Es){zu("WebGLState:",Es)}},compressedTexImage3D:function(){try{t.compressedTexImage3D(...arguments)}catch(Es){zu("WebGLState:",Es)}},texImage2D:function(){try{t.texImage2D(...arguments)}catch(Es){zu("WebGLState:",Es)}},texImage3D:function(){try{t.texImage3D(...arguments)}catch(Es){zu("WebGLState:",Es)}},updateUBOMapping:function(e,n){let r=a.get(n);void 0===r&&(r=new WeakMap,a.set(n,r));let i=r.get(e);void 0===i&&(i=t.getUniformBlockIndex(n,e.name),r.set(e,i))},uniformBlockBinding:function(e,n){const r=a.get(n).get(e);s.get(n)!==r&&(t.uniformBlockBinding(n,r,e.__bindingPointIndex),s.set(n,r))},texStorage2D:function(){try{t.texStorage2D(...arguments)}catch(Es){zu("WebGLState:",Es)}},texStorage3D:function(){try{t.texStorage3D(...arguments)}catch(Es){zu("WebGLState:",Es)}},texSubImage2D:function(){try{t.texSubImage2D(...arguments)}catch(Es){zu("WebGLState:",Es)}},texSubImage3D:function(){try{t.texSubImage3D(...arguments)}catch(Es){zu("WebGLState:",Es)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D(...arguments)}catch(Es){zu("WebGLState:",Es)}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D(...arguments)}catch(Es){zu("WebGLState:",Es)}},scissor:function(e){!1===L.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),L.copy(e))},viewport:function(e){!1===F.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),F.copy(e))},reset:function(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),r.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),o={},O=null,I={},l={},c=new WeakMap,u=[],h=null,d=!1,f=null,p=null,m=null,g=null,v=null,y=null,b=null,w=new Gd(0,0,0),_=0,x=!1,E=null,A=null,S=null,M=null,T=null,L.set(0,0,t.canvas.width,t.canvas.height),F.set(0,0,t.canvas.width,t.canvas.height),n.reset(),r.reset(),i.reset()}}}function Qg(t,e,n,r,i,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new Qu,u=new WeakMap;let h;const d=new WeakMap;let f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(j){}function p(t,e){return f?new OffscreenCanvas(t,e):Uu("canvas")}function m(t,e,n){let r=1;const i=V(t);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&t instanceof VideoFrame){const n=Math.floor(r*i.width),s=Math.floor(r*i.height);void 0===h&&(h=p(n,s));const a=e?p(n,s):h;a.width=n,a.height=s;return a.getContext("2d").drawImage(t,0,0,n,s),Bu("WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+n+"x"+s+")."),a}return"data"in t&&Bu("WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),t}return t}function g(t){return t.generateMipmaps}function v(e){t.generateMipmap(e)}function y(e){return e.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:e.isWebGL3DRenderTarget?t.TEXTURE_3D:e.isWebGLArrayRenderTarget||e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function b(n,r,i,s,a=!1){if(null!==n){if(void 0!==t[n])return t[n];Bu("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=r;if(r===t.RED&&(i===t.FLOAT&&(o=t.R32F),i===t.HALF_FLOAT&&(o=t.R16F),i===t.UNSIGNED_BYTE&&(o=t.R8)),r===t.RED_INTEGER&&(i===t.UNSIGNED_BYTE&&(o=t.R8UI),i===t.UNSIGNED_SHORT&&(o=t.R16UI),i===t.UNSIGNED_INT&&(o=t.R32UI),i===t.BYTE&&(o=t.R8I),i===t.SHORT&&(o=t.R16I),i===t.INT&&(o=t.R32I)),r===t.RG&&(i===t.FLOAT&&(o=t.RG32F),i===t.HALF_FLOAT&&(o=t.RG16F),i===t.UNSIGNED_BYTE&&(o=t.RG8)),r===t.RG_INTEGER&&(i===t.UNSIGNED_BYTE&&(o=t.RG8UI),i===t.UNSIGNED_SHORT&&(o=t.RG16UI),i===t.UNSIGNED_INT&&(o=t.RG32UI),i===t.BYTE&&(o=t.RG8I),i===t.SHORT&&(o=t.RG16I),i===t.INT&&(o=t.RG32I)),r===t.RGB_INTEGER&&(i===t.UNSIGNED_BYTE&&(o=t.RGB8UI),i===t.UNSIGNED_SHORT&&(o=t.RGB16UI),i===t.UNSIGNED_INT&&(o=t.RGB32UI),i===t.BYTE&&(o=t.RGB8I),i===t.SHORT&&(o=t.RGB16I),i===t.INT&&(o=t.RGB32I)),r===t.RGBA_INTEGER&&(i===t.UNSIGNED_BYTE&&(o=t.RGBA8UI),i===t.UNSIGNED_SHORT&&(o=t.RGBA16UI),i===t.UNSIGNED_INT&&(o=t.RGBA32UI),i===t.BYTE&&(o=t.RGBA8I),i===t.SHORT&&(o=t.RGBA16I),i===t.INT&&(o=t.RGBA32I)),r===t.RGB&&(i===t.UNSIGNED_INT_5_9_9_9_REV&&(o=t.RGB9_E5),i===t.UNSIGNED_INT_10F_11F_11F_REV&&(o=t.R11F_G11F_B10F)),r===t.RGBA){const e=a?wu:oh.getTransfer(s);i===t.FLOAT&&(o=t.RGBA32F),i===t.HALF_FLOAT&&(o=t.RGBA16F),i===t.UNSIGNED_BYTE&&(o=e===_u?t.SRGB8_ALPHA8:t.RGBA8),i===t.UNSIGNED_SHORT_4_4_4_4&&(o=t.RGBA4),i===t.UNSIGNED_SHORT_5_5_5_1&&(o=t.RGB5_A1)}return o!==t.R16F&&o!==t.R32F&&o!==t.RG16F&&o!==t.RG32F&&o!==t.RGBA16F&&o!==t.RGBA32F||e.get("EXT_color_buffer_float"),o}function w(e,n){let r;return e?null===n||n===wc||n===Sc?r=t.DEPTH24_STENCIL8:n===_c?r=t.DEPTH32F_STENCIL8:n===yc&&(r=t.DEPTH24_STENCIL8,Bu("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===wc||n===Sc?r=t.DEPTH_COMPONENT24:n===_c?r=t.DEPTH_COMPONENT32F:n===yc&&(r=t.DEPTH_COMPONENT16),r}function _(t,e){return!0===g(t)||t.isFramebufferTexture&&t.minFilter!==cc&&t.minFilter!==dc?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function x(t){const e=t.target;e.removeEventListener("dispose",x),function(t){const e=r.get(t);if(void 0===e.__webglInit)return;const n=t.source,i=d.get(n);if(i){const r=i[e.__cacheKey];r.usedTimes--,0===r.usedTimes&&A(t),0===Object.keys(i).length&&d.delete(n)}r.remove(t)}(e),e.isVideoTexture&&u.delete(e)}function E(e){const n=e.target;n.removeEventListener("dispose",E),function(e){const n=r.get(e);e.depthTexture&&(e.depthTexture.dispose(),r.remove(e.depthTexture));if(e.isWebGLCubeRenderTarget)for(let r=0;r<6;r++){if(Array.isArray(n.__webglFramebuffer[r]))for(let e=0;e<n.__webglFramebuffer[r].length;e++)t.deleteFramebuffer(n.__webglFramebuffer[r][e]);else t.deleteFramebuffer(n.__webglFramebuffer[r]);n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[r])}else{if(Array.isArray(n.__webglFramebuffer))for(let e=0;e<n.__webglFramebuffer.length;e++)t.deleteFramebuffer(n.__webglFramebuffer[e]);else t.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let e=0;e<n.__webglColorRenderbuffer.length;e++)n.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(n.__webglColorRenderbuffer[e]);n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const i=e.textures;for(let s=0,o=i.length;s<o;s++){const e=r.get(i[s]);e.__webglTexture&&(t.deleteTexture(e.__webglTexture),a.memory.textures--),r.remove(i[s])}r.remove(e)}(n)}function A(e){const n=r.get(e);t.deleteTexture(n.__webglTexture);const i=e.source;delete d.get(i)[n.__cacheKey],a.memory.textures--}let S=0;function M(e,i){const s=r.get(e);if(e.isVideoTexture&&function(t){const e=a.render.frame;u.get(t)!==e&&(u.set(t,e),t.update())}(e),!1===e.isRenderTargetTexture&&!0!==e.isExternalTexture&&e.version>0&&s.__version!==e.version){const t=e.image;if(null===t)Bu("WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==t.complete)return void I(s,e,i);Bu("WebGLRenderer: Texture marked for update but image is incomplete")}}else e.isExternalTexture&&(s.__webglTexture=e.sourceTexture?e.sourceTexture:null);n.bindTexture(t.TEXTURE_2D,s.__webglTexture,t.TEXTURE0+i)}const T={[ac]:t.REPEAT,[oc]:t.CLAMP_TO_EDGE,[lc]:t.MIRRORED_REPEAT},R={[cc]:t.NEAREST,[uc]:t.NEAREST_MIPMAP_NEAREST,[hc]:t.NEAREST_MIPMAP_LINEAR,[dc]:t.LINEAR,[fc]:t.LINEAR_MIPMAP_NEAREST,[pc]:t.LINEAR_MIPMAP_LINEAR},C={[Eu]:t.NEVER,[Pu]:t.ALWAYS,[Au]:t.LESS,[Mu]:t.LEQUAL,[Su]:t.EQUAL,[Cu]:t.GEQUAL,[Tu]:t.GREATER,[Ru]:t.NOTEQUAL};function P(n,s){if(s.type!==_c||!1!==e.has("OES_texture_float_linear")||s.magFilter!==dc&&s.magFilter!==fc&&s.magFilter!==hc&&s.magFilter!==pc&&s.minFilter!==dc&&s.minFilter!==fc&&s.minFilter!==hc&&s.minFilter!==pc||Bu("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(n,t.TEXTURE_WRAP_S,T[s.wrapS]),t.texParameteri(n,t.TEXTURE_WRAP_T,T[s.wrapT]),n!==t.TEXTURE_3D&&n!==t.TEXTURE_2D_ARRAY||t.texParameteri(n,t.TEXTURE_WRAP_R,T[s.wrapR]),t.texParameteri(n,t.TEXTURE_MAG_FILTER,R[s.magFilter]),t.texParameteri(n,t.TEXTURE_MIN_FILTER,R[s.minFilter]),s.compareFunction&&(t.texParameteri(n,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(n,t.TEXTURE_COMPARE_FUNC,C[s.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(s.magFilter===cc)return;if(s.minFilter!==hc&&s.minFilter!==pc)return;if(s.type===_c&&!1===e.has("OES_texture_float_linear"))return;if(s.anisotropy>1||r.get(s).__currentAnisotropy){const a=e.get("EXT_texture_filter_anisotropic");t.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,i.getMaxAnisotropy())),r.get(s).__currentAnisotropy=s.anisotropy}}}function N(e,n){let r=!1;void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",x));const i=n.source;let s=d.get(i);void 0===s&&(s={},d.set(i,s));const o=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.colorSpace),e.join()}(n);if(o!==e.__cacheKey){void 0===s[o]&&(s[o]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,r=!0),s[o].usedTimes++;const i=s[e.__cacheKey];void 0!==i&&(s[e.__cacheKey].usedTimes--,0===i.usedTimes&&A(n)),e.__cacheKey=o,e.__webglTexture=s[o].texture}return r}function O(t,e,n){return Math.floor(Math.floor(t/n)/e)}function I(e,a,o){let l=t.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(l=t.TEXTURE_2D_ARRAY),a.isData3DTexture&&(l=t.TEXTURE_3D);const c=N(e,a),u=a.source;n.bindTexture(l,e.__webglTexture,t.TEXTURE0+o);const h=r.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(t.TEXTURE0+o);const e=oh.getPrimaries(oh.workingColorSpace),r=a.colorSpace===vu?null:oh.getPrimaries(a.colorSpace),d=a.colorSpace===vu||e===r?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let f=m(a.image,!1,i.maxTextureSize);f=G(a,f);const p=s.convert(a.format,a.colorSpace),y=s.convert(a.type);let x,E=b(a.internalFormat,p,y,a.colorSpace,a.isVideoTexture);P(l,a);const A=a.mipmaps,S=!0!==a.isVideoTexture,M=void 0===h.__version||!0===c,T=u.dataReady,R=_(a,f);if(a.isDepthTexture)E=w(a.format===Pc,a.type),M&&(S?n.texStorage2D(t.TEXTURE_2D,1,E,f.width,f.height):n.texImage2D(t.TEXTURE_2D,0,E,f.width,f.height,0,p,y,null));else if(a.isDataTexture)if(A.length>0){S&&M&&n.texStorage2D(t.TEXTURE_2D,R,E,A[0].width,A[0].height);for(let e=0,r=A.length;e<r;e++)x=A[e],S?T&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,x.width,x.height,p,y,x.data):n.texImage2D(t.TEXTURE_2D,e,E,x.width,x.height,0,p,y,x.data);a.generateMipmaps=!1}else S?(M&&n.texStorage2D(t.TEXTURE_2D,R,E,f.width,f.height),T&&function(e,r,i,s){const a=e.updateRanges;if(0===a.length)n.texSubImage2D(t.TEXTURE_2D,0,0,0,r.width,r.height,i,s,r.data);else{a.sort((t,e)=>t.start-e.start);let o=0;for(let t=1;t<a.length;t++){const e=a[o],n=a[t],i=e.start+e.count,s=O(n.start,r.width,4),l=O(e.start,r.width,4);n.start<=i+1&&s===l&&O(n.start+n.count-1,r.width,4)===s?e.count=Math.max(e.count,n.start+n.count-e.start):(++o,a[o]=n)}a.length=o+1;const l=t.getParameter(t.UNPACK_ROW_LENGTH),c=t.getParameter(t.UNPACK_SKIP_PIXELS),u=t.getParameter(t.UNPACK_SKIP_ROWS);t.pixelStorei(t.UNPACK_ROW_LENGTH,r.width);for(let e=0,h=a.length;e<h;e++){const o=a[e],l=Math.floor(o.start/4),c=Math.ceil(o.count/4),u=l%r.width,h=Math.floor(l/r.width),d=c,f=1;t.pixelStorei(t.UNPACK_SKIP_PIXELS,u),t.pixelStorei(t.UNPACK_SKIP_ROWS,h),n.texSubImage2D(t.TEXTURE_2D,0,u,h,d,f,i,s,r.data)}e.clearUpdateRanges(),t.pixelStorei(t.UNPACK_ROW_LENGTH,l),t.pixelStorei(t.UNPACK_SKIP_PIXELS,c),t.pixelStorei(t.UNPACK_SKIP_ROWS,u)}}(a,f,p,y)):n.texImage2D(t.TEXTURE_2D,0,E,f.width,f.height,0,p,y,f.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){S&&M&&n.texStorage3D(t.TEXTURE_2D_ARRAY,R,E,A[0].width,A[0].height,f.depth);for(let e=0,r=A.length;e<r;e++)if(x=A[e],a.format!==Rc)if(null!==p)if(S){if(T)if(a.layerUpdates.size>0){const r=fp(x.width,x.height,a.format,a.type);for(const i of a.layerUpdates){const s=x.data.subarray(i*r/x.data.BYTES_PER_ELEMENT,(i+1)*r/x.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,i,x.width,x.height,1,p,s)}a.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,x.width,x.height,f.depth,p,x.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,e,E,x.width,x.height,f.depth,0,x.data,0,0);else Bu("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else S?T&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,x.width,x.height,f.depth,p,y,x.data):n.texImage3D(t.TEXTURE_2D_ARRAY,e,E,x.width,x.height,f.depth,0,p,y,x.data)}else{S&&M&&n.texStorage2D(t.TEXTURE_2D,R,E,A[0].width,A[0].height);for(let e=0,r=A.length;e<r;e++)x=A[e],a.format!==Rc?null!==p?S?T&&n.compressedTexSubImage2D(t.TEXTURE_2D,e,0,0,x.width,x.height,p,x.data):n.compressedTexImage2D(t.TEXTURE_2D,e,E,x.width,x.height,0,x.data):Bu("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):S?T&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,x.width,x.height,p,y,x.data):n.texImage2D(t.TEXTURE_2D,e,E,x.width,x.height,0,p,y,x.data)}else if(a.isDataArrayTexture)if(S){if(M&&n.texStorage3D(t.TEXTURE_2D_ARRAY,R,E,f.width,f.height,f.depth),T)if(a.layerUpdates.size>0){const e=fp(f.width,f.height,a.format,a.type);for(const r of a.layerUpdates){const i=f.data.subarray(r*e/f.data.BYTES_PER_ELEMENT,(r+1)*e/f.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,r,f.width,f.height,1,p,y,i)}a.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,E,f.width,f.height,f.depth,0,p,y,f.data);else if(a.isData3DTexture)S?(M&&n.texStorage3D(t.TEXTURE_3D,R,E,f.width,f.height,f.depth),T&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)):n.texImage3D(t.TEXTURE_3D,0,E,f.width,f.height,f.depth,0,p,y,f.data);else if(a.isFramebufferTexture){if(M)if(S)n.texStorage2D(t.TEXTURE_2D,R,E,f.width,f.height);else{let e=f.width,r=f.height;for(let i=0;i<R;i++)n.texImage2D(t.TEXTURE_2D,i,E,e,r,0,p,y,null),e>>=1,r>>=1}}else if(A.length>0){if(S&&M){const e=V(A[0]);n.texStorage2D(t.TEXTURE_2D,R,E,e.width,e.height)}for(let e=0,r=A.length;e<r;e++)x=A[e],S?T&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,p,y,x):n.texImage2D(t.TEXTURE_2D,e,E,p,y,x);a.generateMipmaps=!1}else if(S){if(M){const e=V(f);n.texStorage2D(t.TEXTURE_2D,R,E,e.width,e.height)}T&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,p,y,f)}else n.texImage2D(t.TEXTURE_2D,0,E,p,y,f);g(a)&&v(l),h.__version=u.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}function D(e,i,a,l,c,u){const h=s.convert(a.format,a.colorSpace),d=s.convert(a.type),f=b(a.internalFormat,h,d,a.colorSpace),p=r.get(i),m=r.get(a);if(m.__renderTarget=i,!p.__hasExternalTextures){const e=Math.max(1,i.width>>u),r=Math.max(1,i.height>>u);c===t.TEXTURE_3D||c===t.TEXTURE_2D_ARRAY?n.texImage3D(c,u,f,e,r,i.depth,0,h,d,null):n.texImage2D(c,u,f,e,r,0,h,d,null)}n.bindFramebuffer(t.FRAMEBUFFER,e),H(i)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,l,c,m.__webglTexture,0,z(i)):(c===t.TEXTURE_2D||c>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,l,c,m.__webglTexture,u),n.bindFramebuffer(t.FRAMEBUFFER,null)}function U(e,n,r){if(t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer){const i=n.depthTexture,s=i&&i.isDepthTexture?i.type:null,a=w(n.stencilBuffer,s),l=n.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;H(n)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,z(n),a,n.width,n.height):r?t.renderbufferStorageMultisample(t.RENDERBUFFER,z(n),a,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,a,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,l,t.RENDERBUFFER,e)}else{const e=n.textures;for(let i=0;i<e.length;i++){const a=e[i],l=s.convert(a.format,a.colorSpace),c=s.convert(a.type),u=b(a.internalFormat,l,c,a.colorSpace);H(n)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,z(n),u,n.width,n.height):r?t.renderbufferStorageMultisample(t.RENDERBUFFER,z(n),u,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,u,n.width,n.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function L(e,i,a){const l=!0===i.isWebGLCubeRenderTarget;if(n.bindFramebuffer(t.FRAMEBUFFER,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const c=r.get(i.depthTexture);if(c.__renderTarget=i,c.__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),l){if(void 0===c.__webglInit&&(c.__webglInit=!0,i.depthTexture.addEventListener("dispose",x)),void 0===c.__webglTexture){c.__webglTexture=t.createTexture(),n.bindTexture(t.TEXTURE_CUBE_MAP,c.__webglTexture),P(t.TEXTURE_CUBE_MAP,i.depthTexture);const e=s.convert(i.depthTexture.format),r=s.convert(i.depthTexture.type);let a;i.depthTexture.format===Cc?a=t.DEPTH_COMPONENT24:i.depthTexture.format===Pc&&(a=t.DEPTH24_STENCIL8);for(let n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,a,i.width,i.height,0,e,r,null)}}else M(i.depthTexture,0);const u=c.__webglTexture,h=z(i),d=l?t.TEXTURE_CUBE_MAP_POSITIVE_X+a:t.TEXTURE_2D,f=i.depthTexture.format===Pc?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(i.depthTexture.format===Cc)H(i)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,f,d,u,0,h):t.framebufferTexture2D(t.FRAMEBUFFER,f,d,u,0);else{if(i.depthTexture.format!==Pc)throw new Error("Unknown depthTexture format");H(i)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,f,d,u,0,h):t.framebufferTexture2D(t.FRAMEBUFFER,f,d,u,0)}}function F(e){const i=r.get(e),s=!0===e.isWebGLCubeRenderTarget;if(i.__boundDepthTexture!==e.depthTexture){const t=e.depthTexture;if(i.__depthDisposeCallback&&i.__depthDisposeCallback(),t){const e=()=>{delete i.__boundDepthTexture,delete i.__depthDisposeCallback,t.removeEventListener("dispose",e)};t.addEventListener("dispose",e),i.__depthDisposeCallback=e}i.__boundDepthTexture=t}if(e.depthTexture&&!i.__autoAllocateDepthBuffer)if(s)for(let t=0;t<6;t++)L(i.__webglFramebuffer[t],e,t);else{const t=e.texture.mipmaps;t&&t.length>0?L(i.__webglFramebuffer[0],e,0):L(i.__webglFramebuffer,e,0)}else if(s){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)if(n.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[r]),void 0===i.__webglDepthbuffer[r])i.__webglDepthbuffer[r]=t.createRenderbuffer(),U(i.__webglDepthbuffer[r],e,!1);else{const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,s=i.__webglDepthbuffer[r];t.bindRenderbuffer(t.RENDERBUFFER,s),t.framebufferRenderbuffer(t.FRAMEBUFFER,n,t.RENDERBUFFER,s)}}else{const r=e.texture.mipmaps;if(r&&r.length>0?n.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),void 0===i.__webglDepthbuffer)i.__webglDepthbuffer=t.createRenderbuffer(),U(i.__webglDepthbuffer,e,!1);else{const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,r=i.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,n,t.RENDERBUFFER,r)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}const k=[],B=[];function z(t){return Math.min(i.maxSamples,t.samples)}function H(t){const n=r.get(t);return t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function G(t,e){const n=t.colorSpace,r=t.format,i=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||n!==bu&&n!==vu&&(oh.getTransfer(n)===_u?r===Rc&&i===mc||Bu("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):zu("WebGLTextures: Unsupported texture color space:",n)),e}function V(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?(c.width=t.naturalWidth||t.width,c.height=t.naturalHeight||t.height):"undefined"!=typeof VideoFrame&&t instanceof VideoFrame?(c.width=t.displayWidth,c.height=t.displayHeight):(c.width=t.width,c.height=t.height),c}this.allocateTextureUnit=function(){const t=S;return t>=i.maxTextures&&Bu("WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+i.maxTextures),S+=1,t},this.resetTextureUnits=function(){S=0},this.setTexture2D=M,this.setTexture2DArray=function(e,i){const s=r.get(e);!1===e.isRenderTargetTexture&&e.version>0&&s.__version!==e.version?I(s,e,i):(e.isExternalTexture&&(s.__webglTexture=e.sourceTexture?e.sourceTexture:null),n.bindTexture(t.TEXTURE_2D_ARRAY,s.__webglTexture,t.TEXTURE0+i))},this.setTexture3D=function(e,i){const s=r.get(e);!1===e.isRenderTargetTexture&&e.version>0&&s.__version!==e.version?I(s,e,i):n.bindTexture(t.TEXTURE_3D,s.__webglTexture,t.TEXTURE0+i)},this.setTextureCube=function(e,a){const o=r.get(e);!0!==e.isCubeDepthTexture&&e.version>0&&o.__version!==e.version?function(e,a,o){if(6!==a.image.length)return;const l=N(e,a),c=a.source;n.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture,t.TEXTURE0+o);const u=r.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(t.TEXTURE0+o);const e=oh.getPrimaries(oh.workingColorSpace),r=a.colorSpace===vu?null:oh.getPrimaries(a.colorSpace),h=a.colorSpace===vu||e===r?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);const d=a.isCompressedTexture||a.image[0].isCompressedTexture,f=a.image[0]&&a.image[0].isDataTexture,p=[];for(let t=0;t<6;t++)p[t]=d||f?f?a.image[t].image:a.image[t]:m(a.image[t],!0,i.maxCubemapSize),p[t]=G(a,p[t]);const y=p[0],w=s.convert(a.format,a.colorSpace),x=s.convert(a.type),E=b(a.internalFormat,w,x,a.colorSpace),A=!0!==a.isVideoTexture,S=void 0===u.__version||!0===l,M=c.dataReady;let T,R=_(a,y);if(P(t.TEXTURE_CUBE_MAP,a),d){A&&S&&n.texStorage2D(t.TEXTURE_CUBE_MAP,R,E,y.width,y.height);for(let e=0;e<6;e++){T=p[e].mipmaps;for(let r=0;r<T.length;r++){const i=T[r];a.format!==Rc?null!==w?A?M&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,0,0,i.width,i.height,w,i.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,E,i.width,i.height,0,i.data):Bu("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):A?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,0,0,i.width,i.height,w,x,i.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,E,i.width,i.height,0,w,x,i.data)}}}else{if(T=a.mipmaps,A&&S){T.length>0&&R++;const e=V(p[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,R,E,e.width,e.height)}for(let e=0;e<6;e++)if(f){A?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,p[e].width,p[e].height,w,x,p[e].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,E,p[e].width,p[e].height,0,w,x,p[e].data);for(let r=0;r<T.length;r++){const i=T[r].image[e].image;A?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,0,0,i.width,i.height,w,x,i.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,E,i.width,i.height,0,w,x,i.data)}}else{A?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,w,x,p[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,E,w,x,p[e]);for(let r=0;r<T.length;r++){const i=T[r];A?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,0,0,w,x,i.image[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,E,w,x,i.image[e])}}}g(a)&&v(t.TEXTURE_CUBE_MAP),u.__version=c.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}(o,e,a):n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture,t.TEXTURE0+a)},this.rebindTextures=function(e,n,i){const s=r.get(e);void 0!==n&&D(s.__webglFramebuffer,e,e.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),void 0!==i&&F(e)},this.setupRenderTarget=function(e){const i=e.texture,o=r.get(e),l=r.get(i);e.addEventListener("dispose",E);const c=e.textures,u=!0===e.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===l.__webglTexture&&(l.__webglTexture=t.createTexture()),l.__version=i.version,a.memory.textures++),u){o.__webglFramebuffer=[];for(let e=0;e<6;e++)if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer[e]=[];for(let n=0;n<i.mipmaps.length;n++)o.__webglFramebuffer[e][n]=t.createFramebuffer()}else o.__webglFramebuffer[e]=t.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer=[];for(let e=0;e<i.mipmaps.length;e++)o.__webglFramebuffer[e]=t.createFramebuffer()}else o.__webglFramebuffer=t.createFramebuffer();if(h)for(let e=0,n=c.length;e<n;e++){const n=r.get(c[e]);void 0===n.__webglTexture&&(n.__webglTexture=t.createTexture(),a.memory.textures++)}if(e.samples>0&&!1===H(e)){o.__webglMultisampledFramebuffer=t.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];o.__webglColorRenderbuffer[n]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const i=s.convert(r.format,r.colorSpace),a=s.convert(r.type),l=b(r.internalFormat,i,a,r.colorSpace,!0===e.isXRRenderTarget),u=z(e);t.renderbufferStorageMultisample(t.RENDERBUFFER,u,l,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.RENDERBUFFER,o.__webglColorRenderbuffer[n])}t.bindRenderbuffer(t.RENDERBUFFER,null),e.depthBuffer&&(o.__webglDepthRenderbuffer=t.createRenderbuffer(),U(o.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(u){n.bindTexture(t.TEXTURE_CUBE_MAP,l.__webglTexture),P(t.TEXTURE_CUBE_MAP,i);for(let n=0;n<6;n++)if(i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)D(o.__webglFramebuffer[n][r],e,i,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,r);else D(o.__webglFramebuffer[n],e,i,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);g(i)&&v(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let i=0,s=c.length;i<s;i++){const s=c[i],a=r.get(s);let l=t.TEXTURE_2D;(e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(l=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(l,a.__webglTexture),P(l,s),D(o.__webglFramebuffer,e,s,t.COLOR_ATTACHMENT0+i,l,0),g(s)&&v(l)}n.unbindTexture()}else{let r=t.TEXTURE_2D;if((e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(r=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(r,l.__webglTexture),P(r,i),i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)D(o.__webglFramebuffer[n],e,i,t.COLOR_ATTACHMENT0,r,n);else D(o.__webglFramebuffer,e,i,t.COLOR_ATTACHMENT0,r,0);g(i)&&v(r),n.unbindTexture()}e.depthBuffer&&F(e)},this.updateRenderTargetMipmap=function(t){const e=t.textures;for(let i=0,s=e.length;i<s;i++){const s=e[i];if(g(s)){const e=y(t),i=r.get(s).__webglTexture;n.bindTexture(e,i),v(e),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(e.samples>0)if(!1===H(e)){const i=e.textures,s=e.width,a=e.height;let o=t.COLOR_BUFFER_BIT;const c=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,u=r.get(e),h=i.length>1;if(h)for(let e=0;e<i.length;e++)n.bindFramebuffer(t.FRAMEBUFFER,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,u.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const d=e.texture.mipmaps;d&&d.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<i.length;n++){if(e.resolveDepthBuffer&&(e.depthBuffer&&(o|=t.DEPTH_BUFFER_BIT),e.stencilBuffer&&e.resolveStencilBuffer&&(o|=t.STENCIL_BUFFER_BIT)),h){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const e=r.get(i[n]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}t.blitFramebuffer(0,0,s,a,0,0,s,a,o,t.NEAREST),!0===l&&(k.length=0,B.length=0,k.push(t.COLOR_ATTACHMENT0+n),e.depthBuffer&&!1===e.resolveDepthBuffer&&(k.push(c),B.push(c),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,B)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,k))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),h)for(let e=0;e<i.length;e++){n.bindFramebuffer(t.FRAMEBUFFER,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,u.__webglColorRenderbuffer[e]);const s=r.get(i[e]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,u.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,s,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(e.depthBuffer&&!1===e.resolveDepthBuffer&&l){const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=D,this.useMultisampledRTT=H,this.isReversedDepthBuffer=function(){return n.buffers.depth.getReversed()}}function Zg(t,e){return{convert:function(n,r=""){let i;const s=oh.getTransfer(r);if(n===mc)return t.UNSIGNED_BYTE;if(n===Ec)return t.UNSIGNED_SHORT_4_4_4_4;if(n===Ac)return t.UNSIGNED_SHORT_5_5_5_1;if(n===Mc)return t.UNSIGNED_INT_5_9_9_9_REV;if(n===Tc)return t.UNSIGNED_INT_10F_11F_11F_REV;if(n===gc)return t.BYTE;if(n===vc)return t.SHORT;if(n===yc)return t.UNSIGNED_SHORT;if(n===bc)return t.INT;if(n===wc)return t.UNSIGNED_INT;if(n===_c)return t.FLOAT;if(n===xc)return t.HALF_FLOAT;if(1021===n)return t.ALPHA;if(1022===n)return t.RGB;if(n===Rc)return t.RGBA;if(n===Cc)return t.DEPTH_COMPONENT;if(n===Pc)return t.DEPTH_STENCIL;if(1028===n)return t.RED;if(n===Nc)return t.RED_INTEGER;if(n===Oc)return t.RG;if(n===Ic)return t.RG_INTEGER;if(n===Dc)return t.RGBA_INTEGER;if(n===Uc||n===Lc||n===Fc||n===kc)if(s===_u){if(i=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===Uc)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Lc)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Fc)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===kc)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=e.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===Uc)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Lc)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Fc)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===kc)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Bc||n===zc||n===Hc||n===Gc){if(i=e.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===Bc)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===zc)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Hc)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Gc)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Vc||n===jc||n===Wc||n===qc||n===Xc||n===Kc||n===Yc){if(i=e.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===Vc||n===jc)return s===_u?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Wc)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC;if(n===qc)return i.COMPRESSED_R11_EAC;if(n===Xc)return i.COMPRESSED_SIGNED_R11_EAC;if(n===Kc)return i.COMPRESSED_RG11_EAC;if(n===Yc)return i.COMPRESSED_SIGNED_RG11_EAC}if(n===Jc||n===Qc||n===Zc||n===$c||n===tu||n===eu||n===nu||n===ru||n===iu||n===su||n===au||n===ou||n===lu||n===cu){if(i=e.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===Jc)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Qc)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Zc)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===$c)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===tu)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===eu)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===nu)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===ru)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===iu)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===su)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===au)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===ou)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===lu)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===cu)return s===_u?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===uu||n===hu||n===du){if(i=e.get("EXT_texture_compression_bptc"),null===i)return null;if(n===uu)return s===_u?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===hu)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===du)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===fu||n===pu||n===mu||n===gu){if(i=e.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===fu)return i.COMPRESSED_RED_RGTC1_EXT;if(n===pu)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===mu)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===gu)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===Sc?t.UNSIGNED_INT_24_8:void 0!==t[n]?t[n]:null}}}class $g{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,e){if(null===this.texture){const n=new ap(t.texture);t.depthNear===e.depthNear&&t.depthFar===e.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=n}}getMesh(t){if(null!==this.texture&&null===this.mesh){const e=t.cameras[0].viewport,n=new Tf({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:e.z},depthHeight:{value:e.w}}});this.mesh=new wf(new op(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class tv extends Gu{constructor(t,e){super();const n=this;let r=null,i=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,h=null,d=null,f=null;const p="undefined"!=typeof XRWebGLBinding,m=new $g,g={},v=e.getContextAttributes();let y=null,b=null;const w=[],_=[],x=new Qu;let E=null;const A=new Of;A.viewport=new yh;const S=new Of;S.viewport=new yh;const M=[A,S],T=new dp;let R=null,C=null;function P(t){const e=_.indexOf(t.inputSource);if(-1===e)return;const n=w[e];void 0!==n&&(n.update(t.inputSource,t.frame,l||s),n.dispatchEvent({type:t.type,data:t.inputSource}))}function N(){r.removeEventListener("select",P),r.removeEventListener("selectstart",P),r.removeEventListener("selectend",P),r.removeEventListener("squeeze",P),r.removeEventListener("squeezestart",P),r.removeEventListener("squeezeend",P),r.removeEventListener("end",N),r.removeEventListener("inputsourceschange",O);for(let t=0;t<w.length;t++){const e=_[t];null!==e&&(_[t]=null,w[t].disconnect(e))}R=null,C=null,m.reset();for(const t in g)delete g[t];t.setRenderTarget(y),d=null,h=null,u=null,r=null,b=null,F.stop(),n.isPresenting=!1,t.setPixelRatio(E),t.setSize(x.width,x.height,!1),n.dispatchEvent({type:"sessionend"})}function O(t){for(let e=0;e<t.removed.length;e++){const n=t.removed[e],r=_.indexOf(n);r>=0&&(_[r]=null,w[r].disconnect(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e];let r=_.indexOf(n);if(-1===r){for(let t=0;t<w.length;t++){if(t>=_.length){_.push(n),r=t;break}if(null===_[t]){_[t]=n,r=t;break}}if(-1===r)break}const i=w[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=w[t];return void 0===e&&(e=new Bf,w[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=w[t];return void 0===e&&(e=new Bf,w[t]=e),e.getGripSpace()},this.getHand=function(t){let e=w[t];return void 0===e&&(e=new Bf,w[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){i=t,!0===n.isPresenting&&Bu("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===n.isPresenting&&Bu("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(t){l=t},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return null===u&&p&&(u=new XRWebGLBinding(r,e)),u},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(c){if(r=c,null!==r){y=t.getRenderTarget(),r.addEventListener("select",P),r.addEventListener("selectstart",P),r.addEventListener("selectend",P),r.addEventListener("squeeze",P),r.addEventListener("squeezestart",P),r.addEventListener("squeezeend",P),r.addEventListener("end",N),r.addEventListener("inputsourceschange",O),!0!==v.xrCompatible&&await e.makeXRCompatible(),E=t.getPixelRatio(),t.getSize(x);if(p&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,s=null,a=null;v.depth&&(a=v.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,n=v.stencil?Pc:Cc,s=v.stencil?Sc:wc);const o={colorFormat:e.RGBA8,depthFormat:a,scaleFactor:i};u=this.getBinding(),h=u.createProjectionLayer(o),r.updateRenderState({layers:[h]}),t.setPixelRatio(1),t.setSize(h.textureWidth,h.textureHeight,!1),b=new wh(h.textureWidth,h.textureHeight,{format:Rc,type:mc,depthTexture:new ip(h.textureWidth,h.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:v.stencil,colorSpace:t.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}else{const n={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(r,e,n),r.updateRenderState({baseLayer:d}),t.setPixelRatio(1),t.setSize(d.framebufferWidth,d.framebufferHeight,!1),b=new wh(d.framebufferWidth,d.framebufferHeight,{format:Rc,type:mc,colorSpace:t.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}b.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await r.requestReferenceSpace(a),F.setContext(r),F.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};const I=new $u,D=new $u;function U(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===r)return;let e=t.near,n=t.far;null!==m.texture&&(m.depthNear>0&&(e=m.depthNear),m.depthFar>0&&(n=m.depthFar)),T.near=S.near=A.near=e,T.far=S.far=A.far=n,R===T.near&&C===T.far||(r.updateRenderState({depthNear:T.near,depthFar:T.far}),R=T.near,C=T.far),T.layers.mask=6|t.layers.mask,A.layers.mask=3&T.layers.mask,S.layers.mask=5&T.layers.mask;const i=t.parent,s=T.cameras;U(T,i);for(let r=0;r<s.length;r++)U(s[r],i);2===s.length?function(t,e,n){I.setFromMatrixPosition(e.matrixWorld),D.setFromMatrixPosition(n.matrixWorld);const r=I.distanceTo(D),i=e.projectionMatrix.elements,s=n.projectionMatrix.elements,a=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(s[8]+1)/s[0],d=a*u,f=a*h,p=r/(-u+h),m=p*-u;if(e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert(),-1===i[10])t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const e=a+p,n=o+p,i=d-m,s=f+(r-m),u=l*o/n*e,h=c*o/n*e;t.projectionMatrix.makePerspective(i,s,u,h,e,n),t.projectionMatrixInverse.copy(t.projectionMatrix).invert()}}(T,A,S):T.projectionMatrix.copy(A.projectionMatrix),function(t,e,n){null===n?t.matrix.copy(e.matrixWorld):(t.matrix.copy(n.matrixWorld),t.matrix.invert(),t.matrix.multiply(e.matrixWorld));t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*Wu*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)}(t,T,i)},this.getCamera=function(){return T},this.getFoveation=function(){if(null!==h||null!==d)return o},this.setFoveation=function(t){o=t,null!==h&&(h.fixedFoveation=t),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=t)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(T)},this.getCameraTexture=function(t){return g[t]};let L=null;const F=new pp;F.setAnimationLoop(function(e,i){if(c=i.getViewerPose(l||s),f=i,null!==c){const e=c.views;null!==d&&(t.setRenderTargetFramebuffer(b,d.framebuffer),t.setRenderTarget(b));let i=!1;e.length!==T.cameras.length&&(T.cameras.length=0,i=!0);for(let n=0;n<e.length;n++){const r=e[n];let s=null;if(null!==d)s=d.getViewport(r);else{const e=u.getViewSubImage(h,r);s=e.viewport,0===n&&(t.setRenderTargetTextures(b,e.colorTexture,e.depthStencilTexture),t.setRenderTarget(b))}let a=M[n];void 0===a&&(a=new Of,a.layers.enable(n),a.viewport=new yh,M[n]=a),a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(r.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(s.x,s.y,s.width,s.height),0===n&&(T.matrix.copy(a.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),!0===i&&T.cameras.push(a)}const s=r.enabledFeatures;if(s&&s.includes("depth-sensing")&&"gpu-optimized"==r.depthUsage&&p){u=n.getBinding();const t=u.getDepthInformation(e[0]);t&&t.isValid&&t.texture&&m.init(t,r.renderState)}if(s&&s.includes("camera-access")&&p){t.state.unbindTexture(),u=n.getBinding();for(let t=0;t<e.length;t++){const n=e[t].camera;if(n){let t=g[n];t||(t=new ap,g[n]=t);const e=u.getCameraImage(n);t.sourceTexture=e}}}}for(let t=0;t<w.length;t++){const e=_[t],n=w[t];null!==e&&void 0!==n&&n.update(e,i,l||s)}L&&L(e,i),i.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:i}),f=null}),this.setAnimationLoop=function(t){L=t},this.dispose=function(){}}}const ev=new ad,nv=new Jh;function rv(t,e){function n(t,e){!0===t.matrixAutoUpdate&&t.updateMatrix(),e.value.copy(t.matrix)}function r(t,r){t.opacity.value=r.opacity,r.color&&t.diffuse.value.copy(r.color),r.emissive&&t.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(t.map.value=r.map,n(r.map,t.mapTransform)),r.alphaMap&&(t.alphaMap.value=r.alphaMap,n(r.alphaMap,t.alphaMapTransform)),r.bumpMap&&(t.bumpMap.value=r.bumpMap,n(r.bumpMap,t.bumpMapTransform),t.bumpScale.value=r.bumpScale,1===r.side&&(t.bumpScale.value*=-1)),r.normalMap&&(t.normalMap.value=r.normalMap,n(r.normalMap,t.normalMapTransform),t.normalScale.value.copy(r.normalScale),1===r.side&&t.normalScale.value.negate()),r.displacementMap&&(t.displacementMap.value=r.displacementMap,n(r.displacementMap,t.displacementMapTransform),t.displacementScale.value=r.displacementScale,t.displacementBias.value=r.displacementBias),r.emissiveMap&&(t.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,t.emissiveMapTransform)),r.specularMap&&(t.specularMap.value=r.specularMap,n(r.specularMap,t.specularMapTransform)),r.alphaTest>0&&(t.alphaTest.value=r.alphaTest);const i=e.get(r),s=i.envMap,a=i.envMapRotation;s&&(t.envMap.value=s,ev.copy(a),ev.x*=-1,ev.y*=-1,ev.z*=-1,s.isCubeTexture&&!1===s.isRenderTargetTexture&&(ev.y*=-1,ev.z*=-1),t.envMapRotation.value.setFromMatrix4(nv.makeRotationFromEuler(ev)),t.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,t.reflectivity.value=r.reflectivity,t.ior.value=r.ior,t.refractionRatio.value=r.refractionRatio),r.lightMap&&(t.lightMap.value=r.lightMap,t.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,t.lightMapTransform)),r.aoMap&&(t.aoMap.value=r.aoMap,t.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,t.aoMapTransform))}return{refreshFogUniforms:function(e,n){n.color.getRGB(e.fogColor.value,Sf(t)),n.isFog?(e.fogNear.value=n.near,e.fogFar.value=n.far):n.isFogExp2&&(e.fogDensity.value=n.density)},refreshMaterialUniforms:function(t,i,s,a,o){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(t,i):i.isMeshToonMaterial?(r(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,i)):i.isMeshPhongMaterial?(r(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,i)):i.isMeshStandardMaterial?(r(t,i),function(t,e){t.metalness.value=e.metalness,e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap,n(e.metalnessMap,t.metalnessMapTransform));t.roughness.value=e.roughness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap,n(e.roughnessMap,t.roughnessMapTransform));e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}(t,i),i.isMeshPhysicalMaterial&&function(t,e,r){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap,n(e.sheenColorMap,t.sheenColorMapTransform)),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap,n(e.sheenRoughnessMap,t.sheenRoughnessMapTransform)));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap,n(e.clearcoatMap,t.clearcoatMapTransform)),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap,n(e.clearcoatRoughnessMap,t.clearcoatRoughnessMapTransform)),e.clearcoatNormalMap&&(t.clearcoatNormalMap.value=e.clearcoatNormalMap,n(e.clearcoatNormalMap,t.clearcoatNormalMapTransform),t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),1===e.side&&t.clearcoatNormalScale.value.negate()));e.dispersion>0&&(t.dispersion.value=e.dispersion);e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap,n(e.iridescenceMap,t.iridescenceMapTransform)),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap,n(e.iridescenceThicknessMap,t.iridescenceThicknessMapTransform)));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=r.texture,t.transmissionSamplerSize.value.set(r.width,r.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap,n(e.transmissionMap,t.transmissionMapTransform)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap,n(e.thicknessMap,t.thicknessMapTransform)),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));e.anisotropy>0&&(t.anisotropyVector.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation)),e.anisotropyMap&&(t.anisotropyMap.value=e.anisotropyMap,n(e.anisotropyMap,t.anisotropyMapTransform)));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap,n(e.specularColorMap,t.specularColorMapTransform));e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap,n(e.specularIntensityMap,t.specularIntensityMapTransform))}(t,i,o)):i.isMeshMatcapMaterial?(r(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,i)):i.isMeshDepthMaterial?r(t,i):i.isMeshDistanceMaterial?(r(t,i),function(t,n){const r=e.get(n).light;t.referencePosition.value.setFromMatrixPosition(r.matrixWorld),t.nearDistance.value=r.shadow.camera.near,t.farDistance.value=r.shadow.camera.far}(t,i)):i.isMeshNormalMaterial?r(t,i):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform))}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,r,i){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*r,t.scale.value=.5*i,e.map&&(t.map.value=e.map,n(e.map,t.uvTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,i,s,a):i.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function iv(t,e,n,r){let i={},s={},a=[];const o=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(t,e,n,r){const i=t.value,s=e+"_"+n;if(void 0===r[s])return r[s]="number"==typeof i||"boolean"==typeof i?i:i.clone(),!0;{const t=r[s];if("number"==typeof i||"boolean"==typeof i){if(t!==i)return r[s]=i,!0}else if(!1===t.equals(i))return t.copy(i),!0}return!1}function c(t){const e={boundary:0,storage:0};return"number"==typeof t||"boolean"==typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture?Bu("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Bu("WebGLRenderer: Unsupported uniform value type.",t),e}function u(e){const n=e.target;n.removeEventListener("dispose",u);const r=a.indexOf(n.__bindingPointIndex);a.splice(r,1),t.deleteBuffer(i[n.id]),delete i[n.id],delete s[n.id]}return{bind:function(t,e){const n=e.program;r.uniformBlockBinding(t,n)},update:function(n,h){let d=i[n.id];void 0===d&&(!function(t){const e=t.uniforms;let n=0;const r=16;for(let s=0,a=e.length;s<a;s++){const t=Array.isArray(e[s])?e[s]:[e[s]];for(let e=0,i=t.length;e<i;e++){const i=t[e],s=Array.isArray(i.value)?i.value:[i.value];for(let t=0,e=s.length;t<e;t++){const e=c(s[t]),a=n%r,o=a%e.boundary,l=a+o;n+=o,0!==l&&r-l<e.storage&&(n+=r-l),i.__data=new Float32Array(e.storage/Float32Array.BYTES_PER_ELEMENT),i.__offset=n,n+=e.storage}}}const i=n%r;i>0&&(n+=r-i);t.__size=n,t.__cache={}}(n),d=function(e){const n=function(){for(let t=0;t<o;t++)if(-1===a.indexOf(t))return a.push(t),t;return zu("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();e.__bindingPointIndex=n;const r=t.createBuffer(),i=e.__size,s=e.usage;return t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,i,s),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",u));const f=h.program;r.updateUBOMapping(n,f);const p=e.render.frame;s[n.id]!==p&&(!function(e){const n=i[e.id],r=e.uniforms,s=e.__cache;t.bindBuffer(t.UNIFORM_BUFFER,n);for(let i=0,a=r.length;i<a;i++){const e=Array.isArray(r[i])?r[i]:[r[i]];for(let n=0,r=e.length;n<r;n++){const r=e[n];if(!0===l(r,i,n,s)){const e=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let i=0;for(let s=0;s<n.length;s++){const a=n[s],o=c(a);"number"==typeof a||"boolean"==typeof a?(r.__data[0]=a,t.bufferSubData(t.UNIFORM_BUFFER,e+i,r.__data)):a.isMatrix3?(r.__data[0]=a.elements[0],r.__data[1]=a.elements[1],r.__data[2]=a.elements[2],r.__data[3]=0,r.__data[4]=a.elements[3],r.__data[5]=a.elements[4],r.__data[6]=a.elements[5],r.__data[7]=0,r.__data[8]=a.elements[6],r.__data[9]=a.elements[7],r.__data[10]=a.elements[8],r.__data[11]=0):(a.toArray(r.__data,i),i+=o.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,e,r.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}(n),s[n.id]=p)},dispose:function(){for(const e in i)t.deleteBuffer(i[e]);a=[],i={},s={}}}}const sv=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let av=null;class ov{constructor(t={}){const{canvas:e=Lu(),context:n=null,depth:r=!0,stencil:i=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1,reversedDepthBuffer:h=!1,outputBufferType:d=mc}=t;let f;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");f=n.getContextAttributes().alpha}else f=s;const p=d,m=new Set([Dc,Ic,Nc]),g=new Set([mc,wc,yc,Sc,Ec,Ac]),v=new Uint32Array(4),y=new Int32Array(4);let b=null,w=null;const _=[],x=[];let E=null;this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const A=this;let S=!1;this._outputColorSpace=yu;let M=0,T=0,R=null,C=-1,P=null;const N=new yh,O=new yh;let I=null;const D=new Gd(0);let U=0,L=e.width,F=e.height,k=1,B=null,z=null;const H=new yh(0,0,L,F),G=new yh(0,0,L,F);let V=!1;const j=new Jf;let W=!1,q=!1;const X=new Jh,K=new $u,Y=new yh,J={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Q=!1;function Z(){return null===R?k:1}let $,tt,et,nt,rt,it,st,at,ot,lt,ct,ut,ht,dt,ft,pt,mt,gt,vt,yt,bt,wt,_t,xt,Et=n;function At(t,n){return e.getContext(t,n)}try{const t={alpha:!0,depth:r,stencil:i,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${pl}`),e.addEventListener("webglcontextlost",Tt,!1),e.addEventListener("webglcontextrestored",Rt,!1),e.addEventListener("webglcontextcreationerror",Ct,!1),null===Et){const e="webgl2";if(Et=At(e,t),null===Et)throw At(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Es){throw zu("WebGLRenderer: "+Es.message),Es}function St(){$=new jp(Et),$.init(),wt=new Zg(Et,$),tt=new Sp(Et,$,t,wt),et=new Jg(Et,$),tt.reversedDepthBuffer&&h&&et.buffers.depth.setReversed(!0),nt=new Xp(Et),rt=new Og,it=new Qg(Et,$,et,rt,tt,wt,nt),st=new Tp(A),at=new Vp(A),ot=new mp(Et),_t=new Ep(Et,ot),lt=new Wp(Et,ot,nt,_t),ct=new Yp(Et,lt,ot,nt),vt=new Kp(Et,tt,it),pt=new Mp(rt),ut=new Ng(A,st,at,$,tt,_t,pt),ht=new rv(A,rt),dt=new Lg,ft=new Gg($),gt=new xp(A,st,at,et,ct,f,o),mt=new Kg(A,ct,tt),xt=new iv(Et,nt,tt,et),yt=new Ap(Et,$,nt),bt=new qp(Et,$,nt),nt.programs=ut.programs,A.capabilities=tt,A.extensions=$,A.properties=rt,A.renderLists=dt,A.shadowMap=mt,A.state=et,A.info=nt}St(),p!==mc&&(E=new Qp(p,e.width,e.height,r,i));const Mt=new tv(A,Et);function Tt(t){t.preventDefault(),ku("WebGLRenderer: Context Lost."),S=!0}function Rt(){ku("WebGLRenderer: Context Restored."),S=!1;const t=nt.autoReset,e=mt.enabled,n=mt.autoUpdate,r=mt.needsUpdate,i=mt.type;St(),nt.autoReset=t,mt.enabled=e,mt.autoUpdate=n,mt.needsUpdate=r,mt.type=i}function Ct(t){zu("WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function Pt(t){const e=t.target;e.removeEventListener("dispose",Pt),function(t){(function(t){const e=rt.get(t).programs;void 0!==e&&(e.forEach(function(t){ut.releaseProgram(t)}),t.isShaderMaterial&&ut.releaseShaderCache(t))})(t),rt.remove(t)}(e)}function Nt(t,e,n){!0===t.transparent&&2===t.side&&!1===t.forceSinglePass?(t.side=1,t.needsUpdate=!0,Ht(t,e,n),t.side=0,t.needsUpdate=!0,Ht(t,e,n),t.side=2):Ht(t,e,n)}this.xr=Mt,this.getContext=function(){return Et},this.getContextAttributes=function(){return Et.getContextAttributes()},this.forceContextLoss=function(){const t=$.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=$.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return k},this.setPixelRatio=function(t){void 0!==t&&(k=t,this.setSize(L,F,!1))},this.getSize=function(t){return t.set(L,F)},this.setSize=function(t,n,r=!0){Mt.isPresenting?Bu("WebGLRenderer: Can't change size while VR device is presenting."):(L=t,F=n,e.width=Math.floor(t*k),e.height=Math.floor(n*k),!0===r&&(e.style.width=t+"px",e.style.height=n+"px"),null!==E&&E.setSize(e.width,e.height),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(L*k,F*k).floor()},this.setDrawingBufferSize=function(t,n,r){L=t,F=n,k=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.setEffects=function(t){if(p!==mc){if(t)for(let e=0;e<t.length;e++)if(!0===t[e].isOutputPass){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}E.setEffects(t||[])}else console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.")},this.getCurrentViewport=function(t){return t.copy(N)},this.getViewport=function(t){return t.copy(H)},this.setViewport=function(t,e,n,r){t.isVector4?H.set(t.x,t.y,t.z,t.w):H.set(t,e,n,r),et.viewport(N.copy(H).multiplyScalar(k).round())},this.getScissor=function(t){return t.copy(G)},this.setScissor=function(t,e,n,r){t.isVector4?G.set(t.x,t.y,t.z,t.w):G.set(t,e,n,r),et.scissor(O.copy(G).multiplyScalar(k).round())},this.getScissorTest=function(){return V},this.setScissorTest=function(t){et.setScissorTest(V=t)},this.setOpaqueSort=function(t){B=t},this.setTransparentSort=function(t){z=t},this.getClearColor=function(t){return t.copy(gt.getClearColor())},this.setClearColor=function(){gt.setClearColor(...arguments)},this.getClearAlpha=function(){return gt.getClearAlpha()},this.setClearAlpha=function(){gt.setClearAlpha(...arguments)},this.clear=function(t=!0,e=!0,n=!0){let r=0;if(t){let t=!1;if(null!==R){const e=R.texture.format;t=m.has(e)}if(t){const t=R.texture.type,e=g.has(t),n=gt.getClearColor(),r=gt.getClearAlpha(),i=n.r,s=n.g,a=n.b;e?(v[0]=i,v[1]=s,v[2]=a,v[3]=r,Et.clearBufferuiv(Et.COLOR,0,v)):(y[0]=i,y[1]=s,y[2]=a,y[3]=r,Et.clearBufferiv(Et.COLOR,0,y))}else r|=Et.COLOR_BUFFER_BIT}e&&(r|=Et.DEPTH_BUFFER_BIT),n&&(r|=Et.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Et.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Tt,!1),e.removeEventListener("webglcontextrestored",Rt,!1),e.removeEventListener("webglcontextcreationerror",Ct,!1),gt.dispose(),dt.dispose(),ft.dispose(),rt.dispose(),st.dispose(),at.dispose(),ct.dispose(),_t.dispose(),xt.dispose(),ut.dispose(),Mt.dispose(),Mt.removeEventListener("sessionstart",It),Mt.removeEventListener("sessionend",Dt),Ut.stop()},this.renderBufferDirect=function(t,e,n,r,i,s){null===e&&(e=J);const a=i.isMesh&&i.matrixWorld.determinant()<0,o=function(t,e,n,r,i){!0!==e.isScene&&(e=J);it.resetTextureUnits();const s=e.fog,a=r.isMeshStandardMaterial?e.environment:null,o=null===R?A.outputColorSpace:!0===R.isXRRenderTarget?R.texture.colorSpace:bu,l=(r.isMeshStandardMaterial?at:st).get(r.envMap||a),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,f=!!n.morphAttributes.color;let p=0;r.toneMapped&&(null!==R&&!0!==R.isXRRenderTarget||(p=A.toneMapping));const m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,g=void 0!==m?m.length:0,v=rt.get(r),y=w.state.lights;if(!0===W&&(!0===q||t!==P)){const e=t===P&&r.id===C;pt.setState(r,t,e)}let b=!1;r.version===v.__version?v.needsLights&&v.lightsStateVersion!==y.state.version||v.outputColorSpace!==o||i.isBatchedMesh&&!1===v.batching?b=!0:i.isBatchedMesh||!0!==v.batching?i.isBatchedMesh&&!0===v.batchingColor&&null===i.colorTexture||i.isBatchedMesh&&!1===v.batchingColor&&null!==i.colorTexture||i.isInstancedMesh&&!1===v.instancing?b=!0:i.isInstancedMesh||!0!==v.instancing?i.isSkinnedMesh&&!1===v.skinning?b=!0:i.isSkinnedMesh||!0!==v.skinning?i.isInstancedMesh&&!0===v.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===v.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===v.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===v.instancingMorph&&null!==i.morphTexture||v.envMap!==l||!0===r.fog&&v.fog!==s?b=!0:void 0===v.numClippingPlanes||v.numClippingPlanes===pt.numPlanes&&v.numIntersection===pt.numIntersection?(v.vertexAlphas!==c||v.vertexTangents!==u||v.morphTargets!==h||v.morphNormals!==d||v.morphColors!==f||v.toneMapping!==p||v.morphTargetsCount!==g)&&(b=!0):b=!0:b=!0:b=!0:b=!0:(b=!0,v.__version=r.version);let _=v.currentProgram;!0===b&&(_=Ht(r,e,i));let x=!1,E=!1,S=!1;const M=_.getUniforms(),T=v.uniforms;et.useProgram(_.program)&&(x=!0,E=!0,S=!0);r.id!==C&&(C=r.id,E=!0);if(x||P!==t){et.buffers.depth.getReversed()&&!0!==t.reversedDepth&&(t._reversedDepth=!0,t.updateProjectionMatrix()),M.setValue(Et,"projectionMatrix",t.projectionMatrix),M.setValue(Et,"viewMatrix",t.matrixWorldInverse);const e=M.map.cameraPosition;void 0!==e&&e.setValue(Et,K.setFromMatrixPosition(t.matrixWorld)),tt.logarithmicDepthBuffer&&M.setValue(Et,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&M.setValue(Et,"isOrthographic",!0===t.isOrthographicCamera),P!==t&&(P=t,E=!0,S=!0)}v.needsLights&&(y.state.directionalShadowMap.length>0&&M.setValue(Et,"directionalShadowMap",y.state.directionalShadowMap,it),y.state.spotShadowMap.length>0&&M.setValue(Et,"spotShadowMap",y.state.spotShadowMap,it),y.state.pointShadowMap.length>0&&M.setValue(Et,"pointShadowMap",y.state.pointShadowMap,it));if(i.isSkinnedMesh){M.setOptional(Et,i,"bindMatrix"),M.setOptional(Et,i,"bindMatrixInverse");const t=i.skeleton;t&&(null===t.boneTexture&&t.computeBoneTexture(),M.setValue(Et,"boneTexture",t.boneTexture,it))}i.isBatchedMesh&&(M.setOptional(Et,i,"batchingTexture"),M.setValue(Et,"batchingTexture",i._matricesTexture,it),M.setOptional(Et,i,"batchingIdTexture"),M.setValue(Et,"batchingIdTexture",i._indirectTexture,it),M.setOptional(Et,i,"batchingColorTexture"),null!==i._colorsTexture&&M.setValue(Et,"batchingColorTexture",i._colorsTexture,it));const N=n.morphAttributes;void 0===N.position&&void 0===N.normal&&void 0===N.color||vt.update(i,n,_);(E||v.receiveShadow!==i.receiveShadow)&&(v.receiveShadow=i.receiveShadow,M.setValue(Et,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(T.envMap.value=l,T.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);r.isMeshStandardMaterial&&null===r.envMap&&null!==e.environment&&(T.envMapIntensity.value=e.environmentIntensity);void 0!==T.dfgLUT&&(T.dfgLUT.value=(null===av&&(av=new Gf(sv,16,16,Oc,xc),av.name="DFG_LUT",av.minFilter=dc,av.magFilter=dc,av.wrapS=oc,av.wrapT=oc,av.generateMipmaps=!1,av.needsUpdate=!0),av));E&&(M.setValue(Et,"toneMappingExposure",A.toneMappingExposure),v.needsLights&&(I=S,(O=T).ambientLightColor.needsUpdate=I,O.lightProbe.needsUpdate=I,O.directionalLights.needsUpdate=I,O.directionalLightShadows.needsUpdate=I,O.pointLights.needsUpdate=I,O.pointLightShadows.needsUpdate=I,O.spotLights.needsUpdate=I,O.spotLightShadows.needsUpdate=I,O.rectAreaLights.needsUpdate=I,O.hemisphereLights.needsUpdate=I),s&&!0===r.fog&&ht.refreshFogUniforms(T,s),ht.refreshMaterialUniforms(T,r,k,F,w.state.transmissionRenderTarget[t.id]),ng.upload(Et,Gt(v),T,it));var O,I;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(ng.upload(Et,Gt(v),T,it),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&M.setValue(Et,"center",i.center);if(M.setValue(Et,"modelViewMatrix",i.modelViewMatrix),M.setValue(Et,"normalMatrix",i.normalMatrix),M.setValue(Et,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const t=r.uniformsGroups;for(let e=0,n=t.length;e<n;e++){const n=t[e];xt.update(n,_),xt.bind(n,_)}}return _}(t,e,n,r,i);et.setMaterial(r,a);let l=n.index,c=1;if(!0===r.wireframe){if(l=lt.getWireframeAttribute(n),void 0===l)return;c=2}const u=n.drawRange,h=n.attributes.position;let d=u.start*c,f=(u.start+u.count)*c;null!==s&&(d=Math.max(d,s.start*c),f=Math.min(f,(s.start+s.count)*c)),null!==l?(d=Math.max(d,0),f=Math.min(f,l.count)):null!=h&&(d=Math.max(d,0),f=Math.min(f,h.count));const p=f-d;if(p<0||p===1/0)return;let m;_t.setup(i,r,o,n,l);let g=yt;if(null!==l&&(m=ot.get(l),g=bt,g.setIndex(m)),i.isMesh)!0===r.wireframe?(et.setLineWidth(r.wireframeLinewidth*Z()),g.setMode(Et.LINES)):g.setMode(Et.TRIANGLES);else if(i.isLine){let t=r.linewidth;void 0===t&&(t=1),et.setLineWidth(t*Z()),i.isLineSegments?g.setMode(Et.LINES):i.isLineLoop?g.setMode(Et.LINE_LOOP):g.setMode(Et.LINE_STRIP)}else i.isPoints?g.setMode(Et.POINTS):i.isSprite&&g.setMode(Et.TRIANGLES);if(i.isBatchedMesh)if(null!==i._multiDrawInstances)Hu("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),g.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances);else if($.get("WEBGL_multi_draw"))g.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else{const t=i._multiDrawStarts,e=i._multiDrawCounts,n=i._multiDrawCount,s=l?ot.get(l).bytesPerElement:1,a=rt.get(r).currentProgram.getUniforms();for(let r=0;r<n;r++)a.setValue(Et,"_gl_DrawID",r),g.render(t[r]/s,e[r])}else if(i.isInstancedMesh)g.renderInstances(d,p,i.count);else if(n.isInstancedBufferGeometry){const t=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,e=Math.min(n.instanceCount,t);g.renderInstances(d,p,e)}else g.render(d,p)},this.compile=function(t,e,n=null){null===n&&(n=t),w=ft.get(n),w.init(e),x.push(w),n.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(w.pushLight(t),t.castShadow&&w.pushShadow(t))}),t!==n&&t.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(w.pushLight(t),t.castShadow&&w.pushShadow(t))}),w.setupLights();const r=new Set;return t.traverse(function(t){if(!(t.isMesh||t.isPoints||t.isLine||t.isSprite))return;const e=t.material;if(e)if(Array.isArray(e))for(let i=0;i<e.length;i++){const s=e[i];Nt(s,n,t),r.add(s)}else Nt(e,n,t),r.add(e)}),w=x.pop(),r},this.compileAsync=function(t,e,n=null){const r=this.compile(t,e,n);return new Promise(e=>{function n(){r.forEach(function(t){rt.get(t).currentProgram.isReady()&&r.delete(t)}),0!==r.size?setTimeout(n,10):e(t)}null!==$.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let Ot=null;function It(){Ut.stop()}function Dt(){Ut.start()}const Ut=new pp;function Lt(t,e,n,r){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)w.pushLight(t),t.castShadow&&w.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||j.intersectsSprite(t)){r&&Y.setFromMatrixPosition(t.matrixWorld).applyMatrix4(X);const e=ct.update(t),i=t.material;i.visible&&b.push(t,e,i,n,Y.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||j.intersectsObject(t))){const e=ct.update(t),i=t.material;if(r&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),Y.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),Y.copy(e.boundingSphere.center)),Y.applyMatrix4(t.matrixWorld).applyMatrix4(X)),Array.isArray(i)){const r=e.groups;for(let s=0,a=r.length;s<a;s++){const a=r[s],o=i[a.materialIndex];o&&o.visible&&b.push(t,e,o,n,Y.z,a)}}else i.visible&&b.push(t,e,i,n,Y.z,null)}const i=t.children;for(let s=0,a=i.length;s<a;s++)Lt(i[s],e,n,r)}function Ft(t,e,n,r){const{opaque:i,transmissive:s,transparent:a}=t;w.setupLightsView(n),!0===W&&pt.setGlobalState(A.clippingPlanes,n),r&&et.viewport(N.copy(r)),i.length>0&&Bt(i,e,n),s.length>0&&Bt(s,e,n),a.length>0&&Bt(a,e,n),et.buffers.depth.setTest(!0),et.buffers.depth.setMask(!0),et.buffers.color.setMask(!0),et.setPolygonOffset(!1)}function kt(t,e,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;if(void 0===w.state.transmissionRenderTarget[r.id]){const t=$.has("EXT_color_buffer_half_float")||$.has("EXT_color_buffer_float");w.state.transmissionRenderTarget[r.id]=new wh(1,1,{generateMipmaps:!0,type:t?xc:mc,minFilter:pc,samples:tt.samples,stencilBuffer:i,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:oh.workingColorSpace})}const s=w.state.transmissionRenderTarget[r.id],a=r.viewport||N;s.setSize(a.z*A.transmissionResolutionScale,a.w*A.transmissionResolutionScale);const o=A.getRenderTarget(),l=A.getActiveCubeFace(),c=A.getActiveMipmapLevel();A.setRenderTarget(s),A.getClearColor(D),U=A.getClearAlpha(),U<1&&A.setClearColor(16777215,.5),A.clear(),Q&&gt.render(n);const u=A.toneMapping;A.toneMapping=0;const h=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),w.setupLightsView(r),!0===W&&pt.setGlobalState(A.clippingPlanes,r),Bt(t,n,r),it.updateMultisampleRenderTarget(s),it.updateRenderTargetMipmap(s),!1===$.has("WEBGL_multisampled_render_to_texture")){let t=!1;for(let i=0,s=e.length;i<s;i++){const s=e[i],{object:a,geometry:o,material:l,group:c}=s;if(2===l.side&&a.layers.test(r.layers)){const e=l.side;l.side=1,l.needsUpdate=!0,zt(a,n,r,o,l,c),l.side=e,l.needsUpdate=!0,t=!0}}!0===t&&(it.updateMultisampleRenderTarget(s),it.updateRenderTargetMipmap(s))}A.setRenderTarget(o,l,c),A.setClearColor(D,U),void 0!==h&&(r.viewport=h),A.toneMapping=u}function Bt(t,e,n){const r=!0===e.isScene?e.overrideMaterial:null;for(let i=0,s=t.length;i<s;i++){const s=t[i],{object:a,geometry:o,group:l}=s;let c=s.material;!0===c.allowOverride&&null!==r&&(c=r),a.layers.test(n.layers)&&zt(a,e,n,o,c,l)}}function zt(t,e,n,r,i,s){t.onBeforeRender(A,e,n,r,i,s),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),i.onBeforeRender(A,e,n,r,t,s),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,i.needsUpdate=!0,A.renderBufferDirect(n,e,r,i,t,s),i.side=0,i.needsUpdate=!0,A.renderBufferDirect(n,e,r,i,t,s),i.side=2):A.renderBufferDirect(n,e,r,i,t,s),t.onAfterRender(A,e,n,r,i,s)}function Ht(t,e,n){!0!==e.isScene&&(e=J);const r=rt.get(t),i=w.state.lights,s=w.state.shadowsArray,a=i.state.version,o=ut.getParameters(t,i.state,s,e,n),l=ut.getProgramCacheKey(o);let c=r.programs;r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.envMap=(t.isMeshStandardMaterial?at:st).get(t.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===t.envMap?e.environmentRotation:t.envMapRotation,void 0===c&&(t.addEventListener("dispose",Pt),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===a)return Vt(t,o),u}else o.uniforms=ut.getUniforms(t),t.onBeforeCompile(o,A),u=ut.acquireProgram(o,l),c.set(l,u),r.uniforms=o.uniforms;const h=r.uniforms;return(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(h.clippingPlanes=pt.uniform),Vt(t,o),r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=a,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=u,r.uniformsList=null,u}function Gt(t){if(null===t.uniformsList){const e=t.currentProgram.getUniforms();t.uniformsList=ng.seqWithValue(e.seq,t.uniforms)}return t.uniformsList}function Vt(t,e){const n=rt.get(t);n.outputColorSpace=e.outputColorSpace,n.batching=e.batching,n.batchingColor=e.batchingColor,n.instancing=e.instancing,n.instancingColor=e.instancingColor,n.instancingMorph=e.instancingMorph,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphColors=e.morphColors,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}Ut.setAnimationLoop(function(t){Ot&&Ot(t)}),"undefined"!=typeof self&&Ut.setContext(self),this.setAnimationLoop=function(t){Ot=t,Mt.setAnimationLoop(t),null===t?Ut.stop():Ut.start()},Mt.addEventListener("sessionstart",It),Mt.addEventListener("sessionend",Dt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void zu("WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===S)return;const n=!0===Mt.enabled&&!0===Mt.isPresenting,r=null!==E&&(null===R||n)&&E.begin(A,R);if(!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0!==Mt.enabled||!0!==Mt.isPresenting||null!==E&&!1!==E.isCompositing()||(!0===Mt.cameraAutoUpdate&&Mt.updateCamera(e),e=Mt.getCamera()),!0===t.isScene&&t.onBeforeRender(A,t,e,R),w=ft.get(t,x.length),w.init(e),x.push(w),X.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),j.setFromProjectionMatrix(X,Ou,e.reversedDepth),q=this.localClippingEnabled,W=pt.init(this.clippingPlanes,q),b=dt.get(t,_.length),b.init(),_.push(b),!0===Mt.enabled&&!0===Mt.isPresenting){const t=A.xr.getDepthSensingMesh();null!==t&&Lt(t,e,-1/0,A.sortObjects)}Lt(t,e,0,A.sortObjects),b.finish(),!0===A.sortObjects&&b.sort(B,z),Q=!1===Mt.enabled||!1===Mt.isPresenting||!1===Mt.hasDepthSensing(),Q&&gt.addToRenderList(b,t),this.info.render.frame++,!0===W&&pt.beginShadows();const i=w.state.shadowsArray;mt.render(i,t,e),!0===W&&pt.endShadows(),!0===this.info.autoReset&&this.info.reset();if(!1===(r&&E.hasRenderPass())){const n=b.opaque,r=b.transmissive;if(w.setupLights(),e.isArrayCamera){const i=e.cameras;if(r.length>0)for(let e=0,s=i.length;e<s;e++){kt(n,r,t,i[e])}Q&&gt.render(t);for(let e=0,n=i.length;e<n;e++){const n=i[e];Ft(b,t,n,n.viewport)}}else r.length>0&&kt(n,r,t,e),Q&&gt.render(t),Ft(b,t,e)}null!==R&&0===T&&(it.updateMultisampleRenderTarget(R),it.updateRenderTargetMipmap(R)),r&&E.end(A),!0===t.isScene&&t.onAfterRender(A,t,e),_t.resetDefaultState(),C=-1,P=null,x.pop(),x.length>0?(w=x[x.length-1],!0===W&&pt.setGlobalState(A.clippingPlanes,w.state.camera)):w=null,_.pop(),b=_.length>0?_[_.length-1]:null},this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(t,e,n){const r=rt.get(t);r.__autoAllocateDepthBuffer=!1===t.resolveDepthBuffer,!1===r.__autoAllocateDepthBuffer&&(r.__useRenderToTexture=!1),rt.get(t.texture).__webglTexture=e,rt.get(t.depthTexture).__webglTexture=r.__autoAllocateDepthBuffer?void 0:n,r.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(t,e){const n=rt.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e};const jt=Et.createFramebuffer();this.setRenderTarget=function(t,e=0,n=0){R=t,M=e,T=n;let r=null,i=!1,s=!1;if(t){const a=rt.get(t);if(void 0!==a.__useDefaultFramebuffer)return et.bindFramebuffer(Et.FRAMEBUFFER,a.__webglFramebuffer),N.copy(t.viewport),O.copy(t.scissor),I=t.scissorTest,et.viewport(N),et.scissor(O),et.setScissorTest(I),void(C=-1);if(void 0===a.__webglFramebuffer)it.setupRenderTarget(t);else if(a.__hasExternalTextures)it.rebindTextures(t,rt.get(t.texture).__webglTexture,rt.get(t.depthTexture).__webglTexture);else if(t.depthBuffer){const e=t.depthTexture;if(a.__boundDepthTexture!==e){if(null!==e&&rt.has(e)&&(t.width!==e.image.width||t.height!==e.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");it.setupDepthRenderbuffer(t)}}const o=t.texture;(o.isData3DTexture||o.isDataArrayTexture||o.isCompressedArrayTexture)&&(s=!0);const l=rt.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=Array.isArray(l[e])?l[e][n]:l[e],i=!0):r=t.samples>0&&!1===it.useMultisampledRTT(t)?rt.get(t).__webglMultisampledFramebuffer:Array.isArray(l)?l[n]:l,N.copy(t.viewport),O.copy(t.scissor),I=t.scissorTest}else N.copy(H).multiplyScalar(k).floor(),O.copy(G).multiplyScalar(k).floor(),I=V;0!==n&&(r=jt);if(et.bindFramebuffer(Et.FRAMEBUFFER,r)&&et.drawBuffers(t,r),et.viewport(N),et.scissor(O),et.setScissorTest(I),i){const r=rt.get(t.texture);Et.framebufferTexture2D(Et.FRAMEBUFFER,Et.COLOR_ATTACHMENT0,Et.TEXTURE_CUBE_MAP_POSITIVE_X+e,r.__webglTexture,n)}else if(s){const r=e;for(let e=0;e<t.textures.length;e++){const i=rt.get(t.textures[e]);Et.framebufferTextureLayer(Et.FRAMEBUFFER,Et.COLOR_ATTACHMENT0+e,i.__webglTexture,n,r)}}else if(null!==t&&0!==n){const e=rt.get(t.texture);Et.framebufferTexture2D(Et.FRAMEBUFFER,Et.COLOR_ATTACHMENT0,Et.TEXTURE_2D,e.__webglTexture,n)}C=-1},this.readRenderTargetPixels=function(t,e,n,r,i,s,a,o=0){if(!t||!t.isWebGLRenderTarget)return void zu("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=rt.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){et.bindFramebuffer(Et.FRAMEBUFFER,l);try{const a=t.textures[o],l=a.format,c=a.type;if(!tt.textureFormatReadable(l))return void zu("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!tt.textureTypeReadable(c))return void zu("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&(t.textures.length>1&&Et.readBuffer(Et.COLOR_ATTACHMENT0+o),Et.readPixels(e,n,r,i,wt.convert(l),wt.convert(c),s))}finally{const t=null!==R?rt.get(R).__webglFramebuffer:null;et.bindFramebuffer(Et.FRAMEBUFFER,t)}}},this.readRenderTargetPixelsAsync=async function(t,e,n,r,i,s,a,o=0){if(!t||!t.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=rt.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){if(e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i){et.bindFramebuffer(Et.FRAMEBUFFER,l);const a=t.textures[o],c=a.format,u=a.type;if(!tt.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!tt.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const h=Et.createBuffer();Et.bindBuffer(Et.PIXEL_PACK_BUFFER,h),Et.bufferData(Et.PIXEL_PACK_BUFFER,s.byteLength,Et.STREAM_READ),t.textures.length>1&&Et.readBuffer(Et.COLOR_ATTACHMENT0+o),Et.readPixels(e,n,r,i,wt.convert(c),wt.convert(u),0);const d=null!==R?rt.get(R).__webglFramebuffer:null;et.bindFramebuffer(Et.FRAMEBUFFER,d);const f=Et.fenceSync(Et.SYNC_GPU_COMMANDS_COMPLETE,0);return Et.flush(),await function(t,e,n){return new Promise(function(r,i){setTimeout(function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:i();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:r()}},n)})}(Et,f,4),Et.bindBuffer(Et.PIXEL_PACK_BUFFER,h),Et.getBufferSubData(Et.PIXEL_PACK_BUFFER,0,s),Et.deleteBuffer(h),Et.deleteSync(f),s}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(t,e=null,n=0){const r=Math.pow(2,-n),i=Math.floor(t.image.width*r),s=Math.floor(t.image.height*r),a=null!==e?e.x:0,o=null!==e?e.y:0;it.setTexture2D(t,0),Et.copyTexSubImage2D(Et.TEXTURE_2D,n,0,0,a,o,i,s),et.unbindTexture()};const Wt=Et.createFramebuffer(),qt=Et.createFramebuffer();this.copyTextureToTexture=function(t,e,n=null,r=null,i=0,s=null){let a,o,l,c,u,h,d,f,p;null===s&&(0!==i?(Hu("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),s=i,i=0):s=0);const m=t.isCompressedTexture?t.mipmaps[s]:t.image;if(null!==n)a=n.max.x-n.min.x,o=n.max.y-n.min.y,l=n.isBox3?n.max.z-n.min.z:1,c=n.min.x,u=n.min.y,h=n.isBox3?n.min.z:0;else{const e=Math.pow(2,-i);a=Math.floor(m.width*e),o=Math.floor(m.height*e),l=t.isDataArrayTexture?m.depth:t.isData3DTexture?Math.floor(m.depth*e):1,c=0,u=0,h=0}null!==r?(d=r.x,f=r.y,p=r.z):(d=0,f=0,p=0);const g=wt.convert(e.format),v=wt.convert(e.type);let y;e.isData3DTexture?(it.setTexture3D(e,0),y=Et.TEXTURE_3D):e.isDataArrayTexture||e.isCompressedArrayTexture?(it.setTexture2DArray(e,0),y=Et.TEXTURE_2D_ARRAY):(it.setTexture2D(e,0),y=Et.TEXTURE_2D),Et.pixelStorei(Et.UNPACK_FLIP_Y_WEBGL,e.flipY),Et.pixelStorei(Et.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),Et.pixelStorei(Et.UNPACK_ALIGNMENT,e.unpackAlignment);const b=Et.getParameter(Et.UNPACK_ROW_LENGTH),w=Et.getParameter(Et.UNPACK_IMAGE_HEIGHT),_=Et.getParameter(Et.UNPACK_SKIP_PIXELS),x=Et.getParameter(Et.UNPACK_SKIP_ROWS),E=Et.getParameter(Et.UNPACK_SKIP_IMAGES);Et.pixelStorei(Et.UNPACK_ROW_LENGTH,m.width),Et.pixelStorei(Et.UNPACK_IMAGE_HEIGHT,m.height),Et.pixelStorei(Et.UNPACK_SKIP_PIXELS,c),Et.pixelStorei(Et.UNPACK_SKIP_ROWS,u),Et.pixelStorei(Et.UNPACK_SKIP_IMAGES,h);const A=t.isDataArrayTexture||t.isData3DTexture,S=e.isDataArrayTexture||e.isData3DTexture;if(t.isDepthTexture){const n=rt.get(t),r=rt.get(e),m=rt.get(n.__renderTarget),g=rt.get(r.__renderTarget);et.bindFramebuffer(Et.READ_FRAMEBUFFER,m.__webglFramebuffer),et.bindFramebuffer(Et.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let v=0;v<l;v++)A&&(Et.framebufferTextureLayer(Et.READ_FRAMEBUFFER,Et.COLOR_ATTACHMENT0,rt.get(t).__webglTexture,i,h+v),Et.framebufferTextureLayer(Et.DRAW_FRAMEBUFFER,Et.COLOR_ATTACHMENT0,rt.get(e).__webglTexture,s,p+v)),Et.blitFramebuffer(c,u,a,o,d,f,a,o,Et.DEPTH_BUFFER_BIT,Et.NEAREST);et.bindFramebuffer(Et.READ_FRAMEBUFFER,null),et.bindFramebuffer(Et.DRAW_FRAMEBUFFER,null)}else if(0!==i||t.isRenderTargetTexture||rt.has(t)){const n=rt.get(t),r=rt.get(e);et.bindFramebuffer(Et.READ_FRAMEBUFFER,Wt),et.bindFramebuffer(Et.DRAW_FRAMEBUFFER,qt);for(let t=0;t<l;t++)A?Et.framebufferTextureLayer(Et.READ_FRAMEBUFFER,Et.COLOR_ATTACHMENT0,n.__webglTexture,i,h+t):Et.framebufferTexture2D(Et.READ_FRAMEBUFFER,Et.COLOR_ATTACHMENT0,Et.TEXTURE_2D,n.__webglTexture,i),S?Et.framebufferTextureLayer(Et.DRAW_FRAMEBUFFER,Et.COLOR_ATTACHMENT0,r.__webglTexture,s,p+t):Et.framebufferTexture2D(Et.DRAW_FRAMEBUFFER,Et.COLOR_ATTACHMENT0,Et.TEXTURE_2D,r.__webglTexture,s),0!==i?Et.blitFramebuffer(c,u,a,o,d,f,a,o,Et.COLOR_BUFFER_BIT,Et.NEAREST):S?Et.copyTexSubImage3D(y,s,d,f,p+t,c,u,a,o):Et.copyTexSubImage2D(y,s,d,f,c,u,a,o);et.bindFramebuffer(Et.READ_FRAMEBUFFER,null),et.bindFramebuffer(Et.DRAW_FRAMEBUFFER,null)}else S?t.isDataTexture||t.isData3DTexture?Et.texSubImage3D(y,s,d,f,p,a,o,l,g,v,m.data):e.isCompressedArrayTexture?Et.compressedTexSubImage3D(y,s,d,f,p,a,o,l,g,m.data):Et.texSubImage3D(y,s,d,f,p,a,o,l,g,v,m):t.isDataTexture?Et.texSubImage2D(Et.TEXTURE_2D,s,d,f,a,o,g,v,m.data):t.isCompressedTexture?Et.compressedTexSubImage2D(Et.TEXTURE_2D,s,d,f,m.width,m.height,g,m.data):Et.texSubImage2D(Et.TEXTURE_2D,s,d,f,a,o,g,v,m);Et.pixelStorei(Et.UNPACK_ROW_LENGTH,b),Et.pixelStorei(Et.UNPACK_IMAGE_HEIGHT,w),Et.pixelStorei(Et.UNPACK_SKIP_PIXELS,_),Et.pixelStorei(Et.UNPACK_SKIP_ROWS,x),Et.pixelStorei(Et.UNPACK_SKIP_IMAGES,E),0===s&&e.generateMipmaps&&Et.generateMipmap(y),et.unbindTexture()},this.initRenderTarget=function(t){void 0===rt.get(t).__webglFramebuffer&&it.setupRenderTarget(t)},this.initTexture=function(t){t.isCubeTexture?it.setTextureCube(t,0):t.isData3DTexture?it.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?it.setTexture2DArray(t,0):it.setTexture2D(t,0),et.unbindTexture()},this.resetState=function(){M=0,T=0,R=null,et.reset(),_t.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ou}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const e=this.getContext();e.drawingBufferColorSpace=oh._getDrawingBufferColorSpace(t),e.unpackColorSpace=oh._getUnpackColorSpace()}}function lv(t,e){return function(){return t.apply(e,arguments)}}const{toString:cv}=Object.prototype,{getPrototypeOf:uv}=Object,{iterator:hv,toStringTag:dv}=Symbol,fv=(t=>e=>{const n=cv.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),pv=t=>(t=t.toLowerCase(),e=>fv(e)===t),mv=t=>e=>typeof e===t,{isArray:gv}=Array,vv=mv("undefined");function yv(t){return null!==t&&!vv(t)&&null!==t.constructor&&!vv(t.constructor)&&_v(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const bv=pv("ArrayBuffer");const wv=mv("string"),_v=mv("function"),xv=mv("number"),Ev=t=>null!==t&&"object"==typeof t,Av=t=>{if("object"!==fv(t))return!1;const e=uv(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||dv in t||hv in t)},Sv=pv("Date"),Mv=pv("File"),Tv=pv("Blob"),Rv=pv("FileList"),Cv=pv("URLSearchParams"),[Pv,Nv,Ov,Iv]=["ReadableStream","Request","Response","Headers"].map(pv);function Dv(t,e,{allOwnKeys:n=!1}={}){if(null==t)return;let r,i;if("object"!=typeof t&&(t=[t]),gv(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{if(yv(t))return;const i=n?Object.getOwnPropertyNames(t):Object.keys(t),s=i.length;let a;for(r=0;r<s;r++)a=i[r],e.call(null,t[a],a,t)}}function Uv(t,e){if(yv(t))return null;e=e.toLowerCase();const n=Object.keys(t);let r,i=n.length;for(;i-- >0;)if(r=n[i],e===r.toLowerCase())return r;return null}const Lv="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Fv=t=>!vv(t)&&t!==Lv;const kv=(t=>e=>t&&e instanceof t)("undefined"!=typeof Uint8Array&&uv(Uint8Array)),Bv=pv("HTMLFormElement"),zv=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Hv=pv("RegExp"),Gv=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Dv(n,(n,i)=>{let s;!1!==(s=e(n,i,t))&&(r[i]=s||n)}),Object.defineProperties(t,r)};const Vv=pv("AsyncFunction"),jv=(Wv="function"==typeof setImmediate,qv=_v(Lv.postMessage),Wv?setImmediate:qv?(Xv=`axios@${Math.random()}`,Kv=[],Lv.addEventListener("message",({source:t,data:e})=>{t===Lv&&e===Xv&&Kv.length&&Kv.shift()()},!1),t=>{Kv.push(t),Lv.postMessage(Xv,"*")}):t=>setTimeout(t));var Wv,qv,Xv,Kv;const Yv="undefined"!=typeof queueMicrotask?queueMicrotask.bind(Lv):"undefined"!=typeof process&&process.nextTick||jv,Jv={isArray:gv,isArrayBuffer:bv,isBuffer:yv,isFormData:t=>{let e;return t&&("function"==typeof FormData&&t instanceof FormData||_v(t.append)&&("formdata"===(e=fv(t))||"object"===e&&_v(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&bv(t.buffer),e},isString:wv,isNumber:xv,isBoolean:t=>!0===t||!1===t,isObject:Ev,isPlainObject:Av,isEmptyObject:t=>{if(!Ev(t)||yv(t))return!1;try{return 0===Object.keys(t).length&&Object.getPrototypeOf(t)===Object.prototype}catch(Es){return!1}},isReadableStream:Pv,isRequest:Nv,isResponse:Ov,isHeaders:Iv,isUndefined:vv,isDate:Sv,isFile:Mv,isBlob:Tv,isRegExp:Hv,isFunction:_v,isStream:t=>Ev(t)&&_v(t.pipe),isURLSearchParams:Cv,isTypedArray:kv,isFileList:Rv,forEach:Dv,merge:function t(){const{caseless:e,skipUndefined:n}=Fv(this)&&this||{},r={},i=(i,s)=>{const a=e&&Uv(r,s)||s;Av(r[a])&&Av(i)?r[a]=t(r[a],i):Av(i)?r[a]=t({},i):gv(i)?r[a]=i.slice():n&&vv(i)||(r[a]=i)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Dv(arguments[s],i);return r},extend:(t,e,n,{allOwnKeys:r}={})=>(Dv(e,(e,r)=>{n&&_v(e)?t[r]=lv(e,n):t[r]=e},{allOwnKeys:r}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,r)=>{let i,s,a;const o={};if(e=e||{},null==t)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)a=i[s],r&&!r(a,t,e)||o[a]||(e[a]=t[a],o[a]=!0);t=!1!==n&&uv(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:fv,kindOfTest:pv,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return-1!==r&&r===n},toArray:t=>{if(!t)return null;if(gv(t))return t;let e=t.length;if(!xv(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[hv]).call(t);let r;for(;(r=n.next())&&!r.done;){const n=r.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const r=[];for(;null!==(n=t.exec(e));)r.push(n);return r},isHTMLForm:Bv,hasOwnProperty:zv,hasOwnProp:zv,reduceDescriptors:Gv,freezeMethods:t=>{Gv(t,(e,n)=>{if(_v(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=t[n];_v(r)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(t,e)=>{const n={},r=t=>{t.forEach(t=>{n[t]=!0})};return gv(t)?r(t):r(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,e,n){return e.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:Uv,global:Lv,isContextDefined:Fv,isSpecCompliantForm:function(t){return!!(t&&_v(t.append)&&"FormData"===t[dv]&&t[hv])},toJSONObject:t=>{const e=new Array(10),n=(t,r)=>{if(Ev(t)){if(e.indexOf(t)>=0)return;if(yv(t))return t;if(!("toJSON"in t)){e[r]=t;const i=gv(t)?[]:{};return Dv(t,(t,e)=>{const s=n(t,r+1);!vv(s)&&(i[e]=s)}),e[r]=void 0,i}}return t};return n(t,0)},isAsyncFn:Vv,isThenable:t=>t&&(Ev(t)||_v(t))&&_v(t.then)&&_v(t.catch),setImmediate:jv,asap:Yv,isIterable:t=>null!=t&&_v(t[hv])};function Qv(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Jv.inherits(Qv,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Jv.toJSONObject(this.config),code:this.code,status:this.status}}});const Zv=Qv.prototype,$v={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{$v[t]={value:t}}),Object.defineProperties(Qv,$v),Object.defineProperty(Zv,"isAxiosError",{value:!0}),Qv.from=(t,e,n,r,i,s)=>{const a=Object.create(Zv);Jv.toFlatObject(t,a,function(t){return t!==Error.prototype},t=>"isAxiosError"!==t);const o=t&&t.message?t.message:"Error",l=null==e&&t?t.code:e;return Qv.call(a,o,l,n,r,i),t&&null==a.cause&&Object.defineProperty(a,"cause",{value:t,configurable:!0}),a.name=t&&t.name||"Error",s&&Object.assign(a,s),a};function ty(t){return Jv.isPlainObject(t)||Jv.isArray(t)}function ey(t){return Jv.endsWith(t,"[]")?t.slice(0,-2):t}function ny(t,e,n){return t?t.concat(e).map(function(t,e){return t=ey(t),!n&&e?"["+t+"]":t}).join(n?".":""):e}const ry=Jv.toFlatObject(Jv,{},null,function(t){return/^is[A-Z]/.test(t)});function iy(t,e,n){if(!Jv.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const r=(n=Jv.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(t,e){return!Jv.isUndefined(e[t])})).metaTokens,i=n.visitor||c,s=n.dots,a=n.indexes,o=(n.Blob||"undefined"!=typeof Blob&&Blob)&&Jv.isSpecCompliantForm(e);if(!Jv.isFunction(i))throw new TypeError("visitor must be a function");function l(t){if(null===t)return"";if(Jv.isDate(t))return t.toISOString();if(Jv.isBoolean(t))return t.toString();if(!o&&Jv.isBlob(t))throw new Qv("Blob is not supported. Use a Buffer instead.");return Jv.isArrayBuffer(t)||Jv.isTypedArray(t)?o&&"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}function c(t,n,i){let o=t;if(t&&!i&&"object"==typeof t)if(Jv.endsWith(n,"{}"))n=r?n:n.slice(0,-2),t=JSON.stringify(t);else if(Jv.isArray(t)&&function(t){return Jv.isArray(t)&&!t.some(ty)}(t)||(Jv.isFileList(t)||Jv.endsWith(n,"[]"))&&(o=Jv.toArray(t)))return n=ey(n),o.forEach(function(t,r){!Jv.isUndefined(t)&&null!==t&&e.append(!0===a?ny([n],r,s):null===a?n:n+"[]",l(t))}),!1;return!!ty(t)||(e.append(ny(i,n,s),l(t)),!1)}const u=[],h=Object.assign(ry,{defaultVisitor:c,convertValue:l,isVisitable:ty});if(!Jv.isObject(t))throw new TypeError("data must be an object");return function t(n,r){if(!Jv.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),Jv.forEach(n,function(n,s){!0===(!(Jv.isUndefined(n)||null===n)&&i.call(e,n,Jv.isString(s)?s.trim():s,r,h))&&t(n,r?r.concat(s):[s])}),u.pop()}}(t),e}function sy(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(t){return e[t]})}function ay(t,e){this._pairs=[],t&&iy(t,this,e)}const oy=ay.prototype;function ly(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function cy(t,e,n){if(!e)return t;const r=n&&n.encode||ly;Jv.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(s=i?i(e,n):Jv.isURLSearchParams(e)?e.toString():new ay(e,n).toString(r),s){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+s}return t}oy.append=function(t,e){this._pairs.push([t,e])},oy.toString=function(t){const e=t?function(e){return t.call(this,e,sy)}:sy;return this._pairs.map(function(t){return e(t[0])+"="+e(t[1])},"").join("&")};class uy{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Jv.forEach(this.handlers,function(e){null!==e&&t(e)})}}const hy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},dy={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:ay,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},fy="undefined"!=typeof window&&"undefined"!=typeof document,py="object"==typeof navigator&&navigator||void 0,my=fy&&(!py||["ReactNative","NativeScript","NS"].indexOf(py.product)<0),gy="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,vy=fy&&window.location.href||"http://localhost",yy={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:fy,hasStandardBrowserEnv:my,hasStandardBrowserWebWorkerEnv:gy,navigator:py,origin:vy},Symbol.toStringTag,{value:"Module"})),...dy};function by(t){function e(t,n,r,i){let s=t[i++];if("__proto__"===s)return!0;const a=Number.isFinite(+s),o=i>=t.length;if(s=!s&&Jv.isArray(r)?r.length:s,o)return Jv.hasOwnProp(r,s)?r[s]=[r[s],n]:r[s]=n,!a;r[s]&&Jv.isObject(r[s])||(r[s]=[]);return e(t,n,r[s],i)&&Jv.isArray(r[s])&&(r[s]=function(t){const e={},n=Object.keys(t);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],e[s]=t[s];return e}(r[s])),!a}if(Jv.isFormData(t)&&Jv.isFunction(t.entries)){const n={};return Jv.forEachEntry(t,(t,r)=>{e(function(t){return Jv.matchAll(/\w+|\[(\w*)]/g,t).map(t=>"[]"===t[0]?"":t[1]||t[0])}(t),r,n,0)}),n}return null}const wy={transitional:hy,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",r=n.indexOf("application/json")>-1,i=Jv.isObject(t);i&&Jv.isHTMLForm(t)&&(t=new FormData(t));if(Jv.isFormData(t))return r?JSON.stringify(by(t)):t;if(Jv.isArrayBuffer(t)||Jv.isBuffer(t)||Jv.isStream(t)||Jv.isFile(t)||Jv.isBlob(t)||Jv.isReadableStream(t))return t;if(Jv.isArrayBufferView(t))return t.buffer;if(Jv.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return iy(t,new yy.classes.URLSearchParams,{visitor:function(t,e,n,r){return yy.isNode&&Jv.isBuffer(t)?(this.append(e,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...e})}(t,this.formSerializer).toString();if((s=Jv.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return iy(s?{"files[]":t}:t,e&&new e,this.formSerializer)}}return i||r?(e.setContentType("application/json",!1),function(t,e,n){if(Jv.isString(t))try{return(e||JSON.parse)(t),Jv.trim(t)}catch(Es){if("SyntaxError"!==Es.name)throw Es}return(n||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||wy.transitional,n=e&&e.forcedJSONParsing,r="json"===this.responseType;if(Jv.isResponse(t)||Jv.isReadableStream(t))return t;if(t&&Jv.isString(t)&&(n&&!this.responseType||r)){const n=!(e&&e.silentJSONParsing)&&r;try{return JSON.parse(t,this.parseReviver)}catch(Es){if(n){if("SyntaxError"===Es.name)throw Qv.from(Es,Qv.ERR_BAD_RESPONSE,this,null,this.response);throw Es}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:yy.classes.FormData,Blob:yy.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Jv.forEach(["delete","get","head","post","put","patch"],t=>{wy.headers[t]={}});const _y=Jv.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),xy=Symbol("internals");function Ey(t){return t&&String(t).trim().toLowerCase()}function Ay(t){return!1===t||null==t?t:Jv.isArray(t)?t.map(Ay):String(t)}function Sy(t,e,n,r,i){return Jv.isFunction(r)?r.call(this,e,n):(i&&(e=n),Jv.isString(e)?Jv.isString(r)?-1!==e.indexOf(r):Jv.isRegExp(r)?r.test(e):void 0:void 0)}let My=class{constructor(t){t&&this.set(t)}set(t,e,n){const r=this;function i(t,e,n){const i=Ey(e);if(!i)throw new Error("header name must be a non-empty string");const s=Jv.findKey(r,i);(!s||void 0===r[s]||!0===n||void 0===n&&!1!==r[s])&&(r[s||e]=Ay(t))}const s=(t,e)=>Jv.forEach(t,(t,n)=>i(t,n,e));if(Jv.isPlainObject(t)||t instanceof this.constructor)s(t,e);else if(Jv.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))s((t=>{const e={};let n,r,i;return t&&t.split("\n").forEach(function(t){i=t.indexOf(":"),n=t.substring(0,i).trim().toLowerCase(),r=t.substring(i+1).trim(),!n||e[n]&&_y[n]||("set-cookie"===n?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e})(t),e);else if(Jv.isObject(t)&&Jv.isIterable(t)){let n,r,i={};for(const e of t){if(!Jv.isArray(e))throw TypeError("Object iterator must return a key-value pair");i[r=e[0]]=(n=i[r])?Jv.isArray(n)?[...n,e[1]]:[n,e[1]]:e[1]}s(i,e)}else null!=t&&i(e,t,n);return this}get(t,e){if(t=Ey(t)){const n=Jv.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}(t);if(Jv.isFunction(e))return e.call(this,t,n);if(Jv.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Ey(t)){const n=Jv.findKey(this,t);return!(!n||void 0===this[n]||e&&!Sy(0,this[n],n,e))}return!1}delete(t,e){const n=this;let r=!1;function i(t){if(t=Ey(t)){const i=Jv.findKey(n,t);!i||e&&!Sy(0,n[i],i,e)||(delete n[i],r=!0)}}return Jv.isArray(t)?t.forEach(i):i(t),r}clear(t){const e=Object.keys(this);let n=e.length,r=!1;for(;n--;){const i=e[n];t&&!Sy(0,this[i],i,t,!0)||(delete this[i],r=!0)}return r}normalize(t){const e=this,n={};return Jv.forEach(this,(r,i)=>{const s=Jv.findKey(n,i);if(s)return e[s]=Ay(r),void delete e[i];const a=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}(i):String(i).trim();a!==i&&delete e[i],e[a]=Ay(r),n[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return Jv.forEach(this,(n,r)=>{null!=n&&!1!==n&&(e[r]=t&&Jv.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach(t=>n.set(t)),n}static accessor(t){const e=(this[xy]=this[xy]={accessors:{}}).accessors,n=this.prototype;function r(t){const r=Ey(t);e[r]||(!function(t,e){const n=Jv.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(t,n,i){return this[r].call(this,e,t,n,i)},configurable:!0})})}(n,t),e[r]=!0)}return Jv.isArray(t)?t.forEach(r):r(t),this}};function Ty(t,e){const n=this||wy,r=e||n,i=My.from(r.headers);let s=r.data;return Jv.forEach(t,function(t){s=t.call(n,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function Ry(t){return!(!t||!t.__CANCEL__)}function Cy(t,e,n){Qv.call(this,null==t?"canceled":t,Qv.ERR_CANCELED,e,n),this.name="CanceledError"}function Py(t,e,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?e(new Qv("Request failed with status code "+n.status,[Qv.ERR_BAD_REQUEST,Qv.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}My.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Jv.reduceDescriptors(My.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[n]=t}}}),Jv.freezeMethods(My),Jv.inherits(Cy,Qv,{__CANCEL__:!0});const Ny=(t,e,n=3)=>{let r=0;const i=function(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i,s=0,a=0;return e=void 0!==e?e:1e3,function(o){const l=Date.now(),c=r[a];i||(i=l),n[s]=o,r[s]=l;let u=a,h=0;for(;u!==s;)h+=n[u++],u%=t;if(s=(s+1)%t,s===a&&(a=(a+1)%t),l-i<e)return;const d=c&&l-c;return d?Math.round(1e3*h/d):void 0}}(50,250);return function(t,e){let n,r,i=0,s=1e3/e;const a=(e,s=Date.now())=>{i=s,n=null,r&&(clearTimeout(r),r=null),t(...e)};return[(...t)=>{const e=Date.now(),o=e-i;o>=s?a(t,e):(n=t,r||(r=setTimeout(()=>{r=null,a(n)},s-o)))},()=>n&&a(n)]}(n=>{const s=n.loaded,a=n.lengthComputable?n.total:void 0,o=s-r,l=i(o);r=s;t({loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:l||void 0,estimated:l&&a&&s<=a?(a-s)/l:void 0,event:n,lengthComputable:null!=a,[e?"download":"upload"]:!0})},n)},Oy=(t,e)=>{const n=null!=t;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},Iy=t=>(...e)=>Jv.asap(()=>t(...e)),Dy=yy.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,yy.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(yy.origin),yy.navigator&&/(msie|trident)/i.test(yy.navigator.userAgent)):()=>!0,Uy=yy.hasStandardBrowserEnv?{write(t,e,n,r,i,s,a){if("undefined"==typeof document)return;const o=[`${t}=${encodeURIComponent(e)}`];Jv.isNumber(n)&&o.push(`expires=${new Date(n).toUTCString()}`),Jv.isString(r)&&o.push(`path=${r}`),Jv.isString(i)&&o.push(`domain=${i}`),!0===s&&o.push("secure"),Jv.isString(a)&&o.push(`SameSite=${a}`),document.cookie=o.join("; ")},read(t){if("undefined"==typeof document)return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function Ly(t,e,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return t&&(r||0==n)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const Fy=t=>t instanceof My?{...t}:t;function ky(t,e){e=e||{};const n={};function r(t,e,n,r){return Jv.isPlainObject(t)&&Jv.isPlainObject(e)?Jv.merge.call({caseless:r},t,e):Jv.isPlainObject(e)?Jv.merge({},e):Jv.isArray(e)?e.slice():e}function i(t,e,n,i){return Jv.isUndefined(e)?Jv.isUndefined(t)?void 0:r(void 0,t,0,i):r(t,e,0,i)}function s(t,e){if(!Jv.isUndefined(e))return r(void 0,e)}function a(t,e){return Jv.isUndefined(e)?Jv.isUndefined(t)?void 0:r(void 0,t):r(void 0,e)}function o(n,i,s){return s in e?r(n,i):s in t?r(void 0,n):void 0}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(t,e,n)=>i(Fy(t),Fy(e),0,!0)};return Jv.forEach(Object.keys({...t,...e}),function(r){const s=l[r]||i,a=s(t[r],e[r],r);Jv.isUndefined(a)&&s!==o||(n[r]=a)}),n}const By=t=>{const e=ky({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:a,auth:o}=e;if(e.headers=a=My.from(a),e.url=cy(Ly(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Jv.isFormData(n))if(yy.hasStandardBrowserEnv||yy.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(Jv.isFunction(n.getHeaders)){const t=n.getHeaders(),e=["content-type","content-length"];Object.entries(t).forEach(([t,n])=>{e.includes(t.toLowerCase())&&a.set(t,n)})}if(yy.hasStandardBrowserEnv&&(r&&Jv.isFunction(r)&&(r=r(e)),r||!1!==r&&Dy(e.url))){const t=i&&s&&Uy.read(s);t&&a.set(i,t)}return e},zy="undefined"!=typeof XMLHttpRequest&&function(t){return new Promise(function(e,n){const r=By(t);let i=r.data;const s=My.from(r.headers).normalize();let a,o,l,c,u,{responseType:h,onUploadProgress:d,onDownloadProgress:f}=r;function p(){c&&c(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(a),r.signal&&r.signal.removeEventListener("abort",a)}let m=new XMLHttpRequest;function g(){if(!m)return;const r=My.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());Py(function(t){e(t),p()},function(t){n(t),p()},{data:h&&"text"!==h&&"json"!==h?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:t,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new Qv("Request aborted",Qv.ECONNABORTED,t,m)),m=null)},m.onerror=function(e){const r=new Qv(e&&e.message?e.message:"Network Error",Qv.ERR_NETWORK,t,m);r.event=e||null,n(r),m=null},m.ontimeout=function(){let e=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const i=r.transitional||hy;r.timeoutErrorMessage&&(e=r.timeoutErrorMessage),n(new Qv(e,i.clarifyTimeoutError?Qv.ETIMEDOUT:Qv.ECONNABORTED,t,m)),m=null},void 0===i&&s.setContentType(null),"setRequestHeader"in m&&Jv.forEach(s.toJSON(),function(t,e){m.setRequestHeader(e,t)}),Jv.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),h&&"json"!==h&&(m.responseType=r.responseType),f&&([l,u]=Ny(f,!0),m.addEventListener("progress",l)),d&&m.upload&&([o,c]=Ny(d),m.upload.addEventListener("progress",o),m.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(a=e=>{m&&(n(!e||e.type?new Cy(null,t,m):e),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(a),r.signal&&(r.signal.aborted?a():r.signal.addEventListener("abort",a)));const v=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(r.url);v&&-1===yy.protocols.indexOf(v)?n(new Qv("Unsupported protocol "+v+":",Qv.ERR_BAD_REQUEST,t)):m.send(i||null)})},Hy=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let n,r=new AbortController;const i=function(t){if(!n){n=!0,a();const e=t instanceof Error?t:this.reason;r.abort(e instanceof Qv?e:new Cy(e instanceof Error?e.message:e))}};let s=e&&setTimeout(()=>{s=null,i(new Qv(`timeout ${e} of ms exceeded`,Qv.ETIMEDOUT))},e);const a=()=>{t&&(s&&clearTimeout(s),s=null,t.forEach(t=>{t.unsubscribe?t.unsubscribe(i):t.removeEventListener("abort",i)}),t=null)};t.forEach(t=>t.addEventListener("abort",i));const{signal:o}=r;return o.unsubscribe=()=>Jv.asap(a),o}},Gy=function*(t,e){let n=t.byteLength;if(n<e)return void(yield t);let r,i=0;for(;i<n;)r=i+e,yield t.slice(i,r),i=r},Vy=async function*(t){if(t[Symbol.asyncIterator])return void(yield*t);const e=t.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}},jy=(t,e,n,r)=>{const i=async function*(t,e){for await(const n of Vy(t))yield*Gy(n,e)}(t,e);let s,a=0,o=t=>{s||(s=!0,r&&r(t))};return new ReadableStream({async pull(t){try{const{done:e,value:r}=await i.next();if(e)return o(),void t.close();let s=r.byteLength;if(n){let t=a+=s;n(t)}t.enqueue(new Uint8Array(r))}catch(e){throw o(e),e}},cancel:t=>(o(t),i.return())},{highWaterMark:2})},{isFunction:Wy}=Jv,qy=(({Request:t,Response:e})=>({Request:t,Response:e}))(Jv.global),{ReadableStream:Xy,TextEncoder:Ky}=Jv.global,Yy=(t,...e)=>{try{return!!t(...e)}catch(Es){return!1}},Jy=t=>{t=Jv.merge.call({skipUndefined:!0},qy,t);const{fetch:e,Request:n,Response:r}=t,i=e?Wy(e):"function"==typeof fetch,s=Wy(n),a=Wy(r);if(!i)return!1;const o=i&&Wy(Xy),l=i&&("function"==typeof Ky?(t=>e=>t.encode(e))(new Ky):async t=>new Uint8Array(await new n(t).arrayBuffer())),c=s&&o&&Yy(()=>{let t=!1;const e=new n(yy.origin,{body:new Xy,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),u=a&&o&&Yy(()=>Jv.isReadableStream(new r("").body)),h={stream:u&&(t=>t.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!h[t]&&(h[t]=(e,n)=>{let r=e&&e[t];if(r)return r.call(e);throw new Qv(`Response type '${t}' is not supported`,Qv.ERR_NOT_SUPPORT,n)})});const d=async(t,e)=>{const r=Jv.toFiniteNumber(t.getContentLength());return null==r?(async t=>{if(null==t)return 0;if(Jv.isBlob(t))return t.size;if(Jv.isSpecCompliantForm(t)){const e=new n(yy.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return Jv.isArrayBufferView(t)||Jv.isArrayBuffer(t)?t.byteLength:(Jv.isURLSearchParams(t)&&(t+=""),Jv.isString(t)?(await l(t)).byteLength:void 0)})(e):r};return async t=>{let{url:i,method:a,data:o,signal:l,cancelToken:f,timeout:p,onDownloadProgress:m,onUploadProgress:g,responseType:v,headers:y,withCredentials:b="same-origin",fetchOptions:w}=By(t),_=e||fetch;v=v?(v+"").toLowerCase():"text";let x=Hy([l,f&&f.toAbortSignal()],p),E=null;const A=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let S;try{if(g&&c&&"get"!==a&&"head"!==a&&0!==(S=await d(y,o))){let t,e=new n(i,{method:"POST",body:o,duplex:"half"});if(Jv.isFormData(o)&&(t=e.headers.get("content-type"))&&y.setContentType(t),e.body){const[t,n]=Oy(S,Ny(Iy(g)));o=jy(e.body,65536,t,n)}}Jv.isString(b)||(b=b?"include":"omit");const e=s&&"credentials"in n.prototype,l={...w,signal:x,method:a.toUpperCase(),headers:y.normalize().toJSON(),body:o,duplex:"half",credentials:e?b:void 0};E=s&&new n(i,l);let f=await(s?_(E,w):_(i,l));const p=u&&("stream"===v||"response"===v);if(u&&(m||p&&A)){const t={};["status","statusText","headers"].forEach(e=>{t[e]=f[e]});const e=Jv.toFiniteNumber(f.headers.get("content-length")),[n,i]=m&&Oy(e,Ny(Iy(m),!0))||[];f=new r(jy(f.body,65536,n,()=>{i&&i(),A&&A()}),t)}v=v||"text";let M=await h[Jv.findKey(h,v)||"text"](f,t);return!p&&A&&A(),await new Promise((e,n)=>{Py(e,n,{data:M,headers:My.from(f.headers),status:f.status,statusText:f.statusText,config:t,request:E})})}catch(M){if(A&&A(),M&&"TypeError"===M.name&&/Load failed|fetch/i.test(M.message))throw Object.assign(new Qv("Network Error",Qv.ERR_NETWORK,t,E),{cause:M.cause||M});throw Qv.from(M,M&&M.code,t,E)}}},Qy=new Map,Zy=t=>{let e=t&&t.env||{};const{fetch:n,Request:r,Response:i}=e,s=[r,i,n];let a,o,l=s.length,c=Qy;for(;l--;)a=s[l],o=c.get(a),void 0===o&&c.set(a,o=l?new Map:Jy(e)),c=o;return o};Zy();const $y={http:null,xhr:zy,fetch:{get:Zy}};Jv.forEach($y,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(Es){}Object.defineProperty(t,"adapterName",{value:e})}});const tb=t=>`- ${t}`,eb=t=>Jv.isFunction(t)||null===t||!1===t;const nb={getAdapter:function(t,e){t=Jv.isArray(t)?t:[t];const{length:n}=t;let r,i;const s={};for(let a=0;a<n;a++){let n;if(r=t[a],i=r,!eb(r)&&(i=$y[(n=String(r)).toLowerCase()],void 0===i))throw new Qv(`Unknown adapter '${n}'`);if(i&&(Jv.isFunction(i)||(i=i.get(e))))break;s[n||"#"+a]=i}if(!i){const t=Object.entries(s).map(([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build"));throw new Qv("There is no suitable adapter to dispatch the request "+(n?t.length>1?"since :\n"+t.map(tb).join("\n"):" "+tb(t[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return i},adapters:$y};function rb(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Cy(null,t)}function ib(t){rb(t),t.headers=My.from(t.headers),t.data=Ty.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return nb.getAdapter(t.adapter||wy.adapter,t)(t).then(function(e){return rb(t),e.data=Ty.call(t,t.transformResponse,e),e.headers=My.from(e.headers),e},function(e){return Ry(e)||(rb(t),e&&e.response&&(e.response.data=Ty.call(t,t.transformResponse,e.response),e.response.headers=My.from(e.response.headers))),Promise.reject(e)})}const sb="1.13.2",ab={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{ab[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const ob={};ab.transitional=function(t,e,n){function r(t,e){return"[Axios v"+sb+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,i,s)=>{if(!1===t)throw new Qv(r(i," has been removed"+(e?" in "+e:"")),Qv.ERR_DEPRECATED);return e&&!ob[i]&&(ob[i]=!0,console.warn(r(i," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,i,s)}},ab.spelling=function(t){return(e,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};const lb={assertOptions:function(t,e,n){if("object"!=typeof t)throw new Qv("options must be an object",Qv.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const s=r[i],a=e[s];if(a){const e=t[s],n=void 0===e||a(e,s,t);if(!0!==n)throw new Qv("option "+s+" must be "+n,Qv.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new Qv("Unknown option "+s,Qv.ERR_BAD_OPTION)}},validators:ab},cb=lb.validators;let ub=class{constructor(t){this.defaults=t||{},this.interceptors={request:new uy,response:new uy}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const e=t.stack?t.stack.replace(/^.+\n/,""):"";try{n.stack?e&&!String(n.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+e):n.stack=e}catch(Es){}}throw n}}_request(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},e=ky(this.defaults,e);const{transitional:n,paramsSerializer:r,headers:i}=e;void 0!==n&&lb.assertOptions(n,{silentJSONParsing:cb.transitional(cb.boolean),forcedJSONParsing:cb.transitional(cb.boolean),clarifyTimeoutError:cb.transitional(cb.boolean)},!1),null!=r&&(Jv.isFunction(r)?e.paramsSerializer={serialize:r}:lb.assertOptions(r,{encode:cb.function,serialize:cb.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),lb.assertOptions(e,{baseUrl:cb.spelling("baseURL"),withXsrfToken:cb.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let s=i&&Jv.merge(i.common,i[e.method]);i&&Jv.forEach(["delete","get","head","post","put","patch","common"],t=>{delete i[t]}),e.headers=My.concat(s,i);const a=[];let o=!0;this.interceptors.request.forEach(function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(o=o&&t.synchronous,a.unshift(t.fulfilled,t.rejected))});const l=[];let c;this.interceptors.response.forEach(function(t){l.push(t.fulfilled,t.rejected)});let u,h=0;if(!o){const t=[ib.bind(this),void 0];for(t.unshift(...a),t.push(...l),u=t.length,c=Promise.resolve(e);h<u;)c=c.then(t[h++],t[h++]);return c}u=a.length;let d=e;for(;h<u;){const t=a[h++],e=a[h++];try{d=t(d)}catch(f){e.call(this,f);break}}try{c=ib.call(this,d)}catch(f){return Promise.reject(f)}for(h=0,u=l.length;h<u;)c=c.then(l[h++],l[h++]);return c}getUri(t){return cy(Ly((t=ky(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}};Jv.forEach(["delete","get","head","options"],function(t){ub.prototype[t]=function(e,n){return this.request(ky(n||{},{method:t,url:e,data:(n||{}).data}))}}),Jv.forEach(["post","put","patch"],function(t){function e(e){return function(n,r,i){return this.request(ky(i||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}ub.prototype[t]=e(),ub.prototype[t+"Form"]=e(!0)});const hb={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(hb).forEach(([t,e])=>{hb[e]=t});const db=function t(e){const n=new ub(e),r=lv(ub.prototype.request,n);return Jv.extend(r,ub.prototype,n,{allOwnKeys:!0}),Jv.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return t(ky(e,n))},r}(wy);db.Axios=ub,db.CanceledError=Cy,db.CancelToken=class t{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(t){e=t});const n=this;this.promise.then(t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null}),this.promise.then=t=>{let e;const r=new Promise(t=>{n.subscribe(t),e=t}).then(t);return r.cancel=function(){n.unsubscribe(e)},r},t(function(t,r,i){n.reason||(n.reason=new Cy(t,r,i),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let e;return{token:new t(function(t){e=t}),cancel:e}}},db.isCancel=Ry,db.VERSION=sb,db.toFormData=iy,db.AxiosError=Qv,db.Cancel=db.CanceledError,db.all=function(t){return Promise.all(t)},db.spread=function(t){return function(e){return t.apply(null,e)}},db.isAxiosError=function(t){return Jv.isObject(t)&&!0===t.isAxiosError},db.mergeConfig=ky,db.AxiosHeaders=My,db.formToJSON=t=>by(Jv.isHTMLForm(t)?new FormData(t):t),db.getAdapter=nb.getAdapter,db.HttpStatusCode=hb,db.default=db;const{Axios:fb,AxiosError:pb,CanceledError:mb,isCancel:gb,CancelToken:vb,VERSION:yb,all:bb,Cancel:wb,isAxiosError:_b,spread:xb,toFormData:Eb,AxiosHeaders:Ab,HttpStatusCode:Sb,formToJSON:Mb,getAdapter:Tb,mergeConfig:Rb}=db;var Cb,Pb,Nb=9e15,Ob=1e9,Ib="0123456789abcdef",Db="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ub="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Lb={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Nb,maxE:Nb,crypto:!1},Fb=!0,kb="[DecimalError] ",Bb=kb+"Invalid argument: ",zb=kb+"Precision limit exceeded",Hb=kb+"crypto unavailable",Gb="[object Decimal]",Vb=Math.floor,jb=Math.pow,Wb=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,qb=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Xb=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Kb=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Yb=1e7,Jb=Db.length-1,Qb=Ub.length-1,Zb={toStringTag:Gb};function $b(t){var e,n,r,i=t.length-1,s="",a=t[0];if(i>0){for(s+=a,e=1;e<i;e++)(n=7-(r=t[e]+"").length)&&(s+=uw(n)),s+=r;(n=7-(r=(a=t[e])+"").length)&&(s+=uw(n))}else if(0===a)return"0";for(;a%10==0;)a/=10;return s+a}function tw(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Bb+t)}function ew(t,e,n,r){var i,s,a,o;for(s=t[0];s>=10;s/=10)--e;return--e<0?(e+=7,i=0):(i=Math.ceil((e+1)/7),e%=7),s=jb(10,7-e),o=t[i]%s|0,null==r?e<3?(0==e?o=o/100|0:1==e&&(o=o/10|0),a=n<4&&99999==o||n>3&&49999==o||5e4==o||0==o):a=(n<4&&o+1==s||n>3&&o+1==s/2)&&(t[i+1]/s/100|0)==jb(10,e-2)-1||(o==s/2||0==o)&&!(t[i+1]/s/100|0):e<4?(0==e?o=o/1e3|0:1==e?o=o/100|0:2==e&&(o=o/10|0),a=(r||n<4)&&9999==o||!r&&n>3&&4999==o):a=((r||n<4)&&o+1==s||!r&&n>3&&o+1==s/2)&&(t[i+1]/s/1e3|0)==jb(10,e-3)-1,a}function nw(t,e,n){for(var r,i,s=[0],a=0,o=t.length;a<o;){for(i=s.length;i--;)s[i]*=e;for(s[0]+=Ib.indexOf(t.charAt(a++)),r=0;r<s.length;r++)s[r]>n-1&&(void 0===s[r+1]&&(s[r+1]=0),s[r+1]+=s[r]/n|0,s[r]%=n)}return s.reverse()}Zb.absoluteValue=Zb.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),iw(t)},Zb.ceil=function(){return iw(new this.constructor(this),this.e+1,2)},Zb.clampedTo=Zb.clamp=function(t,e){var n=this,r=n.constructor;if(t=new r(t),e=new r(e),!t.s||!e.s)return new r(NaN);if(t.gt(e))throw Error(Bb+e);return n.cmp(t)<0?t:n.cmp(e)>0?e:new r(n)},Zb.comparedTo=Zb.cmp=function(t){var e,n,r,i,s=this,a=s.d,o=(t=new s.constructor(t)).d,l=s.s,c=t.s;if(!a||!o)return l&&c?l!==c?l:a===o?0:!a^l<0?1:-1:NaN;if(!a[0]||!o[0])return a[0]?l:o[0]?-c:0;if(l!==c)return l;if(s.e!==t.e)return s.e>t.e^l<0?1:-1;for(e=0,n=(r=a.length)<(i=o.length)?r:i;e<n;++e)if(a[e]!==o[e])return a[e]>o[e]^l<0?1:-1;return r===i?0:r>i^l<0?1:-1},Zb.cosine=Zb.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(t,e){var n,r,i;if(e.isZero())return e;r=e.d.length,r<32?i=(1/bw(4,n=Math.ceil(r/3))).toString():(n=16,i="2.3283064365386962890625e-10");t.precision+=n,e=yw(t,1,e.times(i),new t(1));for(var s=n;s--;){var a=e.times(e);e=a.times(a).minus(a).times(8).plus(1)}return t.precision-=n,e}(r,ww(r,n)),r.precision=t,r.rounding=e,iw(2==Pb||3==Pb?n.neg():n,t,e,!0)):new r(1):new r(NaN)},Zb.cubeRoot=Zb.cbrt=function(){var t,e,n,r,i,s,a,o,l,c,u=this,h=u.constructor;if(!u.isFinite()||u.isZero())return new h(u);for(Fb=!1,(s=u.s*jb(u.s*u,1/3))&&Math.abs(s)!=1/0?r=new h(s.toString()):(n=$b(u.d),(s=((t=u.e)-n.length+1)%3)&&(n+=1==s||-2==s?"0":"00"),s=jb(n,1/3),t=Vb((t+1)/3)-(t%3==(t<0?-1:2)),(r=new h(n=s==1/0?"5e"+t:(n=s.toExponential()).slice(0,n.indexOf("e")+1)+t)).s=u.s),a=(t=h.precision)+3;;)if(c=(l=(o=r).times(o).times(o)).plus(u),r=rw(c.plus(u).times(o),c.plus(l),a+2,1),$b(o.d).slice(0,a)===(n=$b(r.d)).slice(0,a)){if("9999"!=(n=n.slice(a-3,a+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(iw(r,t+1,1),e=!r.times(r).times(r).eq(u));break}if(!i&&(iw(o,t+1,0),o.times(o).times(o).eq(u))){r=o;break}a+=4,i=1}return Fb=!0,iw(r,t,h.rounding,e)},Zb.decimalPlaces=Zb.dp=function(){var t,e=this.d,n=NaN;if(e){if(n=7*((t=e.length-1)-Vb(this.e/7)),t=e[t])for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n},Zb.dividedBy=Zb.div=function(t){return rw(this,new this.constructor(t))},Zb.dividedToIntegerBy=Zb.divToInt=function(t){var e=this.constructor;return iw(rw(this,new e(t),0,1,1),e.precision,e.rounding)},Zb.equals=Zb.eq=function(t){return 0===this.cmp(t)},Zb.floor=function(){return iw(new this.constructor(this),this.e+1,3)},Zb.greaterThan=Zb.gt=function(t){return this.cmp(t)>0},Zb.greaterThanOrEqualTo=Zb.gte=function(t){var e=this.cmp(t);return 1==e||0===e},Zb.hyperbolicCosine=Zb.cosh=function(){var t,e,n,r,i,s=this,a=s.constructor,o=new a(1);if(!s.isFinite())return new a(s.s?1/0:NaN);if(s.isZero())return o;n=a.precision,r=a.rounding,a.precision=n+Math.max(s.e,s.sd())+4,a.rounding=1,(i=s.d.length)<32?e=(1/bw(4,t=Math.ceil(i/3))).toString():(t=16,e="2.3283064365386962890625e-10"),s=yw(a,1,s.times(e),new a(1),!0);for(var l,c=t,u=new a(8);c--;)l=s.times(s),s=o.minus(l.times(u.minus(l.times(u))));return iw(s,a.precision=n,a.rounding=r,!0)},Zb.hyperbolicSine=Zb.sinh=function(){var t,e,n,r,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(e=s.precision,n=s.rounding,s.precision=e+Math.max(i.e,i.sd())+4,s.rounding=1,(r=i.d.length)<3)i=yw(s,2,i,i,!0);else{t=(t=1.4*Math.sqrt(r))>16?16:0|t,i=yw(s,2,i=i.times(1/bw(5,t)),i,!0);for(var a,o=new s(5),l=new s(16),c=new s(20);t--;)a=i.times(i),i=i.times(o.plus(a.times(l.times(a).plus(c))))}return s.precision=e,s.rounding=n,iw(i,e,n,!0)},Zb.hyperbolicTangent=Zb.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,rw(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)},Zb.inverseCosine=Zb.acos=function(){var t=this,e=t.constructor,n=t.abs().cmp(1),r=e.precision,i=e.rounding;return-1!==n?0===n?t.isNeg()?lw(e,r,i):new e(0):new e(NaN):t.isZero()?lw(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,t=new e(1).minus(t).div(t.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,t.times(2))},Zb.inverseHyperbolicCosine=Zb.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,Fb=!1,n=n.times(n).minus(1).sqrt().plus(n),Fb=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)},Zb.inverseHyperbolicSine=Zb.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,Fb=!1,n=n.times(n).plus(1).sqrt().plus(n),Fb=!0,r.precision=t,r.rounding=e,n.ln())},Zb.inverseHyperbolicTangent=Zb.atanh=function(){var t,e,n,r,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=s.precision,e=s.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?iw(new s(i),t,e,!0):(s.precision=n=r-i.e,i=rw(i.plus(1),new s(1).minus(i),n+t,1),s.precision=t+4,s.rounding=1,i=i.ln(),s.precision=t,s.rounding=e,i.times(.5))):new s(NaN)},Zb.inverseSine=Zb.asin=function(){var t,e,n,r,i=this,s=i.constructor;return i.isZero()?new s(i):(e=i.abs().cmp(1),n=s.precision,r=s.rounding,-1!==e?0===e?((t=lw(s,n+4,r).times(.5)).s=i.s,t):new s(NaN):(s.precision=n+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=n,s.rounding=r,i.times(2)))},Zb.inverseTangent=Zb.atan=function(){var t,e,n,r,i,s,a,o,l,c=this,u=c.constructor,h=u.precision,d=u.rounding;if(c.isFinite()){if(c.isZero())return new u(c);if(c.abs().eq(1)&&h+4<=Qb)return(a=lw(u,h+4,d).times(.25)).s=c.s,a}else{if(!c.s)return new u(NaN);if(h+4<=Qb)return(a=lw(u,h+4,d).times(.5)).s=c.s,a}for(u.precision=o=h+10,u.rounding=1,t=n=Math.min(28,o/7+2|0);t;--t)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(Fb=!1,e=Math.ceil(o/7),r=1,l=c.times(c),a=new u(c),i=c;-1!==t;)if(i=i.times(l),s=a.minus(i.div(r+=2)),i=i.times(l),void 0!==(a=s.plus(i.div(r+=2))).d[e])for(t=e;a.d[t]===s.d[t]&&t--;);return n&&(a=a.times(2<<n-1)),Fb=!0,iw(a,u.precision=h,u.rounding=d,!0)},Zb.isFinite=function(){return!!this.d},Zb.isInteger=Zb.isInt=function(){return!!this.d&&Vb(this.e/7)>this.d.length-2},Zb.isNaN=function(){return!this.s},Zb.isNegative=Zb.isNeg=function(){return this.s<0},Zb.isPositive=Zb.isPos=function(){return this.s>0},Zb.isZero=function(){return!!this.d&&0===this.d[0]},Zb.lessThan=Zb.lt=function(t){return this.cmp(t)<0},Zb.lessThanOrEqualTo=Zb.lte=function(t){return this.cmp(t)<1},Zb.logarithm=Zb.log=function(t){var e,n,r,i,s,a,o,l,c=this,u=c.constructor,h=u.precision,d=u.rounding;if(null==t)t=new u(10),e=!0;else{if(n=(t=new u(t)).d,t.s<0||!n||!n[0]||t.eq(1))return new u(NaN);e=t.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new u(n&&!n[0]?-1/0:1!=c.s?NaN:n?0:1/0);if(e)if(n.length>1)s=!0;else{for(i=n[0];i%10==0;)i/=10;s=1!==i}if(Fb=!1,a=mw(c,o=h+5),r=e?ow(u,o+10):mw(t,o),ew((l=rw(a,r,o,1)).d,i=h,d))do{if(a=mw(c,o+=10),r=e?ow(u,o+10):mw(t,o),l=rw(a,r,o,1),!s){+$b(l.d).slice(i+1,i+15)+1==1e14&&(l=iw(l,h+1,0));break}}while(ew(l.d,i+=10,d));return Fb=!0,iw(l,h,d)},Zb.minus=Zb.sub=function(t){var e,n,r,i,s,a,o,l,c,u,h,d,f=this,p=f.constructor;if(t=new p(t),!f.d||!t.d)return f.s&&t.s?f.d?t.s=-t.s:t=new p(t.d||f.s!==t.s?f:NaN):t=new p(NaN),t;if(f.s!=t.s)return t.s=-t.s,f.plus(t);if(c=f.d,d=t.d,o=p.precision,l=p.rounding,!c[0]||!d[0]){if(d[0])t.s=-t.s;else{if(!c[0])return new p(3===l?-0:0);t=new p(f)}return Fb?iw(t,o,l):t}if(n=Vb(t.e/7),u=Vb(f.e/7),c=c.slice(),s=u-n){for((h=s<0)?(e=c,s=-s,a=d.length):(e=d,n=u,a=c.length),s>(r=Math.max(Math.ceil(o/7),a)+2)&&(s=r,e.length=1),e.reverse(),r=s;r--;)e.push(0);e.reverse()}else{for((h=(r=c.length)<(a=d.length))&&(a=r),r=0;r<a;r++)if(c[r]!=d[r]){h=c[r]<d[r];break}s=0}for(h&&(e=c,c=d,d=e,t.s=-t.s),a=c.length,r=d.length-a;r>0;--r)c[a++]=0;for(r=d.length;r>s;){if(c[--r]<d[r]){for(i=r;i&&0===c[--i];)c[i]=Yb-1;--c[i],c[r]+=Yb}c[r]-=d[r]}for(;0===c[--a];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(t.d=c,t.e=aw(c,n),Fb?iw(t,o,l):t):new p(3===l?-0:0)},Zb.modulo=Zb.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?iw(new r(n),r.precision,r.rounding):(Fb=!1,9==r.modulo?(e=rw(n,t.abs(),0,3,1)).s*=t.s:e=rw(n,t,0,r.modulo,1),e=e.times(t),Fb=!0,n.minus(e))},Zb.naturalExponential=Zb.exp=function(){return pw(this)},Zb.naturalLogarithm=Zb.ln=function(){return mw(this)},Zb.negated=Zb.neg=function(){var t=new this.constructor(this);return t.s=-t.s,iw(t)},Zb.plus=Zb.add=function(t){var e,n,r,i,s,a,o,l,c,u,h=this,d=h.constructor;if(t=new d(t),!h.d||!t.d)return h.s&&t.s?h.d||(t=new d(t.d||h.s===t.s?h:NaN)):t=new d(NaN),t;if(h.s!=t.s)return t.s=-t.s,h.minus(t);if(c=h.d,u=t.d,o=d.precision,l=d.rounding,!c[0]||!u[0])return u[0]||(t=new d(h)),Fb?iw(t,o,l):t;if(s=Vb(h.e/7),r=Vb(t.e/7),c=c.slice(),i=s-r){for(i<0?(n=c,i=-i,a=u.length):(n=u,r=s,a=c.length),i>(a=(s=Math.ceil(o/7))>a?s+1:a+1)&&(i=a,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((a=c.length)-(i=u.length)<0&&(i=a,n=u,u=c,c=n),e=0;i;)e=(c[--i]=c[i]+u[i]+e)/Yb|0,c[i]%=Yb;for(e&&(c.unshift(e),++r),a=c.length;0==c[--a];)c.pop();return t.d=c,t.e=aw(c,r),Fb?iw(t,o,l):t},Zb.precision=Zb.sd=function(t){var e,n=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(Bb+t);return n.d?(e=cw(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e},Zb.round=function(){var t=this,e=t.constructor;return iw(new e(t),t.e+1,e.rounding)},Zb.sine=Zb.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(t,e){var n,r=e.d.length;if(r<3)return e.isZero()?e:yw(t,2,e,e);n=(n=1.4*Math.sqrt(r))>16?16:0|n,e=e.times(1/bw(5,n)),e=yw(t,2,e,e);for(var i,s=new t(5),a=new t(16),o=new t(20);n--;)i=e.times(e),e=e.times(s.plus(i.times(a.times(i).minus(o))));return e}(r,ww(r,n)),r.precision=t,r.rounding=e,iw(Pb>2?n.neg():n,t,e,!0)):new r(NaN)},Zb.squareRoot=Zb.sqrt=function(){var t,e,n,r,i,s,a=this,o=a.d,l=a.e,c=a.s,u=a.constructor;if(1!==c||!o||!o[0])return new u(!c||c<0&&(!o||o[0])?NaN:o?a:1/0);for(Fb=!1,0==(c=Math.sqrt(+a))||c==1/0?(((e=$b(o)).length+l)%2==0&&(e+="0"),c=Math.sqrt(e),l=Vb((l+1)/2)-(l<0||l%2),r=new u(e=c==1/0?"5e"+l:(e=c.toExponential()).slice(0,e.indexOf("e")+1)+l)):r=new u(c.toString()),n=(l=u.precision)+3;;)if(r=(s=r).plus(rw(a,s,n+2,1)).times(.5),$b(s.d).slice(0,n)===(e=$b(r.d)).slice(0,n)){if("9999"!=(e=e.slice(n-3,n+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(iw(r,l+1,1),t=!r.times(r).eq(a));break}if(!i&&(iw(s,l+1,0),s.times(s).eq(a))){r=s;break}n+=4,i=1}return Fb=!0,iw(r,l,u.rounding,t)},Zb.tangent=Zb.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,(n=n.sin()).s=1,n=rw(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,iw(2==Pb||4==Pb?n.neg():n,t,e,!0)):new r(NaN)},Zb.times=Zb.mul=function(t){var e,n,r,i,s,a,o,l,c,u=this,h=u.constructor,d=u.d,f=(t=new h(t)).d;if(t.s*=u.s,!(d&&d[0]&&f&&f[0]))return new h(!t.s||d&&!d[0]&&!f||f&&!f[0]&&!d?NaN:d&&f?0*t.s:t.s/0);for(n=Vb(u.e/7)+Vb(t.e/7),(l=d.length)<(c=f.length)&&(s=d,d=f,f=s,a=l,l=c,c=a),s=[],r=a=l+c;r--;)s.push(0);for(r=c;--r>=0;){for(e=0,i=l+r;i>r;)o=s[i]+f[r]*d[i-r-1]+e,s[i--]=o%Yb|0,e=o/Yb|0;s[i]=(s[i]+e)%Yb|0}for(;!s[--a];)s.pop();return e?++n:s.shift(),t.d=s,t.e=aw(s,n),Fb?iw(t,h.precision,h.rounding):t},Zb.toBinary=function(t,e){return _w(this,2,t,e)},Zb.toDecimalPlaces=Zb.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),void 0===t?n:(tw(t,0,Ob),void 0===e?e=r.rounding:tw(e,0,8),iw(n,t+n.e+1,e))},Zb.toExponential=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=sw(r,!0):(tw(t,0,Ob),void 0===e?e=i.rounding:tw(e,0,8),n=sw(r=iw(new i(r),t+1,e),!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n},Zb.toFixed=function(t,e){var n,r,i=this,s=i.constructor;return void 0===t?n=sw(i):(tw(t,0,Ob),void 0===e?e=s.rounding:tw(e,0,8),n=sw(r=iw(new s(i),t+i.e+1,e),!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},Zb.toFraction=function(t){var e,n,r,i,s,a,o,l,c,u,h,d,f=this,p=f.d,m=f.constructor;if(!p)return new m(f);if(c=n=new m(1),r=l=new m(0),a=(s=(e=new m(r)).e=cw(p)-f.e-1)%7,e.d[0]=jb(10,a<0?7+a:a),null==t)t=s>0?e:c;else{if(!(o=new m(t)).isInt()||o.lt(c))throw Error(Bb+o);t=o.gt(e)?s>0?e:c:o}for(Fb=!1,o=new m($b(p)),u=m.precision,m.precision=s=7*p.length*2;h=rw(o,e,0,1,1),1!=(i=n.plus(h.times(r))).cmp(t);)n=r,r=i,i=c,c=l.plus(h.times(i)),l=i,i=e,e=o.minus(h.times(i)),o=i;return i=rw(t.minus(n),r,0,1,1),l=l.plus(i.times(c)),n=n.plus(i.times(r)),l.s=c.s=f.s,d=rw(c,r,s,1).minus(f).abs().cmp(rw(l,n,s,1).minus(f).abs())<1?[c,r]:[l,n],m.precision=u,Fb=!0,d},Zb.toHexadecimal=Zb.toHex=function(t,e){return _w(this,16,t,e)},Zb.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),null==t){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),void 0===e?e=r.rounding:tw(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(Fb=!1,n=rw(n,t,0,e,1).times(t),Fb=!0,iw(n)):(t.s=n.s,n=t),n},Zb.toNumber=function(){return+this},Zb.toOctal=function(t,e){return _w(this,8,t,e)},Zb.toPower=Zb.pow=function(t){var e,n,r,i,s,a,o=this,l=o.constructor,c=+(t=new l(t));if(!(o.d&&t.d&&o.d[0]&&t.d[0]))return new l(jb(+o,c));if((o=new l(o)).eq(1))return o;if(r=l.precision,s=l.rounding,t.eq(1))return iw(o,r,s);if((e=Vb(t.e/7))>=t.d.length-1&&(n=c<0?-c:c)<=9007199254740991)return i=hw(l,o,n,r),t.s<0?new l(1).div(i):iw(i,r,s);if((a=o.s)<0){if(e<t.d.length-1)return new l(NaN);if(1&t.d[e]||(a=1),0==o.e&&1==o.d[0]&&1==o.d.length)return o.s=a,o}return(e=0!=(n=jb(+o,c))&&isFinite(n)?new l(n+"").e:Vb(c*(Math.log("0."+$b(o.d))/Math.LN10+o.e+1)))>l.maxE+1||e<l.minE-1?new l(e>0?a/0:0):(Fb=!1,l.rounding=o.s=1,n=Math.min(12,(e+"").length),(i=pw(t.times(mw(o,r+n)),r)).d&&ew((i=iw(i,r+5,1)).d,r,s)&&(e=r+10,+$b((i=iw(pw(t.times(mw(o,e+n)),e),e+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=iw(i,r+1,0))),i.s=a,Fb=!0,l.rounding=s,iw(i,r,s))},Zb.toPrecision=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=sw(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(tw(t,1,Ob),void 0===e?e=i.rounding:tw(e,0,8),n=sw(r=iw(new i(r),t,e),t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n},Zb.toSignificantDigits=Zb.toSD=function(t,e){var n=this.constructor;return void 0===t?(t=n.precision,e=n.rounding):(tw(t,1,Ob),void 0===e?e=n.rounding:tw(e,0,8)),iw(new n(this),t,e)},Zb.toString=function(){var t=this,e=t.constructor,n=sw(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n},Zb.truncated=Zb.trunc=function(){return iw(new this.constructor(this),this.e+1,1)},Zb.valueOf=Zb.toJSON=function(){var t=this,e=t.constructor,n=sw(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};var rw=function(){function t(t,e,n){var r,i=0,s=t.length;for(t=t.slice();s--;)r=t[s]*e+i,t[s]=r%n|0,i=r/n|0;return i&&t.unshift(i),t}function e(t,e,n,r){var i,s;if(n!=r)s=n>r?1:-1;else for(i=s=0;i<n;i++)if(t[i]!=e[i]){s=t[i]>e[i]?1:-1;break}return s}function n(t,e,n,r){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*r+t[n]-e[n];for(;!t[0]&&t.length>1;)t.shift()}return function(r,i,s,a,o,l){var c,u,h,d,f,p,m,g,v,y,b,w,_,x,E,A,S,M,T,R,C=r.constructor,P=r.s==i.s?1:-1,N=r.d,O=i.d;if(!(N&&N[0]&&O&&O[0]))return new C(r.s&&i.s&&(N?!O||N[0]!=O[0]:O)?N&&0==N[0]||!O?0*P:P/0:NaN);for(l?(f=1,u=r.e-i.e):(l=Yb,f=7,u=Vb(r.e/f)-Vb(i.e/f)),T=O.length,S=N.length,y=(v=new C(P)).d=[],h=0;O[h]==(N[h]||0);h++);if(O[h]>(N[h]||0)&&u--,null==s?(x=s=C.precision,a=C.rounding):x=o?s+(r.e-i.e)+1:s,x<0)y.push(1),p=!0;else{if(x=x/f+2|0,h=0,1==T){for(d=0,O=O[0],x++;(h<S||d)&&x--;h++)E=d*l+(N[h]||0),y[h]=E/O|0,d=E%O|0;p=d||h<S}else{for((d=l/(O[0]+1)|0)>1&&(O=t(O,d,l),N=t(N,d,l),T=O.length,S=N.length),A=T,w=(b=N.slice(0,T)).length;w<T;)b[w++]=0;(R=O.slice()).unshift(0),M=O[0],O[1]>=l/2&&++M;do{d=0,(c=e(O,b,T,w))<0?(_=b[0],T!=w&&(_=_*l+(b[1]||0)),(d=_/M|0)>1?(d>=l&&(d=l-1),1==(c=e(m=t(O,d,l),b,g=m.length,w=b.length))&&(d--,n(m,T<g?R:O,g,l))):(0==d&&(c=d=1),m=O.slice()),(g=m.length)<w&&m.unshift(0),n(b,m,w,l),-1==c&&(c=e(O,b,T,w=b.length))<1&&(d++,n(b,T<w?R:O,w,l)),w=b.length):0===c&&(d++,b=[0]),y[h++]=d,c&&b[0]?b[w++]=N[A]||0:(b=[N[A]],w=1)}while((A++<S||void 0!==b[0])&&x--);p=void 0!==b[0]}y[0]||y.shift()}if(1==f)v.e=u,Cb=p;else{for(h=1,d=y[0];d>=10;d/=10)h++;v.e=h+u*f-1,iw(v,o?s+v.e+1:s,a,p)}return v}}();function iw(t,e,n,r){var i,s,a,o,l,c,u,h,d,f=t.constructor;t:if(null!=e){if(!(h=t.d))return t;for(i=1,o=h[0];o>=10;o/=10)i++;if((s=e-i)<0)s+=7,a=e,l=(u=h[d=0])/jb(10,i-a-1)%10|0;else if((d=Math.ceil((s+1)/7))>=(o=h.length)){if(!r)break t;for(;o++<=d;)h.push(0);u=l=0,i=1,a=(s%=7)-7+1}else{for(u=o=h[d],i=1;o>=10;o/=10)i++;l=(a=(s%=7)-7+i)<0?0:u/jb(10,i-a-1)%10|0}if(r=r||e<0||void 0!==h[d+1]||(a<0?u:u%jb(10,i-a-1)),c=n<4?(l||r)&&(0==n||n==(t.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(s>0?a>0?u/jb(10,i-a):0:h[d-1])%10&1||n==(t.s<0?8:7)),e<1||!h[0])return h.length=0,c?(e-=t.e+1,h[0]=jb(10,(7-e%7)%7),t.e=-e||0):h[0]=t.e=0,t;if(0==s?(h.length=d,o=1,d--):(h.length=d+1,o=jb(10,7-s),h[d]=a>0?(u/jb(10,i-a)%jb(10,a)|0)*o:0),c)for(;;){if(0==d){for(s=1,a=h[0];a>=10;a/=10)s++;for(a=h[0]+=o,o=1;a>=10;a/=10)o++;s!=o&&(t.e++,h[0]==Yb&&(h[0]=1));break}if(h[d]+=o,h[d]!=Yb)break;h[d--]=0,o=1}for(s=h.length;0===h[--s];)h.pop()}return Fb&&(t.e>f.maxE?(t.d=null,t.e=NaN):t.e<f.minE&&(t.e=0,t.d=[0])),t}function sw(t,e,n){if(!t.isFinite())return gw(t);var r,i=t.e,s=$b(t.d),a=s.length;return e?(n&&(r=n-a)>0?s=s.charAt(0)+"."+s.slice(1)+uw(r):a>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(t.e<0?"e":"e+")+t.e):i<0?(s="0."+uw(-i-1)+s,n&&(r=n-a)>0&&(s+=uw(r))):i>=a?(s+=uw(i+1-a),n&&(r=n-i-1)>0&&(s=s+"."+uw(r))):((r=i+1)<a&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-a)>0&&(i+1===a&&(s+="."),s+=uw(r))),s}function aw(t,e){var n=t[0];for(e*=7;n>=10;n/=10)e++;return e}function ow(t,e,n){if(e>Jb)throw Fb=!0,n&&(t.precision=n),Error(zb);return iw(new t(Db),e,1,!0)}function lw(t,e,n){if(e>Qb)throw Error(zb);return iw(new t(Ub),e,n,!0)}function cw(t){var e=t.length-1,n=7*e+1;if(e=t[e]){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function uw(t){for(var e="";t--;)e+="0";return e}function hw(t,e,n,r){var i,s=new t(1),a=Math.ceil(r/7+4);for(Fb=!1;;){if(n%2&&xw((s=s.times(e)).d,a)&&(i=!0),0===(n=Vb(n/2))){n=s.d.length-1,i&&0===s.d[n]&&++s.d[n];break}xw((e=e.times(e)).d,a)}return Fb=!0,s}function dw(t){return 1&t.d[t.d.length-1]}function fw(t,e,n){for(var r,i,s=new t(e[0]),a=0;++a<e.length;){if(!(i=new t(e[a])).s){s=i;break}((r=s.cmp(i))===n||0===r&&s.s===n)&&(s=i)}return s}function pw(t,e){var n,r,i,s,a,o,l,c=0,u=0,h=0,d=t.constructor,f=d.rounding,p=d.precision;if(!t.d||!t.d[0]||t.e>17)return new d(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(Fb=!1,l=p):l=e,o=new d(.03125);t.e>-2;)t=t.times(o),h+=5;for(l+=r=Math.log(jb(2,h))/Math.LN10*2+5|0,n=s=a=new d(1),d.precision=l;;){if(s=iw(s.times(t),l,1),n=n.times(++u),$b((o=a.plus(rw(s,n,l,1))).d).slice(0,l)===$b(a.d).slice(0,l)){for(i=h;i--;)a=iw(a.times(a),l,1);if(null!=e)return d.precision=p,a;if(!(c<3&&ew(a.d,l-r,f,c)))return iw(a,d.precision=p,f,Fb=!0);d.precision=l+=10,n=s=o=new d(1),u=0,c++}a=o}}function mw(t,e){var n,r,i,s,a,o,l,c,u,h,d,f=1,p=t,m=p.d,g=p.constructor,v=g.rounding,y=g.precision;if(p.s<0||!m||!m[0]||!p.e&&1==m[0]&&1==m.length)return new g(m&&!m[0]?-1/0:1!=p.s?NaN:m?0:p);if(null==e?(Fb=!1,u=y):u=e,g.precision=u+=10,r=(n=$b(m)).charAt(0),!(Math.abs(s=p.e)<15e14))return c=ow(g,u+2,y).times(s+""),p=mw(new g(r+"."+n.slice(1)),u-10).plus(c),g.precision=y,null==e?iw(p,y,v,Fb=!0):p;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=$b((p=p.times(t)).d)).charAt(0),f++;for(s=p.e,r>1?(p=new g("0."+n),s++):p=new g(r+"."+n.slice(1)),h=p,l=a=p=rw(p.minus(1),p.plus(1),u,1),d=iw(p.times(p),u,1),i=3;;){if(a=iw(a.times(d),u,1),$b((c=l.plus(rw(a,new g(i),u,1))).d).slice(0,u)===$b(l.d).slice(0,u)){if(l=l.times(2),0!==s&&(l=l.plus(ow(g,u+2,y).times(s+""))),l=rw(l,new g(f),u,1),null!=e)return g.precision=y,l;if(!ew(l.d,u-10,v,o))return iw(l,g.precision=y,v,Fb=!0);g.precision=u+=10,c=a=p=rw(h.minus(1),h.plus(1),u,1),d=iw(p.times(p),u,1),i=o=1}l=c,i+=2}}function gw(t){return String(t.s*t.s/0)}function vw(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;48===e.charCodeAt(r);r++);for(i=e.length;48===e.charCodeAt(i-1);--i);if(e=e.slice(r,i)){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%7,n<0&&(r+=7),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=7;r<i;)t.d.push(+e.slice(r,r+=7));r=7-(e=e.slice(r)).length}else r-=i;for(;r--;)e+="0";t.d.push(+e),Fb&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function yw(t,e,n,r,i){var s,a,o,l,c=t.precision,u=Math.ceil(c/7);for(Fb=!1,l=n.times(n),o=new t(r);;){if(a=rw(o.times(l),new t(e++*e++),c,1),o=i?r.plus(a):r.minus(a),r=rw(a.times(l),new t(e++*e++),c,1),void 0!==(a=o.plus(r)).d[u]){for(s=u;a.d[s]===o.d[s]&&s--;);if(-1==s)break}s=o,o=r,r=a,a=s}return Fb=!0,a.d.length=u+1,a}function bw(t,e){for(var n=t;--e;)n*=t;return n}function ww(t,e){var n,r=e.s<0,i=lw(t,t.precision,1),s=i.times(.5);if((e=e.abs()).lte(s))return Pb=r?4:1,e;if((n=e.divToInt(i)).isZero())Pb=r?3:2;else{if((e=e.minus(n.times(i))).lte(s))return Pb=dw(n)?r?2:3:r?4:1,e;Pb=dw(n)?r?1:4:r?3:2}return e.minus(i).abs()}function _w(t,e,n,r){var i,s,a,o,l,c,u,h,d,f=t.constructor,p=void 0!==n;if(p?(tw(n,1,Ob),void 0===r?r=f.rounding:tw(r,0,8)):(n=f.precision,r=f.rounding),t.isFinite()){for(p?(i=2,16==e?n=4*n-3:8==e&&(n=3*n-2)):i=e,(a=(u=sw(t)).indexOf("."))>=0&&(u=u.replace(".",""),(d=new f(1)).e=u.length-a,d.d=nw(sw(d),10,i),d.e=d.d.length),s=l=(h=nw(u,10,i)).length;0==h[--l];)h.pop();if(h[0]){if(a<0?s--:((t=new f(t)).d=h,t.e=s,h=(t=rw(t,d,n,r,0,i)).d,s=t.e,c=Cb),a=h[n],o=i/2,c=c||void 0!==h[n+1],c=r<4?(void 0!==a||c)&&(0===r||r===(t.s<0?3:2)):a>o||a===o&&(4===r||c||6===r&&1&h[n-1]||r===(t.s<0?8:7)),h.length=n,c)for(;++h[--n]>i-1;)h[n]=0,n||(++s,h.unshift(1));for(l=h.length;!h[l-1];--l);for(a=0,u="";a<l;a++)u+=Ib.charAt(h[a]);if(p){if(l>1)if(16==e||8==e){for(a=16==e?4:3,--l;l%a;l++)u+="0";for(l=(h=nw(u,i,e)).length;!h[l-1];--l);for(a=1,u="1.";a<l;a++)u+=Ib.charAt(h[a])}else u=u.charAt(0)+"."+u.slice(1);u=u+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)u="0"+u;u="0."+u}else if(++s>l)for(s-=l;s--;)u+="0";else s<l&&(u=u.slice(0,s)+"."+u.slice(s))}else u=p?"0p+0":"0";u=(16==e?"0x":2==e?"0b":8==e?"0o":"")+u}else u=gw(t);return t.s<0?"-"+u:u}function xw(t,e){if(t.length>e)return t.length=e,!0}function Ew(t){return new this(t).abs()}function Aw(t){return new this(t).acos()}function Sw(t){return new this(t).acosh()}function Mw(t,e){return new this(t).plus(e)}function Tw(t){return new this(t).asin()}function Rw(t){return new this(t).asinh()}function Cw(t){return new this(t).atan()}function Pw(t){return new this(t).atanh()}function Nw(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,s=r+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(n=e.s<0?lw(this,r,i):new this(0)).s=t.s:!t.d||e.isZero()?(n=lw(this,s,1).times(.5)).s=t.s:e.s<0?(this.precision=s,this.rounding=1,n=this.atan(rw(t,e,s,1)),e=lw(this,s,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(rw(t,e,s,1)):(n=lw(this,s,1).times(e.s>0?.25:.75)).s=t.s:n=new this(NaN),n}function Ow(t){return new this(t).cbrt()}function Iw(t){return iw(t=new this(t),t.e+1,2)}function Dw(t,e,n){return new this(t).clamp(e,n)}function Uw(t){if(!t||"object"!=typeof t)throw Error(kb+"Object expected");var e,n,r,i=!0===t.defaults,s=["precision",1,Ob,"rounding",0,8,"toExpNeg",-Nb,0,"toExpPos",0,Nb,"maxE",0,Nb,"minE",-Nb,0,"modulo",0,9];for(e=0;e<s.length;e+=3)if(n=s[e],i&&(this[n]=Lb[n]),void 0!==(r=t[n])){if(!(Vb(r)===r&&r>=s[e+1]&&r<=s[e+2]))throw Error(Bb+n+": "+r);this[n]=r}if(n="crypto",i&&(this[n]=Lb[n]),void 0!==(r=t[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(Bb+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(Hb);this[n]=!0}else this[n]=!1}return this}function Lw(t){return new this(t).cos()}function Fw(t){return new this(t).cosh()}function kw(t,e){return new this(t).div(e)}function Bw(t){return new this(t).exp()}function zw(t){return iw(t=new this(t),t.e+1,3)}function Hw(){var t,e,n=new this(0);for(Fb=!1,t=0;t<arguments.length;)if((e=new this(arguments[t++])).d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return Fb=!0,new this(1/0);n=e}return Fb=!0,n.sqrt()}function Gw(t){return t instanceof c_||t&&t.toStringTag===Gb||!1}function Vw(t){return new this(t).ln()}function jw(t,e){return new this(t).log(e)}function Ww(t){return new this(t).log(2)}function qw(t){return new this(t).log(10)}function Xw(){return fw(this,arguments,-1)}function Kw(){return fw(this,arguments,1)}function Yw(t,e){return new this(t).mod(e)}function Jw(t,e){return new this(t).mul(e)}function Qw(t,e){return new this(t).pow(e)}function Zw(t){var e,n,r,i,s=0,a=new this(1),o=[];if(void 0===t?t=this.precision:tw(t,1,Ob),r=Math.ceil(t/7),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));s<r;)(i=e[s])>=429e7?e[s]=crypto.getRandomValues(new Uint32Array(1))[0]:o[s++]=i%1e7;else{if(!crypto.randomBytes)throw Error(Hb);for(e=crypto.randomBytes(r*=4);s<r;)(i=e[s]+(e[s+1]<<8)+(e[s+2]<<16)+((127&e[s+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,s):(o.push(i%1e7),s+=4);s=r/4}else for(;s<r;)o[s++]=1e7*Math.random()|0;for(t%=7,(r=o[--s])&&t&&(i=jb(10,7-t),o[s]=(r/i|0)*i);0===o[s];s--)o.pop();if(s<0)n=0,o=[0];else{for(n=-1;0===o[0];n-=7)o.shift();for(r=1,i=o[0];i>=10;i/=10)r++;r<7&&(n-=7-r)}return a.e=n,a.d=o,a}function $w(t){return iw(t=new this(t),t.e+1,this.rounding)}function t_(t){return(t=new this(t)).d?t.d[0]?t.s:0*t.s:t.s||NaN}function e_(t){return new this(t).sin()}function n_(t){return new this(t).sinh()}function r_(t){return new this(t).sqrt()}function i_(t,e){return new this(t).sub(e)}function s_(){var t=0,e=arguments,n=new this(e[t]);for(Fb=!1;n.s&&++t<e.length;)n=n.plus(e[t]);return Fb=!0,iw(n,this.precision,this.rounding)}function a_(t){return new this(t).tan()}function o_(t){return new this(t).tanh()}function l_(t){return iw(t=new this(t),t.e+1,1)}Zb[Symbol.for("nodejs.util.inspect.custom")]=Zb.toString,Zb[Symbol.toStringTag]="Decimal";var c_=Zb.constructor=function t(e){var n,r,i;function s(t){var e,n,r,i=this;if(!(i instanceof s))return new s(t);if(i.constructor=s,Gw(t))return i.s=t.s,void(Fb?!t.d||t.e>s.maxE?(i.e=NaN,i.d=null):t.e<s.minE?(i.e=0,i.d=[0]):(i.e=t.e,i.d=t.d.slice()):(i.e=t.e,i.d=t.d?t.d.slice():t.d));if("number"===(r=typeof t)){if(0===t)return i.s=1/t<0?-1:1,i.e=0,void(i.d=[0]);if(t<0?(t=-t,i.s=-1):i.s=1,t===~~t&&t<1e7){for(e=0,n=t;n>=10;n/=10)e++;return void(Fb?e>s.maxE?(i.e=NaN,i.d=null):e<s.minE?(i.e=0,i.d=[0]):(i.e=e,i.d=[t]):(i.e=e,i.d=[t]))}return 0*t!=0?(t||(i.s=NaN),i.e=NaN,void(i.d=null)):vw(i,t.toString())}if("string"===r)return 45===(n=t.charCodeAt(0))?(t=t.slice(1),i.s=-1):(43===n&&(t=t.slice(1)),i.s=1),Kb.test(t)?vw(i,t):function(t,e){var n,r,i,s,a,o,l,c,u;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),Kb.test(e))return vw(t,e)}else if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(qb.test(e))n=16,e=e.toLowerCase();else if(Wb.test(e))n=2;else{if(!Xb.test(e))throw Error(Bb+e);n=8}for((s=e.search(/p/i))>0?(l=+e.slice(s+1),e=e.substring(2,s)):e=e.slice(2),a=(s=e.indexOf("."))>=0,r=t.constructor,a&&(s=(o=(e=e.replace(".","")).length)-s,i=hw(r,new r(n),s,2*s)),s=u=(c=nw(e,n,Yb)).length-1;0===c[s];--s)c.pop();return s<0?new r(0*t.s):(t.e=aw(c,u),t.d=c,Fb=!1,a&&(t=rw(t,i,4*o)),l&&(t=t.times(Math.abs(l)<54?jb(2,l):c_.pow(2,l))),Fb=!0,t)}(i,t);if("bigint"===r)return t<0?(t=-t,i.s=-1):i.s=1,vw(i,t.toString());throw Error(Bb+t)}if(s.prototype=Zb,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.EUCLID=9,s.config=s.set=Uw,s.clone=t,s.isDecimal=Gw,s.abs=Ew,s.acos=Aw,s.acosh=Sw,s.add=Mw,s.asin=Tw,s.asinh=Rw,s.atan=Cw,s.atanh=Pw,s.atan2=Nw,s.cbrt=Ow,s.ceil=Iw,s.clamp=Dw,s.cos=Lw,s.cosh=Fw,s.div=kw,s.exp=Bw,s.floor=zw,s.hypot=Hw,s.ln=Vw,s.log=jw,s.log10=qw,s.log2=Ww,s.max=Xw,s.min=Kw,s.mod=Yw,s.mul=Jw,s.pow=Qw,s.random=Zw,s.round=$w,s.sign=t_,s.sin=e_,s.sinh=n_,s.sqrt=r_,s.sub=i_,s.sum=s_,s.tan=a_,s.tanh=o_,s.trunc=l_,void 0===e&&(e={}),e&&!0!==e.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)e.hasOwnProperty(r=i[n++])||(e[r]=this[r]);return s.config(e),s}(Lb);Db=new c_(Db),Ub=new c_(Ub);const u_="6.16.0";function h_(t,e,n){const r=e.split("|").map(t=>t.trim());for(let s=0;s<r.length;s++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const i=new Error(`invalid value for type ${e}`);throw i.code="INVALID_ARGUMENT",i.argument=`value.${n}`,i.value=t,i}async function d_(t){const e=Object.keys(t);return(await Promise.all(e.map(e=>Promise.resolve(t[e])))).reduce((t,n,r)=>(t[e[r]]=n,t),{})}function f_(t,e,n){for(let r in e){let i=e[r];const s=n?n[r]:null;s&&h_(i,s,r),Object.defineProperty(t,r,{enumerable:!0,value:i,writable:!1})}}function p_(t,e){if(null==t)return"null";if(null==e&&(e=new Set),"object"==typeof t){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(t=>p_(t,e)).join(", ")+" ]";if(t instanceof Uint8Array){const e="0123456789abcdef";let n="0x";for(let r=0;r<t.length;r++)n+=e[t[r]>>4],n+=e[15&t[r]];return n}if("object"==typeof t&&"function"==typeof t.toJSON)return p_(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const n=Object.keys(t);return n.sort(),"{ "+n.map(n=>`${p_(n,e)}: ${p_(t[n],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function m_(t,e){return t&&t.code===e}function g_(t){return m_(t,"CALL_EXCEPTION")}function v_(t,e,n){let r,i=t;{const r=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${p_(n)}`);for(const t in n){if("shortMessage"===t)continue;const e=n[t];r.push(t+"="+p_(e))}}r.push(`code=${e}`),r.push(`version=${u_}`),r.length&&(t+=" ("+r.join(", ")+")")}switch(e){case"INVALID_ARGUMENT":r=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":r=new RangeError(t);break;default:r=new Error(t)}return f_(r,{code:e}),n&&Object.assign(r,n),null==r.shortMessage&&f_(r,{shortMessage:i}),r}function y_(t,e,n,r){if(!t)throw v_(e,n,r)}function b_(t,e,n,r){y_(t,e,"INVALID_ARGUMENT",{argument:n,value:r})}function w_(t,e,n){null==n&&(n=""),n&&(n=": "+n),y_(t>=e,"missing argument"+n,"MISSING_ARGUMENT",{count:t,expectedCount:e}),y_(t<=e,"too many arguments"+n,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}const __=["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test"!=="test".normalize(e))throw new Error("bad");if("NFD"===e){const t=String.fromCharCode(233).normalize("NFD");if(t!==String.fromCharCode(101,769))throw new Error("broken")}t.push(e)}catch(n){}return t},[]);function x_(t){y_(__.indexOf(t)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:t}})}function E_(t,e,n){if(null==n&&(n=""),t!==e){let t=n,e="new";n&&(t+=".",e+=" "+n),y_(!1,`private constructor; use ${t}from* methods`,"UNSUPPORTED_OPERATION",{operation:e})}}function A_(t,e,n){if(t instanceof Uint8Array)return n?new Uint8Array(t):t;if("string"==typeof t&&t.length%2==0&&t.match(/^0x[0-9a-f]*$/i)){const e=new Uint8Array((t.length-2)/2);let n=2;for(let r=0;r<e.length;r++)e[r]=parseInt(t.substring(n,n+2),16),n+=2;return e}b_(!1,"invalid BytesLike value",e||"value",t)}function S_(t,e){return A_(t,e,!1)}function M_(t,e){return A_(t,e,!0)}function T_(t,e){return!("string"!=typeof t||!t.match(/^0x[0-9A-Fa-f]*$/))&&(("number"!=typeof e||t.length===2+2*e)&&(!0!==e||t.length%2==0))}function R_(t){return T_(t,!0)||t instanceof Uint8Array}const C_="0123456789abcdef";function P_(t){const e=S_(t);let n="0x";for(let r=0;r<e.length;r++){const t=e[r];n+=C_[(240&t)>>4]+C_[15&t]}return n}function N_(t){return"0x"+t.map(t=>P_(t).substring(2)).join("")}function O_(t){return T_(t,!0)?(t.length-2)/2:S_(t).length}function I_(t,e,n){const r=S_(t);return null!=n&&n>r.length&&y_(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n}),P_(r.slice(null==e?0:e,null==n?r.length:n))}function D_(t){let e=P_(t).substring(2);for(;e.startsWith("00");)e=e.substring(2);return"0x"+e}function U_(t,e,n){const r=S_(t);y_(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const i=new Uint8Array(e);return i.fill(0),n?i.set(r,e-r.length):i.set(r,0),P_(i)}function L_(t,e){return U_(t,e,!0)}function F_(t,e){return U_(t,e,!1)}const k_=BigInt(0),B_=BigInt(1),z_=9007199254740991;function H_(t,e){const n=W_(t,"value"),r=BigInt(K_(e,"width"));if(y_(n>>r===k_,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),n>>r-B_){return-((~n&(B_<<r)-B_)+B_)}return n}function G_(t,e){let n=j_(t,"value");const r=BigInt(K_(e,"width")),i=B_<<r-B_;if(n<k_){n=-n,y_(n<=i,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});return(~n&(B_<<r)-B_)+B_}return y_(n<i,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),n}function V_(t,e){const n=W_(t,"value"),r=BigInt(K_(e,"bits"));return n&(B_<<r)-B_}function j_(t,e){switch(typeof t){case"bigint":return t;case"number":return b_(Number.isInteger(t),"underflow",e||"value",t),b_(t>=-z_&&t<=z_,"overflow",e||"value",t),BigInt(t);case"string":try{if(""===t)throw new Error("empty string");return"-"===t[0]&&"-"!==t[1]?-BigInt(t.substring(1)):BigInt(t)}catch(Es){b_(!1,`invalid BigNumberish string: ${Es.message}`,e||"value",t)}}b_(!1,"invalid BigNumberish value",e||"value",t)}function W_(t,e){const n=j_(t,e);return y_(n>=k_,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),n}const q_="0123456789abcdef";function X_(t){if(t instanceof Uint8Array){let e="0x0";for(const n of t)e+=q_[n>>4],e+=q_[15&n];return BigInt(e)}return j_(t)}function K_(t,e){switch(typeof t){case"bigint":return b_(t>=-z_&&t<=z_,"overflow",e||"value",t),Number(t);case"number":return b_(Number.isInteger(t),"underflow",e||"value",t),b_(t>=-z_&&t<=z_,"overflow",e||"value",t),t;case"string":try{if(""===t)throw new Error("empty string");return K_(BigInt(t),e)}catch(Es){b_(!1,`invalid numeric string: ${Es.message}`,e||"value",t)}}b_(!1,"invalid numeric value",e||"value",t)}function Y_(t){return K_(X_(t))}function J_(t,e){const n=W_(t,"value");let r=n.toString(16);if(null==e)r.length%2&&(r="0"+r);else{const i=K_(e,"width");if(0===i&&n===k_)return"0x";for(y_(2*i>=r.length,`value exceeds width (${i} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});r.length<2*i;)r="0"+r}return"0x"+r}function Q_(t,e){const n=W_(t,"value");if(n===k_){const t=null!=e?K_(e,"width"):0;return new Uint8Array(t)}let r=n.toString(16);if(r.length%2&&(r="0"+r),null!=e){const n=K_(e,"width");for(;r.length<2*n;)r="00"+r;y_(2*n===r.length,`value exceeds width (${n} bytes)`,"NUMERIC_FAULT",{operation:"toBeArray",fault:"overflow",value:t})}const i=new Uint8Array(r.length/2);for(let s=0;s<i.length;s++){const t=2*s;i[s]=parseInt(r.substring(t,t+2),16)}return i}function Z_(t){let e=P_(R_(t)?t:Q_(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return""===e&&(e="0"),"0x"+e}const $_="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";let tx=null;function ex(t){if(null==tx){tx={};for(let t=0;t<58;t++)tx[$_[t]]=BigInt(t)}const e=tx[t];return b_(null!=e,"invalid base58 value","letter",t),e}const nx=BigInt(0),rx=BigInt(58);function ix(t){const e=S_(t);let n=X_(e),r="";for(;n;)r=$_[Number(n%rx)]+r,n/=rx;for(let i=0;i<e.length&&!e[i];i++)r=$_[0]+r;return r}function sx(t){let e=nx;for(let n=0;n<t.length;n++)e*=rx,e+=ex(t[n]);return e}function ax(t){t=atob(t);const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return S_(e)}function ox(t){const e=S_(t);let n="";for(let r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return btoa(n)}class lx{filter;emitter;#t;constructor(t,e,n){this.#t=e,f_(this,{emitter:t,filter:n})}async removeListener(){null!=this.#t&&await this.emitter.off(this.filter,this.#t)}}function cx(t,e,n,r,i){if("BAD_PREFIX"===t||"UNEXPECTED_CONTINUE"===t){let t=0;for(let r=e+1;r<n.length&&n[r]>>6==2;r++)t++;return t}return"OVERRUN"===t?n.length-e-1:0}const ux=Object.freeze({error:function(t,e,n,r,i){b_(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",n)},ignore:cx,replace:function(t,e,n,r,i){return"OVERLONG"===t?(b_("number"==typeof i,"invalid bad code point for replacement","badCodepoint",i),r.push(i),0):(r.push(65533),cx(t,e,n))}});function hx(t,e){null==e&&(e=ux.error);const n=S_(t,"bytes"),r=[];let i=0;for(;i<n.length;){const t=n[i++];if(!(t>>7)){r.push(t);continue}let s=null,a=null;if(192==(224&t))s=1,a=127;else if(224==(240&t))s=2,a=2047;else{if(240!=(248&t)){i+=e(128==(192&t)?"UNEXPECTED_CONTINUE":"BAD_PREFIX",i-1,n,r);continue}s=3,a=65535}if(i-1+s>=n.length){i+=e("OVERRUN",i-1,n,r);continue}let o=t&(1<<8-s-1)-1;for(let l=0;l<s;l++){let t=n[i];if(128!=(192&t)){i+=e("MISSING_CONTINUE",i,n,r),o=null;break}o=o<<6|63&t,i++}null!==o&&(o>1114111?i+=e("OUT_OF_RANGE",i-1-s,n,r,o):o>=55296&&o<=57343?i+=e("UTF16_SURROGATE",i-1-s,n,r,o):o<=a?i+=e("OVERLONG",i-1-s,n,r,o):r.push(o))}return r}function dx(t,e){b_("string"==typeof t,"invalid string value","str",t),null!=e&&(x_(e),t=t.normalize(e));let n=[];for(let r=0;r<t.length;r++){const e=t.charCodeAt(r);if(e<128)n.push(e);else if(e<2048)n.push(e>>6|192),n.push(63&e|128);else if(55296==(64512&e)){r++;const i=t.charCodeAt(r);b_(r<t.length&&56320==(64512&i),"invalid surrogate pair","str",t);const s=65536+((1023&e)<<10)+(1023&i);n.push(s>>18|240),n.push(s>>12&63|128),n.push(s>>6&63|128),n.push(63&s|128)}else n.push(e>>12|224),n.push(e>>6&63|128),n.push(63&e|128)}return new Uint8Array(n)}function fx(t,e){return hx(t,e).map(t=>t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10&1023),56320+(1023&t)))).join("")}function px(t,e){return hx(dx(t,e))}function mx(t){return async function(e,n){y_(null==n||!n.cancelled,"request cancelled before sending","CANCELLED");const r=e.url.split(":")[0].toLowerCase();y_("http"===r||"https"===r,`unsupported protocol ${r}`,"UNSUPPORTED_OPERATION",{info:{protocol:r},operation:"request"}),y_("https"===r||!e.credentials||e.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const s=new AbortController,a=setTimeout(()=>{i=v_("request timeout","TIMEOUT"),s.abort()},e.timeout);n&&n.addListener(()=>{i=v_("request cancelled","CANCELLED"),s.abort()});const o=Object.assign({},t,{method:e.method,headers:new Headers(Array.from(e)),body:e.body||void 0,signal:s.signal});let l;try{l=await fetch(e.url,o)}catch(d){if(clearTimeout(a),i)throw i;throw d}clearTimeout(a);const c={};l.headers.forEach((t,e)=>{c[e.toLowerCase()]=t});const u=await l.arrayBuffer(),h=null==u?null:new Uint8Array(u);return{statusCode:l.status,statusMessage:l.statusText,headers:c,body:h}}}let gx=mx();const vx=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),yx=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let bx=!1;async function wx(t,e){try{const e=t.match(vx);if(!e)throw new Error("invalid data");return new Tx(200,"OK",{"content-type":e[1]||"text/plain"},e[2]?ax(e[3]):dx(e[3].replace(/%([0-9a-f][0-9a-f])/gi,(t,e)=>String.fromCharCode(parseInt(e,16)))))}catch(n){return new Tx(599,"BAD REQUEST (invalid data: URI)",{},null,new Mx(t))}}function _x(t){return async function(e,n){try{const n=e.match(yx);if(!n)throw new Error("invalid link");return new Mx(`${t}${n[2]}`)}catch(r){return new Tx(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Mx(e))}}}const xx={data:wx,ipfs:_x("https://gateway.ipfs.io/ipfs/")},Ex=new WeakMap;class Ax{#e;#n;constructor(t){this.#e=[],this.#n=!1,Ex.set(t,()=>{if(!this.#n){this.#n=!0;for(const t of this.#e)setTimeout(()=>{t()},0);this.#e=[]}})}addListener(t){y_(!this.#n,"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),this.#e.push(t)}get cancelled(){return this.#n}checkSignal(){y_(!this.cancelled,"cancelled","CANCELLED",{})}}function Sx(t){if(null==t)throw new Error("missing signal; should not happen");return t.checkSignal(),t}class Mx{#r;#i;#s;#a;#o;#l;#c;#u;#h;#d;#f;#p;#m;#g;#v;get url(){return this.#l}set url(t){this.#l=String(t)}get body(){return null==this.#c?null:new Uint8Array(this.#c)}set body(t){if(null==t)this.#c=void 0,this.#u=void 0;else if("string"==typeof t)this.#c=dx(t),this.#u="text/plain";else if(t instanceof Uint8Array)this.#c=t,this.#u="application/octet-stream";else{if("object"!=typeof t)throw new Error("invalid body");this.#c=dx(JSON.stringify(t)),this.#u="application/json"}}hasBody(){return null!=this.#c}get method(){return this.#a?this.#a:this.hasBody()?"POST":"GET"}set method(t){null==t&&(t=""),this.#a=String(t).toUpperCase()}get headers(){const t=Object.assign({},this.#s);return this.#h&&(t.authorization=`Basic ${ox(dx(this.#h))}`),this.allowGzip&&(t["accept-encoding"]="gzip"),null==t["content-type"]&&this.#u&&(t["content-type"]=this.#u),this.body&&(t["content-length"]=String(this.body.length)),t}getHeader(t){return this.headers[t.toLowerCase()]}setHeader(t,e){this.#s[String(t).toLowerCase()]=String(e)}clearHeaders(){this.#s={}}[Symbol.iterator](){const t=this.headers,e=Object.keys(t);let n=0;return{next:()=>{if(n<e.length){const r=e[n++];return{value:[r,t[r]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return this.#h||null}setCredentials(t,e){b_(!t.match(/:/),"invalid basic authentication username","username","[REDACTED]"),this.#h=`${t}:${e}`}get allowGzip(){return this.#i}set allowGzip(t){this.#i=!!t}get allowInsecureAuthentication(){return!!this.#r}set allowInsecureAuthentication(t){this.#r=!!t}get timeout(){return this.#o}set timeout(t){b_(t>=0,"timeout must be non-zero","timeout",t),this.#o=t}get preflightFunc(){return this.#d||null}set preflightFunc(t){this.#d=t}get processFunc(){return this.#f||null}set processFunc(t){this.#f=t}get retryFunc(){return this.#p||null}set retryFunc(t){this.#p=t}get getUrlFunc(){return this.#v||gx}set getUrlFunc(t){this.#v=t}constructor(t){this.#l=String(t),this.#r=!1,this.#i=!0,this.#s={},this.#a="",this.#o=3e5,this.#g={slotInterval:250,maxAttempts:12},this.#v=null}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${this.#c?P_(this.#c):"null"}>`}setThrottleParams(t){null!=t.slotInterval&&(this.#g.slotInterval=t.slotInterval),null!=t.maxAttempts&&(this.#g.maxAttempts=t.maxAttempts)}async#y(t,e,n,r,i){if(t>=this.#g.maxAttempts)return i.makeServerError("exceeded maximum retry limit");y_(Rx()<=e,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:r}),n>0&&await function(t){return new Promise(e=>setTimeout(e,t))}(n);let s=this.clone();const a=(s.url.split(":")[0]||"").toLowerCase();if(a in xx){const t=await xx[a](s.url,Sx(r.#m));if(t instanceof Tx){let e=t;if(this.processFunc){Sx(r.#m);try{e=await this.processFunc(s,e)}catch(c){null!=c.throttle&&"number"==typeof c.stall||e.makeServerError("error in post-processing function",c).assertOk()}}return e}s=t}this.preflightFunc&&(s=await this.preflightFunc(s));const o=await this.getUrlFunc(s,Sx(r.#m));let l=new Tx(o.statusCode,o.statusMessage,o.headers,o.body,r);if(301===l.statusCode||302===l.statusCode){try{const n=l.headers.location||"";return s.redirect(n).#y(t+1,e,0,r,l)}catch(c){}return l}if(429===l.statusCode&&(null==this.retryFunc||await this.retryFunc(s,l,t))){const n=l.headers["retry-after"];let i=this.#g.slotInterval*Math.trunc(Math.random()*Math.pow(2,t));return"string"==typeof n&&n.match(/^[1-9][0-9]*$/)&&(i=parseInt(n)),s.clone().#y(t+1,e,i,r,l)}if(this.processFunc){Sx(r.#m);try{l=await this.processFunc(s,l)}catch(c){null!=c.throttle&&"number"==typeof c.stall||l.makeServerError("error in post-processing function",c).assertOk();let n=this.#g.slotInterval*Math.trunc(Math.random()*Math.pow(2,t));return c.stall>=0&&(n=c.stall),s.clone().#y(t+1,e,n,r,l)}}return l}send(){return y_(null==this.#m,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),this.#m=new Ax(this),this.#y(0,Rx()+this.timeout,0,this,new Tx(0,"",{},null,this))}cancel(){y_(null!=this.#m,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const t=Ex.get(this);if(!t)throw new Error("missing signal; should not happen");t()}redirect(t){const e=this.url.split(":")[0].toLowerCase(),n=t.split(":")[0].toLowerCase();y_("GET"===this.method&&("https"!==e||"http"!==n)&&t.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(t)})`});const r=new Mx(t);return r.method="GET",r.allowGzip=this.allowGzip,r.timeout=this.timeout,r.#s=Object.assign({},this.#s),this.#c&&(r.#c=new Uint8Array(this.#c)),r.#u=this.#u,r}clone(){const t=new Mx(this.url);return t.#a=this.#a,this.#c&&(t.#c=this.#c),t.#u=this.#u,t.#s=Object.assign({},this.#s),t.#h=this.#h,this.allowGzip&&(t.allowGzip=!0),t.timeout=this.timeout,this.allowInsecureAuthentication&&(t.allowInsecureAuthentication=!0),t.#d=this.#d,t.#f=this.#f,t.#p=this.#p,t.#g=Object.assign({},this.#g),t.#v=this.#v,t}static lockConfig(){bx=!0}static getGateway(t){return xx[t.toLowerCase()]||null}static registerGateway(t,e){if("http"===(t=t.toLowerCase())||"https"===t)throw new Error(`cannot intercept ${t}; use registerGetUrl`);if(bx)throw new Error("gateways locked");xx[t]=e}static registerGetUrl(t){if(bx)throw new Error("gateways locked");gx=t}static createGetUrlFunc(t){return mx(t)}static createDataGateway(){return wx}static createIpfsGatewayFunc(t){return _x(t)}}class Tx{#b;#w;#s;#c;#_;#x;toString(){return`<FetchResponse status=${this.statusCode} body=${this.#c?P_(this.#c):"null"}>`}get statusCode(){return this.#b}get statusMessage(){return this.#w}get headers(){return Object.assign({},this.#s)}get body(){return null==this.#c?null:new Uint8Array(this.#c)}get bodyText(){try{return null==this.#c?"":fx(this.#c)}catch(t){y_(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch(t){y_(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const t=this.headers,e=Object.keys(t);let n=0;return{next:()=>{if(n<e.length){const r=e[n++];return{value:[r,t[r]],done:!1}}return{value:void 0,done:!0}}}}constructor(t,e,n,r,i){this.#b=t,this.#w=e,this.#s=Object.keys(n).reduce((t,e)=>(t[e.toLowerCase()]=String(n[e]),t),{}),this.#c=null==r?null:new Uint8Array(r),this.#_=i||null,this.#x={message:""}}makeServerError(t,e){let n;n=t?`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${t})`:`CLIENT ESCALATED SERVER ERROR (${t=`${this.statusCode} ${this.statusMessage}`})`;const r=new Tx(599,n,this.headers,this.body,this.#_||void 0);return r.#x={message:t,error:e},r}throwThrottleError(t,e){null==e?e=-1:b_(Number.isInteger(e)&&e>=0,"invalid stall timeout","stall",e);const n=new Error(t||"throttling requests");throw f_(n,{stall:e,throttle:!0}),n}getHeader(t){return this.headers[t.toLowerCase()]}hasBody(){return null!=this.#c}get request(){return this.#_}ok(){return""===this.#x.message&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:t,error:e}=this.#x;""===t&&(t=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let r=null;try{this.#c&&(r=fx(this.#c))}catch(Es){}y_(!1,t,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:e,info:{requestUrl:n,responseBody:r,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}}function Rx(){return(new Date).getTime()}const Cx=BigInt(-1),Px=BigInt(0),Nx=BigInt(1),Ox=BigInt(5),Ix={};let Dx="0000";for(;Dx.length<80;)Dx+=Dx;function Ux(t){let e=Dx;for(;e.length<t;)e+=e;return BigInt("1"+e.substring(0,t))}function Lx(t,e,n){const r=BigInt(e.width);if(e.signed){const e=Nx<<r-Nx;y_(null==n||t>=-e&&t<e,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t=t>Px?H_(V_(t,r),r):-H_(V_(-t,r),r)}else{const e=Nx<<r;y_(null==n||t>=0&&t<e,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t=(t%e+e)%e&e-Nx}return t}function Fx(t){"number"==typeof t&&(t=`fixed128x${t}`);let e=!0,n=128,r=18;if("string"==typeof t)if("fixed"===t);else if("ufixed"===t)e=!1;else{const i=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);b_(i,"invalid fixed format","format",t),e="u"!==i[1],n=parseInt(i[2]),r=parseInt(i[3])}else if(t){const i=t,s=(t,e,n)=>null==i[t]?n:(b_(typeof i[t]===e,"invalid fixed format ("+t+" not "+e+")","format."+t,i[t]),i[t]);e=s("signed","boolean",e),n=s("width","number",n),r=s("decimals","number",r)}b_(n%8==0,"invalid FixedNumber width (not byte aligned)","format.width",n),b_(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);return{signed:e,width:n,decimals:r,name:(e?"":"u")+"fixed"+String(n)+"x"+String(r)}}class kx{format;#E;#A;#S;_value;constructor(t,e,n){E_(t,Ix,"FixedNumber"),this.#A=e,this.#E=n;const r=function(t,e){let n="";t<Px&&(n="-",t*=Cx);let r=t.toString();if(0===e)return n+r;for(;r.length<=e;)r=Dx+r;const i=r.length-e;for(r=r.substring(0,i)+"."+r.substring(i);"0"===r[0]&&"."!==r[1];)r=r.substring(1);for(;"0"===r[r.length-1]&&"."!==r[r.length-2];)r=r.substring(0,r.length-1);return n+r}(e,n.decimals);f_(this,{format:n.name,_value:r}),this.#S=Ux(n.decimals)}get signed(){return this.#E.signed}get width(){return this.#E.width}get decimals(){return this.#E.decimals}get value(){return this.#A}#M(t){b_(this.format===t.format,"incompatible format; use fixedNumber.toFormat","other",t)}#T(t,e){return t=Lx(t,this.#E,e),new kx(Ix,t,this.#E)}#R(t,e){return this.#M(t),this.#T(this.#A+t.#A,e)}addUnsafe(t){return this.#R(t)}add(t){return this.#R(t,"add")}#C(t,e){return this.#M(t),this.#T(this.#A-t.#A,e)}subUnsafe(t){return this.#C(t)}sub(t){return this.#C(t,"sub")}#P(t,e){return this.#M(t),this.#T(this.#A*t.#A/this.#S,e)}mulUnsafe(t){return this.#P(t)}mul(t){return this.#P(t,"mul")}mulSignal(t){this.#M(t);const e=this.#A*t.#A;return y_(e%this.#S===Px,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),this.#T(e/this.#S,"mulSignal")}#N(t,e){return y_(t.#A!==Px,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#M(t),this.#T(this.#A*this.#S/t.#A,e)}divUnsafe(t){return this.#N(t)}div(t){return this.#N(t,"div")}divSignal(t){y_(t.#A!==Px,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#M(t);const e=this.#A*this.#S;return y_(e%t.#A===Px,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),this.#T(e/t.#A,"divSignal")}cmp(t){let e=this.value,n=t.value;const r=this.decimals-t.decimals;return r>0?n*=Ux(r):r<0&&(e*=Ux(-r)),e<n?-1:e>n?1:0}eq(t){return 0===this.cmp(t)}lt(t){return this.cmp(t)<0}lte(t){return this.cmp(t)<=0}gt(t){return this.cmp(t)>0}gte(t){return this.cmp(t)>=0}floor(){let t=this.#A;return this.#A<Px&&(t-=this.#S-Nx),t=this.#A/this.#S*this.#S,this.#T(t,"floor")}ceiling(){let t=this.#A;return this.#A>Px&&(t+=this.#S-Nx),t=this.#A/this.#S*this.#S,this.#T(t,"ceiling")}round(t){if(null==t&&(t=0),t>=this.decimals)return this;const e=this.decimals-t,n=Ox*Ux(e-1);let r=this.value+n;const i=Ux(e);return r=r/i*i,Lx(r,this.#E,"round"),new kx(Ix,r,this.#E)}isZero(){return this.#A===Px}isNegative(){return this.#A<Px}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return kx.fromString(this.toString(),t)}static fromValue(t,e,n){const r=null==e?0:K_(e),i=Fx(n);let s=j_(t,"value");const a=r-i.decimals;if(a>0){const e=Ux(a);y_(s%e===Px,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:t}),s/=e}else a<0&&(s*=Ux(-a));return Lx(s,i,"fromValue"),new kx(Ix,s,i)}static fromString(t,e){const n=t.match(/^(-?)([0-9]*)\.?([0-9]*)$/);b_(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",t);const r=Fx(e);let i=n[2]||"0",s=n[3]||"";for(;s.length<r.decimals;)s+=Dx;y_(s.substring(r.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:t}),s=s.substring(0,r.decimals);const a=BigInt(n[1]+i+s);return Lx(a,r,"fromString"),new kx(Ix,a,r)}static fromBytes(t,e){let n=X_(S_(t,"value"));const r=Fx(e);return r.signed&&(n=H_(n,r.width)),Lx(n,r,"fromBytes"),new kx(Ix,n,r)}}function Bx(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function zx(t,e,n){let r=0;for(let i=0;i<n;i++)r=256*r+t[e+i];return r}function Hx(t,e,n,r){const i=[];for(;n<e+1+r;){const s=Gx(t,n);i.push(s.result),y_((n+=s.consumed)<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:t,length:r,offset:e})}return{consumed:1+r,result:i}}function Gx(t,e){y_(0!==t.length,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const n=e=>{y_(e<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:e})};if(t[e]>=248){const r=t[e]-247;n(e+1+r);const i=zx(t,e+1,r);return n(e+1+r+i),Hx(t,e,e+1+r,r+i)}if(t[e]>=192){const r=t[e]-192;return n(e+1+r),Hx(t,e,e+1,r)}if(t[e]>=184){const r=t[e]-183;n(e+1+r);const i=zx(t,e+1,r);n(e+1+r+i);return{consumed:1+r+i,result:P_(t.slice(e+1+r,e+1+r+i))}}if(t[e]>=128){const r=t[e]-128;n(e+1+r);return{consumed:1+r,result:P_(t.slice(e+1,e+1+r))}}return{consumed:1,result:Bx(t[e])}}function Vx(t){const e=S_(t,"data"),n=Gx(e,0);return b_(n.consumed===e.length,"unexpected junk after rlp payload","data",t),n.result}function jx(t){const e=[];for(;t;)e.unshift(255&t),t>>=8;return e}function Wx(t){if(Array.isArray(t)){let e=[];if(t.forEach(function(t){e=e.concat(Wx(t))}),e.length<=55)return e.unshift(192+e.length),e;const n=jx(e.length);return n.unshift(247+n.length),n.concat(e)}const e=Array.prototype.slice.call(S_(t,"object"));if(1===e.length&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const n=jx(e.length);return n.unshift(183+n.length),n.concat(e)}const qx="0123456789abcdef";function Xx(t){let e="0x";for(const n of Wx(t))e+=qx[n>>4],e+=qx[15&n];return e}const Kx=["wei","kwei","mwei","gwei","szabo","finney","ether"];function Yx(t,e){let n=18;if("string"==typeof e){const t=Kx.indexOf(e);b_(t>=0,"invalid unit","unit",e),n=3*t}else null!=e&&(n=K_(e,"unit"));return kx.fromValue(t,n,{decimals:n,width:512}).toString()}function Jx(t,e){b_("string"==typeof t,"value must be a string","value",t);let n=18;if("string"==typeof e){const t=Kx.indexOf(e);b_(t>=0,"invalid unit","unit",e),n=3*t}else null!=e&&(n=K_(e,"unit"));return kx.fromString(t,{decimals:n,width:512}).value}function Qx(t){return Yx(t,18)}function Zx(t){return Jx(t,18)}function $x(t){const e=S_(t,"randomBytes");e[6]=15&e[6]|64,e[8]=63&e[8]|128;const n=P_(e);return[n.substring(2,10),n.substring(10,14),n.substring(14,18),n.substring(18,22),n.substring(22,34)].join("-")}const tE=32,eE=new Uint8Array(tE),nE=["then"],rE={},iE=new WeakMap;function sE(t){return iE.get(t)}function aE(t,e){iE.set(t,e)}function oE(t,e){const n=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw n.error=e,n}function lE(t,e,n){return t.indexOf(null)>=0?e.map((t,e)=>t instanceof cE?lE(sE(t),t,n):t):t.reduce((t,r,i)=>{let s=e.getValue(r);return r in t||(n&&s instanceof cE&&(s=lE(sE(s),s,n)),t[r]=s),t},{})}class cE extends Array{#O;constructor(...t){const e=t[0];let n=t[1],r=(t[2]||[]).slice(),i=!0;e!==rE&&(n=t,r=[],i=!1),super(n.length),n.forEach((t,e)=>{this[e]=t});const s=r.reduce((t,e)=>("string"==typeof e&&t.set(e,(t.get(e)||0)+1),t),new Map);if(aE(this,Object.freeze(n.map((t,e)=>{const n=r[e];return null!=n&&1===s.get(n)?n:null}))),this.#O=[],null==this.#O&&this.#O,!i)return;Object.freeze(this);const a=new Proxy(this,{get:(t,e,n)=>{if("string"==typeof e){if(e.match(/^[0-9]+$/)){const n=K_(e,"%index");if(n<0||n>=this.length)throw new RangeError("out of result range");const r=t[n];return r instanceof Error&&oE(`index ${n}`,r),r}if(nE.indexOf(e)>=0)return Reflect.get(t,e,n);const r=t[e];if(r instanceof Function)return function(...e){return r.apply(this===n?t:this,e)};if(!(e in t))return t.getValue.apply(this===n?t:this,[e])}return Reflect.get(t,e,n)}});return aE(a,sE(this)),a}toArray(t){const e=[];return this.forEach((n,r)=>{n instanceof Error&&oE(`index ${r}`,n),t&&n instanceof cE&&(n=n.toArray(t)),e.push(n)}),e}toObject(t){const e=sE(this);return e.reduce((n,r,i)=>(y_(null!=r,`value at index ${i} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),lE(e,this,t)),{})}slice(t,e){null==t&&(t=0),t<0&&(t+=this.length)<0&&(t=0),null==e&&(e=this.length),e<0&&(e+=this.length)<0&&(e=0),e>this.length&&(e=this.length);const n=sE(this),r=[],i=[];for(let s=t;s<e;s++)r.push(this[s]),i.push(n[s]);return new cE(rE,r,i)}filter(t,e){const n=sE(this),r=[],i=[];for(let s=0;s<this.length;s++){const a=this[s];a instanceof Error&&oE(`index ${s}`,a),t.call(e,a,s,this)&&(r.push(a),i.push(n[s]))}return new cE(rE,r,i)}map(t,e){const n=[];for(let r=0;r<this.length;r++){const i=this[r];i instanceof Error&&oE(`index ${r}`,i),n.push(t.call(e,i,r,this))}return n}getValue(t){const e=sE(this).indexOf(t);if(-1===e)return;const n=this[e];return n instanceof Error&&oE(`property ${JSON.stringify(t)}`,n.error),n}static fromItems(t,e){return new cE(rE,t,e)}}function uE(t){const e=[],n=function(t,r){if(Array.isArray(r))for(let s in r){const a=t.slice();a.push(s);try{n(a,r[s])}catch(i){e.push({path:a,error:i})}}};return n([],t),e}function hE(t){let e=Q_(t);return y_(e.length<=tE,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:tE,offset:e.length}),e.length!==tE&&(e=M_(N_([eE.slice(e.length%tE),e]))),e}class dE{name;type;localName;dynamic;constructor(t,e,n,r){f_(this,{name:t,type:e,localName:n,dynamic:r},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(t,e){b_(!1,t,this.localName,e)}}class fE{#I;#D;constructor(){this.#I=[],this.#D=0}get data(){return N_(this.#I)}get length(){return this.#D}#U(t){return this.#I.push(t),this.#D+=t.length,t.length}appendWriter(t){return this.#U(M_(t.data))}writeBytes(t){let e=M_(t);const n=e.length%tE;return n&&(e=M_(N_([e,eE.slice(n)]))),this.#U(e)}writeValue(t){return this.#U(hE(t))}writeUpdatableValue(){const t=this.#I.length;return this.#I.push(eE),this.#D+=tE,e=>{this.#I[t]=hE(e)}}}class pE{allowLoose;#I;#L;#F;#k;#B;constructor(t,e,n){f_(this,{allowLoose:!!e}),this.#I=M_(t),this.#F=0,this.#k=null,this.#B=null!=n?n:1024,this.#L=0}get data(){return P_(this.#I)}get dataLength(){return this.#I.length}get consumed(){return this.#L}get bytes(){return new Uint8Array(this.#I)}#z(t){if(this.#k)return this.#k.#z(t);this.#F+=t,y_(this.#B<1||this.#F<=this.#B*this.dataLength,`compressed ABI data exceeds inflation ratio of ${this.#B} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:M_(this.#I),offset:this.#L,length:t,info:{bytesRead:this.#F,dataLength:this.dataLength}})}#H(t,e,n){let r=Math.ceil(e/tE)*tE;return this.#L+r>this.#I.length&&(this.allowLoose&&n&&this.#L+e<=this.#I.length?r=e:y_(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:M_(this.#I),length:this.#I.length,offset:this.#L+r})),this.#I.slice(this.#L,this.#L+r)}subReader(t){const e=new pE(this.#I.slice(this.#L+t),this.allowLoose,this.#B);return e.#k=this,e}readBytes(t,e){let n=this.#H(0,t,!!e);return this.#z(t),this.#L+=n.length,n.slice(0,t)}readValue(){return X_(this.readBytes(tE))}readIndex(){return Y_(this.readBytes(tE))}}function mE(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function gE(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function vE(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");mE(t.outputLen),mE(t.blockLen)}function yE(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function bE(t,e){gE(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const wE="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,_E=t=>t instanceof Uint8Array,xE=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),EE=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),AE=(t,e)=>t<<32-e|t>>>e;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");const SE=async()=>{};async function ME(t,e,n){let r=Date.now();for(let i=0;i<t;i++){n(i);const t=Date.now()-r;t>=0&&t<e||(await SE(),r+=t)}}function TE(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!_E(t))throw new Error("expected Uint8Array, got "+typeof t);return t}class RE{clone(){return this._cloneInto()}}const CE={}.toString;function PE(t,e){if(void 0!==e&&"[object Object]"!==CE.call(e))throw new Error("Options should be object or undefined");return Object.assign(t,e)}function NE(t){const e=e=>t().update(TE(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function OE(t=32){if(wE&&"function"==typeof wE.getRandomValues)return wE.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class IE extends RE{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,vE(t);const n=TE(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?t.create().update(n).digest():n);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=t.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(t){return yE(this),this.iHash.update(t),this}digestInto(t){yE(this),gE(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:i,blockLen:s,outputLen:a}=this;return t.finished=r,t.destroyed=i,t.blockLen=s,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const DE=(t,e,n)=>new IE(t,e).update(n).digest();function UE(t,e,n,r){const{c:i,dkLen:s,DK:a,PRF:o,PRFSalt:l}=function(t,e,n,r){vE(t);const i=PE({dkLen:32,asyncTick:10},r),{c:s,dkLen:a,asyncTick:o}=i;if(mE(s),mE(a),mE(o),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const l=TE(e),c=TE(n),u=new Uint8Array(a),h=DE.create(t,l),d=h._cloneInto().update(c);return{c:s,dkLen:a,asyncTick:o,DK:u,PRF:h,PRFSalt:d}}(t,e,n,r);let c;const u=new Uint8Array(4),h=EE(u),d=new Uint8Array(o.outputLen);for(let f=1,p=0;p<s;f++,p+=o.outputLen){const t=a.subarray(p,p+o.outputLen);h.setInt32(0,f,!1),(c=l._cloneInto(c)).update(u).digestInto(d),t.set(d.subarray(0,t.length));for(let e=1;e<i;e++){o._cloneInto(c).update(d).digestInto(d);for(let e=0;e<t.length;e++)t[e]^=d[e]}}return function(t,e,n,r,i){return t.destroy(),e.destroy(),r&&r.destroy(),i.fill(0),n}(o,l,a,c,d)}DE.create=(t,e)=>new IE(t,e);class LE extends RE{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=EE(this.buffer)}update(t){yE(this);const{view:e,buffer:n,blockLen:r}=this,i=(t=TE(t)).length;for(let s=0;s<i;){const a=Math.min(r-this.pos,i-s);if(a===r){const e=EE(t);for(;r<=i-s;s+=r)this.process(e,s);continue}n.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===r&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){yE(this),bE(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:i}=this;let{pos:s}=this;e[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>r-s&&(this.process(n,0),s=0);for(let u=s;u<r;u++)e[u]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const i=BigInt(32),s=BigInt(4294967295),a=Number(n>>i&s),o=Number(n&s),l=r?4:0,c=r?0:4;t.setUint32(e+l,a,r),t.setUint32(e+c,o,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const a=EE(t),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=o/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)a.setUint32(4*u,c[u],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:i,destroyed:s,pos:a}=this;return t.length=r,t.pos=a,t.finished=i,t.destroyed=s,r%e&&t.buffer.set(n),t}}const FE=(t,e,n)=>t&e^~t&n,kE=(t,e,n)=>t&e^t&n^e&n,BE=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),zE=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),HE=new Uint32Array(64);class GE extends LE{constructor(){super(64,32,8,!1),this.A=0|zE[0],this.B=0|zE[1],this.C=0|zE[2],this.D=0|zE[3],this.E=0|zE[4],this.F=0|zE[5],this.G=0|zE[6],this.H=0|zE[7]}get(){const{A:t,B:e,C:n,D:r,E:i,F:s,G:a,H:o}=this;return[t,e,n,r,i,s,a,o]}set(t,e,n,r,i,s,a,o){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|s,this.G=0|a,this.H=0|o}process(t,e){for(let u=0;u<16;u++,e+=4)HE[u]=t.getUint32(e,!1);for(let u=16;u<64;u++){const t=HE[u-15],e=HE[u-2],n=AE(t,7)^AE(t,18)^t>>>3,r=AE(e,17)^AE(e,19)^e>>>10;HE[u]=r+HE[u-7]+n+HE[u-16]|0}let{A:n,B:r,C:i,D:s,E:a,F:o,G:l,H:c}=this;for(let u=0;u<64;u++){const t=c+(AE(a,6)^AE(a,11)^AE(a,25))+FE(a,o,l)+BE[u]+HE[u]|0,e=(AE(n,2)^AE(n,13)^AE(n,22))+kE(n,r,i)|0;c=l,l=o,o=a,a=s+t|0,s=i,i=r,r=n,n=t+e|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,o=o+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,r,i,s,a,o,l,c)}roundClean(){HE.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const VE=NE(()=>new GE),jE=BigInt(2**32-1),WE=BigInt(32);function qE(t,e=!1){return e?{h:Number(t&jE),l:Number(t>>WE&jE)}:{h:0|Number(t>>WE&jE),l:0|Number(t&jE)}}function XE(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:a}=qE(t[i],e);[n[i],r[i]]=[s,a]}return[n,r]}const KE=(t,e,n)=>t<<n|e>>>32-n,YE=(t,e,n)=>e<<n|t>>>32-n,JE=(t,e,n)=>e<<n-32|t>>>64-n,QE=(t,e,n)=>t<<n-32|e>>>64-n;const ZE={fromBig:qE,split:XE,toBig:(t,e)=>BigInt(t>>>0)<<WE|BigInt(e>>>0),shrSH:(t,e,n)=>t>>>n,shrSL:(t,e,n)=>t<<32-n|e>>>n,rotrSH:(t,e,n)=>t>>>n|e<<32-n,rotrSL:(t,e,n)=>t<<32-n|e>>>n,rotrBH:(t,e,n)=>t<<64-n|e>>>n-32,rotrBL:(t,e,n)=>t>>>n-32|e<<64-n,rotr32H:(t,e)=>e,rotr32L:(t,e)=>t,rotlSH:KE,rotlSL:YE,rotlBH:JE,rotlBL:QE,add:function(t,e,n,r){const i=(e>>>0)+(r>>>0);return{h:t+n+(i/2**32|0)|0,l:0|i}},add3L:(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),add3H:(t,e,n,r)=>e+n+r+(t/2**32|0)|0,add4L:(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),add4H:(t,e,n,r,i)=>e+n+r+i+(t/2**32|0)|0,add5H:(t,e,n,r,i,s)=>e+n+r+i+s+(t/2**32|0)|0,add5L:(t,e,n,r,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(i>>>0)},[$E,tA]=(()=>ZE.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),eA=new Uint32Array(80),nA=new Uint32Array(80);class rA extends LE{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:n,Bl:r,Ch:i,Cl:s,Dh:a,Dl:o,Eh:l,El:c,Fh:u,Fl:h,Gh:d,Gl:f,Hh:p,Hl:m}=this;return[t,e,n,r,i,s,a,o,l,c,u,h,d,f,p,m]}set(t,e,n,r,i,s,a,o,l,c,u,h,d,f,p,m){this.Ah=0|t,this.Al=0|e,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|s,this.Dh=0|a,this.Dl=0|o,this.Eh=0|l,this.El=0|c,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|m}process(t,e){for(let y=0;y<16;y++,e+=4)eA[y]=t.getUint32(e),nA[y]=t.getUint32(e+=4);for(let y=16;y<80;y++){const t=0|eA[y-15],e=0|nA[y-15],n=ZE.rotrSH(t,e,1)^ZE.rotrSH(t,e,8)^ZE.shrSH(t,e,7),r=ZE.rotrSL(t,e,1)^ZE.rotrSL(t,e,8)^ZE.shrSL(t,e,7),i=0|eA[y-2],s=0|nA[y-2],a=ZE.rotrSH(i,s,19)^ZE.rotrBH(i,s,61)^ZE.shrSH(i,s,6),o=ZE.rotrSL(i,s,19)^ZE.rotrBL(i,s,61)^ZE.shrSL(i,s,6),l=ZE.add4L(r,o,nA[y-7],nA[y-16]),c=ZE.add4H(l,n,a,eA[y-7],eA[y-16]);eA[y]=0|c,nA[y]=0|l}let{Ah:n,Al:r,Bh:i,Bl:s,Ch:a,Cl:o,Dh:l,Dl:c,Eh:u,El:h,Fh:d,Fl:f,Gh:p,Gl:m,Hh:g,Hl:v}=this;for(let y=0;y<80;y++){const t=ZE.rotrSH(u,h,14)^ZE.rotrSH(u,h,18)^ZE.rotrBH(u,h,41),e=ZE.rotrSL(u,h,14)^ZE.rotrSL(u,h,18)^ZE.rotrBL(u,h,41),b=u&d^~u&p,w=h&f^~h&m,_=ZE.add5L(v,e,w,tA[y],nA[y]),x=ZE.add5H(_,g,t,b,$E[y],eA[y]),E=0|_,A=ZE.rotrSH(n,r,28)^ZE.rotrBH(n,r,34)^ZE.rotrBH(n,r,39),S=ZE.rotrSL(n,r,28)^ZE.rotrBL(n,r,34)^ZE.rotrBL(n,r,39),M=n&i^n&a^i&a,T=r&s^r&o^s&o;g=0|p,v=0|m,p=0|d,m=0|f,d=0|u,f=0|h,({h:u,l:h}=ZE.add(0|l,0|c,0|x,0|E)),l=0|a,c=0|o,a=0|i,o=0|s,i=0|n,s=0|r;const R=ZE.add3L(E,S,T);n=ZE.add3H(R,x,A,M),r=0|R}({h:n,l:r}=ZE.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:s}=ZE.add(0|this.Bh,0|this.Bl,0|i,0|s)),({h:a,l:o}=ZE.add(0|this.Ch,0|this.Cl,0|a,0|o)),({h:l,l:c}=ZE.add(0|this.Dh,0|this.Dl,0|l,0|c)),({h:u,l:h}=ZE.add(0|this.Eh,0|this.El,0|u,0|h)),({h:d,l:f}=ZE.add(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:m}=ZE.add(0|this.Gh,0|this.Gl,0|p,0|m)),({h:g,l:v}=ZE.add(0|this.Hh,0|this.Hl,0|g,0|v)),this.set(n,r,i,s,a,o,l,c,u,h,d,f,p,m,g,v)}roundClean(){eA.fill(0),nA.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const iA=NE(()=>new rA);const sA=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}(),aA=sA.crypto||sA.msCrypto;function oA(t){switch(t){case"sha256":return VE.create();case"sha512":return iA.create()}b_(!1,"invalid hashing algorithm name","algorithm",t)}let lA=!1;const cA=function(t,e,n){return function(t,e){const n={sha256:VE,sha512:iA}[t];return b_(null!=n,"invalid hmac algorithm","algorithm",t),DE.create(n,e)}(t,e).update(n).digest()};let uA=cA;function hA(t,e,n){const r=S_(e,"key"),i=S_(n,"data");return P_(uA(t,r,i))}hA._=cA,hA.lock=function(){lA=!0},hA.register=function(t){if(lA)throw new Error("computeHmac is locked");uA=t},Object.freeze(hA);const[dA,fA,pA]=[[],[],[]],mA=BigInt(0),gA=BigInt(1),vA=BigInt(2),yA=BigInt(7),bA=BigInt(256),wA=BigInt(113);for(let yU=0,bU=gA,wU=1,_U=0;yU<24;yU++){[wU,_U]=[_U,(2*wU+3*_U)%5],dA.push(2*(5*_U+wU)),fA.push((yU+1)*(yU+2)/2%64);let t=mA;for(let e=0;e<7;e++)bU=(bU<<gA^(bU>>yA)*wA)%bA,bU&vA&&(t^=gA<<(gA<<BigInt(e))-gA);pA.push(t)}const[_A,xA]=XE(pA,!0),EA=(t,e,n)=>n>32?JE(t,e,n):KE(t,e,n),AA=(t,e,n)=>n>32?QE(t,e,n):YE(t,e,n);class SA extends RE{constructor(t,e,n,r=!1,i=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=n,this.enableXOF=r,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,mE(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=xE(this.state)}keccak(){!function(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let r=0;r<10;r++)n[r]=t[r]^t[r+10]^t[r+20]^t[r+30]^t[r+40];for(let r=0;r<10;r+=2){const e=(r+8)%10,i=(r+2)%10,s=n[i],a=n[i+1],o=EA(s,a,1)^n[e],l=AA(s,a,1)^n[e+1];for(let n=0;n<50;n+=10)t[r+n]^=o,t[r+n+1]^=l}let e=t[2],i=t[3];for(let n=0;n<24;n++){const r=fA[n],s=EA(e,i,r),a=AA(e,i,r),o=dA[n];e=t[o],i=t[o+1],t[o]=s,t[o+1]=a}for(let r=0;r<50;r+=10){for(let e=0;e<10;e++)n[e]=t[r+e];for(let e=0;e<10;e++)t[r+e]^=~n[(e+2)%10]&n[(e+4)%10]}t[0]^=_A[r],t[1]^=xA[r]}n.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){yE(this);const{blockLen:e,state:n}=this,r=(t=TE(t)).length;for(let i=0;i<r;){const s=Math.min(e-this.pos,r-i);for(let e=0;e<s;e++)n[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:n,blockLen:r}=this;t[n]^=e,128&e&&n===r-1&&this.keccak(),t[r-1]^=128,this.keccak()}writeInto(t){yE(this,!1),gE(t),this.finish();const e=this.state,{blockLen:n}=this;for(let r=0,i=t.length;r<i;){this.posOut>=n&&this.keccak();const s=Math.min(n-this.posOut,i-r);t.set(e.subarray(this.posOut,this.posOut+s),r),this.posOut+=s,r+=s}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return mE(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(bE(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:n,outputLen:r,rounds:i,enableXOF:s}=this;return t||(t=new SA(e,n,r,s,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=n,t.outputLen=r,t.enableXOF=s,t.destroyed=this.destroyed,t}}const MA=((t,e,n)=>NE(()=>new SA(e,t,n)))(1,136,32);let TA=!1;const RA=function(t){return MA(t)};let CA=RA;function PA(t){const e=S_(t,"data");return P_(CA(e))}PA._=RA,PA.lock=function(){TA=!0},PA.register=function(t){if(TA)throw new TypeError("keccak256 is locked");CA=t},Object.freeze(PA);const NA=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),OA=Uint8Array.from({length:16},(t,e)=>e);let IA=[OA],DA=[OA.map(t=>(9*t+5)%16)];for(let yU=0;yU<4;yU++)for(let t of[IA,DA])t.push(t[yU].map(t=>NA[t]));const UA=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>new Uint8Array(t)),LA=IA.map((t,e)=>t.map(t=>UA[e][t])),FA=DA.map((t,e)=>t.map(t=>UA[e][t])),kA=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),BA=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),zA=(t,e)=>t<<e|t>>>32-e;function HA(t,e,n,r){return 0===t?e^n^r:1===t?e&n|~e&r:2===t?(e|~n)^r:3===t?e&r|n&~r:e^(n|~r)}const GA=new Uint32Array(16);class VA extends LE{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:n,h3:r,h4:i}=this;return[t,e,n,r,i]}set(t,e,n,r,i){this.h0=0|t,this.h1=0|e,this.h2=0|n,this.h3=0|r,this.h4=0|i}process(t,e){for(let d=0;d<16;d++,e+=4)GA[d]=t.getUint32(e,!0);let n=0|this.h0,r=n,i=0|this.h1,s=i,a=0|this.h2,o=a,l=0|this.h3,c=l,u=0|this.h4,h=u;for(let d=0;d<5;d++){const t=4-d,e=kA[d],f=BA[d],p=IA[d],m=DA[d],g=LA[d],v=FA[d];for(let r=0;r<16;r++){const t=zA(n+HA(d,i,a,l)+GA[p[r]]+e,g[r])+u|0;n=u,u=l,l=0|zA(a,10),a=i,i=t}for(let n=0;n<16;n++){const e=zA(r+HA(t,s,o,c)+GA[m[n]]+f,v[n])+h|0;r=h,h=c,c=0|zA(o,10),o=s,s=e}}this.set(this.h1+a+c|0,this.h2+l+h|0,this.h3+u+r|0,this.h4+n+s|0,this.h0+i+o|0)}roundClean(){GA.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const jA=NE(()=>new VA);let WA=!1;const qA=function(t){return jA(t)};let XA=qA;function KA(t){const e=S_(t,"data");return P_(XA(e))}KA._=qA,KA.lock=function(){WA=!0},KA.register=function(t){if(WA)throw new TypeError("ripemd160 is locked");XA=t},Object.freeze(KA);let YA=!1;const JA=function(t,e,n,r,i){return function(t,e,n,r,i){const s={sha256:VE,sha512:iA}[i];return b_(null!=s,"invalid pbkdf2 algorithm","algorithm",i),UE(s,t,e,{c:n,dkLen:r})}(t,e,n,r,i)};let QA=JA;function ZA(t,e,n,r,i){const s=S_(t,"password"),a=S_(e,"salt");return P_(QA(s,a,n,r,i))}ZA._=JA,ZA.lock=function(){YA=!0},ZA.register=function(t){if(YA)throw new Error("pbkdf2 is locked");QA=t},Object.freeze(ZA);let $A=!1;const tS=function(t){return new Uint8Array(function(t){y_(null!=aA,"platform does not support secure random numbers","UNSUPPORTED_OPERATION",{operation:"randomBytes"}),b_(Number.isInteger(t)&&t>0&&t<=1024,"invalid length","length",t);const e=new Uint8Array(t);return aA.getRandomValues(e),e}(t))};let eS=tS;function nS(t){return eS(t)}nS._=tS,nS.lock=function(){$A=!0},nS.register=function(t){if($A)throw new Error("randomBytes is locked");eS=t},Object.freeze(nS);const rS=(t,e)=>t<<e|t>>>32-e;function iS(t,e,n,r,i,s){let a=t[e++]^n[r++],o=t[e++]^n[r++],l=t[e++]^n[r++],c=t[e++]^n[r++],u=t[e++]^n[r++],h=t[e++]^n[r++],d=t[e++]^n[r++],f=t[e++]^n[r++],p=t[e++]^n[r++],m=t[e++]^n[r++],g=t[e++]^n[r++],v=t[e++]^n[r++],y=t[e++]^n[r++],b=t[e++]^n[r++],w=t[e++]^n[r++],_=t[e++]^n[r++],x=a,E=o,A=l,S=c,M=u,T=h,R=d,C=f,P=p,N=m,O=g,I=v,D=y,U=b,L=w,F=_;for(let k=0;k<8;k+=2)M^=rS(x+D|0,7),P^=rS(M+x|0,9),D^=rS(P+M|0,13),x^=rS(D+P|0,18),N^=rS(T+E|0,7),U^=rS(N+T|0,9),E^=rS(U+N|0,13),T^=rS(E+U|0,18),L^=rS(O+R|0,7),A^=rS(L+O|0,9),R^=rS(A+L|0,13),O^=rS(R+A|0,18),S^=rS(F+I|0,7),C^=rS(S+F|0,9),I^=rS(C+S|0,13),F^=rS(I+C|0,18),E^=rS(x+S|0,7),A^=rS(E+x|0,9),S^=rS(A+E|0,13),x^=rS(S+A|0,18),R^=rS(T+M|0,7),C^=rS(R+T|0,9),M^=rS(C+R|0,13),T^=rS(M+C|0,18),I^=rS(O+N|0,7),P^=rS(I+O|0,9),N^=rS(P+I|0,13),O^=rS(N+P|0,18),D^=rS(F+L|0,7),U^=rS(D+F|0,9),L^=rS(U+D|0,13),F^=rS(L+U|0,18);i[s++]=a+x|0,i[s++]=o+E|0,i[s++]=l+A|0,i[s++]=c+S|0,i[s++]=u+M|0,i[s++]=h+T|0,i[s++]=d+R|0,i[s++]=f+C|0,i[s++]=p+P|0,i[s++]=m+N|0,i[s++]=g+O|0,i[s++]=v+I|0,i[s++]=y+D|0,i[s++]=b+U|0,i[s++]=w+L|0,i[s++]=_+F|0}function sS(t,e,n,r,i){let s=r+0,a=r+16*i;for(let o=0;o<16;o++)n[a+o]=t[e+16*(2*i-1)+o];for(let o=0;o<i;o++,s+=16,e+=16)iS(n,a,t,e,n,s),o>0&&(a+=16),iS(n,s,t,e+=16,n,a)}function aS(t,e,n){const r=PE({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:i,r:s,p:a,dkLen:o,asyncTick:l,maxmem:c,onProgress:u}=r;if(mE(i),mE(s),mE(a),mE(o),mE(l),mE(c),void 0!==u&&"function"!=typeof u)throw new Error("progressCb should be function");const h=128*s,d=h/4;if(i<=1||i&i-1||i>=2**(h/8)||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(a<0||a>137438953440/h)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(o<0||o>137438953440)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const f=h*(i+a);if(f>c)throw new Error(`Scrypt: parameters too large, ${f} (128 * r * (N + p)) > ${c} (maxmem)`);const p=UE(VE,t,e,{c:1,dkLen:h*a}),m=xE(p),g=xE(new Uint8Array(h*i)),v=xE(new Uint8Array(h));let y=()=>{};if(u){const t=2*i*a,e=Math.max(Math.floor(t/1e4),1);let n=0;y=()=>{n++,!u||n%e&&n!==t||u(n/t)}}return{N:i,r:s,p:a,dkLen:o,blockSize32:d,V:g,B32:m,B:p,tmp:v,blockMixCb:y,asyncTick:l}}function oS(t,e,n,r,i){const s=UE(VE,t,n,{c:1,dkLen:e});return n.fill(0),r.fill(0),i.fill(0),s}let lS=!1,cS=!1;const uS=async function(t,e,n,r,i,s,a){return await async function(t,e,n){const{N:r,r:i,p:s,dkLen:a,blockSize32:o,V:l,B32:c,B:u,tmp:h,blockMixCb:d,asyncTick:f}=aS(t,e,n);for(let p=0;p<s;p++){const t=o*p;for(let n=0;n<o;n++)l[n]=c[t+n];let e=0;await ME(r-1,f,()=>{sS(l,e,l,e+=o,i),d()}),sS(l,(r-1)*o,c,t,i),d(),await ME(r,f,()=>{const e=c[t+o-16]%r;for(let n=0;n<o;n++)h[n]=c[t+n]^l[e*o+n];sS(h,0,c,t,i),d()})}return oS(t,a,u,l,h)}(t,e,{N:n,r:r,p:i,dkLen:s,onProgress:a})},hS=function(t,e,n,r,i,s){return function(t,e,n){const{N:r,r:i,p:s,dkLen:a,blockSize32:o,V:l,B32:c,B:u,tmp:h,blockMixCb:d}=aS(t,e,n);for(let f=0;f<s;f++){const t=o*f;for(let e=0;e<o;e++)l[e]=c[t+e];for(let e=0,n=0;e<r-1;e++)sS(l,n,l,n+=o,i),d();sS(l,(r-1)*o,c,t,i),d();for(let e=0;e<r;e++){const e=c[t+o-16]%r;for(let n=0;n<o;n++)h[n]=c[t+n]^l[e*o+n];sS(h,0,c,t,i),d()}}return oS(t,a,u,l,h)}(t,e,{N:n,r:r,p:i,dkLen:s})};let dS=uS,fS=hS;async function pS(t,e,n,r,i,s,a){const o=S_(t,"passwd"),l=S_(e,"salt");return P_(await dS(o,l,n,r,i,s,a))}function mS(t,e,n,r,i,s){const a=S_(t,"passwd"),o=S_(e,"salt");return P_(fS(a,o,n,r,i,s))}pS._=uS,pS.lock=function(){cS=!0},pS.register=function(t){if(cS)throw new Error("scrypt is locked");dS=t},Object.freeze(pS),mS._=hS,mS.lock=function(){lS=!0},mS.register=function(t){if(lS)throw new Error("scryptSync is locked");fS=t},Object.freeze(mS);const gS=function(t){return oA("sha256").update(t).digest()},vS=function(t){return oA("sha512").update(t).digest()};let yS=gS,bS=vS,wS=!1,_S=!1;function xS(t){const e=S_(t,"data");return P_(yS(e))}function ES(t){const e=S_(t,"data");return P_(bS(e))}xS._=gS,xS.lock=function(){wS=!0},xS.register=function(t){if(wS)throw new Error("sha256 is locked");yS=t},Object.freeze(xS),ES._=vS,ES.lock=function(){_S=!0},ES.register=function(t){if(_S)throw new Error("sha512 is locked");bS=t},Object.freeze(xS);const AS=BigInt(0),SS=BigInt(1),MS=BigInt(2),TS=t=>t instanceof Uint8Array,RS=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function CS(t){if(!TS(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=RS[t[n]];return e}function PS(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function NS(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function OS(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const e=2*r,i=t.slice(e,e+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function IS(t){return NS(CS(t))}function DS(t){if(!TS(t))throw new Error("Uint8Array expected");return NS(CS(Uint8Array.from(t).reverse()))}function US(t,e){return OS(t.toString(16).padStart(2*e,"0"))}function LS(t,e){return US(t,e).reverse()}function FS(t,e,n){let r;if("string"==typeof e)try{r=OS(e)}catch(Es){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${Es}`)}else{if(!TS(e))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const i=r.length;if("number"==typeof n&&i!==n)throw new Error(`${t} expected ${n} bytes, got ${i}`);return r}function kS(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!TS(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e}const BS=t=>(MS<<BigInt(t-1))-SS,zS=t=>new Uint8Array(t),HS=t=>Uint8Array.from(t);function GS(t,e,n){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=zS(t),i=zS(t),s=0;const a=()=>{r.fill(1),i.fill(0),s=0},o=(...t)=>n(i,r,...t),l=(t=zS())=>{i=o(HS([0]),t),r=o(),0!==t.length&&(i=o(HS([1]),t),r=o())},c=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const n=[];for(;t<e;){r=o();const e=r.slice();n.push(e),t+=r.length}return kS(...n)};return(t,e)=>{let n;for(a(),l(t);!(n=e(c()));)l();return a(),n}}const VS={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function jS(t,e,n={}){const r=(e,n,r)=>{const i=VS[n];if("function"!=typeof i)throw new Error(`Invalid validator "${n}", expected function`);const s=t[e];if(!(r&&void 0===s||i(s,t)))throw new Error(`Invalid param ${String(e)}=${s} (${typeof s}), expected ${n}`)};for(const[i,s]of Object.entries(e))r(i,s,!1);for(const[i,s]of Object.entries(n))r(i,s,!0);return t}const WS=Object.freeze(Object.defineProperty({__proto__:null,bitGet:function(t,e){return t>>BigInt(e)&SS},bitLen:function(t){let e;for(e=0;t>AS;t>>=SS,e+=1);return e},bitMask:BS,bitSet:(t,e,n)=>t|(n?SS:AS)<<BigInt(e),bytesToHex:CS,bytesToNumberBE:IS,bytesToNumberLE:DS,concatBytes:kS,createHmacDrbg:GS,ensureBytes:FS,equalBytes:function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},hexToBytes:OS,hexToNumber:NS,numberToBytesBE:US,numberToBytesLE:LS,numberToHexUnpadded:PS,numberToVarBytesBE:function(t){return OS(PS(t))},utf8ToBytes:function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))},validateObject:jS},Symbol.toStringTag,{value:"Module"})),qS=BigInt(0),XS=BigInt(1),KS=BigInt(2),YS=BigInt(3),JS=BigInt(4),QS=BigInt(5),ZS=BigInt(8);function $S(t,e){const n=t%e;return n>=qS?n:e+n}function tM(t,e,n){if(n<=qS||e<qS)throw new Error("Expected power/modulo > 0");if(n===XS)return qS;let r=XS;for(;e>qS;)e&XS&&(r=r*t%n),t=t*t%n,e>>=XS;return r}function eM(t,e,n){let r=t;for(;e-- >qS;)r*=r,r%=n;return r}function nM(t,e){if(t===qS||e<=qS)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=$S(t,e),r=e,i=qS,s=XS;for(;n!==qS;){const t=r%n,e=i-s*(r/n);r=n,n=t,i=s,s=e}if(r!==XS)throw new Error("invert: does not exist");return $S(i,e)}function rM(t){if(t%JS===YS){const e=(t+XS)/JS;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}if(t%ZS===QS){const e=(t-QS)/ZS;return function(t,n){const r=t.mul(n,KS),i=t.pow(r,e),s=t.mul(n,i),a=t.mul(t.mul(s,KS),i),o=t.mul(s,t.sub(a,t.ONE));if(!t.eql(t.sqr(o),n))throw new Error("Cannot find square root");return o}}return function(t){const e=(t-XS)/KS;let n,r,i;for(n=t-XS,r=0;n%KS===qS;n/=KS,r++);for(i=KS;i<t&&tM(i,e,t)!==t-XS;i++);if(1===r){const e=(t+XS)/JS;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}const s=(n+XS)/KS;return function(t,a){if(t.pow(a,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let o=r,l=t.pow(t.mul(t.ONE,i),n),c=t.pow(a,s),u=t.pow(a,n);for(;!t.eql(u,t.ONE);){if(t.eql(u,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(u);e<o&&!t.eql(r,t.ONE);e++)r=t.sqr(r);const n=t.pow(l,XS<<BigInt(o-e-1));l=t.sqr(n),c=t.mul(c,n),u=t.mul(u,l),o=e}return c}}(t)}BigInt(9),BigInt(16);const iM=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function sM(t,e){const n=void 0!==e?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function aM(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function oM(t){const e=aM(t);return e+Math.ceil(e/2)}const lM=BigInt(0),cM=BigInt(1);function uM(t){return jS(t.Fp,iM.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),jS(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...sM(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const{bytesToNumberBE:hM,hexToBytes:dM}=WS,fM={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=fM;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(128&r[0])throw new e("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:hM(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=fM,n="string"==typeof t?dM(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:i,l:s}=fM._parseInt(n.subarray(2)),{d:a,l:o}=fM._parseInt(s);if(o.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:a}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,n=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},r=e(n(t.s)),i=e(n(t.r)),s=r.length/2,a=i.length/2,o=n(s),l=n(a);return`30${n(a+s+4)}02${l}${i}02${o}${r}`}},pM=BigInt(0),mM=BigInt(1);BigInt(2);const gM=BigInt(3);function vM(t){const e=function(t){const e=uM(t);jS(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:i}=e;if(n){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:n}=e,r=e.toBytes||((t,e,r)=>{const i=e.toAffine();return kS(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),i=e.fromBytes||(t=>{const e=t.subarray(1);return{x:n.fromBytes(e.subarray(0,n.BYTES)),y:n.fromBytes(e.subarray(n.BYTES,2*n.BYTES))}});function s(t){const{a:r,b:i}=e,s=n.sqr(t),a=n.mul(s,t);return n.add(n.add(a,n.mul(t,r)),i)}if(!n.eql(n.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function a(t){return"bigint"==typeof t&&pM<t&&t<e.n}function o(t){if(!a(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(t){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:s}=e;if(n&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=CS(t)),"string"!=typeof t||!n.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*r,"0")}let a;try{a="bigint"==typeof t?t:IS(FS("private key",t,r))}catch(l){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof t}`)}return i&&(a=$S(a,s)),o(a),a}const c=new Map;function u(t){if(!(t instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!n.isValid(t))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof h)throw new Error("projective point not allowed");const i=t=>n.eql(t,n.ZERO);return i(e)&&i(r)?h.ZERO:new h(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=n.invertBatch(t.map(t=>t.pz));return t.map((t,n)=>t.toAffine(e[n])).map(h.fromAffine)}static fromHex(t){const e=h.fromAffine(i(FS("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return h.BASE.multiply(l(t))}_setWindowSize(t){this._WINDOW_SIZE=t,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:t,y:r}=this.toAffine();if(!n.isValid(t)||!n.isValid(r))throw new Error("bad point: x or y not FE");const i=n.sqr(r),a=s(t);if(!n.eql(i,a))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){u(t);const{px:e,py:r,pz:i}=this,{px:s,py:a,pz:o}=t,l=n.eql(n.mul(e,o),n.mul(s,i)),c=n.eql(n.mul(r,o),n.mul(a,i));return l&&c}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,i=n.mul(r,gM),{px:s,py:a,pz:o}=this;let l=n.ZERO,c=n.ZERO,u=n.ZERO,d=n.mul(s,s),f=n.mul(a,a),p=n.mul(o,o),m=n.mul(s,a);return m=n.add(m,m),u=n.mul(s,o),u=n.add(u,u),l=n.mul(t,u),c=n.mul(i,p),c=n.add(l,c),l=n.sub(f,c),c=n.add(f,c),c=n.mul(l,c),l=n.mul(m,l),u=n.mul(i,u),p=n.mul(t,p),m=n.sub(d,p),m=n.mul(t,m),m=n.add(m,u),u=n.add(d,d),d=n.add(u,d),d=n.add(d,p),d=n.mul(d,m),c=n.add(c,d),p=n.mul(a,o),p=n.add(p,p),d=n.mul(p,m),l=n.sub(l,d),u=n.mul(p,f),u=n.add(u,u),u=n.add(u,u),new h(l,c,u)}add(t){u(t);const{px:r,py:i,pz:s}=this,{px:a,py:o,pz:l}=t;let c=n.ZERO,d=n.ZERO,f=n.ZERO;const p=e.a,m=n.mul(e.b,gM);let g=n.mul(r,a),v=n.mul(i,o),y=n.mul(s,l),b=n.add(r,i),w=n.add(a,o);b=n.mul(b,w),w=n.add(g,v),b=n.sub(b,w),w=n.add(r,s);let _=n.add(a,l);return w=n.mul(w,_),_=n.add(g,y),w=n.sub(w,_),_=n.add(i,s),c=n.add(o,l),_=n.mul(_,c),c=n.add(v,y),_=n.sub(_,c),f=n.mul(p,w),c=n.mul(m,y),f=n.add(c,f),c=n.sub(v,f),f=n.add(v,f),d=n.mul(c,f),v=n.add(g,g),v=n.add(v,g),y=n.mul(p,y),w=n.mul(m,w),v=n.add(v,y),y=n.sub(g,y),y=n.mul(p,y),w=n.add(w,y),g=n.mul(v,w),d=n.add(d,g),g=n.mul(_,w),c=n.mul(b,c),c=n.sub(c,g),g=n.mul(b,v),f=n.mul(_,f),f=n.add(f,g),new h(c,d,f)}subtract(t){return this.add(t.negate())}is0(){return this.equals(h.ZERO)}wNAF(t){return f.wNAFCached(this,c,t,t=>{const e=n.invertBatch(t.map(t=>t.pz));return t.map((t,n)=>t.toAffine(e[n])).map(h.fromAffine)})}multiplyUnsafe(t){const r=h.ZERO;if(t===pM)return r;if(o(t),t===mM)return this;const{endo:i}=e;if(!i)return f.unsafeLadder(this,t);let{k1neg:s,k1:a,k2neg:l,k2:c}=i.splitScalar(t),u=r,d=r,p=this;for(;a>pM||c>pM;)a&mM&&(u=u.add(p)),c&mM&&(d=d.add(p)),p=p.double(),a>>=mM,c>>=mM;return s&&(u=u.negate()),l&&(d=d.negate()),d=new h(n.mul(d.px,i.beta),d.py,d.pz),u.add(d)}multiply(t){o(t);let r,i,s=t;const{endo:a}=e;if(a){const{k1neg:t,k1:e,k2neg:o,k2:l}=a.splitScalar(s);let{p:c,f:u}=this.wNAF(e),{p:d,f:p}=this.wNAF(l);c=f.constTimeNegate(t,c),d=f.constTimeNegate(o,d),d=new h(n.mul(d.px,a.beta),d.py,d.pz),r=c.add(d),i=u.add(p)}else{const{p:t,f:e}=this.wNAF(s);r=t,i=e}return h.normalizeZ([r,i])[0]}multiplyAndAddUnsafe(t,e,n){const r=h.BASE,i=(t,e)=>e!==pM&&e!==mM&&t.equals(r)?t.multiply(e):t.multiplyUnsafe(e),s=i(this,e).add(i(t,n));return s.is0()?void 0:s}toAffine(t){const{px:e,py:r,pz:i}=this,s=this.is0();null==t&&(t=s?n.ONE:n.inv(i));const a=n.mul(e,t),o=n.mul(r,t),l=n.mul(i,t);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(l,n.ONE))throw new Error("invZ was invalid");return{x:a,y:o}}isTorsionFree(){const{h:t,isTorsionFree:n}=e;if(t===mM)return!0;if(n)return n(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:n}=e;return t===mM?this:n?n(h,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),r(h,this,t)}toHex(t=!0){return CS(this.toRawBytes(t))}}h.BASE=new h(e.Gx,e.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const d=e.nBitLength,f=function(t,e){const n=(t,e)=>{const n=e.negate();return t?n:e},r=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:n,unsafeLadder(e,n){let r=t.ZERO,i=e;for(;n>lM;)n&cM&&(r=r.add(i)),i=i.double(),n>>=cM;return r},precomputeWindow(t,e){const{windows:n,windowSize:i}=r(e),s=[];let a=t,o=a;for(let r=0;r<n;r++){o=a,s.push(o);for(let t=1;t<i;t++)o=o.add(a),s.push(o);a=o.double()}return s},wNAF(e,i,s){const{windows:a,windowSize:o}=r(e);let l=t.ZERO,c=t.BASE;const u=BigInt(2**e-1),h=2**e,d=BigInt(e);for(let t=0;t<a;t++){const e=t*o;let r=Number(s&u);s>>=d,r>o&&(r-=h,s+=cM);const a=e,f=e+Math.abs(r)-1,p=t%2!=0,m=r<0;0===r?c=c.add(n(p,i[a])):l=l.add(n(m,i[f]))}return{p:l,f:c}},wNAFCached(t,e,n,r){const i=t._WINDOW_SIZE||1;let s=e.get(t);return s||(s=this.precomputeWindow(t,i),1!==i&&e.set(t,r(s))),this.wNAF(i,s,n)}}}(h,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:s,isWithinCurveOrder:a}}function yM(t){const e=function(t){const e=uM(t);return jS(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:n,n:r}=e,i=n.BYTES+1,s=2*n.BYTES+1;function a(t){return $S(t,r)}function o(t){return nM(t,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:u,isWithinCurveOrder:h}=vM({...e,toBytes(t,e,r){const i=e.toAffine(),s=n.toBytes(i.x),a=kS;return r?a(Uint8Array.from([e.hasEvenY()?2:3]),s):a(Uint8Array.from([4]),s,n.toBytes(i.y))},fromBytes(t){const e=t.length,r=t[0],a=t.subarray(1);if(e!==i||2!==r&&3!==r){if(e===s&&4===r){return{x:n.fromBytes(a.subarray(0,n.BYTES)),y:n.fromBytes(a.subarray(n.BYTES,2*n.BYTES))}}throw new Error(`Point of length ${e} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}{const t=IS(a);if(!(pM<(o=t)&&o<n.ORDER))throw new Error("Point is not on curve");const e=u(t);let i=n.sqrt(e);return!(1&~r)!==((i&mM)===mM)&&(i=n.neg(i)),{x:t,y:i}}var o}}),d=t=>CS(US(t,e.nByteLength));function f(t){return t>r>>mM}const p=(t,e,n)=>IS(t.slice(e,n));class m{constructor(t,e,n){this.r=t,this.s=e,this.recovery=n,this.assertValidity()}static fromCompact(t){const n=e.nByteLength;return t=FS("compactSignature",t,2*n),new m(p(t,0,n),p(t,n,2*n))}static fromDER(t){const{r:e,s:n}=fM.toSig(FS("DER",t));return new m(e,n)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new m(this.r,this.s,t)}recoverPublicKey(t){const{r:r,s:i,recovery:s}=this,c=b(FS("msgHash",t));if(null==s||![0,1,2,3].includes(s))throw new Error("recovery id invalid");const u=2===s||3===s?r+e.n:r;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=1&s?"03":"02",f=l.fromHex(h+d(u)),p=o(u),m=a(-c*p),g=a(i*p),v=l.BASE.multiplyAndAddUnsafe(f,m,g);if(!v)throw new Error("point at infinify");return v.assertValidity(),v}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return OS(this.toDERHex())}toDERHex(){return fM.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return OS(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const g={isValidPrivateKey(t){try{return c(t),!0}catch(e){return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const t=oM(e.n);return function(t,e,n=!1){const r=t.length,i=aM(e),s=oM(e);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);const a=$S(n?IS(t):DS(t),e-XS)+XS;return n?LS(a,i):US(a,i)}(e.randomBytes(t),e.n)},precompute:(t=8,e=l.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function v(t){const e=t instanceof Uint8Array,n="string"==typeof t,r=(e||n)&&t.length;return e?r===i||r===s:n?r===2*i||r===2*s:t instanceof l}const y=e.bits2int||function(t){const n=IS(t),r=8*t.length-e.nBitLength;return r>0?n>>BigInt(r):n},b=e.bits2int_modN||function(t){return a(y(t))},w=BS(e.nBitLength);function _(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(pM<=t&&t<w))throw new Error(`bigint expected < 2^${e.nBitLength}`);return US(t,e.nByteLength)}function x(t,r,i=E){if(["recovered","canonical"].some(t=>t in i))throw new Error("sign() legacy options not supported");const{hash:s,randomBytes:u}=e;let{lowS:d,prehash:p,extraEntropy:g}=i;null==d&&(d=!0),t=FS("msgHash",t),p&&(t=FS("prehashed msgHash",s(t)));const v=b(t),w=c(r),x=[_(w),_(v)];if(null!=g){const t=!0===g?u(n.BYTES):g;x.push(FS("extraEntropy",t))}const A=kS(...x),S=v;return{seed:A,k2sig:function(t){const e=y(t);if(!h(e))return;const n=o(e),r=l.BASE.multiply(e).toAffine(),i=a(r.x);if(i===pM)return;const s=a(n*a(S+i*w));if(s===pM)return;let c=(r.x===i?0:2)|Number(r.y&mM),u=s;return d&&f(s)&&(u=function(t){return f(t)?a(-t):t}(s),c^=1),new m(i,u,c)}}}const E={lowS:e.lowS,prehash:!1},A={lowS:e.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return l.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,n=!0){if(v(t))throw new Error("first arg must be private key");if(!v(e))throw new Error("second arg must be public key");return l.fromHex(e).multiply(c(t)).toRawBytes(n)},sign:function(t,n,r=E){const{seed:i,k2sig:s}=x(t,n,r),a=e;return GS(a.hash.outputLen,a.nByteLength,a.hmac)(i,s)},verify:function(t,n,r,i=A){const s=t;if(n=FS("msgHash",n),r=FS("publicKey",r),"strict"in i)throw new Error("options.strict was renamed to lowS");const{lowS:c,prehash:u}=i;let h,d;try{if("string"==typeof s||s instanceof Uint8Array)try{h=m.fromDER(s)}catch(x){if(!(x instanceof fM.Err))throw x;h=m.fromCompact(s)}else{if("object"!=typeof s||"bigint"!=typeof s.r||"bigint"!=typeof s.s)throw new Error("PARSE");{const{r:t,s:e}=s;h=new m(t,e)}}d=l.fromHex(r)}catch(E){if("PARSE"===E.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(c&&h.hasHighS())return!1;u&&(n=e.hash(n));const{r:f,s:p}=h,g=b(n),v=o(p),y=a(g*v),w=a(f*v),_=l.BASE.multiplyAndAddUnsafe(d,y,w)?.toAffine();return!!_&&a(_.x)===f},ProjectivePoint:l,Signature:m,utils:g}}function bM(t){return{hash:t,hmac:(e,...n)=>DE(t,e,function(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!_E(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e}(...n)),randomBytes:OE}}BigInt(4);const wM=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),_M=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),xM=BigInt(1),EM=BigInt(2),AM=(t,e)=>(t+e/EM)/e;const SM=function(t,e,n=!1,r={}){if(t<=qS)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:i,nByteLength:s}=sM(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const a=rM(t),o=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:BS(i),ZERO:qS,ONE:XS,create:e=>$S(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return qS<=e&&e<t},is0:t=>t===qS,isOdd:t=>(t&XS)===XS,neg:e=>$S(-e,t),eql:(t,e)=>t===e,sqr:e=>$S(e*e,t),add:(e,n)=>$S(e+n,t),sub:(e,n)=>$S(e-n,t),mul:(e,n)=>$S(e*n,t),pow:(t,e)=>function(t,e,n){if(n<qS)throw new Error("Expected power > 0");if(n===qS)return t.ONE;if(n===XS)return e;let r=t.ONE,i=e;for(;n>qS;)n&XS&&(r=t.mul(r,i)),i=t.sqr(i),n>>=XS;return r}(o,t,e),div:(e,n)=>$S(e*nM(n,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>nM(e,t),sqrt:r.sqrt||(t=>a(o,t)),invertBatch:t=>function(t,e){const n=new Array(e.length),r=e.reduce((e,r,i)=>t.is0(r)?e:(n[i]=e,t.mul(e,r)),t.ONE),i=t.inv(r);return e.reduceRight((e,r,i)=>t.is0(r)?e:(n[i]=t.mul(e,n[i]),t.mul(e,r)),i),n}(o,t),cmov:(t,e,n)=>n?e:t,toBytes:t=>n?LS(t,s):US(t,s),fromBytes:t=>{if(t.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${t.length}`);return n?DS(t):IS(t)}});return Object.freeze(o)}(wM,void 0,void 0,{sqrt:function(t){const e=wM,n=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),l=BigInt(88),c=t*t*t%e,u=c*c*t%e,h=eM(u,n,e)*u%e,d=eM(h,n,e)*u%e,f=eM(d,EM,e)*c%e,p=eM(f,i,e)*f%e,m=eM(p,s,e)*p%e,g=eM(m,o,e)*m%e,v=eM(g,l,e)*g%e,y=eM(v,o,e)*m%e,b=eM(y,n,e)*u%e,w=eM(b,a,e)*p%e,_=eM(w,r,e)*c%e,x=eM(_,EM,e);if(!SM.eql(SM.sqr(x),t))throw new Error("Cannot find square root");return x}}),MM=function(t,e){const n=e=>yM({...t,...bM(e)});return Object.freeze({...n(e),create:n})}({a:BigInt(0),b:BigInt(7),Fp:SM,n:_M,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=_M,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-xM*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,a=BigInt("0x100000000000000000000000000000000"),o=AM(s*t,e),l=AM(-r*t,e);let c=$S(t-o*n-l*i,e),u=$S(-o*r-l*s,e);const h=c>a,d=u>a;if(h&&(c=e-c),d&&(u=e-u),c>a||u>a)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:d,k2:u}}}},VE);BigInt(0),MM.ProjectivePoint;const TM="0x0000000000000000000000000000000000000000",RM="0x0000000000000000000000000000000000000000000000000000000000000000",CM=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),PM=BigInt("1000000000000000000"),NM=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),OM=BigInt("0x8000000000000000000000000000000000000000000000000000000000000000")*BigInt(-1),IM=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),DM="Ethereum Signed Message:\n",UM=BigInt(0),LM=BigInt(1),FM=BigInt(2),kM=BigInt(27),BM=BigInt(28),zM=BigInt(35),HM=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),GM=HM/FM,VM=Symbol.for("nodejs.util.inspect.custom"),jM={};function WM(t){return L_(Q_(t),32)}class qM{#G;#V;#j;#W;get r(){return this.#G}set r(t){b_(32===O_(t),"invalid r","value",t),this.#G=P_(t)}get s(){return b_(parseInt(this.#V.substring(0,3))<8,"non-canonical s; use ._s","s",this.#V),this.#V}set s(t){b_(32===O_(t),"invalid s","value",t),this.#V=P_(t)}get _s(){return this.#V}isValid(){return BigInt(this.#V)<=GM}get v(){return this.#j}set v(t){const e=K_(t,"value");b_(27===e||28===e,"invalid v","v",t),this.#j=e}get networkV(){return this.#W}get legacyChainId(){const t=this.networkV;return null==t?null:qM.getChainId(t)}get yParity(){return 27===this.v?0:1}get yParityAndS(){const t=S_(this.s);return this.yParity&&(t[0]|=128),P_(t)}get compactSerialized(){return N_([this.r,this.yParityAndS])}get serialized(){return N_([this.r,this.s,this.yParity?"0x1c":"0x1b"])}constructor(t,e,n,r){E_(t,jM,"Signature"),this.#G=e,this.#V=n,this.#j=r,this.#W=null}getCanonical(){if(this.isValid())return this;const t=HM-BigInt(this._s),e=55-this.v,n=new qM(jM,this.r,WM(t),e);return this.networkV&&(n.#W=this.networkV),n}clone(){const t=new qM(jM,this.r,this._s,this.v);return this.networkV&&(t.#W=this.networkV),t}toJSON(){const t=this.networkV;return{_type:"signature",networkV:null!=t?t.toString():null,r:this.r,s:this._s,v:this.v}}[VM](){return this.toString()}toString(){return this.isValid()?`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v} }`:`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v}, valid: false }`}static getChainId(t){const e=j_(t,"v");return e==kM||e==BM?UM:(b_(e>=zM,"invalid EIP-155 v","v",t),(e-zM)/FM)}static getChainIdV(t,e){return j_(t)*FM+BigInt(35+e-27)}static getNormalizedV(t){const e=j_(t);return e===UM||e===kM?27:e===LM||e===BM?28:(b_(e>=zM,"invalid v","v",t),e&LM?27:28)}static from(t){function e(e,n){b_(e,n,"signature",t)}if(null==t)return new qM(jM,RM,RM,27);if("string"==typeof t){const n=S_(t,"signature");if(64===n.length){const t=P_(n.slice(0,32)),e=n.slice(32,64),r=128&e[0]?28:27;return e[0]&=127,new qM(jM,t,P_(e),r)}if(65===n.length){const t=P_(n.slice(0,32)),e=P_(n.slice(32,64)),r=qM.getNormalizedV(n[64]);return new qM(jM,t,e,r)}e(!1,"invalid raw signature length")}if(t instanceof qM)return t.clone();const n=t.r;e(null!=n,"missing r");const r=WM(n),i=function(t,n){if(null!=t)return WM(t);if(null!=n){e(T_(n,32),"invalid yParityAndS");const t=S_(n);return t[0]&=127,P_(t)}e(!1,"missing s")}(t.s,t.yParityAndS),{networkV:s,v:a}=function(t,n,r){if(null!=t){const e=j_(t);return{networkV:e>=zM?e:void 0,v:qM.getNormalizedV(e)}}if(null!=n)return e(T_(n,32),"invalid yParityAndS"),{v:128&S_(n)[0]?28:27};if(null!=r){switch(K_(r,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}e(!1,"invalid yParity")}e(!1,"missing v")}(t.v,t.yParityAndS,t.yParity),o=new qM(jM,r,i,a);return s&&(o.#W=s),e(null==t.yParity||K_(t.yParity,"sig.yParity")===o.yParity,"yParity mismatch"),e(null==t.yParityAndS||t.yParityAndS===o.yParityAndS,"yParityAndS mismatch"),o}}class XM{#q;constructor(t){b_(32===O_(t),"invalid private key","privateKey","[REDACTED]"),this.#q=P_(t)}get privateKey(){return this.#q}get publicKey(){return XM.computePublicKey(this.#q)}get compressedPublicKey(){return XM.computePublicKey(this.#q,!0)}sign(t){b_(32===O_(t),"invalid digest length","digest",t);const e=MM.sign(M_(t),M_(this.#q),{lowS:!0});return qM.from({r:J_(e.r,32),s:J_(e.s,32),v:e.recovery?28:27})}computeSharedSecret(t){const e=XM.computePublicKey(t);return P_(MM.getSharedSecret(M_(this.#q),S_(e),!1))}static computePublicKey(t,e){let n=S_(t,"key");if(32===n.length){return P_(MM.getPublicKey(n,!!e))}if(64===n.length){const t=new Uint8Array(65);t[0]=4,t.set(n,1),n=t}return P_(MM.ProjectivePoint.fromHex(n).toRawBytes(e))}static recoverPublicKey(t,e){b_(32===O_(t),"invalid digest length","digest",t);const n=qM.from(e);let r=MM.Signature.fromCompact(M_(N_([n.r,n.s])));r=r.addRecoveryBit(n.yParity);const i=r.recoverPublicKey(M_(t));return b_(null!=i,"invalid signature for digest","signature",e),"0x"+i.toHex(!1)}static addPoints(t,e,n){const r=MM.ProjectivePoint.fromHex(XM.computePublicKey(t).substring(2)),i=MM.ProjectivePoint.fromHex(XM.computePublicKey(e).substring(2));return"0x"+r.add(i).toHex(!!n)}}function KM(){hA.lock(),PA.lock(),ZA.lock(),nS.lock(),KA.lock(),pS.lock(),mS.lock(),xS.lock(),ES.lock(),nS.lock()}const YM=BigInt(0),JM=BigInt(36);function QM(t){const e=(t=t.toLowerCase()).substring(2).split(""),n=new Uint8Array(40);for(let i=0;i<40;i++)n[i]=e[i].charCodeAt(0);const r=S_(PA(n));for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&(e[i]=e[i].toUpperCase()),(15&r[i>>1])>=8&&(e[i+1]=e[i+1].toUpperCase());return"0x"+e.join("")}const ZM={};for(let yU=0;yU<10;yU++)ZM[String(yU)]=String(yU);for(let yU=0;yU<26;yU++)ZM[String.fromCharCode(65+yU)]=String(10+yU);function $M(t){let e=(t=(t=t.toUpperCase()).substring(4)+t.substring(0,2)+"00").split("").map(t=>ZM[t]).join("");for(;e.length>=15;){let t=e.substring(0,15);e=parseInt(t,10)%97+e.substring(t.length)}let n=String(98-parseInt(e,10)%97);for(;n.length<2;)n="0"+n;return n}const tT=function(){const t={};for(let e=0;e<36;e++){t["0123456789abcdefghijklmnopqrstuvwxyz"[e]]=BigInt(e)}return t}();function eT(t){if(b_("string"==typeof t,"invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=QM(t);return b_(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){b_(t.substring(2,4)===$M(t),"bad icap checksum","address",t);let e=function(t){t=t.toLowerCase();let e=YM;for(let n=0;n<t.length;n++)e=e*JM+tT[t[n]];return e}(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return QM("0x"+e)}b_(!1,"invalid address","address",t)}function nT(t){let e=BigInt(eT(t)).toString(36).toUpperCase();for(;e.length<30;)e="0"+e;return"XE"+$M("XE00"+e)+e}function rT(t){const e=eT(t.from);let n=j_(t.nonce,"tx.nonce").toString(16);return n="0"===n?"0x":n.length%2?"0x0"+n:"0x"+n,eT(I_(PA(Xx([e,n])),12))}function iT(t,e,n){const r=eT(t),i=S_(e,"salt"),s=S_(n,"initCodeHash");return b_(32===i.length,"salt must be 32 bytes","salt",e),b_(32===s.length,"initCodeHash must be 32 bytes","initCodeHash",n),eT(I_(PA(N_(["0xff",r,i,s])),12))}function sT(t){return t&&"function"==typeof t.getAddress}function aT(t){try{return eT(t),!0}catch(e){}return!1}async function oT(t,e){const n=await e;return null!=n&&"0x0000000000000000000000000000000000000000"!==n||(y_("string"!=typeof t,"unconfigured name","UNCONFIGURED_NAME",{value:t}),b_(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),eT(n)}function lT(t,e){return"string"==typeof t?t.match(/^0x[0-9a-f]{40}$/i)?eT(t):(y_(null!=e,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),oT(t,e.resolveName(t))):sT(t)?oT(t,t.getAddress()):t&&"function"==typeof t.then?oT(t,t):void b_(!1,"unsupported addressable value","target",t)}const cT={};function uT(t,e){let n=!1;return e<0&&(n=!0,e*=-1),new fT(cT,`${n?"":"u"}int${e}`,t,{signed:n,width:e})}function hT(t,e){return new fT(cT,`bytes${e||""}`,t,{size:e})}const dT=Symbol.for("_ethers_typed");class fT{type;value;#X;_typedSymbol;constructor(t,e,n,r){null==r&&(r=null),E_(cT,t,"Typed"),f_(this,{_typedSymbol:dT,type:e,value:n}),this.#X=r,this.format()}format(){if("array"===this.type)throw new Error("");if("dynamicArray"===this.type)throw new Error("");return"tuple"===this.type?`tuple(${this.value.map(t=>t.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return"string"===this.type}get tupleName(){if("tuple"!==this.type)throw TypeError("not a tuple");return this.#X}get arrayLength(){if("array"!==this.type)throw TypeError("not an array");return!0===this.#X?-1:!1===this.#X?this.value.length:null}static from(t,e){return new fT(cT,t,e)}static uint8(t){return uT(t,8)}static uint16(t){return uT(t,16)}static uint24(t){return uT(t,24)}static uint32(t){return uT(t,32)}static uint40(t){return uT(t,40)}static uint48(t){return uT(t,48)}static uint56(t){return uT(t,56)}static uint64(t){return uT(t,64)}static uint72(t){return uT(t,72)}static uint80(t){return uT(t,80)}static uint88(t){return uT(t,88)}static uint96(t){return uT(t,96)}static uint104(t){return uT(t,104)}static uint112(t){return uT(t,112)}static uint120(t){return uT(t,120)}static uint128(t){return uT(t,128)}static uint136(t){return uT(t,136)}static uint144(t){return uT(t,144)}static uint152(t){return uT(t,152)}static uint160(t){return uT(t,160)}static uint168(t){return uT(t,168)}static uint176(t){return uT(t,176)}static uint184(t){return uT(t,184)}static uint192(t){return uT(t,192)}static uint200(t){return uT(t,200)}static uint208(t){return uT(t,208)}static uint216(t){return uT(t,216)}static uint224(t){return uT(t,224)}static uint232(t){return uT(t,232)}static uint240(t){return uT(t,240)}static uint248(t){return uT(t,248)}static uint256(t){return uT(t,256)}static uint(t){return uT(t,256)}static int8(t){return uT(t,-8)}static int16(t){return uT(t,-16)}static int24(t){return uT(t,-24)}static int32(t){return uT(t,-32)}static int40(t){return uT(t,-40)}static int48(t){return uT(t,-48)}static int56(t){return uT(t,-56)}static int64(t){return uT(t,-64)}static int72(t){return uT(t,-72)}static int80(t){return uT(t,-80)}static int88(t){return uT(t,-88)}static int96(t){return uT(t,-96)}static int104(t){return uT(t,-104)}static int112(t){return uT(t,-112)}static int120(t){return uT(t,-120)}static int128(t){return uT(t,-128)}static int136(t){return uT(t,-136)}static int144(t){return uT(t,-144)}static int152(t){return uT(t,-152)}static int160(t){return uT(t,-160)}static int168(t){return uT(t,-168)}static int176(t){return uT(t,-176)}static int184(t){return uT(t,-184)}static int192(t){return uT(t,-192)}static int200(t){return uT(t,-200)}static int208(t){return uT(t,-208)}static int216(t){return uT(t,-216)}static int224(t){return uT(t,-224)}static int232(t){return uT(t,-232)}static int240(t){return uT(t,-240)}static int248(t){return uT(t,-248)}static int256(t){return uT(t,-256)}static int(t){return uT(t,-256)}static bytes1(t){return hT(t,1)}static bytes2(t){return hT(t,2)}static bytes3(t){return hT(t,3)}static bytes4(t){return hT(t,4)}static bytes5(t){return hT(t,5)}static bytes6(t){return hT(t,6)}static bytes7(t){return hT(t,7)}static bytes8(t){return hT(t,8)}static bytes9(t){return hT(t,9)}static bytes10(t){return hT(t,10)}static bytes11(t){return hT(t,11)}static bytes12(t){return hT(t,12)}static bytes13(t){return hT(t,13)}static bytes14(t){return hT(t,14)}static bytes15(t){return hT(t,15)}static bytes16(t){return hT(t,16)}static bytes17(t){return hT(t,17)}static bytes18(t){return hT(t,18)}static bytes19(t){return hT(t,19)}static bytes20(t){return hT(t,20)}static bytes21(t){return hT(t,21)}static bytes22(t){return hT(t,22)}static bytes23(t){return hT(t,23)}static bytes24(t){return hT(t,24)}static bytes25(t){return hT(t,25)}static bytes26(t){return hT(t,26)}static bytes27(t){return hT(t,27)}static bytes28(t){return hT(t,28)}static bytes29(t){return hT(t,29)}static bytes30(t){return hT(t,30)}static bytes31(t){return hT(t,31)}static bytes32(t){return hT(t,32)}static address(t){return new fT(cT,"address",t)}static bool(t){return new fT(cT,"bool",!!t)}static bytes(t){return new fT(cT,"bytes",t)}static string(t){return new fT(cT,"string",t)}static array(t,e){throw new Error("not implemented yet")}static tuple(t,e){throw new Error("not implemented yet")}static overrides(t){return new fT(cT,"overrides",Object.assign({},t))}static isTyped(t){return t&&"object"==typeof t&&"_typedSymbol"in t&&t._typedSymbol===dT}static dereference(t,e){if(fT.isTyped(t)){if(t.type!==e)throw new Error(`invalid type: expecetd ${e}, got ${t.type}`);return t.value}return t}}class pT extends dE{constructor(t){super("address","address",t,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(t,e){let n=fT.dereference(e,"string");try{n=eT(n)}catch(r){return this._throwError(r.message,e)}return t.writeValue(n)}decode(t){return eT(J_(t.readValue(),20))}}class mT extends dE{coder;constructor(t){super(t.name,t.type,"_",t.dynamic),this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,e){return this.coder.encode(t,e)}decode(t){return this.coder.decode(t)}}function gT(t,e,n){let r=[];if(Array.isArray(n))r=n;else if(n&&"object"==typeof n){let t={};r=e.map(e=>{const r=e.localName;return y_(r,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:n}),y_(!t[r],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:n}),t[r]=!0,n[r]})}else b_(!1,"invalid tuple value","tuple",n);b_(e.length===r.length,"types/value length mismatch","tuple",n);let i=new fE,s=new fE,a=[];e.forEach((t,e)=>{let n=r[e];if(t.dynamic){let e=s.length;t.encode(s,n);let r=i.writeUpdatableValue();a.push(t=>{r(t+e)})}else t.encode(i,n)}),a.forEach(t=>{t(i.length)});let o=t.appendWriter(i);return o+=t.appendWriter(s),o}function vT(t,e){let n=[],r=[],i=t.subReader(0);return e.forEach(e=>{let s=null;if(e.dynamic){let n=t.readIndex(),r=i.subReader(n);try{s=e.decode(r)}catch(a){if(m_(a,"BUFFER_OVERRUN"))throw a;s=a,s.baseType=e.name,s.name=e.localName,s.type=e.type}}else try{s=e.decode(t)}catch(a){if(m_(a,"BUFFER_OVERRUN"))throw a;s=a,s.baseType=e.name,s.name=e.localName,s.type=e.type}if(null==s)throw new Error("investigate");n.push(s),r.push(e.localName||null)}),cE.fromItems(n,r)}class yT extends dE{coder;length;constructor(t,e,n){super("array",t.type+"["+(e>=0?e:"")+"]",n,-1===e||t.dynamic),f_(this,{coder:t,length:e})}defaultValue(){const t=this.coder.defaultValue(),e=[];for(let n=0;n<this.length;n++)e.push(t);return e}encode(t,e){const n=fT.dereference(e,"array");Array.isArray(n)||this._throwError("expected array value",n);let r=this.length;-1===r&&(r=n.length,t.writeValue(n.length)),w_(n.length,r,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let s=0;s<n.length;s++)i.push(this.coder);return gT(t,i,n)}decode(t){let e=this.length;-1===e&&(e=t.readIndex(),y_(e*tE<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:e*tE,length:t.dataLength}));let n=[];for(let r=0;r<e;r++)n.push(new mT(this.coder));return vT(t,n)}}class bT extends dE{constructor(t){super("bool","bool",t,!1)}defaultValue(){return!1}encode(t,e){const n=fT.dereference(e,"bool");return t.writeValue(n?1:0)}decode(t){return!!t.readValue()}}class wT extends dE{constructor(t,e){super(t,t,e,!0)}defaultValue(){return"0x"}encode(t,e){e=M_(e);let n=t.writeValue(e.length);return n+=t.writeBytes(e),n}decode(t){return t.readBytes(t.readIndex(),!0)}}class _T extends wT{constructor(t){super("bytes",t)}decode(t){return P_(super.decode(t))}}class xT extends dE{size;constructor(t,e){let n="bytes"+String(t);super(n,n,e,!1),f_(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(t,e){let n=M_(fT.dereference(e,this.type));return n.length!==this.size&&this._throwError("incorrect data length",e),t.writeBytes(n)}decode(t){return P_(t.readBytes(this.size))}}const ET=new Uint8Array([]);class AT extends dE{constructor(t){super("null","",t,!1)}defaultValue(){return null}encode(t,e){return null!=e&&this._throwError("not null",e),t.writeBytes(ET)}decode(t){return t.readBytes(0),null}}const ST=BigInt(0),MT=BigInt(1),TT=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class RT extends dE{size;signed;constructor(t,e,n){const r=(e?"int":"uint")+8*t;super(r,r,n,!1),f_(this,{size:t,signed:e},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,e){let n=j_(fT.dereference(e,this.type)),r=V_(TT,256);if(this.signed){let t=V_(r,8*this.size-1);(n>t||n<-(t+MT))&&this._throwError("value out-of-bounds",e),n=G_(n,256)}else(n<ST||n>V_(r,8*this.size))&&this._throwError("value out-of-bounds",e);return t.writeValue(n)}decode(t){let e=V_(t.readValue(),8*this.size);return this.signed&&(e=H_(e,8*this.size)),e}}class CT extends wT{constructor(t){super("string",t)}defaultValue(){return""}encode(t,e){return super.encode(t,dx(fT.dereference(e,"string")))}decode(t){return fx(super.decode(t))}}class PT extends dE{coders;constructor(t,e){let n=!1;const r=[];t.forEach(t=>{t.dynamic&&(n=!0),r.push(t.type)});super("tuple","tuple("+r.join(",")+")",e,n),f_(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(e=>{t.push(e.defaultValue())});const e=this.coders.reduce((t,e)=>{const n=e.localName;return n&&(t[n]||(t[n]=0),t[n]++),t},{});return this.coders.forEach((n,r)=>{let i=n.localName;i&&1===e[i]&&("length"===i&&(i="_length"),null==t[i]&&(t[i]=t[r]))}),Object.freeze(t)}encode(t,e){const n=fT.dereference(e,"tuple");return gT(t,this.coders,n)}decode(t){return vT(t,this.coders)}}function NT(t,e){return{address:eT(t),storageKeys:e.map((t,e)=>(b_(T_(t,32),"invalid slot",`storageKeys[${e}]`,t),t.toLowerCase()))}}function OT(t){if(Array.isArray(t))return t.map((e,n)=>Array.isArray(e)?(b_(2===e.length,"invalid slot set",`value[${n}]`,e),NT(e[0],e[1])):(b_(null!=e&&"object"==typeof e,"invalid address-slot set","value",t),NT(e.address,e.storageKeys)));b_(null!=t&&"object"==typeof t,"invalid access list","value",t);const e=Object.keys(t).map(e=>{const n=t[e].reduce((t,e)=>(t[e]=!0,t),{});return NT(e,Object.keys(n).sort())});return e.sort((t,e)=>t.address.localeCompare(e.address)),e}function IT(t){return{address:eT(t.address),nonce:j_(null!=t.nonce?t.nonce:0),chainId:j_(null!=t.chainId?t.chainId:0),signature:qM.from(t.signature)}}function DT(t){let e;return e="string"==typeof t?XM.computePublicKey(t,!1):t.publicKey,eT(PA("0x"+e.substring(4)).substring(26))}function UT(t,e){return DT(XM.recoverPublicKey(t,e))}const LT=BigInt(0),FT=BigInt(2),kT=BigInt(27),BT=BigInt(28),zT=BigInt(35),HT=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),GT=Symbol.for("nodejs.util.inspect.custom"),VT=131072,jT=128;function WT(t,e){let n=t.toString(16);for(;n.length<2;)n="0"+n;return n+=xS(e).substring(4),"0x"+n}function qT(t){return"0x"===t?null:eT(t)}function XT(t,e){try{return OT(t)}catch(n){b_(!1,n.message,e,t)}}function KT(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const e=[];for(let n=0;n<t.length;n++){const r=t[n];if(!Array.isArray(r))throw new Error(`authorization[${n}]: invalid array`);if(6!==r.length)throw new Error(`authorization[${n}]: wrong length`);if(!r[1])throw new Error(`authorization[${n}]: null address`);e.push({address:qT(r[1]),nonce:JT(r[2],"nonce"),chainId:JT(r[0],"chainId"),signature:qM.from({yParity:YT(r[3],"yParity"),r:L_(r[4],32),s:L_(r[5],32)})})}return e}catch(n){b_(!1,n.message,e,t)}}function YT(t,e){return"0x"===t?0:K_(t,e)}function JT(t,e){if("0x"===t)return LT;const n=j_(t,e);return b_(n<=HT,"value exceeds uint size",e,n),n}function QT(t,e){const n=j_(t,"value"),r=Q_(n);return b_(r.length<=32,"value too large",`tx.${e}`,n),r}function ZT(t){return OT(t).map(t=>[t.address,t.storageKeys])}function $T(t,e){b_(Array.isArray(t),`invalid ${e}`,"value",t);for(let n=0;n<t.length;n++)b_(T_(t[n],32),"invalid ${ param } hash",`value[${n}]`,t[n]);return t}function tR(t,e){let n;try{if(n=YT(e[0],"yParity"),0!==n&&1!==n)throw new Error("bad yParity")}catch(a){b_(!1,"invalid yParity","yParity",e[0])}const r=L_(e[1],32),i=L_(e[2],32),s=qM.from({r:r,s:i,yParity:n});t.signature=s}class eR{#K;#Y;#I;#J;#Q;#Z;#$;#tt;#et;#nt;#rt;#it;#st;#at;#ot;#lt;#ct;#ut;get type(){return this.#K}set type(t){switch(t){case null:this.#K=null;break;case 0:case"legacy":this.#K=0;break;case 1:case"berlin":case"eip-2930":this.#K=1;break;case 2:case"london":case"eip-1559":this.#K=2;break;case 3:case"cancun":case"eip-4844":this.#K=3;break;case 4:case"pectra":case"eip-7702":this.#K=4;break;default:b_(!1,"unsupported transaction type","type",t)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const t=this.#Y;return null==t&&3===this.type?TM:t}set to(t){this.#Y=null==t?null:eT(t)}get nonce(){return this.#J}set nonce(t){this.#J=K_(t,"value")}get gasLimit(){return this.#Q}set gasLimit(t){this.#Q=j_(t)}get gasPrice(){const t=this.#Z;return null!=t||0!==this.type&&1!==this.type?t:LT}set gasPrice(t){this.#Z=null==t?null:j_(t,"gasPrice")}get maxPriorityFeePerGas(){const t=this.#$;return null==t?2===this.type||3===this.type?LT:null:t}set maxPriorityFeePerGas(t){this.#$=null==t?null:j_(t,"maxPriorityFeePerGas")}get maxFeePerGas(){const t=this.#tt;return null==t?2===this.type||3===this.type?LT:null:t}set maxFeePerGas(t){this.#tt=null==t?null:j_(t,"maxFeePerGas")}get data(){return this.#I}set data(t){this.#I=P_(t)}get value(){return this.#et}set value(t){this.#et=j_(t,"value")}get chainId(){return this.#nt}set chainId(t){this.#nt=j_(t)}get signature(){return this.#rt||null}set signature(t){this.#rt=null==t?null:qM.from(t)}isValid(){const t=this.signature;if(t&&!t.isValid())return!1;const e=this.authorizationList;if(e)for(const n of e)if(!n.signature.isValid())return!1;return!0}get accessList(){const t=this.#it||null;return null==t?1===this.type||2===this.type||3===this.type?[]:null:t}set accessList(t){this.#it=null==t?null:OT(t)}get authorizationList(){const t=this.#ct||null;return null==t&&4===this.type?[]:t}set authorizationList(t){this.#ct=null==t?null:t.map(t=>IT(t))}get maxFeePerBlobGas(){const t=this.#st;return null==t&&3===this.type?LT:t}set maxFeePerBlobGas(t){this.#st=null==t?null:j_(t,"maxFeePerBlobGas")}get blobVersionedHashes(){let t=this.#at;return null==t&&3===this.type?[]:t}set blobVersionedHashes(t){if(null!=t){b_(Array.isArray(t),"blobVersionedHashes must be an Array","value",t),t=t.slice();for(let e=0;e<t.length;e++)b_(T_(t[e],32),"invalid blobVersionedHash",`value[${e}]`,t[e])}this.#at=t}get blobs(){return null==this.#lt?null:this.#lt.map(t=>Object.assign({},t))}set blobs(t){if(null==t)return void(this.#lt=null);const e=[],n=[];for(let r=0;r<t.length;r++){const i=t[r];if(R_(i)){y_(this.#ot,"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let t=S_(i);if(b_(t.length<=VT,"blob is too large",`blobs[${r}]`,i),t.length!==VT){const e=new Uint8Array(VT);e.set(t),t=e}const s=this.#ot.blobToKzgCommitment(t),a=P_(this.#ot.computeBlobKzgProof(t,s));e.push({data:P_(t),commitment:P_(s),proof:a}),n.push(WT(1,s))}else{const t=P_(i.data),r=P_(i.commitment),s=P_(i.proof);e.push({data:t,commitment:r,proof:s}),n.push(WT(1,r))}}this.#lt=e,this.#at=n}get kzg(){return this.#ot}set kzg(t){this.#ot=null==t?null:function(t){return{blobToKzgCommitment:e=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&"function"==typeof t.blobToKzgCommitment)return S_(t.blobToKzgCommitment(P_(e)))}else if("blobToKzgCommitment"in t&&"function"==typeof t.blobToKzgCommitment)return S_(t.blobToKzgCommitment(e));if("blobToKZGCommitment"in t&&"function"==typeof t.blobToKZGCommitment)return S_(t.blobToKZGCommitment(P_(e)));b_(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(e,n)=>"computeBlobProof"in t&&"function"==typeof t.computeBlobProof?S_(t.computeBlobProof(P_(e),P_(n))):"computeBlobKzgProof"in t&&"function"==typeof t.computeBlobKzgProof?t.computeBlobKzgProof(e,n):"computeBlobKZGProof"in t&&"function"==typeof t.computeBlobKZGProof?S_(t.computeBlobKZGProof(P_(e),P_(n))):void b_(!1,"unsupported KZG library","kzg",t)}}(t)}get blobWrapperVersion(){return this.#ut}set blobWrapperVersion(t){this.#ut=t}constructor(){this.#K=null,this.#Y=null,this.#J=0,this.#Q=LT,this.#Z=null,this.#$=null,this.#tt=null,this.#I="0x",this.#et=LT,this.#nt=LT,this.#rt=null,this.#it=null,this.#st=null,this.#at=null,this.#ot=null,this.#lt=null,this.#ct=null,this.#ut=null}get hash(){return null==this.signature?null:PA(this.#ht(!0,!1))}get unsignedHash(){return PA(this.unsignedSerialized)}get from(){return null==this.signature?null:UT(this.unsignedHash,this.signature.getCanonical())}get fromPublicKey(){return null==this.signature?null:XM.recoverPublicKey(this.unsignedHash,this.signature.getCanonical())}isSigned(){return null!=this.signature}#ht(t,e){y_(!t||null!=this.signature,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=t?this.signature:null;switch(this.inferType()){case 0:return function(t,e){const n=[QT(t.nonce,"nonce"),QT(t.gasPrice||0,"gasPrice"),QT(t.gasLimit,"gasLimit"),t.to||"0x",QT(t.value,"value"),t.data];let r=LT;if(t.chainId!=LT)r=j_(t.chainId,"tx.chainId"),b_(!e||null==e.networkV||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const e=t.signature.legacyChainId;null!=e&&(r=e)}if(!e)return r!==LT&&(n.push(Q_(r)),n.push("0x"),n.push("0x")),Xx(n);let i=BigInt(27+e.yParity);return r!==LT?i=qM.getChainIdV(r,e.v):BigInt(e.v)!==i&&b_(!1,"tx.chainId/sig.v mismatch","sig",e),n.push(Q_(i)),n.push(Q_(e.r)),n.push(Q_(e._s)),Xx(n)}(this,n);case 1:return function(t,e){const n=[QT(t.chainId,"chainId"),QT(t.nonce,"nonce"),QT(t.gasPrice||0,"gasPrice"),QT(t.gasLimit,"gasLimit"),t.to||"0x",QT(t.value,"value"),t.data,ZT(t.accessList||[])];return e&&(n.push(QT(e.yParity,"recoveryParam")),n.push(Q_(e.r)),n.push(Q_(e.s))),N_(["0x01",Xx(n)])}(this,n);case 2:return function(t,e){const n=[QT(t.chainId,"chainId"),QT(t.nonce,"nonce"),QT(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),QT(t.maxFeePerGas||0,"maxFeePerGas"),QT(t.gasLimit,"gasLimit"),t.to||"0x",QT(t.value,"value"),t.data,ZT(t.accessList||[])];return e&&(n.push(QT(e.yParity,"yParity")),n.push(Q_(e.r)),n.push(Q_(e.s))),N_(["0x02",Xx(n)])}(this,n);case 3:return function(t,e,n){const r=[QT(t.chainId,"chainId"),QT(t.nonce,"nonce"),QT(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),QT(t.maxFeePerGas||0,"maxFeePerGas"),QT(t.gasLimit,"gasLimit"),t.to||TM,QT(t.value,"value"),t.data,ZT(t.accessList||[]),QT(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),$T(t.blobVersionedHashes||[],"blobVersionedHashes")];if(e&&(r.push(QT(e.yParity,"yParity")),r.push(Q_(e.r)),r.push(Q_(e.s)),n)){if(null!=t.blobWrapperVersion){const e=Q_(t.blobWrapperVersion),i=[];for(const{proof:t}of n){const e=S_(t),n=e.length/jT;for(let t=0;t<e.length;t+=n)i.push(e.subarray(t,t+n))}return N_(["0x03",Xx([r,e,n.map(t=>t.data),n.map(t=>t.commitment),i])])}return N_(["0x03",Xx([r,n.map(t=>t.data),n.map(t=>t.commitment),n.map(t=>t.proof)])])}return N_(["0x03",Xx(r)])}(this,n,e?this.blobs:null);case 4:return function(t,e){const n=[QT(t.chainId,"chainId"),QT(t.nonce,"nonce"),QT(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),QT(t.maxFeePerGas||0,"maxFeePerGas"),QT(t.gasLimit,"gasLimit"),t.to||"0x",QT(t.value,"value"),t.data,ZT(t.accessList||[]),(r=t.authorizationList||[],r.map(t=>[QT(t.chainId,"chainId"),t.address,QT(t.nonce,"nonce"),QT(t.signature.yParity,"yParity"),Q_(t.signature.r),Q_(t.signature._s)]))];var r;return e&&(n.push(QT(e.yParity,"yParity")),n.push(Q_(e.r)),n.push(Q_(e.s))),N_(["0x04",Xx(n)])}(this,n)}y_(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})}get serialized(){return this.#ht(!0,!0)}get unsignedSerialized(){return this.#ht(!1,!1)}inferType(){const t=this.inferTypes();return t.indexOf(2)>=0?2:t.pop()}inferTypes(){const t=null!=this.gasPrice,e=null!=this.maxFeePerGas||null!=this.maxPriorityFeePerGas,n=null!=this.accessList,r=null!=this.#st||this.#at;null!=this.maxFeePerGas&&null!=this.maxPriorityFeePerGas&&y_(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),y_(!e||0!==this.type&&1!==this.type,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),y_(0!==this.type||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return null!=this.type?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):e?i.push(2):t?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(r&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}clone(){return eR.from(this)}toJSON(){const t=t=>null==t?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:t(this.gasLimit),gasPrice:t(this.gasPrice),maxPriorityFeePerGas:t(this.maxPriorityFeePerGas),maxFeePerGas:t(this.maxFeePerGas),value:t(this.value),chainId:t(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}[GT](){return this.toString()}toString(){const t=[],e=e=>{let n=this[e];"string"==typeof n&&(n=JSON.stringify(n)),t.push(`${e}: ${n}`)};this.type&&e("type"),e("to"),e("data"),e("nonce"),e("gasLimit"),e("value"),null!=this.chainId&&e("chainId"),this.signature&&(e("from"),t.push(`signature: ${this.signature.toString()}`));const n=this.authorizationList;if(n){const e=[];for(const t of n){const n=[];n.push(`address: ${JSON.stringify(t.address)}`),null!=t.nonce&&n.push(`nonce: ${t.nonce}`),null!=t.chainId&&n.push(`chainId: ${t.chainId}`),t.signature&&n.push(`signature: ${t.signature.toString()}`),e.push(`Authorization { ${n.join(", ")} }`)}t.push(`authorizations: [ ${e.join(", ")} ]`)}return`Transaction { ${t.join(", ")} }`}static from(t){if(null==t)return new eR;if("string"==typeof t){const e=S_(t);if(e[0]>=127)return eR.from(function(t){const e=Vx(t);b_(Array.isArray(e)&&(9===e.length||6===e.length),"invalid field count for legacy transaction","data",t);const n={type:0,nonce:YT(e[0],"nonce"),gasPrice:JT(e[1],"gasPrice"),gasLimit:JT(e[2],"gasLimit"),to:qT(e[3]),value:JT(e[4],"value"),data:P_(e[5]),chainId:LT};if(6===e.length)return n;const r=JT(e[6],"v"),i=JT(e[7],"r"),s=JT(e[8],"s");if(i===LT&&s===LT)n.chainId=r;else{let t=(r-zT)/FT;t<LT&&(t=LT),n.chainId=t,b_(t!==LT||r===kT||r===BT,"non-canonical legacy v","v",e[6]),n.signature=qM.from({r:L_(e[7],32),s:L_(e[8],32),v:r})}return n}(e));switch(e[0]){case 1:return eR.from(function(t){const e=Vx(S_(t).slice(1));b_(Array.isArray(e)&&(8===e.length||11===e.length),"invalid field count for transaction type: 1","data",P_(t));const n={type:1,chainId:JT(e[0],"chainId"),nonce:YT(e[1],"nonce"),gasPrice:JT(e[2],"gasPrice"),gasLimit:JT(e[3],"gasLimit"),to:qT(e[4]),value:JT(e[5],"value"),data:P_(e[6]),accessList:XT(e[7],"accessList")};return 8===e.length||tR(n,e.slice(8)),n}(e));case 2:return eR.from(function(t){const e=Vx(S_(t).slice(1));b_(Array.isArray(e)&&(9===e.length||12===e.length),"invalid field count for transaction type: 2","data",P_(t));const n={type:2,chainId:JT(e[0],"chainId"),nonce:YT(e[1],"nonce"),maxPriorityFeePerGas:JT(e[2],"maxPriorityFeePerGas"),maxFeePerGas:JT(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:JT(e[4],"gasLimit"),to:qT(e[5]),value:JT(e[6],"value"),data:P_(e[7]),accessList:XT(e[8],"accessList")};return 9===e.length||tR(n,e.slice(9)),n}(e));case 3:return eR.from(function(t){let e=Vx(S_(t).slice(1)),n="3",r=null,i=null;if(4===e.length&&Array.isArray(e[0])){n="3 (network format)";const t=e[1],r=e[2],s=e[3];b_(Array.isArray(t),"invalid network format: blobs not an array","fields[1]",t),b_(Array.isArray(r),"invalid network format: commitments not an array","fields[2]",r),b_(Array.isArray(s),"invalid network format: proofs not an array","fields[3]",s),b_(t.length===r.length,"invalid network format: blobs/commitments length mismatch","fields",e),b_(t.length===s.length,"invalid network format: blobs/proofs length mismatch","fields",e),i=[];for(let n=0;n<e[1].length;n++)i.push({data:t[n],commitment:r[n],proof:s[n]});e=e[0]}else if(5===e.length&&Array.isArray(e[0])){n="3 (EIP-7594 network format)",r=K_(e[1]);const t=e[2],s=e[3],a=e[4];b_(1===r,`unsupported EIP-7594 network format version: ${r}`,"fields[1]",r),b_(Array.isArray(t),"invalid EIP-7594 network format: blobs not an array","fields[2]",t),b_(Array.isArray(s),"invalid EIP-7594 network format: commitments not an array","fields[3]",s),b_(Array.isArray(a),"invalid EIP-7594 network format: proofs not an array","fields[4]",a),b_(t.length===s.length,"invalid network format: blobs/commitments length mismatch","fields",e),b_(t.length*jT===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),i=[];for(let e=0;e<t.length;e++){const n=[];for(let t=0;t<jT;t++)n.push(a[e*jT+t]);i.push({data:t[e],commitment:s[e],proof:N_(n)})}e=e[0]}b_(Array.isArray(e)&&(11===e.length||14===e.length),`invalid field count for transaction type: ${n}`,"data",P_(t));const s={type:3,chainId:JT(e[0],"chainId"),nonce:YT(e[1],"nonce"),maxPriorityFeePerGas:JT(e[2],"maxPriorityFeePerGas"),maxFeePerGas:JT(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:JT(e[4],"gasLimit"),to:qT(e[5]),value:JT(e[6],"value"),data:P_(e[7]),accessList:XT(e[8],"accessList"),maxFeePerBlobGas:JT(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10],blobWrapperVersion:r};i&&(s.blobs=i),b_(null!=s.to,`invalid address for transaction type: ${n}`,"data",t),b_(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let a=0;a<s.blobVersionedHashes.length;a++)b_(T_(s.blobVersionedHashes[a],32),`invalid blobVersionedHash at index ${a}: must be length 32`,"data",t);return 11===e.length||tR(s,e.slice(11)),s}(e));case 4:return eR.from(function(t){const e=Vx(S_(t).slice(1));b_(Array.isArray(e)&&(10===e.length||13===e.length),"invalid field count for transaction type: 4","data",P_(t));const n={type:4,chainId:JT(e[0],"chainId"),nonce:YT(e[1],"nonce"),maxPriorityFeePerGas:JT(e[2],"maxPriorityFeePerGas"),maxFeePerGas:JT(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:JT(e[4],"gasLimit"),to:qT(e[5]),value:JT(e[6],"value"),data:P_(e[7]),accessList:XT(e[8],"accessList"),authorizationList:KT(e[9],"authorizationList")};return 10===e.length||tR(n,e.slice(10)),n}(e))}y_(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const e=new eR;return null!=t.type&&(e.type=t.type),null!=t.to&&(e.to=t.to),null!=t.nonce&&(e.nonce=t.nonce),null!=t.gasLimit&&(e.gasLimit=t.gasLimit),null!=t.gasPrice&&(e.gasPrice=t.gasPrice),null!=t.maxPriorityFeePerGas&&(e.maxPriorityFeePerGas=t.maxPriorityFeePerGas),null!=t.maxFeePerGas&&(e.maxFeePerGas=t.maxFeePerGas),null!=t.maxFeePerBlobGas&&(e.maxFeePerBlobGas=t.maxFeePerBlobGas),null!=t.data&&(e.data=t.data),null!=t.value&&(e.value=t.value),null!=t.chainId&&(e.chainId=t.chainId),null!=t.signature&&(e.signature=qM.from(t.signature)),null!=t.accessList&&(e.accessList=t.accessList),null!=t.authorizationList&&(e.authorizationList=t.authorizationList),null!=t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes),null!=t.kzg&&(e.kzg=t.kzg),null!=t.blobWrapperVersion&&(e.blobWrapperVersion=t.blobWrapperVersion),null!=t.blobs&&(e.blobs=t.blobs),null!=t.hash&&(b_(e.isSigned(),"unsigned transaction cannot define '.hash'","tx",t),b_(e.hash===t.hash,"hash mismatch","tx",t)),null!=t.from&&(b_(e.isSigned(),"unsigned transaction cannot define '.from'","tx",t),b_(e.from.toLowerCase()===(t.from||"").toLowerCase(),"from mismatch","tx",t)),e}}function nR(t){return b_("string"==typeof t.address,"invalid address for hashAuthorization","auth.address",t),PA(N_(["0x05",Xx([null!=t.chainId?Q_(t.chainId):"0x",eT(t.address),null!=t.nonce?Q_(t.nonce):"0x"])]))}function rR(t,e){return UT(nR(t),e)}function iR(t){return PA(dx(t))}const sR=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]);function aR(t){return function(t){let e=0;return()=>t[e++]}(function(t){let e=0;function n(){return t[e++]<<8|t[e++]}let r=n(),i=1,s=[0,1];for(let w=1;w<r;w++)s.push(i+=n());let a=n(),o=e;e+=a;let l=0,c=0;function u(){return 0==l&&(c=c<<8|t[e++],l=8),c>>--l&1}const h=2**31,d=h>>>1,f=d>>1,p=h-1;let m=0;for(let w=0;w<31;w++)m=m<<1|u();let g=[],v=0,y=h;for(;;){let t=Math.floor(((m-v+1)*i-1)/y),e=0,n=r;for(;n-e>1;){let r=e+n>>>1;t<s[r]?n=r:e=r}if(0==e)break;g.push(e);let a=v+Math.floor(y*s[e]/i),o=v+Math.floor(y*s[e+1]/i)-1;for(;0==((a^o)&d);)m=m<<1&p|u(),a=a<<1&p,o=o<<1&p|1;for(;a&~o&f;)m=m&d|m<<1&p>>>1|u(),a=a<<1^d,o=(o^d)<<1|d|1;v=a,y=1+o-a}let b=r-4;return g.map(e=>{switch(e-b){case 3:return b+65792+(t[o++]<<16|t[o++]<<8|t[o++]);case 2:return b+256+(t[o++]<<8|t[o++]);case 1:return b+t[o++];default:return e-1}})}(function(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((t,n)=>e[t.charCodeAt(0)]=n);let n=t.length,r=new Uint8Array(6*n>>3);for(let i=0,s=0,a=0,o=0;i<n;i++)o=o<<6|e[t.charCodeAt(i)],a+=6,a>=8&&(r[s++]=o>>(a-=8));return r}(t)))}function oR(t){return 1&t?~t>>1:t>>1}function lR(t,e){let n=Array(t);for(let r=0,i=0;r<t;r++)n[r]=i+=oR(e());return n}function cR(t,e=0){let n=[];for(;;){let r=t(),i=t();if(!i)break;e+=r;for(let t=0;t<i;t++)n.push(e+t);e+=i+1}return n}function uR(t){return dR(()=>{let e=cR(t);if(e.length)return e})}function hR(t){let e=[];for(;;){let n=t();if(0==n)break;e.push(pR(n,t))}for(;;){let n=t()-1;if(n<0)break;e.push(mR(n,t))}return e.flat()}function dR(t){let e=[];for(;;){let n=t(e.length);if(!n)break;e.push(n)}return e}function fR(t,e,n){let r=Array(t).fill().map(()=>[]);for(let i=0;i<e;i++)lR(t,n).forEach((t,e)=>r[e].push(t));return r}function pR(t,e){let n=1+e(),r=e(),i=dR(e);return fR(i.length,1+t,e).flatMap((t,e)=>{let[s,...a]=t;return Array(i[e]).fill().map((t,e)=>{let i=e*r;return[s+e*n,a.map(t=>t+i)]})})}function mR(t,e){return fR(1+e(),1+t,e).map(t=>[t[0],t.slice(1)])}function gR(t){return`{${function(t){return t.toString(16).toUpperCase().padStart(2,"0")}(t)}}`}function vR(t){let e=t.length;if(e<4096)return String.fromCodePoint(...t);let n=[];for(let r=0;r<e;)n.push(String.fromCodePoint(...t.slice(r,r+=4096)));return n.join("")}function yR(t,e){let n=t.length,r=n-e.length;for(let i=0;0==r&&i<n;i++)r=t[i]-e[i];return r}const bR=44032,wR=4352,_R=4449,xR=4519,ER=28,AR=588;function SR(t){return t>>24&255}function MR(t){return 16777215&t}let TR,RR,CR,PR;function NR(t){return t>=bR&&t<55204}function OR(t,e){if(t>=wR&&t<4371&&e>=_R&&e<4470)return bR+(t-wR)*AR+(e-_R)*ER;if(NR(t)&&e>xR&&e<4547&&(t-bR)%ER==0)return t+(e-xR);{let n=PR.get(t);return n&&(n=n.get(e),n)?n:-1}}function IR(t){TR||function(){let t=aR("AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g");TR=new Map(uR(t).flatMap((t,e)=>t.map(t=>[t,e+1<<24]))),RR=new Set(cR(t)),CR=new Map,PR=new Map;for(let[e,n]of hR(t)){if(!RR.has(e)&&2==n.length){let[t,r]=n,i=PR.get(t);i||(i=new Map,PR.set(t,i)),i.set(r,e)}CR.set(e,n.reverse())}}();let e=[],n=[],r=!1;function i(t){let n=TR.get(t);n&&(r=!0,t|=n),e.push(t)}for(let s of t)for(;;){if(s<128)e.push(s);else if(NR(s)){let t=s-bR,e=t%AR/ER|0,n=t%ER;i(wR+(t/AR|0)),i(_R+e),n>0&&i(xR+n)}else{let t=CR.get(s);t?n.push(...t):i(s)}if(!n.length)break;s=n.pop()}if(r&&e.length>1){let t=SR(e[0]);for(let n=1;n<e.length;n++){let r=SR(e[n]);if(0==r||t<=r){t=r;continue}let i=n-1;for(;;){let n=e[i+1];if(e[i+1]=e[i],e[i]=n,!i)break;if(t=SR(e[--i]),t<=r)break}t=SR(e[n])}}return e}function DR(t){return IR(t).map(MR)}function UR(t){return function(t){let e=[],n=[],r=-1,i=0;for(let s of t){let t=SR(s),a=MR(s);if(-1==r)0==t?r=a:e.push(a);else if(i>0&&i>=t)0==t?(e.push(r,...n),n.length=0,r=a):n.push(a),i=t;else{let s=OR(r,a);s>=0?r=s:0==i&&0==t?(e.push(r),r=a):(n.push(a),i=t)}}return r>=0&&e.push(r,...n),e}(IR(t))}const LR=".",FR=t=>Array.from(t);function kR(t,e){return t.P.has(e)||t.Q.has(e)}class BR extends Array{get is_emoji(){return!0}}let zR,HR,GR,VR,jR,WR,qR,XR,KR,YR,JR;function QR(){if(zR)return;let t=aR("AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI");const e=()=>cR(t),n=()=>new Set(e()),r=(t,e)=>e.forEach(e=>t.add(e));zR=new Map(hR(t)),HR=n(),GR=e(),VR=new Set(e().map(t=>GR[t])),GR=new Set(GR),jR=n(),n();let i=uR(t),s=t();const a=()=>{let t=new Set;return e().forEach(e=>r(t,i[e])),r(t,e()),t};WR=dR(e=>{let n=dR(t).map(t=>t+96);if(n.length){let r=e>=s;return n[0]-=32,n=vR(n),r&&(n=`Restricted[${n}]`),{N:n,P:a(),Q:a(),M:!t(),R:r}}}),qR=n(),XR=new Map;let o=e().concat(FR(qR)).sort((t,e)=>t-e);o.forEach((e,n)=>{let r=t(),i=o[n]=r?o[n-r]:{V:[],M:new Map};i.V.push(e),qR.has(e)||XR.set(e,i)});for(let{V:u,M:h}of new Set(XR.values())){let t=[];for(let n of u){let e=WR.filter(t=>kR(t,n)),i=t.find(({G:t})=>e.some(e=>t.has(e)));i||(i={G:new Set,V:[]},t.push(i)),i.V.push(n),r(i.G,e)}let e=t.flatMap(t=>FR(t.G));for(let{G:n,V:r}of t){let t=new Set(e.filter(t=>!n.has(t)));for(let e of r)h.set(e,t)}}KR=new Set;let l=new Set;const c=t=>KR.has(t)?l.add(t):KR.add(t);for(let u of WR){for(let t of u.P)c(t);for(let t of u.Q)c(t)}for(let u of KR)XR.has(u)||l.has(u)||XR.set(u,1);r(KR,DR(KR)),YR=function(t){let e=[],n=cR(t);return function t({S:n,B:r},i,s){if(!(4&n&&s===i[i.length-1])){2&n&&(s=i[i.length-1]),1&n&&e.push(i);for(let e of r)for(let n of e.Q)t(e,[...i,n],s)}}(function e(r){return{S:t(),B:dR(()=>{let r=cR(t).map(t=>n[t]);if(r.length)return e(r)}),Q:r}}([]),[]),e}(t).map(t=>BR.from(t)).sort(yR),JR=new Map;for(let u of YR){let t=[JR];for(let e of u){let n=t.map(t=>{let n=t.get(e);return n||(n=new Map,t.set(e,n)),n});65039===e?t.push(...n):t=n}for(let e of t)e.V=u}}function ZR(t){return(eC(t)?"":`${$R(tC([t]))} `)+gR(t)}function $R(t){return`"${t}"`}function tC(t,e=1/0,n=gR){let r=[];var i;i=t[0],QR(),GR.has(i)&&r.push(""),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let s=0,a=t.length;for(let o=0;o<a;o++){let e=t[o];eC(e)&&(r.push(vR(t.slice(s,o))),r.push(n(e)),s=o+1)}return r.push(vR(t.slice(s,a))),r.join("")}function eC(t){return QR(),jR.has(t)}function nC(t){return e=function(t,e,n){if(!t)return[];QR();let r=0;return t.split(LR).map(t=>{let i=function(t){let e=[];for(let n=0,r=t.length;n<r;){let r=t.codePointAt(n);n+=r<65536?1:2,e.push(r)}return e}(t),s={input:i,offset:r};r+=i.length+1;try{let t,r=s.tokens=function(t,e,n){let r=[],i=[];for(t=t.slice().reverse();t.length;){let s=oC(t);if(s)i.length&&(r.push(e(i)),i=[]),r.push(n(s));else{let e=t.pop();if(KR.has(e))i.push(e);else{let t=zR.get(e);if(t)i.push(...t);else if(!HR.has(e))throw rC(e)}}}return i.length&&r.push(e(i)),r}(i,e,n),a=r.length;if(!a)throw new Error("empty label");let o=s.output=r.flat();if(function(t){for(let e=t.lastIndexOf(95);e>0;)if(95!==t[--e])throw new Error("underscore allowed only at start")}(o),!(s.emoji=a>1||r[0].is_emoji)&&o.every(t=>t<128))!function(t){if(t.length>=4&&45==t[2]&&45==t[3])throw new Error(`invalid label extension: "${vR(t.slice(0,4))}"`)}(o),t="ASCII";else{let e=r.flatMap(t=>t.is_emoji?[]:t);if(e.length){if(GR.has(o[0]))throw sC("leading combining mark");for(let t=1;t<a;t++){let e=r[t];if(!e.is_emoji&&GR.has(e[0]))throw sC(`emoji + combining mark: "${vR(r[t-1])} + ${tC([e[0]])}"`)}!function(t){let e=t[0],n=sR.get(e);if(n)throw sC(`leading ${n}`);let r=t.length,i=-1;for(let s=1;s<r;s++){e=t[s];let r=sR.get(e);if(r){if(i==s)throw sC(`${n} + ${r}`);i=s+1,n=r}}if(i==r)throw sC(`trailing ${n}`)}(o);let n=FR(new Set(e)),[i]=function(t){let e=WR;for(let n of t){let t=e.filter(t=>kR(t,n));if(!t.length)throw WR.some(t=>kR(t,n))?iC(e[0],n):rC(n);if(e=t,1==t.length)break}return e}(n);!function(t,e){for(let n of e)if(!kR(t,n))throw iC(t,n);if(t.M){let t=DR(e);for(let e=1,n=t.length;e<n;e++)if(VR.has(t[e])){let r=e+1;for(let i;r<n&&VR.has(i=t[r]);r++)for(let n=e;n<r;n++)if(t[n]==i)throw new Error(`duplicate non-spacing marks: ${ZR(i)}`);if(r-e>4)throw new Error(`excessive non-spacing marks: ${$R(tC(t.slice(e-1,r)))} (${r-e}/4)`);e=r}}}(i,e),function(t,e){let n,r=[];for(let i of e){let t=XR.get(i);if(1===t)return;if(t){let e=t.M.get(i);if(n=n?n.filter(t=>e.has(t)):FR(e),!n.length)return}else r.push(i)}if(n)for(let i of n)if(r.every(t=>kR(i,t)))throw new Error(`whole-script confusable: ${t.N}/${i.N}`)}(i,n),t=i.N}else t="Emoji"}s.type=t}catch(a){s.error=a}return s})}(t,UR,aC),e.map(({input:t,error:n,output:r})=>{if(n){let r=n.message;throw new Error(1==e.length?r:`Invalid label ${$R(tC(t,63))}: ${r}`)}return vR(r)}).join(LR);var e}function rC(t){return new Error(`disallowed character: ${ZR(t)}`)}function iC(t,e){let n=ZR(e),r=WR.find(t=>t.P.has(e));return r&&(n=`${r.N} ${n}`),new Error(`illegal mixture: ${t.N} + ${n}`)}function sC(t){return new Error(`illegal placement: ${t}`)}function aC(t){return t.filter(t=>65039!=t)}function oC(t,e){let n,r=JR,i=t.length;for(;i&&(r=r.get(t[--i]),r);){let{V:e}=r;e&&(n=e,t.length=i)}return n}const lC=new Uint8Array(32);function cC(t){return b_(0!==t.length,"invalid ENS name; empty component","comp",t),t}function uC(t){const e=dx(hC(t)),n=[];if(0===t.length)return n;let r=0;for(let i=0;i<e.length;i++){46===e[i]&&(n.push(cC(e.slice(r,i))),r=i+1)}return b_(r<e.length,"invalid ENS name; empty component","name",t),n.push(cC(e.slice(r))),n}function hC(t){try{if(0===t.length)throw new Error("empty label");return nC(t)}catch(e){b_(!1,`invalid ENS name (${e.message})`,"name",t)}}function dC(t){try{return 0!==uC(t).length}catch(e){}return!1}function fC(t){b_("string"==typeof t,"invalid ENS name; not a string","name",t),b_(t.length,"invalid ENS name (empty label)","name",t);let e=lC;const n=uC(t);for(;n.length;)e=PA(N_([e,PA(n.pop())]));return P_(e)}function pC(t,e){const n=null!=e?e:63;return b_(n<=255,"DNS encoded label cannot exceed 255","length",n),P_(N_(uC(t).map(e=>{b_(e.length<=n,`label ${JSON.stringify(t)} exceeds ${n} bytes`,"name",t);const r=new Uint8Array(e.length+1);return r.set(e,1),r[0]=r.length-1,r})))+"00"}function mC(t){return"string"==typeof t&&(t=dx(t)),PA(N_([dx(DM),dx(String(t.length)),t]))}function gC(t,e){return UT(mC(t),e)}lC.fill(0);const vC=new RegExp("^bytes([0-9]+)$"),yC=new RegExp("^(u?int)([0-9]*)$"),bC=new RegExp("^(.*)\\[([0-9]*)\\]$");function wC(t,e,n){switch(t){case"address":return S_(n?L_(e,32):eT(e));case"string":return dx(e);case"bytes":return S_(e);case"bool":return e=e?"0x01":"0x00",S_(n?L_(e,32):e)}let r=t.match(yC);if(r){let i="int"===r[1],s=parseInt(r[2]||"256");return b_((!r[2]||r[2]===String(s))&&s%8==0&&0!==s&&s<=256,"invalid number type","type",t),n&&(s=256),i&&(e=G_(e,s)),S_(L_(Q_(e),s/8))}if(r=t.match(vC),r){const i=parseInt(r[1]);return b_(String(i)===r[1]&&0!==i&&i<=32,"invalid bytes type","type",t),b_(O_(e)===i,`invalid value for ${t}`,"value",e),n?S_(F_(e,32)):e}if(r=t.match(bC),r&&Array.isArray(e)){const n=r[1];b_(parseInt(r[2]||String(e.length))===e.length,`invalid array length for ${t}`,"value",e);const i=[];return e.forEach(function(t){i.push(wC(n,t,!0))}),S_(N_(i))}b_(!1,"invalid type","type",t)}function _C(t,e){b_(t.length===e.length,"wrong number of values; expected ${ types.length }","values",e);const n=[];return t.forEach(function(t,r){n.push(wC(t,e[r]))}),P_(N_(n))}function xC(t,e){return PA(_C(t,e))}function EC(t,e){return xS(_C(t,e))}const AC=new Uint8Array(32);AC.fill(0);const SC=BigInt(-1),MC=BigInt(0),TC=BigInt(1),RC=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const CC=J_(TC,32),PC=J_(MC,32),NC={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},OC=["name","version","chainId","verifyingContract","salt"];function IC(t){return function(e){return b_("string"==typeof e,`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const DC={name:IC("name"),version:IC("version"),chainId:function(t){const e=j_(t,"domain.chainId");return b_(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):Z_(e)},verifyingContract:function(t){try{return eT(t).toLowerCase()}catch(e){}b_(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=S_(t,"domain.salt");return b_(32===e.length,'invalid domain value "salt"',"domain.salt",t),P_(e)}};function UC(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const n=""===e[1],r=parseInt(e[2]);b_(r%8==0&&0!==r&&r<=256&&e[2]===String(r),"invalid numeric width","type",t);const i=V_(RC,n?r-1:r),s=n?(i+TC)*SC:MC;return function(e){const r=j_(e,"value");return b_(r>=s&&r<=i,`value out-of-bounds for ${t}`,"value",r),J_(n?G_(r,256):r,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const n=parseInt(e[1]);return b_(0!==n&&n<=32&&e[1]===String(n),"invalid bytes width","type",t),function(e){return b_(S_(e).length===n,`invalid length for ${t}`,"value",e),function(t){const e=S_(t),n=e.length%32;return n?N_([e,AC.slice(n)]):P_(e)}(e)}}}switch(t){case"address":return function(t){return L_(eT(t),32)};case"bool":return function(t){return t?CC:PC};case"bytes":return function(t){return PA(t)};case"string":return function(t){return iR(t)}}return null}function LC(t,e){return`${t}(${e.map(({name:t,type:e})=>e+" "+t).join(",")})`}function FC(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}class kC{primaryType;#dt;get types(){return JSON.parse(this.#dt)}#ft;#pt;constructor(t){this.#ft=new Map,this.#pt=new Map;const e=new Map,n=new Map,r=new Map,i={};Object.keys(t).forEach(s=>{i[s]=t[s].map(({name:e,type:n})=>{let{base:r,index:i}=FC(n);return"int"!==r||t.int||(r="int256"),"uint"!==r||t.uint||(r="uint256"),{name:e,type:r+(i||"")}}),e.set(s,new Set),n.set(s,[]),r.set(s,new Set)}),this.#dt=JSON.stringify(i);for(const a in i){const r=new Set;for(const s of i[a]){b_(!r.has(s.name),`duplicate variable name ${JSON.stringify(s.name)} in ${JSON.stringify(a)}`,"types",t),r.add(s.name);const i=FC(s.type).base;b_(i!==a,`circular type reference to ${JSON.stringify(i)}`,"types",t);UC(i)||(b_(n.has(i),`unknown type ${JSON.stringify(i)}`,"types",t),n.get(i).push(a),e.get(a).add(i))}}const s=Array.from(n.keys()).filter(t=>0===n.get(t).length);b_(0!==s.length,"missing primary type","types",t),b_(1===s.length,`ambiguous primary types or unused types: ${s.map(t=>JSON.stringify(t)).join(", ")}`,"types",t),f_(this,{primaryType:s[0]}),function i(s,a){b_(!a.has(s),`circular type reference to ${JSON.stringify(s)}`,"types",t),a.add(s);for(const t of e.get(s))if(n.has(t)){i(t,a);for(const e of a)r.get(e).add(t)}a.delete(s)}(this.primaryType,new Set);for(const[a,o]of r){const t=Array.from(o);t.sort(),this.#ft.set(a,LC(a,i[a])+t.map(t=>LC(t,i[t])).join(""))}}getEncoder(t){let e=this.#pt.get(t);return e||(e=this.#mt(t),this.#pt.set(t,e)),e}#mt(t){{const e=UC(t);if(e)return e}const e=FC(t).array;if(e){const t=e.prefix,n=this.getEncoder(t);return r=>{b_(-1===e.count||e.count===r.length,`array length mismatch; expected length ${e.count}`,"value",r);let i=r.map(n);return this.#ft.has(t)&&(i=i.map(PA)),PA(N_(i))}}const n=this.types[t];if(n){const e=iR(this.#ft.get(t));return t=>{const r=n.map(({name:e,type:n})=>{const r=this.getEncoder(n)(t[e]);return this.#ft.has(n)?PA(r):r});return r.unshift(e),N_(r)}}b_(!1,`unknown type: ${t}`,"type",t)}encodeType(t){const e=this.#ft.get(t);return b_(e,`unknown type: ${JSON.stringify(t)}`,"name",t),e}encodeData(t,e){return this.getEncoder(t)(e)}hashStruct(t,e){return PA(this.encodeData(t,e))}encode(t){return this.encodeData(this.primaryType,t)}hash(t){return this.hashStruct(this.primaryType,t)}_visit(t,e,n){if(UC(t))return n(t,e);const r=FC(t).array;if(r)return b_(-1===r.count||r.count===e.length,`array length mismatch; expected length ${r.count}`,"value",e),e.map(t=>this._visit(r.prefix,t,n));const i=this.types[t];if(i)return i.reduce((t,{name:r,type:i})=>(t[r]=this._visit(i,e[r],n),t),{});b_(!1,`unknown type: ${t}`,"type",t)}visit(t,e){return this._visit(this.primaryType,t,e)}static from(t){return new kC(t)}static getPrimaryType(t){return kC.from(t).primaryType}static hashStruct(t,e,n){return kC.from(e).hashStruct(t,n)}static hashDomain(t){const e=[];for(const n in t){if(null==t[n])continue;const r=NC[n];b_(r,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",t),e.push({name:n,type:r})}return e.sort((t,e)=>OC.indexOf(t.name)-OC.indexOf(e.name)),kC.hashStruct("EIP712Domain",{EIP712Domain:e},t)}static encode(t,e,n){return N_(["0x1901",kC.hashDomain(t),kC.from(e).hash(n)])}static hash(t,e,n){return PA(kC.encode(t,e,n))}static async resolveNames(t,e,n,r){t=Object.assign({},t);for(const a in t)null==t[a]&&delete t[a];const i={};t.verifyingContract&&!T_(t.verifyingContract,20)&&(i[t.verifyingContract]="0x");const s=kC.from(e);s.visit(n,(t,e)=>("address"!==t||T_(e,20)||(i[e]="0x"),e));for(const a in i)i[a]=await r(a);return t.verifyingContract&&i[t.verifyingContract]&&(t.verifyingContract=i[t.verifyingContract]),{domain:t,value:n=s.visit(n,(t,e)=>"address"===t&&i[e]?i[e]:e)}}static getPayload(t,e,n){kC.hashDomain(t);const r={},i=[];OC.forEach(e=>{const n=t[e];null!=n&&(r[e]=DC[e](n),i.push({name:e,type:NC[e]}))});const s=kC.from(e);e=s.types;const a=Object.assign({},e);return b_(null==a.EIP712Domain,"types must not contain EIP712Domain type","types.EIP712Domain",e),a.EIP712Domain=i,s.encode(n),{types:a,domain:r,primaryType:s.primaryType,message:s.visit(n,(t,e)=>{if(t.match(/^bytes(\d*)/))return P_(S_(e));if(t.match(/^u?int/))return j_(e).toString();switch(t){case"address":return e.toLowerCase();case"bool":return!!e;case"string":return b_("string"==typeof e,"invalid string","value",e),e}b_(!1,"unsupported type","type",t)})}}}function BC(t,e,n,r){return UT(kC.hash(t,e,n),r)}function zC(t){const e=new Set;return t.forEach(t=>e.add(t)),Object.freeze(e)}const HC=zC("external public payable override".split(" ")),GC="constant external internal payable private public pure view override",VC=zC(GC.split(" ")),jC="constructor error event fallback function receive struct",WC=zC(jC.split(" ")),qC="calldata memory storage payable indexed",XC=zC(qC.split(" ")),KC=zC([jC,qC,"tuple returns",GC].join(" ").split(" ")),YC={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},JC=new RegExp("^(\\s*)"),QC=new RegExp("^([0-9]+)"),ZC=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),$C=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),tP=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");class eP{#L;#gt;get offset(){return this.#L}get length(){return this.#gt.length-this.#L}constructor(t){this.#L=0,this.#gt=t.slice()}clone(){return new eP(this.#gt)}reset(){this.#L=0}#vt(t=0,e=0){return new eP(this.#gt.slice(t,e).map(e=>Object.freeze(Object.assign({},e,{match:e.match-t,linkBack:e.linkBack-t,linkNext:e.linkNext-t}))))}popKeyword(t){const e=this.peek();if("KEYWORD"!==e.type||!t.has(e.text))throw new Error(`expected keyword ${e.text}`);return this.pop().text}popType(t){if(this.peek().type!==t){const e=this.peek();throw new Error(`expected ${t}; got ${e.type} ${JSON.stringify(e.text)}`)}return this.pop().text}popParen(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=this.#vt(this.#L+1,t.match+1);return this.#L=t.match+1,e}popParams(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=[];for(;this.#L<t.match-1;){const t=this.peek().linkNext;e.push(this.#vt(this.#L+1,t)),this.#L=t}return this.#L=t.match+1,e}peek(){if(this.#L>=this.#gt.length)throw new Error("out-of-bounds");return this.#gt[this.#L]}peekKeyword(t){const e=this.peekType("KEYWORD");return null!=e&&t.has(e)?e:null}peekType(t){if(0===this.length)return null;const e=this.peek();return e.type===t?e.text:null}pop(){const t=this.peek();return this.#L++,t}toString(){const t=[];for(let e=this.#L;e<this.#gt.length;e++){const n=this.#gt[e];t.push(`${n.type}:${n.text}`)}return`<TokenString ${t.join(" ")}>`}}function nP(t){const e=[],n=e=>{const n=s<t.length?JSON.stringify(t[s]):"$EOI";throw new Error(`invalid token ${n} at ${s}: ${e}`)};let r=[],i=[],s=0;for(;s<t.length;){let a=t.substring(s),o=a.match(JC);o&&(s+=o[1].length,a=t.substring(s));const l={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:s,value:-1};e.push(l);let c=YC[a[0]]||"";if(c){if(l.type=c,l.text=a[0],s++,"OPEN_PAREN"===c)r.push(e.length-1),i.push(e.length-1);else if("CLOSE_PAREN"==c)0===r.length&&n("no matching open bracket"),l.match=r.pop(),e[l.match].match=e.length-1,l.depth--,l.linkBack=i.pop(),e[l.linkBack].linkNext=e.length-1;else if("COMMA"===c)l.linkBack=i.pop(),e[l.linkBack].linkNext=e.length-1,i.push(e.length-1);else if("OPEN_BRACKET"===c)l.type="BRACKET";else if("CLOSE_BRACKET"===c){let t=e.pop().text;if(e.length>0&&"NUMBER"===e[e.length-1].type){const n=e.pop().text;t=n+t,e[e.length-1].value=K_(n)}if(0===e.length||"BRACKET"!==e[e.length-1].type)throw new Error("missing opening bracket");e[e.length-1].text+=t}}else if(o=a.match(ZC),o){if(l.text=o[1],s+=l.text.length,KC.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(tP)){l.type="TYPE";continue}l.type="ID"}else{if(o=a.match(QC),!o)throw new Error(`unexpected token ${JSON.stringify(a[0])} at position ${s}`);l.text=o[1],l.type="NUMBER",s+=l.text.length}}return new eP(e.map(t=>Object.freeze(t)))}function rP(t,e){let n=[];for(const r in e.keys())t.has(r)&&n.push(r);if(n.length>1)throw new Error(`conflicting types: ${n.join(", ")}`)}function iP(t,e){if(e.peekKeyword(WC)){const n=e.pop().text;if(n!==t)throw new Error(`expected ${t}, got ${n}`)}return e.popType("ID")}function sP(t,e){const n=new Set;for(;;){const r=t.peekType("KEYWORD");if(null==r||e&&!e.has(r))break;if(t.pop(),n.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);n.add(r)}return Object.freeze(n)}function aP(t){let e=sP(t,VC);return rP(e,zC("constant payable nonpayable".split(" "))),rP(e,zC("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function oP(t,e){return t.popParams().map(t=>_P.from(t,e))}function lP(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return j_(t.pop().text);throw new Error("invalid gas")}return null}function cP(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const uP=new RegExp(/^(.*)\[([0-9]*)\]$/);function hP(t){const e=t.match(tP);if(b_(e,"invalid type","type",t),"uint"===t)return"uint256";if("int"===t)return"int256";if(e[2]){const n=parseInt(e[2]);b_(0!==n&&n<=32,"invalid bytes length","type",t)}else if(e[3]){const n=parseInt(e[3]);b_(0!==n&&n<=256&&n%8==0,"invalid numeric width","type",t)}return t}const dP={},fP=Symbol.for("_ethers_internal"),pP="_ParamTypeInternal",mP="_ErrorInternal",gP="_EventInternal",vP="_ConstructorInternal",yP="_FallbackInternal",bP="_FunctionInternal",wP="_StructInternal";class _P{name;type;baseType;indexed;components;arrayLength;arrayChildren;constructor(t,e,n,r,i,s,a,o){if(E_(t,dP,"ParamType"),Object.defineProperty(this,fP,{value:pP}),s&&(s=Object.freeze(s.slice())),"array"===r){if(null==a||null==o)throw new Error("")}else if(null!=a||null!=o)throw new Error("");if("tuple"===r){if(null==s)throw new Error("")}else if(null!=s)throw new Error("");f_(this,{name:e,type:n,baseType:r,indexed:i,components:s,arrayLength:a,arrayChildren:o})}format(t){if(null==t&&(t="sighash"),"json"===t){const e=this.name||"";if(this.isArray()){const t=JSON.parse(this.arrayChildren.format("json"));return t.name=e,t.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(t)}const n={type:"tuple"===this.baseType?"tuple":this.type,name:e};return"boolean"==typeof this.indexed&&(n.indexed=this.indexed),this.isTuple()&&(n.components=this.components.map(e=>JSON.parse(e.format(t)))),JSON.stringify(n)}let e="";return this.isArray()?(e+=this.arrayChildren.format(t),e+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?e+="("+this.components.map(e=>e.format(t)).join("full"===t?", ":",")+")":e+=this.type,"sighash"!==t&&(!0===this.indexed&&(e+=" indexed"),"full"===t&&this.name&&(e+=" "+this.name)),e}isArray(){return"array"===this.baseType}isTuple(){return"tuple"===this.baseType}isIndexable(){return null!=this.indexed}walk(t,e){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(-1!==this.arrayLength&&t.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return t.map(t=>n.arrayChildren.walk(t,e))}if(this.isTuple()){if(!Array.isArray(t))throw new Error("invalid tuple value");if(t.length!==this.components.length)throw new Error("array is wrong length");const n=this;return t.map((t,r)=>n.components[r].walk(t,e))}return e(this.type,t)}#yt(t,e,n,r){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(-1!==this.arrayLength&&e.length!==this.arrayLength)throw new Error("array is wrong length");const i=this.arrayChildren,s=e.slice();return s.forEach((e,r)=>{i.#yt(t,e,n,t=>{s[r]=t})}),void r(s)}if(this.isTuple()){const i=this.components;let s;if(Array.isArray(e))s=e.slice();else{if(null==e||"object"!=typeof e)throw new Error("invalid tuple value");s=i.map(t=>{if(!t.name)throw new Error("cannot use object value with unnamed components");if(!(t.name in e))throw new Error(`missing value for component ${t.name}`);return e[t.name]})}if(s.length!==this.components.length)throw new Error("array is wrong length");return s.forEach((e,r)=>{i[r].#yt(t,e,n,t=>{s[r]=t})}),void r(s)}const i=n(this.type,e);i.then?t.push(async function(){r(await i)}()):r(i)}async walkAsync(t,e){const n=[],r=[t];return this.#yt(n,t,e,t=>{r[0]=t}),n.length&&await Promise.all(n),r[0]}static from(t,e){if(_P.isParamType(t))return t;if("string"==typeof t)try{return _P.from(nP(t),e)}catch(a){b_(!1,"invalid param type","obj",t)}else if(t instanceof eP){let n="",r="",i=null;sP(t,zC(["tuple"])).has("tuple")||t.peekType("OPEN_PAREN")?(r="tuple",i=t.popParams().map(t=>_P.from(t)),n=`tuple(${i.map(t=>t.format()).join(",")})`):(n=hP(t.popType("TYPE")),r=n);let s=null,a=null;for(;t.length&&t.peekType("BRACKET");){const e=t.pop();s=new _P(dP,"",n,r,null,i,a,s),a=e.value,n+=e.text,r="array",i=null}let o=null;if(sP(t,XC).has("indexed")){if(!e)throw new Error("");o=!0}const l=t.peekType("ID")?t.pop().text:"";if(t.length)throw new Error("leftover tokens");return new _P(dP,l,n,r,o,i,a,s)}const n=t.name;b_(!n||"string"==typeof n&&n.match($C),"invalid name","obj.name",n);let r=t.indexed;null!=r&&(b_(e,"parameter cannot be indexed","obj.indexed",t.indexed),r=!!r);let i=t.type,s=i.match(uP);if(s){const e=parseInt(s[2]||"-1"),a=_P.from({type:s[1],components:t.components});return new _P(dP,n||"",i,"array",r,null,e,a)}if("tuple"===i||i.startsWith("tuple(")||i.startsWith("(")){const e=null!=t.components?t.components.map(t=>_P.from(t)):null;return new _P(dP,n||"",i,"tuple",r,e,null,null)}return i=hP(t.type),new _P(dP,n||"",i,i,r,null,null,null)}static isParamType(t){return t&&t[fP]===pP}}class xP{type;inputs;constructor(t,e,n){E_(t,dP,"Fragment"),f_(this,{type:e,inputs:n=Object.freeze(n.slice())})}static from(t){if("string"==typeof t){try{xP.from(JSON.parse(t))}catch(Es){}return xP.from(nP(t))}if(t instanceof eP){switch(t.peekKeyword(WC)){case"constructor":return TP.from(t);case"error":return SP.from(t);case"event":return MP.from(t);case"fallback":case"receive":return RP.from(t);case"function":return CP.from(t);case"struct":return PP.from(t)}}else if("object"==typeof t){switch(t.type){case"constructor":return TP.from(t);case"error":return SP.from(t);case"event":return MP.from(t);case"fallback":case"receive":return RP.from(t);case"function":return CP.from(t);case"struct":return PP.from(t)}y_(!1,`unsupported type: ${t.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}b_(!1,"unsupported frgament object","obj",t)}static isConstructor(t){return TP.isFragment(t)}static isError(t){return SP.isFragment(t)}static isEvent(t){return MP.isFragment(t)}static isFunction(t){return CP.isFragment(t)}static isStruct(t){return PP.isFragment(t)}}class EP extends xP{name;constructor(t,e,n,r){super(t,e,r),b_("string"==typeof n&&n.match($C),"invalid identifier","name",n),r=Object.freeze(r.slice()),f_(this,{name:n})}}function AP(t,e){return"("+e.map(e=>e.format(t)).join("full"===t?", ":",")+")"}class SP extends EP{constructor(t,e,n){super(t,"error",e,n),Object.defineProperty(this,fP,{value:mP})}get selector(){return iR(this.format("sighash")).substring(0,10)}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(e=>JSON.parse(e.format(t)))});const e=[];return"sighash"!==t&&e.push("error"),e.push(this.name+AP(t,this.inputs)),e.join(" ")}static from(t){if(SP.isFragment(t))return t;if("string"==typeof t)return SP.from(nP(t));if(t instanceof eP){const e=iP("error",t),n=oP(t);return cP(t),new SP(dP,e,n)}return new SP(dP,t.name,t.inputs?t.inputs.map(_P.from):[])}static isFragment(t){return t&&t[fP]===mP}}class MP extends EP{anonymous;constructor(t,e,n,r){super(t,"event",e,n),Object.defineProperty(this,fP,{value:gP}),f_(this,{anonymous:r})}get topicHash(){return iR(this.format("sighash"))}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(e=>JSON.parse(e.format(t)))});const e=[];return"sighash"!==t&&e.push("event"),e.push(this.name+AP(t,this.inputs)),"sighash"!==t&&this.anonymous&&e.push("anonymous"),e.join(" ")}static getTopicHash(t,e){e=(e||[]).map(t=>_P.from(t));return new MP(dP,t,e,!1).topicHash}static from(t){if(MP.isFragment(t))return t;if("string"==typeof t)try{return MP.from(nP(t))}catch(e){b_(!1,"invalid event fragment","obj",t)}else if(t instanceof eP){const e=iP("event",t),n=oP(t,!0),r=!!sP(t,zC(["anonymous"])).has("anonymous");return cP(t),new MP(dP,e,n,r)}return new MP(dP,t.name,t.inputs?t.inputs.map(t=>_P.from(t,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[fP]===gP}}class TP extends xP{payable;gas;constructor(t,e,n,r,i){super(t,e,n),Object.defineProperty(this,fP,{value:vP}),f_(this,{payable:r,gas:i})}format(t){if(y_(null!=t&&"sighash"!==t,"cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),"json"===t)return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map(e=>JSON.parse(e.format(t)))});const e=[`constructor${AP(t,this.inputs)}`];return this.payable&&e.push("payable"),null!=this.gas&&e.push(`@${this.gas.toString()}`),e.join(" ")}static from(t){if(TP.isFragment(t))return t;if("string"==typeof t)try{return TP.from(nP(t))}catch(e){b_(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof eP){sP(t,zC(["constructor"]));const e=oP(t),n=!!sP(t,HC).has("payable"),r=lP(t);return cP(t),new TP(dP,"constructor",e,n,r)}return new TP(dP,"constructor",t.inputs?t.inputs.map(_P.from):[],!!t.payable,null!=t.gas?t.gas:null)}static isFragment(t){return t&&t[fP]===vP}}class RP extends xP{payable;constructor(t,e,n){super(t,"fallback",e),Object.defineProperty(this,fP,{value:yP}),f_(this,{payable:n})}format(t){const e=0===this.inputs.length?"receive":"fallback";if("json"===t){const t=this.payable?"payable":"nonpayable";return JSON.stringify({type:e,stateMutability:t})}return`${e}()${this.payable?" payable":""}`}static from(t){if(RP.isFragment(t))return t;if("string"==typeof t)try{return RP.from(nP(t))}catch(e){b_(!1,"invalid fallback fragment","obj",t)}else if(t instanceof eP){const e=t.toString();b_(t.peekKeyword(zC(["fallback","receive"])),"type must be fallback or receive","obj",e);if("receive"===t.popKeyword(zC(["fallback","receive"]))){const e=oP(t);return b_(0===e.length,"receive cannot have arguments","obj.inputs",e),sP(t,zC(["payable"])),cP(t),new RP(dP,[],!0)}let n=oP(t);n.length?b_(1===n.length&&"bytes"===n[0].type,"invalid fallback inputs","obj.inputs",n.map(t=>t.format("minimal")).join(", ")):n=[_P.from("bytes")];const r=aP(t);if(b_("nonpayable"===r||"payable"===r,"fallback cannot be constants","obj.stateMutability",r),sP(t,zC(["returns"])).has("returns")){const e=oP(t);b_(1===e.length&&"bytes"===e[0].type,"invalid fallback outputs","obj.outputs",e.map(t=>t.format("minimal")).join(", "))}return cP(t),new RP(dP,n,"payable"===r)}if("receive"===t.type)return new RP(dP,[],!0);if("fallback"===t.type){const e=[_P.from("bytes")],n="payable"===t.stateMutability;return new RP(dP,e,n)}b_(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[fP]===yP}}class CP extends EP{constant;outputs;stateMutability;payable;gas;constructor(t,e,n,r,i,s){super(t,"function",e,r),Object.defineProperty(this,fP,{value:bP});f_(this,{constant:"view"===n||"pure"===n,gas:s,outputs:i=Object.freeze(i.slice()),payable:"payable"===n,stateMutability:n})}get selector(){return iR(this.format("sighash")).substring(0,10)}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map(e=>JSON.parse(e.format(t))),outputs:this.outputs.map(e=>JSON.parse(e.format(t)))});const e=[];return"sighash"!==t&&e.push("function"),e.push(this.name+AP(t,this.inputs)),"sighash"!==t&&("nonpayable"!==this.stateMutability&&e.push(this.stateMutability),this.outputs&&this.outputs.length&&(e.push("returns"),e.push(AP(t,this.outputs))),null!=this.gas&&e.push(`@${this.gas.toString()}`)),e.join(" ")}static getSelector(t,e){e=(e||[]).map(t=>_P.from(t));return new CP(dP,t,"view",e,[],null).selector}static from(t){if(CP.isFragment(t))return t;if("string"==typeof t)try{return CP.from(nP(t))}catch(n){b_(!1,"invalid function fragment","obj",t)}else if(t instanceof eP){const e=iP("function",t),n=oP(t),r=aP(t);let i=[];sP(t,zC(["returns"])).has("returns")&&(i=oP(t));const s=lP(t);return cP(t),new CP(dP,e,r,n,i,s)}let e=t.stateMutability;return null==e&&(e="payable","boolean"==typeof t.constant?(e="view",t.constant||(e="payable","boolean"!=typeof t.payable||t.payable||(e="nonpayable"))):"boolean"!=typeof t.payable||t.payable||(e="nonpayable")),new CP(dP,t.name,e,t.inputs?t.inputs.map(_P.from):[],t.outputs?t.outputs.map(_P.from):[],null!=t.gas?t.gas:null)}static isFragment(t){return t&&t[fP]===bP}}class PP extends EP{constructor(t,e,n){super(t,"struct",e,n),Object.defineProperty(this,fP,{value:wP})}format(){throw new Error("@TODO")}static from(t){if("string"==typeof t)try{return PP.from(nP(t))}catch(e){b_(!1,"invalid struct fragment","obj",t)}else if(t instanceof eP){const e=iP("struct",t),n=oP(t);return cP(t),new PP(dP,e,n)}return new PP(dP,t.name,t.inputs?t.inputs.map(_P.from):[])}static isFragment(t){return t&&t[fP]===wP}}const NP=new Map;NP.set(0,"GENERIC_PANIC"),NP.set(1,"ASSERT_FALSE"),NP.set(17,"OVERFLOW"),NP.set(18,"DIVIDE_BY_ZERO"),NP.set(33,"ENUM_RANGE_ERROR"),NP.set(34,"BAD_STORAGE_DATA"),NP.set(49,"STACK_UNDERFLOW"),NP.set(50,"ARRAY_RANGE_ERROR"),NP.set(65,"OUT_OF_MEMORY"),NP.set(81,"UNINITIALIZED_FUNCTION_CALL");const OP=new RegExp(/^bytes([0-9]*)$/),IP=new RegExp(/^(u?int)([0-9]*)$/);let DP=null,UP=1024;class LP{#bt(t){if(t.isArray())return new yT(this.#bt(t.arrayChildren),t.arrayLength,t.name);if(t.isTuple())return new PT(t.components.map(t=>this.#bt(t)),t.name);switch(t.baseType){case"address":return new pT(t.name);case"bool":return new bT(t.name);case"string":return new CT(t.name);case"bytes":return new _T(t.name);case"":return new AT(t.name)}let e=t.type.match(IP);if(e){let n=parseInt(e[2]||"256");return b_(0!==n&&n<=256&&n%8==0,"invalid "+e[1]+" bit length","param",t),new RT(n/8,"int"===e[1],t.name)}if(e=t.type.match(OP),e){let n=parseInt(e[1]);return b_(0!==n&&n<=32,"invalid bytes length","param",t),new xT(n,t.name)}b_(!1,"invalid type","type",t.type)}getDefaultValue(t){const e=t.map(t=>this.#bt(_P.from(t)));return new PT(e,"_").defaultValue()}encode(t,e){w_(e.length,t.length,"types/values length mismatch");const n=t.map(t=>this.#bt(_P.from(t))),r=new PT(n,"_"),i=new fE;return r.encode(i,e),i.data}decode(t,e,n){const r=t.map(t=>this.#bt(_P.from(t)));return new PT(r,"_").decode(new pE(e,n,UP))}static _setDefaultMaxInflation(t){b_("number"==typeof t&&Number.isInteger(t),"invalid defaultMaxInflation factor","value",t),UP=t}static defaultAbiCoder(){return null==DP&&(DP=new LP),DP}static getBuiltinCallException(t,e,n){return function(t,e,n,r){let i="missing revert data",s=null,a=null;if(n){i="execution reverted";const t=S_(n);if(n=P_(n),0===t.length)i+=" (no data present; likely require(false) occurred",s="require(false)";else if(t.length%32!=4)i+=" (could not decode reason; invalid data length)";else if("0x08c379a0"===P_(t.slice(0,4)))try{s=r.decode(["string"],t.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[s]},i+=`: ${JSON.stringify(s)}`}catch(l){i+=" (could not decode reason; invalid string data)"}else if("0x4e487b71"===P_(t.slice(0,4)))try{const e=Number(r.decode(["uint256"],t.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[e]},s=`Panic due to ${NP.get(e)||"UNKNOWN"}(${e})`,i+=`: ${s}`}catch(l){i+=" (could not decode panic code)"}else i+=" (unknown custom error)"}const o={to:e.to?eT(e.to):null,data:e.data||"0x"};return e.from&&(o.from=eT(e.from)),v_(i,"CALL_EXCEPTION",{action:t,data:n,reason:s,transaction:o,invocation:null,revert:a})}(t,e,n,LP.defaultAbiCoder())}}function FP(t){const e=dx(t);if(e.length>31)throw new Error("bytes32 string must be less than 32 bytes");return F_(e,32)}function kP(t){const e=S_(t,"bytes");if(32!==e.length)throw new Error("invalid bytes32 - not 32 bytes long");if(0!==e[31])throw new Error("invalid bytes32 string - no null terminator");let n=31;for(;0===e[n-1];)n--;return fx(e.slice(0,n))}class BP{fragment;name;signature;topic;args;constructor(t,e,n){const r=t.name,i=t.format();f_(this,{fragment:t,name:r,signature:i,topic:e,args:n})}}class zP{fragment;name;args;signature;selector;value;constructor(t,e,n,r){const i=t.name,s=t.format();f_(this,{fragment:t,name:i,args:n,signature:s,selector:e,value:r})}}class HP{fragment;name;args;signature;selector;constructor(t,e,n){const r=t.name,i=t.format();f_(this,{fragment:t,name:r,args:n,signature:i,selector:e})}}class GP{hash;_isIndexed;static isIndexed(t){return!(!t||!t._isIndexed)}constructor(t){f_(this,{hash:t,_isIndexed:!0})}}const VP={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},jP={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&VP[t.toString()]&&(e=VP[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};class WP{fragments;deploy;fallback;receive;#wt;#_t;#xt;#Et;constructor(t){let e=[];e="string"==typeof t?JSON.parse(t):t,this.#xt=new Map,this.#wt=new Map,this.#_t=new Map;const n=[];for(const a of e)try{n.push(xP.from(a))}catch(s){console.log(`[Warning] Invalid Fragment ${JSON.stringify(a)}:`,s.message)}f_(this,{fragments:Object.freeze(n)});let r=null,i=!1;this.#Et=this.getAbiCoder(),this.fragments.forEach((t,e)=>{let n;switch(t.type){case"constructor":return this.deploy?void console.log("duplicate definition - constructor"):void f_(this,{deploy:t});case"fallback":return void(0===t.inputs.length?i=!0:(b_(!r||t.payable!==r.payable,"conflicting fallback fragments",`fragments[${e}]`,t),r=t,i=r.payable));case"function":n=this.#xt;break;case"event":n=this.#_t;break;case"error":n=this.#wt;break;default:return}const s=t.format();n.has(s)||n.set(s,t)}),this.deploy||f_(this,{deploy:TP.from("constructor()")}),f_(this,{fallback:r,receive:i})}format(t){const e=t?"minimal":"full";return this.fragments.map(t=>t.format(e))}formatJson(){const t=this.fragments.map(t=>t.format("json"));return JSON.stringify(t.map(t=>JSON.parse(t)))}getAbiCoder(){return LP.defaultAbiCoder()}#At(t,e,n){if(T_(t)){const e=t.toLowerCase();for(const t of this.#xt.values())if(e===t.selector)return t;return null}if(-1===t.indexOf("(")){const r=[];for(const[e,n]of this.#xt)e.split("(")[0]===t&&r.push(n);if(e){const t=e.length>0?e[e.length-1]:null;let n=e.length,i=!0;fT.isTyped(t)&&"overrides"===t.type&&(i=!1,n--);for(let e=r.length-1;e>=0;e--){const t=r[e].inputs.length;t===n||i&&t===n-1||r.splice(e,1)}for(let s=r.length-1;s>=0;s--){const t=r[s].inputs;for(let n=0;n<e.length;n++)if(fT.isTyped(e[n])){if(n>=t.length){if("overrides"===e[n].type)continue;r.splice(s,1);break}if(e[n].type!==t[n].baseType){r.splice(s,1);break}}}}if(1===r.length&&e&&e.length!==r[0].inputs.length){const t=e[e.length-1];(null==t||Array.isArray(t)||"object"!=typeof t)&&r.splice(0,1)}if(0===r.length)return null;if(r.length>1&&n){b_(!1,`ambiguous function description (i.e. matches ${r.map(t=>JSON.stringify(t.format())).join(", ")})`,"key",t)}return r[0]}const r=this.#xt.get(CP.from(t).format());return r||null}getFunctionName(t){const e=this.#At(t,null,!1);return b_(e,"no matching function","key",t),e.name}hasFunction(t){return!!this.#At(t,null,!1)}getFunction(t,e){return this.#At(t,e||null,!0)}forEachFunction(t){const e=Array.from(this.#xt.keys());e.sort((t,e)=>t.localeCompare(e));for(let n=0;n<e.length;n++){const r=e[n];t(this.#xt.get(r),n)}}#St(t,e,n){if(T_(t)){const e=t.toLowerCase();for(const t of this.#_t.values())if(e===t.topicHash)return t;return null}if(-1===t.indexOf("(")){const r=[];for(const[e,n]of this.#_t)e.split("(")[0]===t&&r.push(n);if(e){for(let t=r.length-1;t>=0;t--)r[t].inputs.length<e.length&&r.splice(t,1);for(let t=r.length-1;t>=0;t--){const n=r[t].inputs;for(let i=0;i<e.length;i++)if(fT.isTyped(e[i])&&e[i].type!==n[i].baseType){r.splice(t,1);break}}}if(0===r.length)return null;if(r.length>1&&n){b_(!1,`ambiguous event description (i.e. matches ${r.map(t=>JSON.stringify(t.format())).join(", ")})`,"key",t)}return r[0]}const r=this.#_t.get(MP.from(t).format());return r||null}getEventName(t){const e=this.#St(t,null,!1);return b_(e,"no matching event","key",t),e.name}hasEvent(t){return!!this.#St(t,null,!1)}getEvent(t,e){return this.#St(t,e||null,!0)}forEachEvent(t){const e=Array.from(this.#_t.keys());e.sort((t,e)=>t.localeCompare(e));for(let n=0;n<e.length;n++){const r=e[n];t(this.#_t.get(r),n)}}getError(t,e){if(T_(t)){const e=t.toLowerCase();if(jP[e])return SP.from(jP[e].signature);for(const t of this.#wt.values())if(e===t.selector)return t;return null}if(-1===t.indexOf("(")){const e=[];for(const[n,r]of this.#wt)n.split("(")[0]===t&&e.push(r);if(0===e.length)return"Error"===t?SP.from("error Error(string)"):"Panic"===t?SP.from("error Panic(uint256)"):null;if(e.length>1){b_(!1,`ambiguous error description (i.e. ${e.map(t=>JSON.stringify(t.format())).join(", ")})`,"name",t)}return e[0]}if("Error(string)"===(t=SP.from(t).format()))return SP.from("error Error(string)");if("Panic(uint256)"===t)return SP.from("error Panic(uint256)");const n=this.#wt.get(t);return n||null}forEachError(t){const e=Array.from(this.#wt.keys());e.sort((t,e)=>t.localeCompare(e));for(let n=0;n<e.length;n++){const r=e[n];t(this.#wt.get(r),n)}}_decodeParams(t,e){return this.#Et.decode(t,e)}_encodeParams(t,e){return this.#Et.encode(t,e)}encodeDeploy(t){return this._encodeParams(this.deploy.inputs,t||[])}decodeErrorResult(t,e){if("string"==typeof t){const e=this.getError(t);b_(e,"unknown error","fragment",t),t=e}return b_(I_(e,0,4)===t.selector,`data signature does not match error ${t.name}.`,"data",e),this._decodeParams(t.inputs,I_(e,4))}encodeErrorResult(t,e){if("string"==typeof t){const e=this.getError(t);b_(e,"unknown error","fragment",t),t=e}return N_([t.selector,this._encodeParams(t.inputs,e||[])])}decodeFunctionData(t,e){if("string"==typeof t){const e=this.getFunction(t);b_(e,"unknown function","fragment",t),t=e}return b_(I_(e,0,4)===t.selector,`data signature does not match function ${t.name}.`,"data",e),this._decodeParams(t.inputs,I_(e,4))}encodeFunctionData(t,e){if("string"==typeof t){const e=this.getFunction(t);b_(e,"unknown function","fragment",t),t=e}return N_([t.selector,this._encodeParams(t.inputs,e||[])])}decodeFunctionResult(t,e){if("string"==typeof t){const e=this.getFunction(t);b_(e,"unknown function","fragment",t),t=e}let n="invalid length for result data";const r=M_(e);if(r.length%32==0)try{return this.#Et.decode(t.outputs,r)}catch(i){n="could not decode result data"}y_(!1,n,"BAD_DATA",{value:P_(r),info:{method:t.name,signature:t.format()}})}makeError(t,e){const n=S_(t,"data"),r=LP.getBuiltinCallException("call",e,n);if(r.message.startsWith("execution reverted (unknown custom error)")){const t=P_(n.slice(0,4)),e=this.getError(t);if(e)try{const t=this.#Et.decode(e.inputs,n.slice(4));r.revert={name:e.name,signature:e.format(),args:t},r.reason=r.revert.signature,r.message=`execution reverted: ${r.reason}`}catch(Es){r.message="execution reverted (coult not decode custom error)"}}const i=this.parseTransaction(e);return i&&(r.invocation={method:i.name,signature:i.signature,args:i.args}),r}encodeFunctionResult(t,e){if("string"==typeof t){const e=this.getFunction(t);b_(e,"unknown function","fragment",t),t=e}return P_(this.#Et.encode(t.outputs,e||[]))}encodeFilterTopics(t,e){if("string"==typeof t){const e=this.getEvent(t);b_(e,"unknown event","eventFragment",t),t=e}y_(e.length<=t.inputs.length,`too many arguments for ${t.format()}`,"UNEXPECTED_ARGUMENT",{count:e.length,expectedCount:t.inputs.length});const n=[];t.anonymous||n.push(t.topicHash);const r=(t,e)=>"string"===t.type?iR(e):"bytes"===t.type?PA(P_(e)):("bool"===t.type&&"boolean"==typeof e?e=e?"0x01":"0x00":t.type.match(/^u?int/)?e=J_(e):t.type.match(/^bytes/)?e=F_(e,32):"address"===t.type&&this.#Et.encode(["address"],[e]),L_(P_(e),32));for(e.forEach((e,i)=>{const s=t.inputs[i];s.indexed?null==e?n.push(null):"array"===s.baseType||"tuple"===s.baseType?b_(!1,"filtering with tuples or arrays not supported","contract."+s.name,e):Array.isArray(e)?n.push(e.map(t=>r(s,t))):n.push(r(s,e)):b_(null==e,"cannot filter non-indexed parameters; must be null","contract."+s.name,e)});n.length&&null===n[n.length-1];)n.pop();return n}encodeEventLog(t,e){if("string"==typeof t){const e=this.getEvent(t);b_(e,"unknown event","eventFragment",t),t=e}const n=[],r=[],i=[];return t.anonymous||n.push(t.topicHash),b_(e.length===t.inputs.length,"event arguments/values mismatch","values",e),t.inputs.forEach((t,s)=>{const a=e[s];if(t.indexed)if("string"===t.type)n.push(iR(a));else if("bytes"===t.type)n.push(PA(a));else{if("tuple"===t.baseType||"array"===t.baseType)throw new Error("not implemented");n.push(this.#Et.encode([t.type],[a]))}else r.push(t),i.push(a)}),{data:this.#Et.encode(r,i),topics:n}}decodeEventLog(t,e,n){if("string"==typeof t){const e=this.getEvent(t);b_(e,"unknown event","eventFragment",t),t=e}if(null!=n&&!t.anonymous){const e=t.topicHash;b_(T_(n[0],32)&&n[0].toLowerCase()===e,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const r=[],i=[],s=[];t.inputs.forEach((t,e)=>{t.indexed?"string"===t.type||"bytes"===t.type||"tuple"===t.baseType||"array"===t.baseType?(r.push(_P.from({type:"bytes32",name:t.name})),s.push(!0)):(r.push(t),s.push(!1)):(i.push(t),s.push(!1))});const a=null!=n?this.#Et.decode(r,N_(n)):null,o=this.#Et.decode(i,e,!0),l=[],c=[];let u=0,h=0;return t.inputs.forEach((t,e)=>{let n=null;if(t.indexed)if(null==a)n=new GP(null);else if(s[e])n=new GP(a[h++]);else try{n=a[h++]}catch(r){n=r}else try{n=o[u++]}catch(r){n=r}l.push(n),c.push(t.name||null)}),cE.fromItems(l,c)}parseTransaction(t){const e=S_(t.data,"tx.data"),n=j_(null!=t.value?t.value:0,"tx.value"),r=this.getFunction(P_(e.slice(0,4)));if(!r)return null;const i=this.#Et.decode(r.inputs,e.slice(4));return new zP(r,r.selector,i,n)}parseCallResult(t){throw new Error("@TODO")}parseLog(t){const e=this.getEvent(t.topics[0]);return!e||e.anonymous?null:new BP(e,e.topicHash,this.decodeEventLog(e,t.data,t.topics))}parseError(t){const e=P_(t),n=this.getError(I_(e,0,4));if(!n)return null;const r=this.#Et.decode(n.inputs,I_(e,4));return new HP(n,n.selector,r)}static from(t){return t instanceof WP?t:"string"==typeof t?new WP(JSON.parse(t)):"function"==typeof t.formatJson?new WP(t.formatJson()):"function"==typeof t.format?new WP(t.format("json")):new WP(t)}}const qP=BigInt(0);function XP(t){return null==t?null:t}function KP(t){return null==t?null:t.toString()}class YP{gasPrice;maxFeePerGas;maxPriorityFeePerGas;constructor(t,e,n){f_(this,{gasPrice:XP(t),maxFeePerGas:XP(e),maxPriorityFeePerGas:XP(n)})}toJSON(){const{gasPrice:t,maxFeePerGas:e,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:KP(t),maxFeePerGas:KP(e),maxPriorityFeePerGas:KP(n)}}}function JP(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=P_(t.data));const n="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const i of n)i in t&&null!=t[i]&&(e[i]=j_(t[i],`request.${i}`));const r="type,nonce".split(/,/);for(const i of r)i in t&&null!=t[i]&&(e[i]=K_(t[i],`request.${i}`));return t.accessList&&(e.accessList=OT(t.accessList)),t.authorizationList&&(e.authorizationList=t.authorizationList.slice()),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobWrapperVersion"in t&&(e.blobWrapperVersion=t.blobWrapperVersion),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map(t=>R_(t)?P_(t):Object.assign({},t))),e}class QP{provider;number;hash;timestamp;parentHash;parentBeaconBlockRoot;nonce;difficulty;gasLimit;gasUsed;stateRoot;receiptsRoot;blobGasUsed;excessBlobGas;miner;prevRandao;extraData;baseFeePerGas;#Mt;constructor(t,e){this.#Mt=t.transactions.map(t=>"string"!=typeof t?new tN(t,e):t),f_(this,{provider:e,hash:XP(t.hash),number:t.number,timestamp:t.timestamp,parentHash:t.parentHash,parentBeaconBlockRoot:t.parentBeaconBlockRoot,nonce:t.nonce,difficulty:t.difficulty,gasLimit:t.gasLimit,gasUsed:t.gasUsed,blobGasUsed:t.blobGasUsed,excessBlobGas:t.excessBlobGas,miner:t.miner,prevRandao:XP(t.prevRandao),extraData:t.extraData,baseFeePerGas:XP(t.baseFeePerGas),stateRoot:t.stateRoot,receiptsRoot:t.receiptsRoot})}get transactions(){return this.#Mt.map(t=>"string"==typeof t?t:t.hash)}get prefetchedTransactions(){const t=this.#Mt.slice();return 0===t.length?[]:(y_("object"==typeof t[0],"transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),t)}toJSON(){const{baseFeePerGas:t,difficulty:e,extraData:n,gasLimit:r,gasUsed:i,hash:s,miner:a,prevRandao:o,nonce:l,number:c,parentHash:u,parentBeaconBlockRoot:h,stateRoot:d,receiptsRoot:f,timestamp:p,transactions:m}=this;return{_type:"Block",baseFeePerGas:KP(t),difficulty:KP(e),extraData:n,gasLimit:KP(r),gasUsed:KP(i),blobGasUsed:KP(this.blobGasUsed),excessBlobGas:KP(this.excessBlobGas),hash:s,miner:a,prevRandao:o,nonce:l,number:c,parentHash:u,timestamp:p,parentBeaconBlockRoot:h,stateRoot:d,receiptsRoot:f,transactions:m}}[Symbol.iterator](){let t=0;const e=this.transactions;return{next:()=>t<this.length?{value:e[t++],done:!1}:{value:void 0,done:!0}}}get length(){return this.#Mt.length}get date(){return null==this.timestamp?null:new Date(1e3*this.timestamp)}async getTransaction(t){let e;if("number"==typeof t)e=this.#Mt[t];else{const n=t.toLowerCase();for(const t of this.#Mt){if("string"==typeof t){if(t!==n)continue;e=t;break}if(t.hash===n){e=t;break}}}if(null==e)throw new Error("no such tx");return"string"==typeof e?await this.provider.getTransaction(e):e}getPrefetchedTransaction(t){const e=this.prefetchedTransactions;if("number"==typeof t)return e[t];t=t.toLowerCase();for(const n of e)if(n.hash===t)return n;b_(!1,"no matching transaction","indexOrHash",t)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return{orphan:"drop-block",hash:(t=this).hash,number:t.number};var t}}class ZP{provider;transactionHash;blockHash;blockNumber;removed;address;data;topics;index;transactionIndex;constructor(t,e){this.provider=e;const n=Object.freeze(t.topics.slice());f_(this,{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,removed:t.removed,address:t.address,data:t.data,topics:n,index:t.index,transactionIndex:t.transactionIndex})}toJSON(){const{address:t,blockHash:e,blockNumber:n,data:r,index:i,removed:s,topics:a,transactionHash:o,transactionIndex:l}=this;return{_type:"log",address:t,blockHash:e,blockNumber:n,data:r,index:i,removed:s,topics:a,transactionHash:o,transactionIndex:l}}async getBlock(){const t=await this.provider.getBlock(this.blockHash);return y_(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransaction(){const t=await this.provider.getTransaction(this.transactionHash);return y_(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransactionReceipt(){const t=await this.provider.getTransactionReceipt(this.transactionHash);return y_(!!t,"failed to find transaction receipt","UNKNOWN_ERROR",{}),t}removedEvent(){return{orphan:"drop-log",log:{transactionHash:(t=this).transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}};var t}}class $P{provider;to;from;contractAddress;hash;index;blockHash;blockNumber;logsBloom;gasUsed;blobGasUsed;cumulativeGasUsed;gasPrice;blobGasPrice;type;status;root;#Tt;constructor(t,e){this.#Tt=Object.freeze(t.logs.map(t=>new ZP(t,e)));let n=qP;null!=t.effectiveGasPrice?n=t.effectiveGasPrice:null!=t.gasPrice&&(n=t.gasPrice),f_(this,{provider:e,to:t.to,from:t.from,contractAddress:t.contractAddress,hash:t.hash,index:t.index,blockHash:t.blockHash,blockNumber:t.blockNumber,logsBloom:t.logsBloom,gasUsed:t.gasUsed,cumulativeGasUsed:t.cumulativeGasUsed,blobGasUsed:t.blobGasUsed,gasPrice:n,blobGasPrice:t.blobGasPrice,type:t.type,status:t.status,root:t.root})}get logs(){return this.#Tt}toJSON(){const{to:t,from:e,contractAddress:n,hash:r,index:i,blockHash:s,blockNumber:a,logsBloom:o,logs:l,status:c,root:u}=this;return{_type:"TransactionReceipt",blockHash:s,blockNumber:a,contractAddress:n,cumulativeGasUsed:KP(this.cumulativeGasUsed),from:e,gasPrice:KP(this.gasPrice),blobGasUsed:KP(this.blobGasUsed),blobGasPrice:KP(this.blobGasPrice),gasUsed:KP(this.gasUsed),hash:r,index:i,logs:l,logsBloom:o,root:u,status:c,to:t}}get length(){return this.logs.length}[Symbol.iterator](){let t=0;return{next:()=>t<this.length?{value:this.logs[t++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const t=await this.provider.getBlock(this.blockHash);if(null==t)throw new Error("TODO");return t}async getTransaction(){const t=await this.provider.getTransaction(this.hash);if(null==t)throw new Error("TODO");return t}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return nN(this)}reorderedEvent(t){return y_(!t||t.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),eN(this,t)}}class tN{provider;blockNumber;blockHash;index;hash;type;to;from;nonce;gasLimit;gasPrice;maxPriorityFeePerGas;maxFeePerGas;maxFeePerBlobGas;data;value;chainId;signature;accessList;blobVersionedHashes;authorizationList;#Rt;constructor(t,e){this.provider=e,this.blockNumber=null!=t.blockNumber?t.blockNumber:null,this.blockHash=null!=t.blockHash?t.blockHash:null,this.hash=t.hash,this.index=t.index,this.type=t.type,this.from=t.from,this.to=t.to||null,this.gasLimit=t.gasLimit,this.nonce=t.nonce,this.data=t.data,this.value=t.value,this.gasPrice=t.gasPrice,this.maxPriorityFeePerGas=null!=t.maxPriorityFeePerGas?t.maxPriorityFeePerGas:null,this.maxFeePerGas=null!=t.maxFeePerGas?t.maxFeePerGas:null,this.maxFeePerBlobGas=null!=t.maxFeePerBlobGas?t.maxFeePerBlobGas:null,this.chainId=t.chainId,this.signature=t.signature,this.accessList=null!=t.accessList?t.accessList:null,this.blobVersionedHashes=null!=t.blobVersionedHashes?t.blobVersionedHashes:null,this.authorizationList=null!=t.authorizationList?t.authorizationList:null,this.#Rt=-1}toJSON(){const{blockNumber:t,blockHash:e,index:n,hash:r,type:i,to:s,from:a,nonce:o,data:l,signature:c,accessList:u,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:u,blockNumber:t,blockHash:e,blobVersionedHashes:h,chainId:KP(this.chainId),data:l,from:a,gasLimit:KP(this.gasLimit),gasPrice:KP(this.gasPrice),hash:r,maxFeePerGas:KP(this.maxFeePerGas),maxPriorityFeePerGas:KP(this.maxPriorityFeePerGas),maxFeePerBlobGas:KP(this.maxFeePerBlobGas),nonce:o,signature:c,to:s,index:n,type:i,value:KP(this.value)}}async getBlock(){let t=this.blockNumber;if(null==t){const e=await this.getTransaction();e&&(t=e.blockNumber)}if(null==t)return null;const e=this.provider.getBlock(t);if(null==e)throw new Error("TODO");return e}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(null==this.blockNumber){const{tx:t,blockNumber:e}=await d_({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return null==t||null==t.blockNumber?0:e-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(t,e){const n=null==t?1:t,r=null==e?0:e;let i=this.#Rt,s=-1,a=-1===i;const o=async()=>{if(a)return null;const{blockNumber:t,nonce:e}=await d_({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(e<this.nonce)return void(i=t);if(a)return null;const r=await this.getTransaction();if(!r||null==r.blockNumber)for(-1===s&&(s=i-3,s<this.#Rt&&(s=this.#Rt));s<=t;){if(a)return null;const e=await this.provider.getBlock(s,!0);if(null==e)return;for(const t of e)if(t===this.hash)return;for(let r=0;r<e.length;r++){const s=await e.getTransaction(r);if(s.from===this.from&&s.nonce===this.nonce){if(a)return null;const e=await this.provider.getTransactionReceipt(s.hash);if(null==e)return;if(t-e.blockNumber+1<n)return;let r="replaced";s.data===this.data&&s.to===this.to&&s.value===this.value?r="repriced":"0x"===s.data&&s.from===s.to&&s.value===qP&&(r="cancelled"),y_(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:"replaced"===r||"cancelled"===r,reason:r,replacement:s.replaceableTransaction(i),hash:s.hash,receipt:e})}}s++}},l=t=>{if(null==t||0!==t.status)return t;y_(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:t.to,from:t.from,data:""},receipt:t})},c=await this.provider.getTransactionReceipt(this.hash);if(0===n)return l(c);if(c){if(1===n||await c.confirmations()>=n)return l(c)}else if(await o(),0===n)return null;const u=new Promise((t,e)=>{const s=[],c=()=>{s.forEach(t=>t())};if(s.push(()=>{a=!0}),r>0){const t=setTimeout(()=>{c(),e(v_("wait for transaction timeout","TIMEOUT"))},r);s.push(()=>{clearTimeout(t)})}const u=async r=>{if(await r.confirmations()>=n){c();try{t(l(r))}catch(i){e(i)}}};if(s.push(()=>{this.provider.off(this.hash,u)}),this.provider.on(this.hash,u),i>=0){const t=async()=>{try{await o()}catch(n){if(m_(n,"TRANSACTION_REPLACED"))return c(),void e(n)}a||this.provider.once("block",t)};s.push(()=>{this.provider.off("block",t)}),this.provider.once("block",t)}});return await u}isMined(){return null!=this.blockHash}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}removedEvent(){return y_(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),nN(this)}reorderedEvent(t){return y_(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),y_(!t||t.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),eN(this,t)}replaceableTransaction(t){b_(Number.isInteger(t)&&t>=0,"invalid startBlock","startBlock",t);const e=new tN(this,this.provider);return e.#Rt=t,e}}function eN(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function nN(t){return{orphan:"drop-transaction",tx:t}}class rN extends ZP{interface;fragment;args;constructor(t,e,n){super(t,t.provider);f_(this,{args:e.decodeEventLog(n,t.data,t.topics),fragment:n,interface:e})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class iN extends ZP{error;constructor(t,e){super(t,t.provider),f_(this,{error:e})}}class sN extends $P{#Ct;constructor(t,e,n){super(n,e),this.#Ct=t}get logs(){return super.logs.map(t=>{const e=t.topics.length?this.#Ct.getEvent(t.topics[0]):null;if(e)try{return new rN(t,this.#Ct,e)}catch(n){return new iN(t,n)}return t})}}class aN extends tN{#Ct;constructor(t,e,n){super(n,e),this.#Ct=t}async wait(t,e){const n=await super.wait(t,e);return null==n?null:new sN(this.#Ct,this.provider,n)}}class oN extends lx{log;constructor(t,e,n,r){super(t,e,n),f_(this,{log:r})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class lN extends oN{constructor(t,e,n,r,i){super(t,e,n,new rN(i,t.interface,r));f_(this,{args:t.interface.decodeEventLog(r,this.log.data,this.log.topics),fragment:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const cN=BigInt(0);function uN(t){return t&&"function"==typeof t.call}function hN(t){return t&&"function"==typeof t.estimateGas}function dN(t){return t&&"function"==typeof t.resolveName}function fN(t){return t&&"function"==typeof t.sendTransaction}function pN(t){if(null!=t){if(dN(t))return t;if(t.provider)return t.provider}}class mN{#Pt;fragment;constructor(t,e,n){if(f_(this,{fragment:e}),e.inputs.length<n.length)throw new Error("too many arguments");const r=gN(t.runner,"resolveName"),i=dN(r)?r:null;this.#Pt=async function(){const r=await Promise.all(e.inputs.map((t,e)=>null==n[e]?null:t.walkAsync(n[e],(t,e)=>"address"===t?Array.isArray(e)?Promise.all(e.map(t=>lT(t,i))):lT(e,i):e)));return t.interface.encodeFilterTopics(e,r)}()}getTopicFilter(){return this.#Pt}}function gN(t,e){return null==t?null:"function"==typeof t[e]?t:t.provider&&"function"==typeof t.provider[e]?t.provider:null}function vN(t){return null==t?null:t.provider||null}async function yN(t,e){const n=fT.dereference(t,"overrides");b_("object"==typeof n,"invalid overrides parameter","overrides",t);const r=JP(n);return b_(null==r.to||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),b_(null==r.data||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function bN(t,e,n){const r=gN(t,"resolveName"),i=dN(r)?r:null;return await Promise.all(e.map((t,e)=>t.walkAsync(n[e],(t,e)=>(e=fT.dereference(e,t),"address"===t?lT(e,i):e))))}function wN(t){const e=async function(e){const n=await yN(e,["data"]);n.to=await t.getAddress(),n.from&&(n.from=await lT(n.from,pN(t.runner)));const r=t.interface,i=j_(n.value||cN,"overrides.value")===cN,s="0x"===(n.data||"0x");!r.fallback||r.fallback.payable||!r.receive||s||i||b_(!1,"cannot send data to receive or send value to non-payable fallback","overrides",e),b_(r.fallback||s,"cannot send data to receive-only contract","overrides.data",n.data);return b_(r.receive||r.fallback&&r.fallback.payable||i,"cannot send value to non-payable fallback","overrides.value",n.value),b_(r.fallback||s,"cannot send data to receive-only contract","overrides.data",n.data),n},n=async function(n){const r=t.runner;y_(fN(r),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const i=await r.sendTransaction(await e(n)),s=vN(t.runner);return new aN(t.interface,s,i)},r=async t=>await n(t);return f_(r,{_contract:t,estimateGas:async function(n){const r=gN(t.runner,"estimateGas");return y_(hN(r),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await r.estimateGas(await e(n))},populateTransaction:e,send:n,staticCall:async function(n){const r=gN(t.runner,"call");y_(uN(r),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const i=await e(n);try{return await r.call(i)}catch(s){if(g_(s)&&s.data)throw t.interface.makeError(s.data,i);throw s}}}),r}const _N=Symbol.for("_ethersInternal_contract"),xN=new WeakMap;function EN(t){return xN.get(t[_N])}async function AN(t,e){let n,r=null;if(Array.isArray(e)){const r=function(e){if(T_(e,32))return e;const n=t.interface.getEvent(e);return b_(n,"unknown fragment","name",e),n.topicHash};n=e.map(t=>null==t?null:Array.isArray(t)?t.map(r):r(t))}else"*"===e?n=[null]:"string"==typeof e?T_(e,32)?n=[e]:(r=t.interface.getEvent(e),b_(r,"unknown fragment","event",e),n=[r.topicHash]):(i=e)&&"object"==typeof i&&"getTopicFilter"in i&&"function"==typeof i.getTopicFilter&&i.fragment?n=await e.getTopicFilter():"fragment"in e?(r=e.fragment,n=[r.topicHash]):b_(!1,"unknown event name","event",e);var i;n=n.map(t=>{if(null==t)return null;if(Array.isArray(t)){const e=Array.from(new Set(t.map(t=>t.toLowerCase())).values());return 1===e.length?e[0]:(e.sort(),e)}return t.toLowerCase()});const s=n.map(t=>null==t?"null":Array.isArray(t)?t.join("|"):t).join("&");return{fragment:r,tag:s,topics:n}}async function SN(t,e){const{subs:n}=EN(t);return n.get((await AN(t,e)).tag)||null}async function MN(t,e,n){const r=vN(t.runner);y_(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:i,tag:s,topics:a}=await AN(t,n),{addr:o,subs:l}=EN(t);let c=l.get(s);if(!c){const e={address:o||t,topics:a},u=e=>{let r=i;if(null==r)try{r=t.interface.getEvent(e.topics[0])}catch(s){}if(r){const s=r,a=i?t.interface.decodeEventLog(i,e.data,e.topics):[];RN(t,n,a,r=>new lN(t,r,n,s,e))}else RN(t,n,[],r=>new oN(t,r,n,e))};let h=[];c={tag:s,listeners:[],start:()=>{h.length||h.push(r.on(e,u))},stop:async()=>{if(0==h.length)return;let t=h;h=[],await Promise.all(t),r.off(e,u)}},l.set(s,c)}return c}let TN=Promise.resolve();async function RN(t,e,n,r){try{await TN}catch(s){}const i=async function(t,e,n,r){await TN;const i=await SN(t,e);if(!i)return!1;const a=i.listeners.length;return i.listeners=i.listeners.filter(({listener:e,once:i})=>{const a=Array.from(n);r&&a.push(r(i?null:e));try{e.call(t,...a)}catch(s){}return!i}),0===i.listeners.length&&(i.stop(),EN(t).subs.delete(i.tag)),a>0}(t,e,n,r);return TN=i,await i}const CN=["then"];class PN{target;interface;runner;filters;[_N];fallback;constructor(t,e,n,r){b_("string"==typeof t||sT(t),"invalid value for Contract target","target",t),null==n&&(n=null);const i=WP.from(e);let s;f_(this,{target:t,runner:n,interface:i}),Object.defineProperty(this,_N,{value:{}});let a=null,o=null;if(r){const t=vN(n);o=new aN(this.interface,t,r)}let l=new Map;if("string"==typeof t)if(T_(t))a=t,s=Promise.resolve(t);else{const e=gN(n,"resolveName");if(!dN(e))throw v_("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});s=e.resolveName(t).then(e=>{if(null==e)throw v_("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:t});return EN(this).addr=e,e})}else s=t.getAddress().then(t=>{if(null==t)throw new Error("TODO");return EN(this).addr=t,t});var c,u;c=this,u={addrPromise:s,addr:a,deployTx:o,subs:l},xN.set(c[_N],u);return f_(this,{filters:new Proxy({},{get:(t,e,n)=>{if("symbol"==typeof e||CN.indexOf(e)>=0)return Reflect.get(t,e,n);try{return this.getEvent(e)}catch(r){if(!m_(r,"INVALID_ARGUMENT")||"key"!==r.argument)throw r}},has:(t,e)=>CN.indexOf(e)>=0?Reflect.has(t,e):Reflect.has(t,e)||this.interface.hasEvent(String(e))})}),f_(this,{fallback:i.receive||i.fallback?wN(this):null}),new Proxy(this,{get:(t,e,n)=>{if("symbol"==typeof e||e in t||CN.indexOf(e)>=0)return Reflect.get(t,e,n);try{return t.getFunction(e)}catch(r){if(!m_(r,"INVALID_ARGUMENT")||"key"!==r.argument)throw r}},has:(t,e)=>"symbol"==typeof e||e in t||CN.indexOf(e)>=0?Reflect.has(t,e):t.interface.hasFunction(e)})}connect(t){return new PN(this.target,this.interface,t)}attach(t){return new PN(t,this.interface,this.runner)}async getAddress(){return await EN(this).addrPromise}async getDeployedCode(){const t=vN(this.runner);y_(t,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const e=await t.getCode(await this.getAddress());return"0x"===e?null:e}async waitForDeployment(){const t=this.deploymentTransaction();if(t)return await t.wait(),this;if(null!=await this.getDeployedCode())return this;const e=vN(this.runner);return y_(null!=e,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((t,n)=>{const r=async()=>{try{if(null!=await this.getDeployedCode())return t(this);e.once("block",r)}catch(i){n(i)}};r()})}deploymentTransaction(){return EN(this).deployTx}getFunction(t){"string"!=typeof t&&(t=t.format());const e=function(t,e){const n=function(...n){const r=t.interface.getFunction(e,n);return y_(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:n}}),r},r=async function(...e){const r=n(...e);let i={};if(r.inputs.length+1===e.length&&(i=await yN(e.pop()),i.from&&(i.from=await lT(i.from,pN(t.runner)))),r.inputs.length!==e.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const s=await bN(t.runner,r.inputs,e);return Object.assign({},i,await d_({to:t.getAddress(),data:t.interface.encodeFunctionData(r,s)}))},i=async function(...t){const e=await a(...t);return 1===e.length?e[0]:e},s=async function(...e){const n=t.runner;y_(fN(n),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const i=await n.sendTransaction(await r(...e)),s=vN(t.runner);return new aN(t.interface,s,i)},a=async function(...e){const i=gN(t.runner,"call");y_(uN(i),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const s=await r(...e);let a="0x";try{a=await i.call(s)}catch(l){if(g_(l)&&l.data)throw t.interface.makeError(l.data,s);throw l}const o=n(...e);return t.interface.decodeFunctionResult(o,a)},o=async(...t)=>n(...t).constant?await i(...t):await s(...t);return f_(o,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:n,estimateGas:async function(...e){const n=gN(t.runner,"estimateGas");return y_(hN(n),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await n.estimateGas(await r(...e))},populateTransaction:r,send:s,staticCall:i,staticCallResult:a}),Object.defineProperty(o,"fragment",{configurable:!1,enumerable:!0,get:()=>{const n=t.interface.getFunction(e);return y_(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),n}}),o}(this,t);return e}getEvent(t){return"string"!=typeof t&&(t=t.format()),function(t,e){const n=function(...n){const r=t.interface.getEvent(e,n);return y_(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:n}}),r},r=function(...e){return new mN(t,n(...e),e)};return f_(r,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:n}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const n=t.interface.getEvent(e);return y_(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),n}}),r}(this,t)}async queryTransaction(t){throw new Error("@TODO")}async queryFilter(t,e,n){null==e&&(e=0),null==n&&(n="latest");const{addr:r,addrPromise:i}=EN(this),s=r||await i,{fragment:a,topics:o}=await AN(this,t),l={address:s,topics:o,fromBlock:e,toBlock:n},c=vN(this.runner);return y_(c,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await c.getLogs(l)).map(t=>{let e=a;if(null==e)try{e=this.interface.getEvent(t.topics[0])}catch(n){}if(e)try{return new rN(t,this.interface,e)}catch(n){return new iN(t,n)}return new ZP(t,c)})}async on(t,e){const n=await MN(this,"on",t);return n.listeners.push({listener:e,once:!1}),n.start(),this}async once(t,e){const n=await MN(this,"once",t);return n.listeners.push({listener:e,once:!0}),n.start(),this}async emit(t,...e){return await RN(this,t,e,null)}async listenerCount(t){if(t){const e=await SN(this,t);return e?e.listeners.length:0}const{subs:e}=EN(this);let n=0;for(const{listeners:r}of e.values())n+=r.length;return n}async listeners(t){if(t){const e=await SN(this,t);return e?e.listeners.map(({listener:t})=>t):[]}const{subs:e}=EN(this);let n=[];for(const{listeners:r}of e.values())n=n.concat(r.map(({listener:t})=>t));return n}async off(t,e){const n=await SN(this,t);if(!n)return this;if(e){const t=n.listeners.map(({listener:t})=>t).indexOf(e);t>=0&&n.listeners.splice(t,1)}return null!=e&&0!==n.listeners.length||(n.stop(),EN(this).subs.delete(n.tag)),this}async removeAllListeners(t){if(t){const e=await SN(this,t);if(!e)return this;e.stop(),EN(this).subs.delete(e.tag)}else{const{subs:t}=EN(this);for(const{tag:e,stop:n}of t.values())n(),t.delete(e)}return this}async addListener(t,e){return await this.on(t,e)}async removeListener(t,e){return await this.off(t,e)}static buildClass(t){return class extends PN{constructor(e,n=null){super(e,t,n)}}}static from(t,e,n){null==n&&(n=null);return new this(t,e,n)}}class NN extends(function(){return PN}()){}class ON{interface;bytecode;runner;constructor(t,e,n){const r=WP.from(t);e instanceof Uint8Array||("object"==typeof e&&(e=e.object),e.startsWith("0x")||(e="0x"+e)),f_(this,{bytecode:e=P_(S_(e)),interface:r,runner:n||null})}attach(t){return new PN(t,this.interface,this.runner)}async getDeployTransaction(...t){let e={};const n=this.interface.deploy;if(n.inputs.length+1===t.length&&(e=await yN(t.pop())),n.inputs.length!==t.length)throw new Error("incorrect number of arguments to constructor");const r=await bN(this.runner,n.inputs,t),i=N_([this.bytecode,this.interface.encodeDeploy(r)]);return Object.assign({},e,{data:i})}async deploy(...t){const e=await this.getDeployTransaction(...t);y_(this.runner&&"function"==typeof this.runner.sendTransaction,"factory runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const n=await this.runner.sendTransaction(e),r=rT(n);return new PN(r,this.interface,this.runner,n)}connect(t){return new ON(this.interface,this.bytecode,t)}static fromSolidity(t,e){b_(null!=t,"bad compiler output","output",t),"string"==typeof t&&(t=JSON.parse(t));const n=t.abi;let r="";return t.bytecode?r=t.bytecode:t.evm&&t.evm.bytecode&&(r=t.evm.bytecode),new this(n,r,e)}}function IN(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):b_(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class DN{name;constructor(t){f_(this,{name:t})}connect(t){return this}supportsCoinType(t){return!1}async encodeAddress(t,e){throw new Error("unsupported coin")}async decodeAddress(t,e){throw new Error("unsupported coin")}}const UN=new RegExp("^(ipfs)://(.*)$","i"),LN=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),UN,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];class FN{provider;address;name;#Nt;#Ot;constructor(t,e,n){f_(this,{provider:t,address:e,name:n}),this.#Nt=null,this.#Ot=new NN(e,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],t)}async supportsWildcard(){return null==this.#Nt&&(this.#Nt=(async()=>{try{return await this.#Ot.supportsInterface("0x9061b923")}catch(t){if(m_(t,"CALL_EXCEPTION"))return!1;throw this.#Nt=null,t}})()),await this.#Nt}async#It(t,e){e=(e||[]).slice();const n=this.#Ot.interface;e.unshift(fC(this.name));let r=null;await this.supportsWildcard()&&(r=n.getFunction(t),y_(r,"missing fragment","UNKNOWN_ERROR",{info:{funcName:t}}),e=[pC(this.name,255),n.encodeFunctionData(r,e)],t="resolve(bytes,bytes)"),e.push({enableCcipRead:!0});try{const i=await this.#Ot[t](...e);return r?n.decodeFunctionResult(r,i)[0]:i}catch(i){if(!m_(i,"CALL_EXCEPTION"))throw i}return null}async getAddress(t){if(null==t&&(t=60),60===t)try{const t=await this.#It("addr(bytes32)");return null==t||t===TM?null:t}catch(i){if(m_(i,"CALL_EXCEPTION"))return null;throw i}if(t>=0&&t<2147483648){let e=t+2147483648;const n=await this.#It("addr(bytes32,uint)",[e]);if(T_(n,20))return eT(n)}let e=null;for(const s of this.provider.plugins)if(s instanceof DN&&s.supportsCoinType(t)){e=s;break}if(null==e)return null;const n=await this.#It("addr(bytes32,uint)",[t]);if(null==n||"0x"===n)return null;const r=await e.decodeAddress(t,n);if(null!=r)return r;y_(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${t})`,info:{coinType:t,data:n}})}async getText(t){const e=await this.#It("text(bytes32,string)",[t]);return null==e||"0x"===e?null:e}async getContentHash(){const t=await this.#It("contenthash(bytes32)");if(null==t||"0x"===t)return null;const e=t.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(e){const t="e3010170"===e[1]?"ipfs":"ipns",n=parseInt(e[4],16);if(e[5].length===2*n)return`${t}://${ix("0x"+e[2])}`}const n=t.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&64===n[1].length)return`bzz://${n[1]}`;y_(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:t}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const t=[{type:"name",value:this.name}];try{const r=await this.getText("avatar");if(null==r)return t.push({type:"!avatar",value:""}),{url:null,linkage:t};t.push({type:"avatar",value:r});for(let i=0;i<LN.length;i++){const s=r.match(LN[i]);if(null==s)continue;const a=s[1].toLowerCase();switch(a){case"https":case"data":return t.push({type:"url",value:r}),{linkage:t,url:r};case"ipfs":{const e=IN(r);return t.push({type:"ipfs",value:r}),t.push({type:"url",value:e}),{linkage:t,url:e}}case"erc721":case"erc1155":{const i="erc721"===a?"tokenURI(uint256)":"uri(uint256)";t.push({type:a,value:r});const o=await this.getAddress();if(null==o)return t.push({type:"!owner",value:""}),{url:null,linkage:t};const l=(s[2]||"").split("/");if(2!==l.length)return t.push({type:`!${a}caip`,value:s[2]||""}),{url:null,linkage:t};const c=l[1],u=new NN(l[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if("erc721"===a){const e=await u.ownerOf(c);if(o!==e)return t.push({type:"!owner",value:e}),{url:null,linkage:t};t.push({type:"owner",value:e})}else if("erc1155"===a){const e=await u.balanceOf(o,c);if(!e)return t.push({type:"!balance",value:"0"}),{url:null,linkage:t};t.push({type:"balance",value:e.toString()})}let h=await u[i](c);if(null==h||"0x"===h)return t.push({type:"!metadata-url",value:""}),{url:null,linkage:t};t.push({type:"metadata-url-base",value:h}),"erc1155"===a&&(h=h.replace("{id}",J_(c,32).substring(2)),t.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=IN(h)),t.push({type:"metadata-url",value:h});let d={};const f=await new Mx(h).send();f.assertOk();try{d=f.bodyJson}catch(e){try{t.push({type:"!metadata",value:f.bodyText})}catch(n){const e=f.body;return e&&t.push({type:"!metadata",value:P_(e)}),{url:null,linkage:t}}return{url:null,linkage:t}}if(!d)return t.push({type:"!metadata",value:""}),{url:null,linkage:t};t.push({type:"metadata",value:JSON.stringify(d)});let p=d.image;if("string"!=typeof p)return t.push({type:"!imageUrl",value:""}),{url:null,linkage:t};if(p.match(/^(https:\/\/|data:)/i));else{if(null==p.match(UN))return t.push({type:"!imageUrl-ipfs",value:p}),{url:null,linkage:t};t.push({type:"imageUrl-ipfs",value:p}),p=IN(p)}return t.push({type:"url",value:p}),{linkage:t,url:p}}}}}catch(e){}return{linkage:t,url:null}}static async getEnsAddress(t){const e=await t.getNetwork(),n=e.getPlugin("org.ethers.plugins.network.Ens");return y_(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:e}}),n.address}static async#Dt(t,e){const n=await FN.getEnsAddress(t);try{const r=new NN(n,["function resolver(bytes32) view returns (address)"],t),i=await r.resolver(fC(e),{enableCcipRead:!0});return i===TM?null:i}catch(r){throw r}return null}static async fromName(t,e){let n=e;for(;;){if(""===n||"."===n)return null;if("eth"!==e&&"eth"===n)return null;const r=await FN.#Dt(t,n);if(null!=r){const i=new FN(t,r,e);return n===e||await i.supportsWildcard()?i:null}n=n.split(".").slice(1).join(".")}}}const kN=BigInt(0);function BN(t,e){return function(n){return null==n?e:t(n)}}function zN(t,e){return n=>{if(e&&null==n)return null;if(!Array.isArray(n))throw new Error("not an array");return n.map(e=>t(e))}}function HN(t,e){return n=>{const r={};for(const s in t){let a=s;if(e&&s in e&&!(a in n))for(const t of e[s])if(t in n){a=t;break}try{const e=t[s](n[a]);void 0!==e&&(r[s]=e)}catch(i){y_(!1,`invalid value for value.${s} (${i instanceof Error?i.message:"not-an-error"})`,"BAD_DATA",{value:n})}}return r}}function GN(t){return b_(T_(t,!0),"invalid data","value",t),t}function VN(t){return b_(T_(t,32),"invalid hash","value",t),t}const jN=HN({address:eT,blockHash:VN,blockNumber:K_,data:GN,index:K_,removed:BN(function(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}b_(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)},!1),topics:zN(VN),transactionHash:VN,transactionIndex:K_},{index:["logIndex"]});const WN=HN({hash:BN(VN),parentHash:VN,parentBeaconBlockRoot:BN(VN,null),number:K_,timestamp:K_,nonce:BN(GN),difficulty:j_,gasLimit:j_,gasUsed:j_,stateRoot:BN(VN,null),receiptsRoot:BN(VN,null),blobGasUsed:BN(j_,null),excessBlobGas:BN(j_,null),miner:BN(eT),prevRandao:BN(VN,null),extraData:GN,baseFeePerGas:BN(j_)},{prevRandao:["mixHash"]});const qN=HN({transactionIndex:K_,blockNumber:K_,transactionHash:VN,address:eT,topics:zN(VN),data:GN,index:K_,blockHash:VN},{index:["logIndex"]});const XN=HN({to:BN(eT,null),from:BN(eT,null),contractAddress:BN(eT,null),index:K_,root:BN(P_),gasUsed:j_,blobGasUsed:BN(j_,null),logsBloom:BN(GN),blockHash:VN,hash:VN,logs:zN(function(t){return qN(t)}),blockNumber:K_,cumulativeGasUsed:j_,effectiveGasPrice:BN(j_),blobGasPrice:BN(j_,null),status:BN(K_),type:BN(K_,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function KN(t){t.to&&j_(t.to)===kN&&(t.to="0x0000000000000000000000000000000000000000");const e=HN({hash:VN,index:BN(K_,void 0),type:t=>"0x"===t||null==t?0:K_(t),accessList:BN(OT,null),blobVersionedHashes:BN(zN(VN,!0),null),authorizationList:BN(zN(t=>{let e;if(t.signature)e=t.signature;else{let n=t.yParity;"0x1b"===n?n=0:"0x1c"===n&&(n=1),e=Object.assign({},t,{yParity:n})}return{address:eT(t.address),chainId:j_(t.chainId),nonce:j_(t.nonce),signature:qM.from(e)}},!1),null),blockHash:BN(VN,null),blockNumber:BN(K_,null),transactionIndex:BN(K_,null),from:eT,gasPrice:BN(j_),maxPriorityFeePerGas:BN(j_),maxFeePerGas:BN(j_),maxFeePerBlobGas:BN(j_,null),gasLimit:j_,to:BN(eT,null),value:j_,nonce:K_,data:GN,creates:BN(eT,null),chainId:BN(j_,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(null==e.to&&null==e.creates&&(e.creates=rT(e)),1!==t.type&&2!==t.type||null!=t.accessList||(e.accessList=[]),t.signature?e.signature=qM.from(t.signature):e.signature=qM.from(t),null==e.chainId){const t=e.signature.legacyChainId;null!=t&&(e.chainId=t)}return e.blockHash&&j_(e.blockHash)===kN&&(e.blockHash=null),e}class YN{name;constructor(t){f_(this,{name:t})}clone(){return new YN(this.name)}}class JN extends YN{effectiveBlock;txBase;txCreate;txDataZero;txDataNonzero;txAccessListStorageKey;txAccessListAddress;constructor(t,e){null==t&&(t=0),super(`org.ethers.network.plugins.GasCost#${t||0}`);const n={effectiveBlock:t};function r(t,r){let i=(e||{})[t];null==i&&(i=r),b_("number"==typeof i,`invalud value for ${t}`,"costs",e),n[t]=i}r("txBase",21e3),r("txCreate",32e3),r("txDataZero",4),r("txDataNonzero",16),r("txAccessListStorageKey",1900),r("txAccessListAddress",2400),f_(this,n)}clone(){return new JN(this.effectiveBlock,this)}}class QN extends YN{address;targetNetwork;constructor(t,e){super("org.ethers.plugins.network.Ens"),f_(this,{address:t||"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",targetNetwork:null==e?1:e})}clone(){return new QN(this.address,this.targetNetwork)}}class ZN extends YN{#Ut;get feeDataFunc(){return this.#Ut}constructor(t){super("org.ethers.plugins.network.FeeData"),this.#Ut=t}async getFeeData(t){return await this.#Ut(t)}clone(){return new ZN(this.#Ut)}}class $N extends YN{#l;#Lt;get url(){return this.#l}get processFunc(){return this.#Lt}constructor(t,e){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin"),this.#l=t,this.#Lt=e}clone(){return this}}const tO=new Map;class eO{#Ft;#nt;#kt;constructor(t,e){this.#Ft=t,this.#nt=j_(e),this.#kt=new Map}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return this.#Ft}set name(t){this.#Ft=t}get chainId(){return this.#nt}set chainId(t){this.#nt=j_(t,"chainId")}matches(t){if(null==t)return!1;if("string"==typeof t){try{return this.chainId===j_(t)}catch(e){}return this.name===t}if("number"==typeof t||"bigint"==typeof t){try{return this.chainId===j_(t)}catch(e){}return!1}if("object"==typeof t){if(null!=t.chainId){try{return this.chainId===j_(t.chainId)}catch(e){}return!1}return null!=t.name&&this.name===t.name}return!1}get plugins(){return Array.from(this.#kt.values())}attachPlugin(t){if(this.#kt.get(t.name))throw new Error(`cannot replace existing plugin: ${t.name} `);return this.#kt.set(t.name,t.clone()),this}getPlugin(t){return this.#kt.get(t)||null}getPlugins(t){return this.plugins.filter(e=>e.name.split("#")[0]===t)}clone(){const t=new eO(this.name,this.chainId);return this.plugins.forEach(e=>{t.attachPlugin(e.clone())}),t}computeIntrinsicGas(t){const e=this.getPlugin("org.ethers.plugins.network.GasCost")||new JN;let n=e.txBase;if(null==t.to&&(n+=e.txCreate),t.data)for(let r=2;r<t.data.length;r+=2)"00"===t.data.substring(r,r+2)?n+=e.txDataZero:n+=e.txDataNonzero;if(t.accessList){const r=OT(t.accessList);for(const t in r)n+=e.txAccessListAddress+e.txAccessListStorageKey*r[t].storageKeys.length}return n}static from(t){if(function(){if(iO)return;function t(t,e,n){const r=function(){const r=new eO(t,e);return null!=n.ensNetwork&&r.attachPlugin(new QN(null,n.ensNetwork)),r.attachPlugin(new JN),(n.plugins||[]).forEach(t=>{r.attachPlugin(t)}),r};eO.register(t,r),eO.register(e,r),n.altNames&&n.altNames.forEach(t=>{eO.register(t,r)})}iO=!0,t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("filecoin",314,{}),t("filecoin-calibration",314159,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[rO("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[rO("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1})}(),null==t)return eO.from("mainnet");if("number"==typeof t&&(t=BigInt(t)),"string"==typeof t||"bigint"==typeof t){const e=tO.get(t);if(e)return e();if("bigint"==typeof t)return new eO("unknown",t);b_(!1,"unknown network","network",t)}if("function"==typeof t.clone){return t.clone()}if("object"==typeof t){b_("string"==typeof t.name&&"number"==typeof t.chainId,"invalid network object name or chainId","network",t);const e=new eO(t.name,t.chainId);return(t.ensAddress||null!=t.ensNetwork)&&e.attachPlugin(new QN(t.ensAddress,t.ensNetwork)),e}b_(!1,"invalid network","network",t)}static register(t,e){"number"==typeof t&&(t=BigInt(t));const n=tO.get(t);n&&b_(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",t),tO.set(t,e)}}function nO(t,e){const n=String(t);if(!n.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const r=n.split(".");if(1===r.length&&r.push(""),2!==r.length)throw new Error(`invalid gwei value: ${t}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let t=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||t++,r[1]=t.toString()}return BigInt(r[0]+r[1])}function rO(t){return new $N(t,async(t,e,n)=>{let r;n.setHeader("User-Agent","ethers");try{const[e,i]=await Promise.all([n.send(),t()]);r=e;const s=r.bodyJson.standard;return{gasPrice:i.gasPrice,maxFeePerGas:nO(s.maxFee,9),maxPriorityFeePerGas:nO(s.maxPriorityFee,9)}}catch(i){y_(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:r,error:i})}})}let iO=!1;function sO(t){return JSON.parse(JSON.stringify(t))}class aO{#Bt;#zt;#Ht;#Gt;constructor(t){this.#Bt=t,this.#zt=null,this.#Ht=4e3,this.#Gt=-2}get pollingInterval(){return this.#Ht}set pollingInterval(t){this.#Ht=t}async#Vt(){try{const t=await this.#Bt.getBlockNumber();if(-2===this.#Gt)return void(this.#Gt=t);if(t!==this.#Gt){for(let e=this.#Gt+1;e<=t;e++){if(null==this.#zt)return;await this.#Bt.emit("block",e)}this.#Gt=t}}catch(t){}null!=this.#zt&&(this.#zt=this.#Bt._setTimeout(this.#Vt.bind(this),this.#Ht))}start(){this.#zt||(this.#zt=this.#Bt._setTimeout(this.#Vt.bind(this),this.#Ht),this.#Vt())}stop(){this.#zt&&(this.#Bt._clearTimeout(this.#zt),this.#zt=null)}pause(t){this.stop(),t&&(this.#Gt=-2)}resume(){this.start()}}class oO{#Bt;#Vt;#jt;constructor(t){this.#Bt=t,this.#jt=!1,this.#Vt=t=>{this._poll(t,this.#Bt)}}async _poll(t,e){throw new Error("sub-classes must override this")}start(){this.#jt||(this.#jt=!0,this.#Vt(-2),this.#Bt.on("block",this.#Vt))}stop(){this.#jt&&(this.#jt=!1,this.#Bt.off("block",this.#Vt))}pause(t){this.stop()}resume(){this.start()}}class lO extends oO{#Wt;#qt;constructor(t,e){super(t),this.#Wt=e,this.#qt=-2}pause(t){t&&(this.#qt=-2),super.pause(t)}async _poll(t,e){const n=await e.getBlock(this.#Wt);null!=n&&(-2===this.#qt?this.#qt=n.number:n.number>this.#qt&&(e.emit(this.#Wt,n.number),this.#qt=n.number))}}class cO extends oO{#Pt;constructor(t,e){super(t),this.#Pt=sO(e)}async _poll(t,e){throw new Error("@TODO")}}class uO extends oO{#Xt;constructor(t,e){super(t),this.#Xt=e}async _poll(t,e){const n=await e.getTransactionReceipt(this.#Xt);n&&e.emit(this.#Xt,n)}}class hO{#Bt;#Pt;#zt;#jt;#Gt;constructor(t,e){this.#Bt=t,this.#Pt=sO(e),this.#zt=this.#Vt.bind(this),this.#jt=!1,this.#Gt=-2}async#Vt(t){if(-2===this.#Gt)return;const e=sO(this.#Pt);e.fromBlock=this.#Gt+1,e.toBlock=t;const n=await this.#Bt.getLogs(e);if(0!==n.length)for(const r of n)this.#Bt.emit(this.#Pt,r),this.#Gt=r.blockNumber;else this.#Gt<t-60&&(this.#Gt=t-60)}start(){this.#jt||(this.#jt=!0,-2===this.#Gt&&this.#Bt.getBlockNumber().then(t=>{this.#Gt=t}),this.#Bt.on("block",this.#zt))}stop(){this.#jt&&(this.#jt=!1,this.#Bt.off("block",this.#zt))}pause(t){this.stop(),t&&(this.#Gt=-2)}resume(){this.start()}}const dO=BigInt(2);function fO(t){return t&&"function"==typeof t.then}function pO(t,e){return t+":"+JSON.stringify(e,(t,e)=>{if(null==e)return"null";if("bigint"==typeof e)return`bigint:${e.toString()}`;if("string"==typeof e)return e.toLowerCase();if("object"==typeof e&&!Array.isArray(e)){const t=Object.keys(e);return t.sort(),t.reduce((t,n)=>(t[n]=e[n],t),{})}return e})}class mO{name;constructor(t){f_(this,{name:t})}start(){}stop(){}pause(t){}resume(){}}function gO(t){return(t=Array.from(new Set(t).values())).sort(),t}async function vO(t,e){if(null==t)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),"string"==typeof t)switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if(T_(t,32)){const e=t.toLowerCase();return{type:"transaction",tag:pO("tx",{hash:e}),hash:e}}if(t.orphan){const e=t;return{type:"orphan",tag:pO("orphan",e),filter:(n=e,JSON.parse(JSON.stringify(n)))}}var n;if(t.address||t.topics){const n=t,r={topics:(n.topics||[]).map(t=>null==t?null:Array.isArray(t)?gO(t.map(t=>t.toLowerCase())):t.toLowerCase())};if(n.address){const t=[],i=[],s=n=>{T_(n)?t.push(n):i.push((async()=>{t.push(await lT(n,e))})())};Array.isArray(n.address)?n.address.forEach(s):s(n.address),i.length&&await Promise.all(i),r.address=gO(t.map(t=>t.toLowerCase()))}return{filter:r,tag:pO("event",r),type:"event"}}b_(!1,"unknown ProviderEvent","event",t)}function yO(){return(new Date).getTime()}const bO={cacheTimeout:250,pollingInterval:4e3};class wO{#Kt;#kt;#Yt;#Jt;#Qt;#Zt;#$t;#te;#ee;#ne;#re;#X;constructor(t,e){if(this.#X=Object.assign({},bO,e||{}),"any"===t)this.#Zt=!0,this.#Qt=null;else if(t){const e=eO.from(t);this.#Zt=!1,this.#Qt=Promise.resolve(e),setTimeout(()=>{this.emit("network",e,null)},0)}else this.#Zt=!1,this.#Qt=null;this.#te=-1,this.#$t=new Map,this.#Kt=new Map,this.#kt=new Map,this.#Yt=null,this.#Jt=!1,this.#ee=1,this.#ne=new Map,this.#re=!1}get pollingInterval(){return this.#X.pollingInterval}get provider(){return this}get plugins(){return Array.from(this.#kt.values())}attachPlugin(t){if(this.#kt.get(t.name))throw new Error(`cannot replace existing plugin: ${t.name} `);return this.#kt.set(t.name,t.connect(this)),this}getPlugin(t){return this.#kt.get(t)||null}get disableCcipRead(){return this.#re}set disableCcipRead(t){this.#re=!!t}async#ie(t){const e=this.#X.cacheTimeout;if(e<0)return await this._perform(t);const n=pO(t.method,t);let r=this.#$t.get(n);return r||(r=this._perform(t),this.#$t.set(n,r),setTimeout(()=>{this.#$t.get(n)===r&&this.#$t.delete(n)},e)),await r}async ccipReadFetch(t,e,n){if(this.disableCcipRead||0===n.length||null==t.to)return null;const r=t.to.toLowerCase(),i=e.toLowerCase(),s=[];for(let o=0;o<n.length;o++){const e=n[o],l=e.replace("{sender}",r).replace("{data}",i),c=new Mx(l);-1===e.indexOf("{data}")&&(c.body={data:i,sender:r}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:c,index:o,urls:n});let u,h="unknown error";try{u=await c.send()}catch(a){s.push(a.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:c,result:{error:a}});continue}try{const t=u.bodyJson;if(t.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:c,result:t}),t.data;t.message&&(h=t.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:c,result:t})}catch(a){}y_(u.statusCode<400||u.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:t,info:{url:e,errorMessage:h}}),s.push(h)}y_(!1,`error encountered during CCIP fetch: ${s.map(t=>JSON.stringify(t)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:t,info:{urls:n,errorMessages:s}})}_wrapBlock(t,e){return new QP(function(t){const e=WN(t);return e.transactions=t.transactions.map(t=>"string"==typeof t?t:KN(t)),e}(t),this)}_wrapLog(t,e){return new ZP(function(t){return jN(t)}(t),this)}_wrapTransactionReceipt(t,e){return new $P(function(t){return XN(t)}(t),this)}_wrapTransactionResponse(t,e){return new tN(KN(t),this)}_detectNetwork(){y_(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(t){y_(!1,`unsupported method: ${t.method}`,"UNSUPPORTED_OPERATION",{operation:t.method,info:t})}async getBlockNumber(){const t=K_(await this.#ie({method:"getBlockNumber"}),"%response");return this.#te>=0&&(this.#te=t),t}_getAddress(t){return lT(t,this)}_getBlockTag(t){if(null==t)return"latest";switch(t){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return t}return T_(t)?T_(t,32)?t:Z_(t):("bigint"==typeof t&&(t=K_(t,"blockTag")),"number"==typeof t?t>=0?Z_(t):this.#te>=0?Z_(this.#te+t):this.getBlockNumber().then(e=>Z_(e+t)):void b_(!1,"invalid blockTag","blockTag",t))}_getFilter(t){const e=(t.topics||[]).map(t=>null==t?null:Array.isArray(t)?gO(t.map(t=>t.toLowerCase())):t.toLowerCase()),n="blockHash"in t?t.blockHash:void 0,r=(t,r,i)=>{let s;switch(t.length){case 0:break;case 1:s=t[0];break;default:t.sort(),s=t}if(n&&(null!=r||null!=i))throw new Error("invalid filter");const a={};return s&&(a.address=s),e.length&&(a.topics=e),r&&(a.fromBlock=r),i&&(a.toBlock=i),n&&(a.blockHash=n),a};let i,s,a=[];if(t.address)if(Array.isArray(t.address))for(const o of t.address)a.push(this._getAddress(o));else a.push(this._getAddress(t.address));return"fromBlock"in t&&(i=this._getBlockTag(t.fromBlock)),"toBlock"in t&&(s=this._getBlockTag(t.toBlock)),a.filter(t=>"string"!=typeof t).length||null!=i&&"string"!=typeof i||null!=s&&"string"!=typeof s?Promise.all([Promise.all(a),i,s]).then(t=>r(t[0],t[1],t[2])):r(a,i,s)}_getTransactionRequest(t){const e=JP(t),n=[];if(["to","from"].forEach(t=>{if(null==e[t])return;const r=lT(e[t],this);fO(r)?n.push(async function(){e[t]=await r}()):e[t]=r}),null!=e.blockTag){const t=this._getBlockTag(e.blockTag);fO(t)?n.push(async function(){e.blockTag=await t}()):e.blockTag=t}return n.length?async function(){return await Promise.all(n),e}():e}async getNetwork(){if(null==this.#Qt){const t=(async()=>{try{const t=await this._detectNetwork();return this.emit("network",t,null),t}catch(e){throw this.#Qt===t&&(this.#Qt=null),e}})();return this.#Qt=t,(await t).clone()}const t=this.#Qt,[e,n]=await Promise.all([t,this._detectNetwork()]);return e.chainId!==n.chainId&&(this.#Zt?(this.emit("network",n,e),this.#Qt===t&&(this.#Qt=Promise.resolve(n))):y_(!1,`network changed: ${e.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),e.clone()}async getFeeData(){const t=await this.getNetwork(),e=async()=>{const{_block:e,gasPrice:n,priorityFee:r}=await d_({_block:this.#se("latest",!1),gasPrice:(async()=>{try{return j_(await this.#ie({method:"getGasPrice"}),"%response")}catch(t){}return null})(),priorityFee:(async()=>{try{return j_(await this.#ie({method:"getPriorityFee"}),"%response")}catch(t){}return null})()});let i=null,s=null;const a=this._wrapBlock(e,t);return a&&a.baseFeePerGas&&(s=null!=r?r:BigInt("1000000000"),i=a.baseFeePerGas*dO+s),new YP(n,i,s)},n=t.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const t=new Mx(n.url),r=await n.processFunc(e,this,t);return new YP(r.gasPrice,r.maxFeePerGas,r.maxPriorityFeePerGas)}return await e()}async estimateGas(t){let e=this._getTransactionRequest(t);return fO(e)&&(e=await e),j_(await this.#ie({method:"estimateGas",transaction:e}),"%response")}async#ae(t,e,n){y_(n<10,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},t,{blockTag:e,enableCcipRead:!0})});const r=JP(t);try{return P_(await this._perform({method:"call",transaction:r,blockTag:e}))}catch(i){if(!this.disableCcipRead&&g_(i)&&i.data&&n>=0&&"latest"===e&&null!=r.to&&"0x556f1830"===I_(i.data,0,4)){const t=i.data,a=await lT(r.to,this);let o;try{o=function(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};y_(O_(t)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const n=I_(t,0,32);y_(I_(n,0,12)===I_(TO,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=I_(n,12);try{const n=[],r=K_(I_(t,32,64)),i=K_(I_(t,r,r+32)),s=I_(t,r+32);for(let t=0;t<i;t++){const e=_O(s,32*t);if(null==e)throw new Error("abort");n.push(e)}e.urls=n}catch(i){y_(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=xO(t,64);if(null==n)throw new Error("abort");e.calldata=n}catch(i){y_(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}y_(I_(t,100,128)===I_(TO,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=I_(t,96,100);try{const n=xO(t,128);if(null==n)throw new Error("abort");e.extraData=n}catch(i){y_(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(t=>e[t]),e}(I_(i.data,4))}catch(s){y_(!1,s.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:r,info:{data:t}})}y_(o.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:t,reason:"OffchainLookup",transaction:r,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:o.errorArgs}});const l=await this.ccipReadFetch(r,o.calldata,o.urls);y_(null!=l,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:r,info:{data:i.data,errorArgs:o.errorArgs}});const c={to:a,data:N_([o.selector,MO([l,o.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:c});try{const t=await this.#ae(c,e,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},c),result:t}),t}catch(s){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},c),error:s}),s}}throw i}}async#oe(t){const{value:e}=await d_({network:this.getNetwork(),value:t});return e}async call(t){const{tx:e,blockTag:n}=await d_({tx:this._getTransactionRequest(t),blockTag:this._getBlockTag(t.blockTag)});return await this.#oe(this.#ae(e,n,t.enableCcipRead?0:-1))}async#le(t,e,n){let r=this._getAddress(e),i=this._getBlockTag(n);return"string"==typeof r&&"string"==typeof i||([r,i]=await Promise.all([r,i])),await this.#oe(this.#ie(Object.assign(t,{address:r,blockTag:i})))}async getBalance(t,e){return j_(await this.#le({method:"getBalance"},t,e),"%response")}async getTransactionCount(t,e){return K_(await this.#le({method:"getTransactionCount"},t,e),"%response")}async getCode(t,e){return P_(await this.#le({method:"getCode"},t,e))}async getStorage(t,e,n){const r=j_(e,"position");return P_(await this.#le({method:"getStorage",position:r},t,n))}async broadcastTransaction(t){const{blockNumber:e,hash:n,network:r}=await d_({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:t}),network:this.getNetwork()}),i=eR.from(t);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,r).replaceableTransaction(e)}async#se(t,e){if(T_(t,32))return await this.#ie({method:"getBlock",blockHash:t,includeTransactions:e});let n=this._getBlockTag(t);return"string"!=typeof n&&(n=await n),await this.#ie({method:"getBlock",blockTag:n,includeTransactions:e})}async getBlock(t,e){const{network:n,params:r}=await d_({network:this.getNetwork(),params:this.#se(t,!!e)});return null==r?null:this._wrapBlock(r,n)}async getTransaction(t){const{network:e,params:n}=await d_({network:this.getNetwork(),params:this.#ie({method:"getTransaction",hash:t})});return null==n?null:this._wrapTransactionResponse(n,e)}async getTransactionReceipt(t){const{network:e,params:n}=await d_({network:this.getNetwork(),params:this.#ie({method:"getTransactionReceipt",hash:t})});if(null==n)return null;if(null==n.gasPrice&&null==n.effectiveGasPrice){const e=await this.#ie({method:"getTransaction",hash:t});if(null==e)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=e.gasPrice}return this._wrapTransactionReceipt(n,e)}async getTransactionResult(t){const{result:e}=await d_({network:this.getNetwork(),result:this.#ie({method:"getTransactionResult",hash:t})});return null==e?null:P_(e)}async getLogs(t){let e=this._getFilter(t);fO(e)&&(e=await e);const{network:n,params:r}=await d_({network:this.getNetwork(),params:this.#ie({method:"getLogs",filter:e})});return r.map(t=>this._wrapLog(t,n))}_getProvider(t){y_(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(t){return await FN.fromName(this,t)}async getAvatar(t){const e=await this.getResolver(t);return e?await e.getAvatar():null}async resolveName(t){const e=await this.getResolver(t);return e?await e.getAddress():null}async lookupAddress(t){const e=fC((t=eT(t)).substring(2).toLowerCase()+".addr.reverse");try{const n=await FN.getEnsAddress(this),r=new NN(n,["function resolver(bytes32) view returns (address)"],this),i=await r.resolver(e);if(null==i||i===TM)return null;const s=new NN(i,["function name(bytes32) view returns (string)"],this),a=await s.name(e);return await this.resolveName(a)!==t?null:a}catch(n){if(m_(n,"BAD_DATA")&&"0x"===n.value)return null;if(m_(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(t,e,n){const r=null!=e?e:1;return 0===r?this.getTransactionReceipt(t):new Promise(async(e,i)=>{let s=null;const a=async n=>{try{const i=await this.getTransactionReceipt(t);if(null!=i&&n-i.blockNumber+1>=r)return e(i),void(s&&(clearTimeout(s),s=null))}catch(i){console.log("EEE",i)}this.once("block",a)};null!=n&&(s=setTimeout(()=>{null!=s&&(s=null,this.off("block",a),i(v_("timeout","TIMEOUT",{reason:"timeout"})))},n)),a(await this.getBlockNumber())})}async waitForBlock(t){y_(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(t){const e=this.#ne.get(t);e&&(e.timer&&clearTimeout(e.timer),this.#ne.delete(t))}_setTimeout(t,e){null==e&&(e=0);const n=this.#ee++,r=()=>{this.#ne.delete(n),t()};if(this.paused)this.#ne.set(n,{timer:null,func:r,time:e});else{const t=setTimeout(r,e);this.#ne.set(n,{timer:t,func:r,time:yO()})}return n}_forEachSubscriber(t){for(const e of this.#Kt.values())t(e.subscriber)}_getSubscriber(t){switch(t.type){case"debug":case"error":case"network":return new mO(t.type);case"block":{const t=new aO(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new lO(this,t.type);case"event":return new hO(this,t.filter);case"transaction":return new uO(this,t.hash);case"orphan":return new cO(this,t.filter)}throw new Error(`unsupported event: ${t.type}`)}_recoverSubscriber(t,e){for(const n of this.#Kt.values())if(n.subscriber===t){n.started&&n.subscriber.stop(),n.subscriber=e,n.started&&e.start(),null!=this.#Yt&&e.pause(this.#Yt);break}}async#ce(t,e){let n=await vO(t,this);return"event"===n.type&&e&&e.length>0&&!0===e[0].removed&&(n=await vO({orphan:"drop-log",log:e[0]},this)),this.#Kt.get(n.tag)||null}async#ue(t){const e=await vO(t,this),n=e.tag;let r=this.#Kt.get(n);if(!r){r={subscriber:this._getSubscriber(e),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},this.#Kt.set(n,r)}return r}async on(t,e){const n=await this.#ue(t);return n.listeners.push({listener:e,once:!1}),n.started||(n.subscriber.start(),n.started=!0,null!=this.#Yt&&n.subscriber.pause(this.#Yt)),this}async once(t,e){const n=await this.#ue(t);return n.listeners.push({listener:e,once:!0}),n.started||(n.subscriber.start(),n.started=!0,null!=this.#Yt&&n.subscriber.pause(this.#Yt)),this}async emit(t,...e){const n=await this.#ce(t,e);if(!n||0===n.listeners.length)return!1;const r=n.listeners.length;return n.listeners=n.listeners.filter(({listener:n,once:r})=>{const i=new lx(this,r?null:n,t);try{n.call(this,...e,i)}catch(s){}return!r}),0===n.listeners.length&&(n.started&&n.subscriber.stop(),this.#Kt.delete(n.tag)),r>0}async listenerCount(t){if(t){const e=await this.#ce(t);return e?e.listeners.length:0}let e=0;for(const{listeners:n}of this.#Kt.values())e+=n.length;return e}async listeners(t){if(t){const e=await this.#ce(t);return e?e.listeners.map(({listener:t})=>t):[]}let e=[];for(const{listeners:n}of this.#Kt.values())e=e.concat(n.map(({listener:t})=>t));return e}async off(t,e){const n=await this.#ce(t);if(!n)return this;if(e){const t=n.listeners.map(({listener:t})=>t).indexOf(e);t>=0&&n.listeners.splice(t,1)}return e&&0!==n.listeners.length||(n.started&&n.subscriber.stop(),this.#Kt.delete(n.tag)),this}async removeAllListeners(t){if(t){const{tag:e,started:n,subscriber:r}=await this.#ue(t);n&&r.stop(),this.#Kt.delete(e)}else for(const[e,{started:n,subscriber:r}]of this.#Kt)n&&r.stop(),this.#Kt.delete(e);return this}async addListener(t,e){return await this.on(t,e)}async removeListener(t,e){return this.off(t,e)}get destroyed(){return this.#Jt}destroy(){this.removeAllListeners();for(const t of this.#ne.keys())this._clearTimeout(t);this.#Jt=!0}get paused(){return null!=this.#Yt}set paused(t){!!t!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(t){if(this.#te=-1,null!=this.#Yt){if(this.#Yt==!!t)return;y_(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(e=>e.pause(t)),this.#Yt=!!t;for(const e of this.#ne.values())e.timer&&clearTimeout(e.timer),e.time=yO()-e.time}resume(){if(null!=this.#Yt){this._forEachSubscriber(t=>t.resume()),this.#Yt=null;for(const t of this.#ne.values()){let e=t.time;e<0&&(e=0),t.time=yO(),setTimeout(t.func,e)}}}}function _O(t,e){try{const n=xO(t,e);if(n)return fx(n)}catch(n){}return null}function xO(t,e){if("0x"===t)return null;try{const n=K_(I_(t,e,e+32)),r=K_(I_(t,n,n+32));return I_(t,n+32,n+32+r)}catch(n){}return null}function EO(t){const e=Q_(t);if(e.length>32)throw new Error("internal; should not happen");const n=new Uint8Array(32);return n.set(e,32-e.length),n}function AO(t){if(t.length%32==0)return t;const e=new Uint8Array(32*Math.ceil(t.length/32));return e.set(t),e}const SO=new Uint8Array([]);function MO(t){const e=[];let n=0;for(let r=0;r<t.length;r++)e.push(SO),n+=32;for(let r=0;r<t.length;r++){const i=S_(t[r]);e[r]=EO(n),e.push(EO(i.length)),e.push(AO(i)),n+=32+32*Math.ceil(i.length/32)}return N_(e)}const TO="0x0000000000000000000000000000000000000000000000000000000000000000";function RO(t,e){if(t.provider)return t.provider;y_(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function CO(t,e){let n=JP(e);if(null!=n.to&&(n.to=lT(n.to,t)),null!=n.from){const e=n.from;n.from=Promise.all([t.getAddress(),lT(e,t)]).then(([t,e])=>(b_(t.toLowerCase()===e.toLowerCase(),"transaction from mismatch","tx.from",e),t))}else n.from=t.getAddress();return await d_(n)}class PO{provider;constructor(t){f_(this,{provider:t||null})}async getNonce(t){return RO(this,"getTransactionCount").getTransactionCount(await this.getAddress(),t)}async populateCall(t){return await CO(this,t)}async populateTransaction(t){const e=RO(this,"populateTransaction"),n=await CO(this,t);null==n.nonce&&(n.nonce=await this.getNonce("pending")),null==n.gasLimit&&(n.gasLimit=await this.estimateGas(n));const r=await this.provider.getNetwork();if(null!=n.chainId){b_(j_(n.chainId)===r.chainId,"transaction chainId mismatch","tx.chainId",t.chainId)}else n.chainId=r.chainId;const i=null!=n.maxFeePerGas||null!=n.maxPriorityFeePerGas;if(null==n.gasPrice||2!==n.type&&!i?0!==n.type&&1!==n.type||!i||b_(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",t):b_(!1,"eip-1559 transaction do not support gasPrice","tx",t),2!==n.type&&null!=n.type||null==n.maxFeePerGas||null==n.maxPriorityFeePerGas)if(0===n.type||1===n.type){const t=await e.getFeeData();y_(null!=t.gasPrice,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),null==n.gasPrice&&(n.gasPrice=t.gasPrice)}else{const t=await e.getFeeData();if(null==n.type)if(null!=t.maxFeePerGas&&null!=t.maxPriorityFeePerGas)if(n.authorizationList&&n.authorizationList.length?n.type=4:n.type=2,null!=n.gasPrice){const t=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=t,n.maxPriorityFeePerGas=t}else null==n.maxFeePerGas&&(n.maxFeePerGas=t.maxFeePerGas),null==n.maxPriorityFeePerGas&&(n.maxPriorityFeePerGas=t.maxPriorityFeePerGas);else null!=t.gasPrice?(y_(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),null==n.gasPrice&&(n.gasPrice=t.gasPrice),n.type=0):y_(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else 2!==n.type&&3!==n.type&&4!==n.type||(null==n.maxFeePerGas&&(n.maxFeePerGas=t.maxFeePerGas),null==n.maxPriorityFeePerGas&&(n.maxPriorityFeePerGas=t.maxPriorityFeePerGas))}else n.type=2;return await d_(n)}async populateAuthorization(t){const e=Object.assign({},t);return null==e.chainId&&(e.chainId=(await RO(this,"getNetwork").getNetwork()).chainId),null==e.nonce&&(e.nonce=await this.getNonce()),e}async estimateGas(t){return RO(this,"estimateGas").estimateGas(await this.populateCall(t))}async call(t){return RO(this,"call").call(await this.populateCall(t))}async resolveName(t){const e=RO(this,"resolveName");return await e.resolveName(t)}async sendTransaction(t){const e=RO(this,"sendTransaction"),n=await this.populateTransaction(t);delete n.from;const r=eR.from(n);return await e.broadcastTransaction(await this.signTransaction(r))}authorize(t){y_(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}class NO extends PO{address;constructor(t,e){super(e),f_(this,{address:t})}async getAddress(){return this.address}connect(t){return new NO(this.address,t)}#he(t,e){y_(!1,`VoidSigner cannot sign ${t}`,"UNSUPPORTED_OPERATION",{operation:e})}async signTransaction(t){this.#he("transactions","signTransaction")}async signMessage(t){this.#he("messages","signMessage")}async signTypedData(t,e,n){this.#he("typed-data","signTypedData")}}const OO=new Set;function IO(t){OO.has(t)||(OO.add(t),console.log("========= NOTICE ========="),console.log(`Request-Rate Exceeded for ${t} (this message will not be repeated)`),console.log(""),console.log("The default API keys for each service are provided as a highly-throttled,"),console.log("community resource for low-traffic projects and early prototyping."),console.log(""),console.log("While your application will continue to function, we highly recommended"),console.log("signing up for your own API keys to improve performance, increase your"),console.log("request rate/limit and enable other perks, such as metrics and advanced APIs."),console.log(""),console.log("For more details: https://docs.ethers.org/api-keys/"),console.log("=========================="))}class DO{#Bt;#de;#zt;#jt;#fe;#pe;constructor(t){this.#Bt=t,this.#de=null,this.#zt=this.#Vt.bind(this),this.#jt=!1,this.#fe=null,this.#pe=!1}_subscribe(t){throw new Error("subclasses must override this")}_emitResults(t,e){throw new Error("subclasses must override this")}_recover(t){throw new Error("subclasses must override this")}async#Vt(t){try{null==this.#de&&(this.#de=this._subscribe(this.#Bt));let t=null;try{t=await this.#de}catch(e){if(!m_(e,"UNSUPPORTED_OPERATION")||"eth_newFilter"!==e.operation)throw e}if(null==t)return this.#de=null,void this.#Bt._recoverSubscriber(this,this._recover(this.#Bt));const n=await this.#Bt.getNetwork();if(this.#fe||(this.#fe=n),this.#fe.chainId!==n.chainId)throw new Error("chaid changed");if(this.#pe)return;const r=await this.#Bt.send("eth_getFilterChanges",[t]);await this._emitResults(this.#Bt,r)}catch(e){console.log("@TODO",e)}this.#Bt.once("block",this.#zt)}#me(){const t=this.#de;t&&(this.#de=null,t.then(t=>{this.#Bt.destroyed||this.#Bt.send("eth_uninstallFilter",[t])}))}start(){this.#jt||(this.#jt=!0,this.#Vt(-2))}stop(){this.#jt&&(this.#jt=!1,this.#pe=!0,this.#me(),this.#Bt.off("block",this.#zt))}pause(t){t&&this.#me(),this.#Bt.off("block",this.#zt)}resume(){this.start()}}class UO extends DO{#ge;constructor(t,e){var n;super(t),this.#ge=(n=e,JSON.parse(JSON.stringify(n)))}_recover(t){return new hO(t,this.#ge)}async _subscribe(t){return await t.send("eth_newFilter",[this.#ge])}async _emitResults(t,e){for(const n of e)t.emit(this.#ge,t._wrapLog(n,t._network))}}class LO extends DO{async _subscribe(t){return await t.send("eth_newPendingTransactionFilter",[])}async _emitResults(t,e){for(const n of e)t.emit("pending",n)}}const FO="bigint,boolean,function,number,string,symbol".split(/,/g);function kO(t){if(null==t||FO.indexOf(typeof t)>=0)return t;if("function"==typeof t.getAddress)return t;if(Array.isArray(t))return t.map(kO);if("object"==typeof t)return Object.keys(t).reduce((e,n)=>(e[n]=t[n],e),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function BO(t){return new Promise(e=>{setTimeout(e,t)})}function zO(t){return t?t.toLowerCase():t}function HO(t){return t&&"number"==typeof t.pollingInterval}const GO={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class VO extends PO{address;constructor(t,e){super(t),f_(this,{address:e=eT(e)})}connect(t){y_(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const e=kO(t),n=[];if(e.from){const r=e.from;n.push((async()=>{const n=await lT(r,this.provider);b_(null!=n&&n.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),e.from=n})())}else e.from=this.address;if(null==e.gasLimit&&n.push((async()=>{e.gasLimit=await this.provider.estimateGas({...e,from:this.address})})()),null!=e.to){const t=e.to;n.push((async()=>{e.to=await lT(t,this.provider)})())}n.length&&await Promise.all(n);const r=this.provider.getRpcTransaction(e);return this.provider.send("eth_sendTransaction",[r])}async sendTransaction(t){const e=await this.provider.getBlockNumber(),n=await this.sendUncheckedTransaction(t);return await new Promise((t,r)=>{const i=[1e3,100];let s=0;const a=async()=>{try{const r=await this.provider.getTransaction(n);if(null!=r)return void t(r.replaceableTransaction(e))}catch(o){if(m_(o,"CANCELLED")||m_(o,"BAD_DATA")||m_(o,"NETWORK_ERROR")||m_(o,"UNSUPPORTED_OPERATION"))return null==o.info&&(o.info={}),o.info.sendTransactionHash=n,void r(o);if(m_(o,"INVALID_ARGUMENT")&&(s++,null==o.info&&(o.info={}),o.info.sendTransactionHash=n,s>10))return void r(o);this.provider.emit("error",v_("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:o}))}this.provider._setTimeout(()=>{a()},i.pop()||4e3)};a()})}async signTransaction(t){const e=kO(t);if(e.from){const n=await lT(e.from,this.provider);b_(null!=n&&n.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),e.from=n}else e.from=this.address;const n=this.provider.getRpcTransaction(e);return await this.provider.send("eth_signTransaction",[n])}async signMessage(t){const e="string"==typeof t?dx(t):t;return await this.provider.send("personal_sign",[P_(e),this.address.toLowerCase()])}async signTypedData(t,e,n){const r=kO(n),i=await kC.resolveNames(t,e,r,async t=>{const e=await lT(t);return b_(null!=e,"TypedData does not support null address","value",t),e});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(kC.getPayload(i.domain,e,i.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const e="string"==typeof t?dx(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),P_(e)])}}class jO extends wO{#X;#ve;#ye;#be;#we;#fe;#_e;#xe(){if(this.#be)return;const t=1===this._getOption("batchMaxCount")?0:this._getOption("batchStallTime");this.#be=setTimeout(()=>{this.#be=null;const t=this.#ye;for(this.#ye=[];t.length;){const e=[t.shift()];for(;t.length&&e.length!==this.#X.batchMaxCount;){e.push(t.shift());if(JSON.stringify(e.map(t=>t.payload)).length>this.#X.batchMaxSize){t.unshift(e.pop());break}}(async()=>{const t=1===e.length?e[0].payload:e.map(t=>t.payload);this.emit("debug",{action:"sendRpcPayload",payload:t});try{const n=await this._send(t);this.emit("debug",{action:"receiveRpcResult",result:n});for(const{resolve:t,reject:r,payload:i}of e){if(this.destroyed){r(v_("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:i.method}));continue}const e=n.filter(t=>t.id===i.id)[0];if(null==e){const t=v_("missing response for request","BAD_DATA",{value:n,info:{payload:i}});this.emit("error",t),r(t);continue}"error"in e?r(this.getRpcError(i,e)):t(e.result)}}catch(n){this.emit("debug",{action:"receiveRpcError",error:n});for(const{reject:t}of e)t(n)}})()}},t)}constructor(t,e){super(t,e),this.#ve=1,this.#X=Object.assign({},GO,e||{}),this.#ye=[],this.#be=null,this.#fe=null,this.#_e=null;{let t=null;const e=new Promise(e=>{t=e});this.#we={promise:e,resolve:t}}const n=this._getOption("staticNetwork");"boolean"==typeof n?(b_(!n||"any"!==t,"staticNetwork cannot be used on special network 'any'","options",e),n&&null!=t&&(this.#fe=eO.from(t))):n&&(b_(null==t||n.matches(t),"staticNetwork MUST match network object","options",e),this.#fe=n)}_getOption(t){return this.#X[t]}get _network(){return y_(this.#fe,"network is not available yet","NETWORK_ERROR"),this.#fe}async _perform(t){if("call"===t.method||"estimateGas"===t.method){let e=t.transaction;if(e&&null!=e.type&&j_(e.type)&&null==e.maxFeePerGas&&null==e.maxPriorityFeePerGas){const n=await this.getFeeData();null==n.maxFeePerGas&&null==n.maxPriorityFeePerGas&&(t=Object.assign({},t,{transaction:Object.assign({},e,{type:void 0})}))}}const e=this.getRpcRequest(t);return null!=e?await this.send(e.method,e.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t){if(!0!==t)return t;if(this.#fe)return this.#fe}return this.#_e?await this.#_e:this.ready?(this.#_e=(async()=>{try{const t=eO.from(j_(await this.send("eth_chainId",[])));return this.#_e=null,t}catch(t){throw this.#_e=null,t}})(),await this.#_e):(this.#_e=(async()=>{const t={id:this.#ve++,method:"eth_chainId",params:[],jsonrpc:"2.0"};let e;this.emit("debug",{action:"sendRpcPayload",payload:t});try{e=(await this._send(t))[0],this.#_e=null}catch(n){throw this.#_e=null,this.emit("debug",{action:"receiveRpcError",error:n}),n}if(this.emit("debug",{action:"receiveRpcResult",result:e}),"result"in e)return eO.from(j_(e.result));throw this.getRpcError(t,e)})(),await this.#_e)}_start(){null!=this.#we&&null!=this.#we.resolve&&(this.#we.resolve(),this.#we=null,(async()=>{for(;null==this.#fe&&!this.destroyed;)try{this.#fe=await this._detectNetwork()}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",v_("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await BO(1e3)}this.#xe()})())}async _waitUntilReady(){if(null!=this.#we)return await this.#we.promise}_getSubscriber(t){return"pending"===t.type?new LO(this):"event"===t.type?this._getOption("polling")?new hO(this,t.filter):new UO(this,t.filter):"orphan"===t.type&&"drop-log"===t.filter.orphan?new mO("orphan"):super._getSubscriber(t)}get ready(){return null==this.#we}getRpcTransaction(t){const e={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(n=>{if(null==t[n])return;let r=n;"gasLimit"===n&&(r="gas"),e[r]=Z_(j_(t[n],`tx.${n}`))}),["from","to","data"].forEach(n=>{null!=t[n]&&(e[n]=P_(t[n]))}),t.accessList&&(e.accessList=OT(t.accessList)),t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.map(t=>t.toLowerCase())),t.authorizationList&&(e.authorizationList=t.authorizationList.map(t=>{const e=IT(t);return{address:e.address,nonce:Z_(e.nonce),chainId:Z_(e.chainId),yParity:Z_(e.signature.yParity),r:Z_(e.signature.r),s:Z_(e.signature.s)}})),e}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[zO(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[zO(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[zO(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[zO(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&null!=t.filter.address&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(zO):t.filter.address=zO(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,e){const{method:n}=t,{error:r}=e;if("eth_estimateGas"===n&&r.message){const e=r.message;if(!e.match(/revert/i)&&e.match(/insufficient funds/i))return v_("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:r}});if(e.match(/nonce/i)&&e.match(/too low/i))return v_("nonce has already been used","NONCE_EXPIRED",{transaction:t.params[0],info:{payload:t,error:r}})}if("eth_call"===n||"eth_estimateGas"===n){const e=XO(r),i=LP.getBuiltinCallException("eth_call"===n?"call":"estimateGas",t.params[0],e?e.data:null);return i.info={error:r,payload:t},i}const i=JSON.stringify(function(t){const e=[];return KO(t,e),e}(r));if("string"==typeof r.message&&r.message.match(/user denied|ethers-user-denied/i)){return v_("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[n]||"unknown",reason:"rejected",info:{payload:t,error:r}})}if("eth_sendRawTransaction"===n||"eth_sendTransaction"===n){const e=t.params[0];if(i.match(/insufficient funds|base fee exceeds gas limit/i))return v_("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:e,info:{error:r}});if(i.match(/nonce/i)&&i.match(/too low/i))return v_("nonce has already been used","NONCE_EXPIRED",{transaction:e,info:{error:r}});if(i.match(/replacement transaction/i)&&i.match(/underpriced/i))return v_("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:e,info:{error:r}});if(i.match(/only replay-protected/i))return v_("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:n,info:{transaction:e,info:{error:r}}})}let s=!!i.match(/the method .* does not exist/i);return s||r&&r.details&&r.details.startsWith("Unauthorized method:")&&(s=!0),s?v_("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:r,payload:t}}):v_("could not coalesce error","UNKNOWN_ERROR",{error:r,payload:t})}send(t,e){if(this.destroyed)return Promise.reject(v_("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const n=this.#ve++,r=new Promise((r,i)=>{this.#ye.push({resolve:r,reject:i,payload:{method:t,params:e,id:n,jsonrpc:"2.0"}})});return this.#xe(),r}async getSigner(t){null==t&&(t=0);const e=this.send("eth_accounts",[]);if("number"==typeof t){const n=await e;if(t>=n.length)throw new Error("no such account");return new VO(this,n[t])}const{accounts:n}=await d_({network:this.getNetwork(),accounts:e});t=eT(t);for(const r of n)if(eT(r)===t)return new VO(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(t=>new VO(this,t))}destroy(){this.#be&&(clearTimeout(this.#be),this.#be=null);for(const{payload:t,reject:e}of this.#ye)e(v_("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));this.#ye=[],super.destroy()}}class WO extends jO{#Ee;constructor(t,e){super(t,e);let n=this._getOption("pollingInterval");null==n&&(n=GO.pollingInterval),this.#Ee=n}_getSubscriber(t){const e=super._getSubscriber(t);return HO(e)&&(e.pollingInterval=this.#Ee),e}get pollingInterval(){return this.#Ee}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");this.#Ee=t,this._forEachSubscriber(t=>{HO(t)&&(t.pollingInterval=this.#Ee)})}}class qO extends WO{#Ae;constructor(t,e,n){null==t&&(t="http://localhost:8545"),super(e,n),this.#Ae="string"==typeof t?new Mx(t):t.clone()}_getConnection(){return this.#Ae.clone()}async send(t,e){return await this._start(),await super.send(t,e)}async _send(t){const e=this._getConnection();e.body=JSON.stringify(t),e.setHeader("content-type","application/json");const n=await e.send();n.assertOk();let r=n.bodyJson;return Array.isArray(r)||(r=[r]),r}}function XO(t){if(null==t)return null;if("string"==typeof t.message&&t.message.match(/revert/i)&&T_(t.data))return{message:t.message,data:t.data};if("object"==typeof t){for(const e in t){const n=XO(t[e]);if(n)return n}return null}if("string"==typeof t)try{return XO(JSON.parse(t))}catch(e){}return null}function KO(t,e){if(null!=t){if("string"==typeof t.message&&e.push(t.message),"object"==typeof t)for(const n in t)KO(t[n],e);if("string"==typeof t)try{return KO(JSON.parse(t),e)}catch(n){}}}const YO="9f7d929b018cdffb338517efa06f58359e86ff1ffd350bc889738523659e7972";class JO extends qO{apiKey;constructor(t,e){null==t&&(t="mainnet");const n=eO.from(t);null==e&&(e=YO);const r={polling:!0,staticNetwork:n};super(JO.getRequest(n,e),n,r),f_(this,{apiKey:e})}_getProvider(t){try{return new JO(t,this.apiKey)}catch(e){}return super._getProvider(t)}static getRequest(t,e){null==e&&(e=YO);const n=new Mx(`https://${function(t){switch(t){case"mainnet":return"rpc.ankr.com/eth";case"goerli":return"rpc.ankr.com/eth_goerli";case"sepolia":return"rpc.ankr.com/eth_sepolia";case"arbitrum":return"rpc.ankr.com/arbitrum";case"base":return"rpc.ankr.com/base";case"base-goerli":return"rpc.ankr.com/base_goerli";case"base-sepolia":return"rpc.ankr.com/base_sepolia";case"bnb":return"rpc.ankr.com/bsc";case"bnbt":return"rpc.ankr.com/bsc_testnet_chapel";case"filecoin":return"rpc.ankr.com/filecoin";case"filecoin-calibration":return"rpc.ankr.com/filecoin_testnet";case"matic":return"rpc.ankr.com/polygon";case"matic-mumbai":return"rpc.ankr.com/polygon_mumbai";case"optimism":return"rpc.ankr.com/optimism";case"optimism-goerli":return"rpc.ankr.com/optimism_testnet";case"optimism-sepolia":return"rpc.ankr.com/optimism_sepolia"}b_(!1,"unsupported network","network",t)}(t.name)}/${e}`);return n.allowGzip=!0,e===YO&&(n.retryFunc=async(t,e,n)=>(IO("AnkrProvider"),!0)),n}getRpcError(t,e){return"eth_sendRawTransaction"===t.method&&e&&e.error&&"INTERNAL_ERROR: could not replace existing tx"===e.error.message&&(e.error.message="replacement transaction underpriced"),super.getRpcError(t,e)}isCommunityResource(){return this.apiKey===YO}}const QO="_gg7wSSi0KMBsdKnGVfHDueq6xMB9EkC";class ZO extends qO{apiKey;constructor(t,e){null==t&&(t="mainnet");const n=eO.from(t);null==e&&(e=QO);super(ZO.getRequest(n,e),n,{staticNetwork:n}),f_(this,{apiKey:e})}_getProvider(t){try{return new ZO(t,this.apiKey)}catch(e){}return super._getProvider(t)}async _perform(t){if("getTransactionResult"===t.method){const{trace:n,tx:r}=await d_({trace:this.send("trace_transaction",[t.hash]),tx:this.getTransaction(t.hash)});if(null==n||null==r)return null;let i,s=!1;try{i=n[0].result.output,s="Reverted"===n[0].error}catch(e){}if(i)return y_(!s,"an error occurred during transaction executions","CALL_EXCEPTION",{action:"getTransactionResult",data:i,reason:null,transaction:r,invocation:null,revert:null}),i;y_(!1,"could not parse trace result","BAD_DATA",{value:n})}return await super._perform(t)}isCommunityResource(){return this.apiKey===QO}static getRequest(t,e){null==e&&(e=QO);const n=new Mx(`https://${function(t){switch(t){case"mainnet":return"eth-mainnet.g.alchemy.com";case"goerli":return"eth-goerli.g.alchemy.com";case"sepolia":return"eth-sepolia.g.alchemy.com";case"arbitrum":return"arb-mainnet.g.alchemy.com";case"arbitrum-goerli":return"arb-goerli.g.alchemy.com";case"arbitrum-sepolia":return"arb-sepolia.g.alchemy.com";case"base":return"base-mainnet.g.alchemy.com";case"base-goerli":return"base-goerli.g.alchemy.com";case"base-sepolia":return"base-sepolia.g.alchemy.com";case"matic":return"polygon-mainnet.g.alchemy.com";case"matic-amoy":return"polygon-amoy.g.alchemy.com";case"matic-mumbai":return"polygon-mumbai.g.alchemy.com";case"optimism":return"opt-mainnet.g.alchemy.com";case"optimism-goerli":return"opt-goerli.g.alchemy.com";case"optimism-sepolia":return"opt-sepolia.g.alchemy.com"}b_(!1,"unsupported network","network",t)}(t.name)}/v2/${e}`);return n.allowGzip=!0,e===QO&&(n.retryFunc=async(t,e,n)=>(IO("alchemy"),!0)),n}}function $O(t){switch(t){case"mainnet":return"39f1d67cedf8b7831010a665328c9197";case"arbitrum":return"0550c209db33c3abf4cc927e1e18cea1";case"bnb":return"98b5a77e531614387366f6fc5da097f8";case"matic":return"cd9d4d70377471aa7c142ec4a4205249"}b_(!1,"unsupported network","network",t)}class tI extends qO{apiKey;constructor(t,e){null==t&&(t="mainnet");const n=eO.from(t);null==e&&(e=$O(n.name));super(tI.getRequest(n,e),n,{staticNetwork:n}),f_(this,{apiKey:e})}_getProvider(t){try{return new tI(t,this.apiKey)}catch(e){}return super._getProvider(t)}isCommunityResource(){return this.apiKey===$O(this._network.name)}static getRequest(t,e){null==e&&(e=$O(t.name));const n=new Mx(`https://${function(t){switch(t){case"mainnet":return"ethereum-mainnet.core.chainstack.com";case"arbitrum":return"arbitrum-mainnet.core.chainstack.com";case"bnb":return"bsc-mainnet.core.chainstack.com";case"matic":return"polygon-mainnet.core.chainstack.com"}b_(!1,"unsupported network","network",t)}(t.name)}/${e}`);return n.allowGzip=!0,e===$O(t.name)&&(n.retryFunc=async(t,e,n)=>(IO("ChainstackProvider"),!0)),n}}class eI extends qO{constructor(t){null==t&&(t="mainnet");const e=eO.from(t);b_("mainnet"===e.name,"unsupported network","network",t),super("https://cloudflare-eth.com/",e,{staticNetwork:e})}}const nI="1 11155111 17000 560048 2741 11124 33111 33139 42170 42161 421614 43114 43113 8453 84532 80069 80094 199 1029 81457 168587773 56 97 42220 11142220 252 2523 100 999 737373 747474 59144 59141 5000 5003 43521 143 10143 1287 1284 1285 10 11155420 204 5611 80002 137 534352 534351 1329 1328 146 14601 988 2201 1923 1924 167013 167000 130 1301 480 4801 51 50 324 300".split(/ /g);const rI="org.ethers.plugins.provider.Etherscan";class iI extends YN{baseUrl;constructor(t){super(rI),f_(this,{baseUrl:t})}clone(){return new iI(this.baseUrl)}}const sI=["enableCcipRead"];let aI=1;class oI extends wO{network;apiKey;#Se;constructor(t,e){const n=null!=e?e:null;super();const r=eO.from(t);b_(nI.indexOf(`${r.chainId}`)>=0,"unsupported network","network",r),this.#Se=r.getPlugin(rI),f_(this,{apiKey:n,network:r})}getBaseUrl(){if(this.#Se)return this.#Se.baseUrl;switch(this.network.name){case"mainnet":return"https://api.etherscan.io";case"goerli":return"https://api-goerli.etherscan.io";case"sepolia":return"https://api-sepolia.etherscan.io";case"holesky":return"https://api-holesky.etherscan.io";case"arbitrum":return"https://api.arbiscan.io";case"arbitrum-goerli":return"https://api-goerli.arbiscan.io";case"base":return"https://api.basescan.org";case"base-sepolia":return"https://api-sepolia.basescan.org";case"bnb":return"https://api.bscscan.com";case"bnbt":return"https://api-testnet.bscscan.com";case"matic":return"https://api.polygonscan.com";case"matic-amoy":return"https://api-amoy.polygonscan.com";case"matic-mumbai":return"https://api-testnet.polygonscan.com";case"optimism":return"https://api-optimistic.etherscan.io";case"optimism-goerli":return"https://api-goerli-optimistic.etherscan.io"}b_(!1,"unsupported network","network",this.network)}getUrl(t,e){let n=Object.keys(e).reduce((t,n)=>{const r=e[n];return null!=r&&(t+=`&${n}=${r}`),t},"");return this.apiKey&&(n+=`&apikey=${this.apiKey}`),`https://api.etherscan.io/v2/api?chainid=${this.network.chainId}&module=${t}${n}`}getPostUrl(){return`https://api.etherscan.io/v2/api?chainid=${this.network.chainId}`}getPostData(t,e){return e.module=t,e.apikey=this.apiKey,e.chainid=this.network.chainId,e}async detectNetwork(){return this.network}async fetch(t,e,n){const r=aI++,i=n?this.getPostUrl():this.getUrl(t,e),s=n?this.getPostData(t,e):null;this.emit("debug",{action:"sendRequest",id:r,url:i,payload:s});const a=new Mx(i);a.setThrottleParams({slotInterval:1e3}),a.retryFunc=(t,e,n)=>(this.isCommunityResource()&&IO("Etherscan"),Promise.resolve(!0)),a.processFunc=async(e,n)=>{const i=n.hasBody()?JSON.parse(fx(n.body)):{},s=("string"==typeof i.result?i.result:"").toLowerCase().indexOf("rate limit")>=0;return"proxy"===t?i&&0==i.status&&"NOTOK"==i.message&&s&&(this.emit("debug",{action:"receiveError",id:r,reason:"proxy-NOTOK",error:i}),n.throwThrottleError(i.result,2e3)):s&&(this.emit("debug",{action:"receiveError",id:r,reason:"null result",error:i.result}),n.throwThrottleError(i.result,2e3)),n},s&&(a.setHeader("content-type","application/x-www-form-urlencoded; charset=UTF-8"),a.body=Object.keys(s).map(t=>`${t}=${s[t]}`).join("&"));const o=await a.send();try{o.assertOk()}catch(c){this.emit("debug",{action:"receiveError",id:r,error:c,reason:"assertOk"}),y_(!1,"response error","SERVER_ERROR",{request:a,response:o})}o.hasBody()||(this.emit("debug",{action:"receiveError",id:r,error:"missing body",reason:"null body"}),y_(!1,"missing response","SERVER_ERROR",{request:a,response:o}));const l=JSON.parse(fx(o.body));return"proxy"===t?("2.0"!=l.jsonrpc&&(this.emit("debug",{action:"receiveError",id:r,result:l,reason:"invalid JSON-RPC"}),y_(!1,"invalid JSON-RPC response (missing jsonrpc='2.0')","SERVER_ERROR",{request:a,response:o,info:{result:l}})),l.error&&(this.emit("debug",{action:"receiveError",id:r,result:l,reason:"JSON-RPC error"}),y_(!1,"error response","SERVER_ERROR",{request:a,response:o,info:{result:l}})),this.emit("debug",{action:"receiveRequest",id:r,result:l}),l.result):0!=l.status||"No records found"!==l.message&&"No transactions found"!==l.message?((1!=l.status||"string"==typeof l.message&&!l.message.match(/^OK/))&&(this.emit("debug",{action:"receiveError",id:r,result:l}),y_(!1,"error response","SERVER_ERROR",{request:a,response:o,info:{result:l}})),this.emit("debug",{action:"receiveRequest",id:r,result:l}),l.result):(this.emit("debug",{action:"receiveRequest",id:r,result:l}),l.result)}_getTransactionPostData(t){const e={};for(let n in t){if(sI.indexOf(n)>=0)continue;if(null==t[n])continue;let r=t[n];if(("type"!==n||0!==r)&&("blockTag"!==n||"latest"!==r)){if({type:!0,gasLimit:!0,gasPrice:!0,maxFeePerGs:!0,maxPriorityFeePerGas:!0,nonce:!0,value:!0}[n])r=Z_(r);else if("accessList"===n)r="["+OT(r).map(t=>`{address:"${t.address}",storageKeys:["${t.storageKeys.join('","')}"]}`).join(",")+"]";else if("blobVersionedHashes"===n){if(0===r.length)continue;y_(!1,"Etherscan API does not support blobVersionedHashes","UNSUPPORTED_OPERATION",{operation:"_getTransactionPostData",info:{transaction:t}})}else r=P_(r);e[n]=r}}return e}_checkError(t,e,n){let r="";if(m_(e,"SERVER_ERROR")){try{r=e.info.result.error.message}catch(Es){}if(!r)try{r=e.info.message}catch(Es){}}if("estimateGas"===t.method&&!r.match(/revert/i)&&r.match(/insufficient funds/i)&&y_(!1,"insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.transaction}),("call"===t.method||"estimateGas"===t.method)&&r.match(/execution reverted/i)){let n="";try{n=e.info.result.error.data}catch(i){}const r=LP.getBuiltinCallException(t.method,t.transaction,n);throw r.info={request:t,error:e},r}if(r&&"broadcastTransaction"===t.method){const e=eR.from(t.signedTransaction);r.match(/replacement/i)&&r.match(/underpriced/i)&&y_(!1,"replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:e}),r.match(/insufficient funds/)&&y_(!1,"insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:e}),r.match(/same hash was already imported|transaction nonce is too low|nonce too low/)&&y_(!1,"nonce has already been used","NONCE_EXPIRED",{transaction:e})}throw e}async _detectNetwork(){return this.network}async _perform(t){switch(t.method){case"chainId":return this.network.chainId;case"getBlockNumber":return this.fetch("proxy",{action:"eth_blockNumber"});case"getGasPrice":return this.fetch("proxy",{action:"eth_gasPrice"});case"getPriorityFee":if("mainnet"===this.network.name)return"1000000000";if("optimism"===this.network.name)return"1000000";throw new Error("fallback onto the AbstractProvider default");case"getBalance":return this.fetch("account",{action:"balance",address:t.address,tag:t.blockTag});case"getTransactionCount":return this.fetch("proxy",{action:"eth_getTransactionCount",address:t.address,tag:t.blockTag});case"getCode":return this.fetch("proxy",{action:"eth_getCode",address:t.address,tag:t.blockTag});case"getStorage":return this.fetch("proxy",{action:"eth_getStorageAt",address:t.address,position:t.position,tag:t.blockTag});case"broadcastTransaction":return this.fetch("proxy",{action:"eth_sendRawTransaction",hex:t.signedTransaction},!0).catch(e=>this._checkError(t,e,t.signedTransaction));case"getBlock":if("blockTag"in t)return this.fetch("proxy",{action:"eth_getBlockByNumber",tag:t.blockTag,boolean:t.includeTransactions?"true":"false"});y_(!1,"getBlock by blockHash not supported by Etherscan","UNSUPPORTED_OPERATION",{operation:"getBlock(blockHash)"});case"getTransaction":return this.fetch("proxy",{action:"eth_getTransactionByHash",txhash:t.hash});case"getTransactionReceipt":return this.fetch("proxy",{action:"eth_getTransactionReceipt",txhash:t.hash});case"call":{if("latest"!==t.blockTag)throw new Error("EtherscanProvider does not support blockTag for call");const n=this._getTransactionPostData(t.transaction);n.module="proxy",n.action="eth_call";try{return await this.fetch("proxy",n,!0)}catch(e){return this._checkError(t,e,t.transaction)}}case"estimateGas":{const n=this._getTransactionPostData(t.transaction);n.module="proxy",n.action="eth_estimateGas";try{return await this.fetch("proxy",n,!0)}catch(e){return this._checkError(t,e,t.transaction)}}}return super._perform(t)}async getNetwork(){return this.network}async getEtherPrice(){return"mainnet"!==this.network.name?0:parseFloat((await this.fetch("stats",{action:"ethprice"})).ethusd)}async getContract(t){let e=this._getAddress(t);var n;(n=e)&&"function"==typeof n.then&&(e=await e);try{const t=await this.fetch("contract",{action:"getabi",address:e}),n=JSON.parse(t);return new NN(e,n,this)}catch(r){return null}}isCommunityResource(){return null==this.apiKey}}const lI=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}().WebSocket;class cI{#Bt;#Pt;get filter(){return JSON.parse(this.#Pt)}#Me;#Te;#Re;constructor(t,e){this.#Bt=t,this.#Pt=JSON.stringify(e),this.#Me=null,this.#Te=null,this.#Re=null}start(){this.#Me=this.#Bt.send("eth_subscribe",this.filter).then(t=>(this.#Bt._register(t,this),t))}stop(){this.#Me.then(t=>{this.#Bt.destroyed||this.#Bt.send("eth_unsubscribe",[t])}),this.#Me=null}pause(t){y_(t,"preserve logs while paused not supported by SocketSubscriber yet","UNSUPPORTED_OPERATION",{operation:"pause(false)"}),this.#Te=!!t}resume(){this.#Te=null}_handleMessage(t){if(null!=this.#Me&&null===this.#Te){let e=this.#Re;e=null==e?this._emit(this.#Bt,t):e.then(async()=>{await this._emit(this.#Bt,t)}),this.#Re=e.then(()=>{this.#Re===e&&(this.#Re=null)})}}async _emit(t,e){throw new Error("sub-classes must implemente this; _emit")}}class uI extends cI{constructor(t){super(t,["newHeads"])}async _emit(t,e){t.emit("block",parseInt(e.number))}}class hI extends cI{constructor(t){super(t,["newPendingTransactions"])}async _emit(t,e){t.emit("pending",e)}}class dI extends cI{#Ce;get logFilter(){return JSON.parse(this.#Ce)}constructor(t,e){super(t,["logs",e]),this.#Ce=JSON.stringify(e)}async _emit(t,e){t.emit(this.logFilter,t._wrapLog(e,t._network))}}class fI extends jO{#Pe;#Kt;#Ne;constructor(t,e){const n=Object.assign({},null!=e?e:{});b_(null==n.batchMaxCount||1===n.batchMaxCount,"sockets-based providers do not support batches","options.batchMaxCount",e),n.batchMaxCount=1,null==n.staticNetwork&&(n.staticNetwork=!0),super(t,n),this.#Pe=new Map,this.#Kt=new Map,this.#Ne=new Map}_getSubscriber(t){switch(t.type){case"close":return new mO("close");case"block":return new uI(this);case"pending":return new hI(this);case"event":return new dI(this,t.filter);case"orphan":if("drop-log"===t.filter.orphan)return new mO("drop-log")}return super._getSubscriber(t)}_register(t,e){this.#Kt.set(t,e);const n=this.#Ne.get(t);if(n){for(const t of n)e._handleMessage(t);this.#Ne.delete(t)}}async _send(t){b_(!Array.isArray(t),"WebSocket does not support batch send","payload",t);const e=new Promise((e,n)=>{this.#Pe.set(t.id,{payload:t,resolve:e,reject:n})});return await this._waitUntilReady(),await this._write(JSON.stringify(t)),[await e]}async _processMessage(t){const e=JSON.parse(t);if(e&&"object"==typeof e&&"id"in e){const t=this.#Pe.get(e.id);if(null==t)return void this.emit("error",v_("received result for unknown id","UNKNOWN_ERROR",{reasonCode:"UNKNOWN_ID",result:e}));this.#Pe.delete(e.id),t.resolve(e)}else{if(!e||"eth_subscription"!==e.method)return void this.emit("error",v_("received unexpected message","UNKNOWN_ERROR",{reasonCode:"UNEXPECTED_MESSAGE",result:e}));{const t=e.params.subscription,n=this.#Kt.get(t);if(n)n._handleMessage(e.params.result);else{let n=this.#Ne.get(t);null==n&&(n=[],this.#Ne.set(t,n)),n.push(e.params.result)}}}}async _write(t){throw new Error("sub-classes must override this")}}class pI extends fI{#Ae;#Oe;get websocket(){if(null==this.#Oe)throw new Error("websocket closed");return this.#Oe}constructor(t,e,n){super(e,n),"string"==typeof t?(this.#Ae=()=>new lI(t),this.#Oe=this.#Ae()):"function"==typeof t?(this.#Ae=t,this.#Oe=t()):(this.#Ae=null,this.#Oe=t),this.websocket.onopen=async()=>{try{await this._start(),this.resume()}catch(t){console.log("failed to start WebsocketProvider",t)}},this.websocket.onmessage=t=>{this._processMessage(t.data)}}async _write(t){this.websocket.send(t)}async destroy(){null!=this.#Oe&&(this.#Oe.close(),this.#Oe=null),super.destroy()}}const mI="84842078b09946638c03157f83405213";class gI extends pI{projectId;projectSecret;constructor(t,e){const n=new vI(t,e),r=n._getConnection();y_(!r.credentials,"INFURA WebSocket project secrets unsupported","UNSUPPORTED_OPERATION",{operation:"InfuraProvider.getWebSocketProvider()"});super(r.url.replace(/^http/i,"ws").replace("/v3/","/ws/v3/"),n._network),f_(this,{projectId:n.projectId,projectSecret:n.projectSecret})}isCommunityResource(){return this.projectId===mI}}class vI extends qO{projectId;projectSecret;constructor(t,e,n){null==t&&(t="mainnet");const r=eO.from(t);null==e&&(e=mI),null==n&&(n=null);super(vI.getRequest(r,e,n),r,{staticNetwork:r}),f_(this,{projectId:e,projectSecret:n})}_getProvider(t){try{return new vI(t,this.projectId,this.projectSecret)}catch(e){}return super._getProvider(t)}isCommunityResource(){return this.projectId===mI}static getWebSocketProvider(t,e){return new gI(t,e)}static getRequest(t,e,n){null==e&&(e=mI),null==n&&(n=null);const r=new Mx(`https://${function(t){switch(t){case"mainnet":return"mainnet.infura.io";case"goerli":return"goerli.infura.io";case"sepolia":return"sepolia.infura.io";case"arbitrum":return"arbitrum-mainnet.infura.io";case"arbitrum-goerli":return"arbitrum-goerli.infura.io";case"arbitrum-sepolia":return"arbitrum-sepolia.infura.io";case"base":return"base-mainnet.infura.io";case"base-goerlia":case"base-goerli":return"base-goerli.infura.io";case"base-sepolia":return"base-sepolia.infura.io";case"bnb":return"bsc-mainnet.infura.io";case"bnbt":return"bsc-testnet.infura.io";case"linea":return"linea-mainnet.infura.io";case"linea-goerli":return"linea-goerli.infura.io";case"linea-sepolia":return"linea-sepolia.infura.io";case"matic":return"polygon-mainnet.infura.io";case"matic-amoy":return"polygon-amoy.infura.io";case"matic-mumbai":return"polygon-mumbai.infura.io";case"optimism":return"optimism-mainnet.infura.io";case"optimism-goerli":return"optimism-goerli.infura.io";case"optimism-sepolia":return"optimism-sepolia.infura.io"}b_(!1,"unsupported network","network",t)}(t.name)}/v3/${e}`);return r.allowGzip=!0,n&&r.setCredentials("",n),e===mI&&(r.retryFunc=async(t,e,n)=>(IO("InfuraProvider"),!0)),r}}const yI="919b412a057b5e9c9b6dce193c5a60242d6efadb";class bI extends qO{token;constructor(t,e){null==t&&(t="mainnet");const n=eO.from(t);null==e&&(e=yI);super(bI.getRequest(n,e),n,{staticNetwork:n}),f_(this,{token:e})}_getProvider(t){try{return new bI(t,this.token)}catch(e){}return super._getProvider(t)}isCommunityResource(){return this.token===yI}static getRequest(t,e){null==e&&(e=yI);const n=new Mx(`https://${function(t){switch(t){case"mainnet":return"ethers.quiknode.pro";case"goerli":return"ethers.ethereum-goerli.quiknode.pro";case"sepolia":return"ethers.ethereum-sepolia.quiknode.pro";case"holesky":return"ethers.ethereum-holesky.quiknode.pro";case"arbitrum":return"ethers.arbitrum-mainnet.quiknode.pro";case"arbitrum-goerli":return"ethers.arbitrum-goerli.quiknode.pro";case"arbitrum-sepolia":return"ethers.arbitrum-sepolia.quiknode.pro";case"base":return"ethers.base-mainnet.quiknode.pro";case"base-goerli":return"ethers.base-goerli.quiknode.pro";case"base-spolia":return"ethers.base-sepolia.quiknode.pro";case"bnb":return"ethers.bsc.quiknode.pro";case"bnbt":return"ethers.bsc-testnet.quiknode.pro";case"matic":return"ethers.matic.quiknode.pro";case"matic-mumbai":return"ethers.matic-testnet.quiknode.pro";case"optimism":return"ethers.optimism.quiknode.pro";case"optimism-goerli":return"ethers.optimism-goerli.quiknode.pro";case"optimism-sepolia":return"ethers.optimism-sepolia.quiknode.pro";case"xdai":return"ethers.xdai.quiknode.pro"}b_(!1,"unsupported network","network",t)}(t.name)}/${e}`);return n.allowGzip=!0,e===yI&&(n.retryFunc=async(t,e,n)=>(IO("QuickNodeProvider"),!0)),n}}const wI=BigInt("1"),_I=BigInt("2");function xI(){return(new Date).getTime()}function EI(t){return JSON.stringify(t,(t,e)=>"bigint"==typeof e?{type:"bigint",value:e.toString()}:e)}const AI={stallTimeout:400,priority:1,weight:1},SI={blockNumber:-2,requests:0,lateResponses:0,errorResponses:0,outOfSync:-1,unsupportedEvents:0,rollingDuration:0,score:0,_network:null,_updateNumber:null,_totalTime:0,_lastFatalError:null,_lastFatalErrorTimestamp:0};function MI(t){if(null==t)return"null";if(Array.isArray(t))return"["+t.map(MI).join(",")+"]";if("object"==typeof t&&"function"==typeof t.toJSON)return MI(t.toJSON());switch(typeof t){case"boolean":case"symbol":return t.toString();case"bigint":case"number":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const e=Object.keys(t);return e.sort(),"{"+e.map(e=>`${JSON.stringify(e)}:${MI(t[e])}`).join(",")+"}"}}throw console.log("Could not serialize",t),new Error("Hmm...")}function TI(t,e){if("error"in e){const t=e.error;let n;return n=m_(t,"CALL_EXCEPTION")?MI(Object.assign({},t,{shortMessage:void 0,reason:void 0,info:void 0})):MI(t),{tag:n,value:t}}const n=e.result;return{tag:MI(n),value:n}}function RI(t,e){const n=new Map;for(const{value:i,tag:s,weight:a}of e){const t=n.get(s)||{value:i,weight:0};t.weight+=a,n.set(s,t)}let r=null;for(const i of n.values())i.weight>=t&&(!r||i.weight>r.weight)&&(r=i);if(r)return r.value}function CI(t,e){let n=0;const r=new Map;let i=null;const s=[];for(const{value:o,tag:l,weight:c}of e)if(o instanceof Error){const t=r.get(l)||{value:o,weight:0};t.weight+=c,r.set(l,t),(null==i||t.weight>i.weight)&&(i=t)}else s.push(BigInt(o)),n+=c;if(n<t)return i&&i.weight>=t?i.value:void 0;s.sort((t,e)=>t<e?-1:e>t?1:0);const a=Math.floor(s.length/2);return s.length%2?s[a]:(s[a-1]+s[a]+wI)/_I}function PI(t,e){const n=RI(t,e);if(void 0!==n)return n;for(const r of e)if(r.value)return r.value}class NI extends wO{quorum;eventQuorum;eventWorkers;#Ie;#De;#Ue;constructor(t,e,n){super(e,n),this.#Ie=t.map(t=>t instanceof wO?Object.assign({provider:t},AI,SI):Object.assign({},AI,t,SI)),this.#De=-2,this.#Ue=null,n&&null!=n.quorum?this.quorum=n.quorum:this.quorum=Math.ceil(this.#Ie.reduce((t,e)=>t+=e.weight,0)/2),this.eventQuorum=1,this.eventWorkers=1,b_(this.quorum<=this.#Ie.reduce((t,e)=>t+e.weight,0),"quorum exceed provider weight","quorum",this.quorum)}get providerConfigs(){return this.#Ie.map(t=>{const e=Object.assign({},t);for(const n in e)"_"===n[0]&&delete e[n];return e})}async _detectNetwork(){return eO.from(j_(await this._perform({method:"chainId"})))}async _translatePerform(t,e){switch(e.method){case"broadcastTransaction":return await t.broadcastTransaction(e.signedTransaction);case"call":return await t.call(Object.assign({},e.transaction,{blockTag:e.blockTag}));case"chainId":return(await t.getNetwork()).chainId;case"estimateGas":return await t.estimateGas(e.transaction);case"getBalance":return await t.getBalance(e.address,e.blockTag);case"getBlock":{const n="blockHash"in e?e.blockHash:e.blockTag;return await t.getBlock(n,e.includeTransactions)}case"getBlockNumber":return await t.getBlockNumber();case"getCode":return await t.getCode(e.address,e.blockTag);case"getGasPrice":return(await t.getFeeData()).gasPrice;case"getPriorityFee":return(await t.getFeeData()).maxPriorityFeePerGas;case"getLogs":return await t.getLogs(e.filter);case"getStorage":return await t.getStorage(e.address,e.position,e.blockTag);case"getTransaction":return await t.getTransaction(e.hash);case"getTransactionCount":return await t.getTransactionCount(e.address,e.blockTag);case"getTransactionReceipt":return await t.getTransactionReceipt(e.hash);case"getTransactionResult":return await t.getTransactionResult(e.hash)}}#Le(t){const e=Array.from(t).map(t=>t.config),n=this.#Ie.slice();!function(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1)),r=t[e];t[e]=t[n],t[n]=r}}(n),n.sort((t,e)=>t.priority-e.priority);for(const r of n)if(!r._lastFatalError&&-1===e.indexOf(r))return r;return null}#Fe(t,e){const n=this.#Le(t);if(null==n)return null;const r={config:n,result:null,didBump:!1,perform:null,staller:null},i=xI();return r.perform=(async()=>{try{n.requests++;const t=await this._translatePerform(n.provider,e);r.result={result:t}}catch(s){n.errorResponses++,r.result={error:s}}const t=xI()-i;n._totalTime+=t,n.rollingDuration=.95*n.rollingDuration+.05*t,r.perform=null})(),r.staller=(async()=>{var t;await(t=n.stallTimeout,new Promise(e=>{setTimeout(e,t)})),r.staller=null})(),t.add(r),r}async#ke(){let t=this.#Ue;if(!t){const e=[];this.#Ie.forEach(t=>{e.push((async()=>{await async function(t,e){for(;(t.blockNumber<0||t.blockNumber<e)&&(t._updateNumber||(t._updateNumber=(async()=>{try{const e=await t.provider.getBlockNumber();e>t.blockNumber&&(t.blockNumber=e)}catch(e){t.blockNumber=-2,t._lastFatalError=e,t._lastFatalErrorTimestamp=xI()}t._updateNumber=null})()),await t._updateNumber,t.outOfSync++,!t._lastFatalError););}(t,0),t._lastFatalError||(t._network=await t.provider.getNetwork())})())}),this.#Ue=t=(async()=>{await Promise.all(e);let t=null;for(const e of this.#Ie){if(e._lastFatalError)continue;const n=e._network;null==t?t=n.chainId:n.chainId!==t&&y_(!1,"cannot mix providers on different networks","UNSUPPORTED_OPERATION",{operation:"new FallbackProvider"})}})()}await t}async#Be(t,e){const n=[];for(const r of t)if(null!=r.result){const{tag:t,value:i}=TI(e.method,r.result);n.push({tag:t,value:i,weight:r.config.weight})}if(!(n.reduce((t,e)=>t+e.weight,0)<this.quorum)){switch(e.method){case"getBlockNumber":{-2===this.#De&&(this.#De=Math.ceil(K_(CI(this.quorum,this.#Ie.filter(t=>!t._lastFatalError).map(t=>({value:t.blockNumber,tag:K_(t.blockNumber).toString(),weight:t.weight}))))));const t=function(t,e){if(1===t)return K_(CI(t,e),"%internal");const n=new Map,r=(t,e)=>{const r=n.get(t)||{result:t,weight:0};r.weight+=e,n.set(t,r)};for(const{weight:a,value:o}of e){const t=K_(o);r(t-1,a),r(t,a),r(t+1,a)}let i,s=0;for(const{weight:a,result:o}of n.values())a>=t&&(a>s||null!=i&&a===s&&o>i)&&(s=a,i=o);return i}(this.quorum,n);if(void 0===t)return;return t>this.#De&&(this.#De=t),this.#De}case"getGasPrice":case"getPriorityFee":case"estimateGas":return CI(this.quorum,n);case"getBlock":return"blockTag"in e&&"pending"===e.blockTag?PI(this.quorum,n):RI(this.quorum,n);case"call":case"chainId":case"getBalance":case"getTransactionCount":case"getCode":case"getStorage":case"getTransaction":case"getTransactionReceipt":case"getLogs":return RI(this.quorum,n);case"broadcastTransaction":return PI(this.quorum,n)}y_(!1,"unsupported method","UNSUPPORTED_OPERATION",{operation:`_perform(${EI(e.method)})`})}}async#ze(t,e){if(0===t.size)throw new Error("no runners?!");const n=[];let r=0;for(const s of t)s.perform&&n.push(s.perform),s.staller?n.push(s.staller):s.didBump||(s.didBump=!0,r++);const i=await this.#Be(t,e);if(void 0!==i){if(i instanceof Error)throw i;return i}for(let s=0;s<r;s++)this.#Fe(t,e);return y_(n.length>0,"quorum not met","SERVER_ERROR",{request:"%sub-requests",info:{request:e,results:Array.from(t).map(t=>EI(t.result))}}),await Promise.race(n),await this.#ze(t,e)}async _perform(t){if("broadcastTransaction"===t.method){const e=this.#Ie.map(t=>null),n=this.#Ie.map(async({provider:n,weight:r},i)=>{try{const s=await n._perform(t);e[i]=Object.assign(TI(t.method,{result:s}),{weight:r})}catch(s){e[i]=Object.assign(TI(t.method,{error:s}),{weight:r})}});for(;;){const t=e.filter(t=>null!=t);for(const{value:e}of t)if(!(e instanceof Error))return e;const r=RI(this.quorum,e.filter(t=>null!=t));if(m_(r,"INSUFFICIENT_FUNDS"))throw r;const i=n.filter((t,n)=>null==e[n]);if(0===i.length)break;await Promise.race(i)}const r=PI(this.quorum,e);if(y_(void 0!==r,"problem multi-broadcasting","SERVER_ERROR",{request:"%sub-requests",info:{request:t,results:e.map(EI)}}),r instanceof Error)throw r;return r}await this.#ke();const e=new Set;let n=0;for(;;){const r=this.#Fe(e,t);if(null==r)break;if(n+=r.config.weight,n>=this.quorum)break}const r=await this.#ze(e,t);for(const i of e)i.perform&&null==i.result&&i.config.lateResponses++;return r}async destroy(){for(const{provider:t}of this.#Ie)t.destroy();super.destroy()}}const OI="goerli kovan sepolia classicKotti optimism-goerli arbitrum-goerli matic-mumbai bnbt".split(" ");function II(t,e){null==e&&(e={});const n=t=>"-"!==e[t]&&("string"==typeof e.exclusive?t===e.exclusive:!Array.isArray(e.exclusive)||-1!==e.exclusive.indexOf(t));if("string"==typeof t&&t.match(/^https?:/))return new qO(t);if("string"==typeof t&&t.match(/^wss?:/)||(r=t)&&"function"==typeof r.send&&"function"==typeof r.close)return new pI(t);var r;let i=null;try{i=eO.from(t)}catch(o){}const s=[];if(n("publicPolygon")&&i&&("matic"===i.name?s.push(new qO("https://polygon-rpc.com/",i,{staticNetwork:i})):"matic-amoy"===i.name&&s.push(new qO("https://rpc-amoy.polygon.technology/",i,{staticNetwork:i}))),n("alchemy"))try{s.push(new ZO(t,e.alchemy))}catch(o){}if(n("ankr")&&null!=e.ankr)try{s.push(new JO(t,e.ankr))}catch(o){}if(n("chainstack"))try{s.push(new tI(t,e.chainstack))}catch(o){}if(n("cloudflare"))try{s.push(new eI(t))}catch(o){}if(n("etherscan"))try{s.push(new oI(t,e.etherscan))}catch(o){}if(n("infura"))try{let n,r=e.infura;"object"==typeof r&&(n=r.projectSecret,r=r.projectId),s.push(new vI(t,r,n))}catch(o){}if(n("quicknode"))try{let n=e.quicknode;s.push(new bI(t,n))}catch(o){}if(y_(s.length,"unsupported default network","UNSUPPORTED_OPERATION",{operation:"getDefaultProvider"}),1===s.length)return s[0];let a=Math.floor(s.length/2);return a>2&&(a=2),i&&-1!==OI.indexOf(i.name)&&(a=1),e&&e.quorum&&(a=e.quorum),new NI(s,void 0,{quorum:a})}class DI extends PO{signer;#He;#Ge;constructor(t){super(t.provider),f_(this,{signer:t}),this.#He=null,this.#Ge=0}async getAddress(){return this.signer.getAddress()}connect(t){return new DI(this.signer.connect(t))}async getNonce(t){if("pending"===t){null==this.#He&&(this.#He=super.getNonce("pending"));const t=this.#Ge;return await this.#He+t}return super.getNonce(t)}increment(){this.#Ge++}reset(){this.#Ge=0,this.#He=null}async sendTransaction(t){const e=this.getNonce("pending");return this.increment(),(t=await this.signer.populateTransaction(t)).nonce=await e,await this.signer.sendTransaction(t)}signTransaction(t){return this.signer.signTransaction(t)}signMessage(t){return this.signer.signMessage(t)}signTypedData(t,e,n){return this.signer.signTypedData(t,e,n)}}class UI extends WO{#_;#Ve;constructor(t,e,n){const r=Object.assign({},null!=n?n:{},{batchMaxCount:1});b_(t&&t.request,"invalid EIP-1193 provider","ethereum",t),super(e,r),this.#Ve=null,n&&n.providerInfo&&(this.#Ve=n.providerInfo),this.#_=async(e,n)=>{const r={method:e,params:n};this.emit("debug",{action:"sendEip1193Request",payload:r});try{const e=await t.request(r);return this.emit("debug",{action:"receiveEip1193Result",result:e}),e}catch(Es){const e=new Error(Es.message);throw e.code=Es.code,e.data=Es.data,e.payload=r,this.emit("debug",{action:"receiveEip1193Error",error:e}),e}}}get providerInfo(){return this.#Ve}async send(t,e){return await this._start(),await super.send(t,e)}async _send(t){b_(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const e=await this.#_(t.method,t.params||[]);return[{id:t.id,result:e}]}catch(Es){return[{id:t.id,error:{code:Es.code,data:Es.data,message:Es.message}}]}}getRpcError(t,e){switch((e=JSON.parse(JSON.stringify(e))).error.code||-1){case 4001:e.error.message=`ethers-user-denied: ${e.error.message}`;break;case 4200:e.error.message=`ethers-unsupported: ${e.error.message}`}return super.getRpcError(t,e)}async hasSigner(t){null==t&&(t=0);const e=await this.send("eth_accounts",[]);return"number"==typeof t?e.length>t:(t=t.toLowerCase(),0!==e.filter(e=>e.toLowerCase()===t).length)}async getSigner(t){if(null==t&&(t=0),!(await this.hasSigner(t)))try{await this.#_("eth_requestAccounts",[])}catch(e){const t=e.payload;throw this.getRpcError(t,{id:t.id,error:e})}return await super.getSigner(t)}static async discover(t){if(null==t&&(t={}),t.provider)return new UI(t.provider);const e=t.window?t.window:"undefined"!=typeof window?window:null;if(null==e)return null;const n=t.anyProvider;if(n&&e.ethereum)return new UI(e.ethereum);if(!("addEventListener"in e&&"dispatchEvent"in e&&"removeEventListener"in e))return null;const r=t.timeout?t.timeout:300;return 0===r?null:await new Promise((i,s)=>{let a=[];const o=t=>{a.push(t.detail),n&&l()},l=()=>{if(clearTimeout(c),a.length)if(t&&t.filter){const e=t.filter(a.map(t=>Object.assign({},t.info)));if(null==e)i(null);else if(e instanceof UI)i(e);else{let t=null;if(e.uuid){t=a.filter(t=>e.uuid===t.info.uuid)[0]}if(t){const{provider:e,info:n}=t;i(new UI(e,void 0,{providerInfo:n}))}else s(v_("filter returned unknown info","UNSUPPORTED_OPERATION",{value:e}))}}else{const{provider:t,info:e}=a[0];i(new UI(t,void 0,{providerInfo:e}))}else i(null);e.removeEventListener("eip6963:announceProvider",o)},c=setTimeout(()=>{l()},r);e.addEventListener("eip6963:announceProvider",o),e.dispatchEvent(new Event("eip6963:requestProvider"))})}}class LI extends qO{apiKey;constructor(t,e){null==t&&(t="mainnet");const n=eO.from(t);null==e&&(e=null);super(LI.getRequest(n),n,{staticNetwork:n}),f_(this,{apiKey:e})}_getProvider(t){try{return new LI(t,this.apiKey)}catch(e){}return super._getProvider(t)}isCommunityResource(){return null===this.apiKey}getRpcRequest(t){const e=super.getRpcRequest(t);return e&&"eth_estimateGas"===e.method&&1==e.args.length&&(e.args=e.args.slice(),e.args.push("latest")),e}getRpcError(t,e){const n=e?e.error:null;if(n&&-32015===n.code&&!T_(n.data||"",!0)){const t={"assert(false)":"01","arithmetic underflow or overflow":"11","division or modulo by zero":"12","out-of-bounds array access; popping on an empty array":"31","out-of-bounds access of an array or bytesN":"32"};let e="";"VM execution error."===n.message?e=t[n.data]||"":t[n.message||""]&&(e=t[n.message||""]),e&&(n.message+=` (reverted: ${n.data})`,n.data="0x4e487b7100000000000000000000000000000000000000000000000000000000000000"+e)}else n&&-32e3===n.code&&"wrong transaction nonce"===n.message&&(n.message+=" (nonce too low)");return super.getRpcError(t,e)}static getRequest(t){const e=new Mx(function(t){switch(t){case"mainnet":return"https://eth.blockscout.com/api/eth-rpc";case"sepolia":return"https://eth-sepolia.blockscout.com/api/eth-rpc";case"holesky":return"https://eth-holesky.blockscout.com/api/eth-rpc";case"classic":return"https://etc.blockscout.com/api/eth-rpc";case"arbitrum":return"https://arbitrum.blockscout.com/api/eth-rpc";case"base":return"https://base.blockscout.com/api/eth-rpc";case"base-sepolia":return"https://base-sepolia.blockscout.com/api/eth-rpc";case"matic":return"https://polygon.blockscout.com/api/eth-rpc";case"optimism":return"https://optimism.blockscout.com/api/eth-rpc";case"optimism-sepolia":return"https://optimism-sepolia.blockscout.com/api/eth-rpc";case"xdai":return"https://gnosis.blockscout.com/api/eth-rpc"}b_(!1,"unsupported network","network",t)}(t.name));return e.allowGzip=!0,e}}const FI="62e1ad51b37b8e00394bda3b";class kI extends qO{applicationId;applicationSecret;constructor(t,e,n){null==t&&(t="mainnet");const r=eO.from(t);null==e&&(e=FI),null==n&&(n=null);const i={staticNetwork:r};super(kI.getRequest(r,e,n),r,i),f_(this,{applicationId:e,applicationSecret:n})}_getProvider(t){try{return new kI(t,this.applicationId,this.applicationSecret)}catch(e){}return super._getProvider(t)}static getRequest(t,e,n){null==e&&(e=FI);const r=new Mx(`https://${function(t){switch(t){case"mainnet":return"eth-mainnet.gateway.pokt.network";case"goerli":return"eth-goerli.gateway.pokt.network";case"matic":return"poly-mainnet.gateway.pokt.network";case"matic-mumbai":return"polygon-mumbai-rpc.gateway.pokt.network"}b_(!1,"unsupported network","network",t)}(t.name)}/v1/lb/${e}`);return r.allowGzip=!0,n&&r.setCredentials("",n),e===FI&&(r.retryFunc=async(t,e,n)=>(IO("PocketProvider"),!0)),r}isCommunityResource(){return this.applicationId===FI}}const BI=void 0;class zI extends PO{address;#je;constructor(t,e){super(e),b_(t&&"function"==typeof t.sign,"invalid private key","privateKey","[ REDACTED ]"),this.#je=t;f_(this,{address:DT(this.signingKey.publicKey)})}get signingKey(){return this.#je}get privateKey(){return this.signingKey.privateKey}async getAddress(){return this.address}connect(t){return new zI(this.#je,t)}async signTransaction(t){t=JP(t);const{to:e,from:n}=await d_({to:t.to?lT(t.to,this):void 0,from:t.from?lT(t.from,this):void 0});null!=e&&(t.to=e),null!=n&&(t.from=n),null!=t.from&&(b_(eT(t.from)===this.address,"transaction from address mismatch","tx.from",t.from),delete t.from);const r=eR.from(t);return r.signature=this.signingKey.sign(r.unsignedHash),r.serialized}async signMessage(t){return this.signMessageSync(t)}signMessageSync(t){return this.signingKey.sign(mC(t)).serialized}authorizeSync(t){b_("string"==typeof t.address,"invalid address for authorizeSync","auth.address",t);const e=this.signingKey.sign(nR(t));return Object.assign({},{address:eT(t.address),nonce:j_(t.nonce||0),chainId:j_(t.chainId||0)},{signature:e})}async authorize(t){return t=Object.assign({},t,{address:await lT(t.address,this)}),this.authorizeSync(await this.populateAuthorization(t))}async signTypedData(t,e,n){const r=await kC.resolveNames(t,e,n,async t=>{y_(null!=this.provider,"cannot resolve ENS names without a provider","UNSUPPORTED_OPERATION",{operation:"resolveName",info:{name:t}});const e=await this.provider.resolveName(t);return y_(null!=e,"unconfigured ENS name","UNCONFIGURED_NAME",{value:t}),e});return this.signingKey.sign(kC.hash(r.domain,e,r.value)).serialized}}const HI=" !#$%&'()*+,-./<=>?@[]^_`{|}~",GI=/^[a-z]*$/i;function VI(t,e){let n=97;return t.reduce((t,r)=>(r===e?n++:r.match(GI)?t.push(String.fromCharCode(n)+r):(n=97,t.push(r)),t),[])}function jI(t){return b_("0"===t[0],"unsupported auwl data","data",t),function(t,e){for(let i=28;i>=0;i--)t=t.split(HI[i]).join(e.substring(2*i,2*i+2));const n=[],r=t.replace(/(:|([0-9])|([A-Z][a-z]*))/g,(t,e,r,i)=>{if(r)for(let s=parseInt(r);s>=0;s--)n.push(";");else n.push(e.toLowerCase());return""});if(r)throw new Error(`leftovers: ${JSON.stringify(r)}`);return VI(VI(n,";"),":")}(t.substring(59),t.substring(1,59))}class WI{locale;constructor(t){f_(this,{locale:t})}split(t){return t.toLowerCase().split(/\s+/g)}join(t){return t.join(" ")}}class qI extends WI{#I;#We;constructor(t,e,n){super(t),this.#I=e,this.#We=n,this.#qe=null}get _data(){return this.#I}_decodeWords(){return jI(this.#I)}#qe;#Xe(){if(null==this.#qe){const t=this._decodeWords();if(iR(t.join("\n")+"\n")!==this.#We)throw new Error(`BIP39 Wordlist for ${this.locale} FAILED`);this.#qe=t}return this.#qe}getWord(t){const e=this.#Xe();return b_(t>=0&&t<e.length,`invalid word index: ${t}`,"index",t),e[t]}getWordIndex(t){return this.#Xe().indexOf(t)}}let XI=null;class KI extends qI{constructor(){super("en","0erleonalorenseinceregesticitStanvetearctssi#ch2Athck&tneLl0And#Il.yLeOutO=S|S%b/ra@SurdU'0Ce[Cid|CountCu'Hie=IdOu,-Qui*Ro[TT]T%T*[Tu$0AptDD-tD*[Ju,M.UltV<)Vi)0Rob-0FairF%dRaid0A(EEntRee0Ead0MRRp%tS!_rmBumCoholErtI&LLeyLowMo,O}PhaReadySoT Ways0A>urAz(gOngOuntU'd0Aly,Ch%Ci|G G!GryIm$K!Noun)Nu$O` Sw T&naTiqueXietyY1ArtOlogyPe?P!Pro=Ril1ChCt-EaEnaGueMMedM%MyOundR<+Re,Ri=RowTTefa@Ti,Tw%k0KPe@SaultSetSi,SumeThma0H!>OmTa{T&dT.udeTra@0Ct]D.Gu,NtTh%ToTumn0Era+OcadoOid0AkeA*AyEsomeFulKw?d0Is:ByChel%C#D+GL<)Lc#y~MbooN<aNn RRelyRga(R*lSeS-SketTt!3A^AnAutyCau'ComeEfF%eG(Ha=H(dLie=LowLtN^Nef./TrayTt Twe&Y#d3Cyc!DKeNdOlogyRdR`Tt _{AdeAmeAnketA,EakE[IndOodO[omOu'UeUrUsh_rdAtDyIlMbNeNusOkO,Rd R(gRrowSsTtomUn)XY_{etA(AndA[A=EadEezeI{Id+IefIghtIngIskOccoliOk&OnzeOomO` OwnUsh2Bb!DdyD+tFf$oIldLbLkL!tNd!Nk Rd&Rg R,SS(e[SyTt Y Zz:Bba+B(B!CtusGeKe~LmM aMpNN$N)lNdyNn#NoeNvasNy#Pab!P.$Pta(RRb#RdRgoRpetRryRtSeShS(o/!Su$TT$ogT^Teg%yTt!UghtU'Ut]Ve3Il(gL yM|NsusNturyRe$Rta(_irAlkAmp]An+AosApt Ar+A'AtEapE{Ee'EfErryE,I{&IefIldIm}yOi)Oo'R#-U{!UnkUrn0G?Nnam#Rc!Tiz&TyVil_imApArifyAwAyE<ErkEv I{I|IffImbIn-IpO{OgO'O`OudOwnUbUmpU, Ut^_^A,C#utDeFfeeIlInL!@L%LumnMb(eMeMf%tM-Mm#Mp<yNc tNdu@NfirmNg*[N}@Nsid NtrolNv()OkOlPp PyR$ReRnR*@/Tt#U^UntryUp!Ur'Us(V Yo>_{Ad!AftAmA}AshAt AwlAzyEamEd.EekEwI{etImeIspIt-OpO[Ou^OwdUci$UelUi'Umb!Un^UshYY,$2BeLtu*PPbo?dRiousRr|Rta(R=Sh]/omTe3C!:DMa+MpN)Ng R(gShUght WnY3AlBa>BrisCadeCemb CideCl(eC%a>C*a'ErF&'F(eFyG*eLayLiv M<dMi'Ni$Nti,NyP?tP&dPos.P`PutyRi=ScribeS tSignSkSpair/royTailTe@VelopVi)Vo>3AgramAlAm#dAryCeE'lEtFf G.$Gn.yLemmaNn NosaurRe@RtSag*eScov Sea'ShSmi[S%d Splay/<)V tVideV%)Zzy5Ct%Cum|G~Lph(Ma(Na>NkeyN%OrSeUb!Ve_ftAg#AmaA,-AwEamE[IftIllInkIpI=OpUmY2CkMbNeR(g/T^Ty1Arf1Nam-:G G!RlyRnR`Sily/Sy1HoOlogyOnomy0GeItUca>1F%t0G1GhtTh 2BowD E@r-Eg<tEm|Eph<tEvat%I>Se0B?kBodyBra)Er+Ot]PloyPow Pty0Ab!A@DD![D%'EmyErgyF%)Ga+G(eH<)JoyLi,OughR-hRollSu*T Ti*TryVelope1Isode0U$Uip0AA'OdeOs]R%Upt0CapeSayS&)Ta>0Ern$H-s1Id&)IlOkeOl=1A@Amp!Ce[Ch<+C.eCludeCu'Ecu>Erci'Hau,Hib.I!I,ItOt-P<dPe@Pi*Pla(Po'P*[T&dTra0EEbrow:Br-CeCultyDeIntI`~L'MeMilyMousNNcyNtasyRmSh]TT$Th TigueUltV%.e3Atu*Bru?yD $EEdElMa!N)/iv$T^V W3B Ct]EldGu*LeLmLt N$NdNeNg NishReRmR,Sc$ShTT}[X_gAmeAshAtAv%EeIghtIpOatO{O%Ow UidUshY_mCusGIlLd~owOdOtR)Re,R+tRkRtu}RumRw?dSsil/ UndX_gi!AmeEqu|EshI&dIn+OgOntO,OwnOz&U.2ElNNnyRna)RyTu*:D+tInLaxy~ yMePRa+Rba+Rd&Rl-Rm|SSpTeTh U+Ze3N $NiusN*Nt!Nu(e/u*2O,0AntFtGg!Ng RaffeRlVe_dAn)A*A[IdeImp'ObeOomOryO=OwUe_tDde[LdOdO'RillaSpelSsipV nWn_bA)A(AntApeA[Av.yEatE&IdIefItOc yOupOwUnt_rdE[IdeIltIt?N3M:B.IrLfMm M, NdPpyRb%RdRshR=,TVeWkZ?d3AdAl`ArtAvyD+hogIght~oLmetLpNRo3Dd&Gh~NtPRe/%y5BbyCkeyLdLeLiday~owMeNeyOdPeRnRr%R'Sp.$/TelUrV 5BGeM<Mb!M%Nd*dNgryNtRd!RryRtSb<d3Brid:1EOn0EaEntifyLe2N%e4LLeg$L}[0A+Ita>M&'Mu}Pa@Po'Pro=Pul'0ChCludeComeC*a'DexD-a>Do%Du,ryF<tFl-tF%mHa!H .Iti$Je@JuryMa>N Noc|PutQuiryS<eSe@SideSpi*/$lTa@T e,ToVe,V.eVol=3On0L<dOla>Sue0Em1Ory:CketGu?RZz3AlousAns~yWel9BInKeUr}yY5D+I)MpNg!Ni%Nk/:Ng?oo3EnEpT^upY3CkDD}yNdNgdomSsTT^&TeTt&Wi4EeIfeO{Ow:BBelB%Dd DyKeMpNgua+PtopR+T T(UghUndryVaWWnWsu.Y Zy3Ad AfArnA=Ctu*FtGG$G&dIsu*M#NdNg`NsOp?dSs#Tt Vel3ArB tyBr?yC&'FeFtGhtKeMbM.NkOnQuid/Tt!VeZ?d5AdAnB, C$CkG-NelyNgOpTt yUdUn+VeY$5CkyGga+Mb N?N^Xury3R-s:Ch(eDG-G}tIdIlInJ%KeMm$NNa+Nda>NgoNs]Nu$P!Rb!R^Rg(R(eRketRria+SkSs/ T^T i$ThTrixTt XimumZe3AdowAnAsu*AtCh<-D$DiaLodyLtMb M%yNt]NuRcyR+R.RryShSsa+T$Thod3Dd!DnightLk~]M-NdNimumN%Nu>Rac!Rr%S ySs/akeXXedXtu*5Bi!DelDifyMM|N.%NkeyN, N`OnR$ReRn(gSqu.oTh T]T%Unta(U'VeVie5ChFf(LeLtiplySc!SeumShroomS-/Tu$3Self/ yTh:I=MePk(Rrow/yT]Tu*3ArCkEdGati=G!@I` PhewR=/TTw%kUtr$V WsXt3CeGht5B!I'M(eeOd!Rm$R`SeTab!TeTh(gTi)VelW5C!?Mb R'T:K0EyJe@Li+Scu*S =Ta(Vious0CurE<Tob 0Or1FF Fi)T&2L1Ay0DI=Ymp-0It0CeEI#L(eLy1EnEraIn]Po'T]1An+B.Ch?dD D(?yG<I|Ig($Ph<0Tr-h0H 0Tdo%T TputTside0AlEnEr0NN 0Yg&0/ 0O}:CtDd!GeIrLa)LmNdaNelN-N` P RadeR|RkRrotRtySsT^ThTi|TrolTt nU'VeYm|3A)AnutArAs<tL-<NN$tyNcilOp!Pp Rfe@Rm.Rs#T2O}OtoRa'Ys-$0AnoCn-Ctu*E)GGe#~LotNkO} Pe/olT^Zza_)A}tA,-A>AyEa'Ed+U{UgUn+2EmEtIntL?LeLi)NdNyOlPul?Rt]S.]Ssib!/TatoTt yV tyWd W _@i)Ai'Ed-tEf Epa*Es|EttyEv|I)IdeIm?yIntI%.yIs#Iva>IzeOb!mO)[Odu)Of.OgramOje@Omo>OofOp tyOsp O>@OudOvide2Bl-Dd(g~LpL'Mpk(N^PilPpyR^a'R.yRpo'R'ShTZz!3Ramid:99Al.yAntumArt E,]I{ItIzO>:Bb.Cco#CeCkD?DioIlInI'~yMpN^NdomN+PidReTeTh V&WZ%3AdyAlAs#BelBuildC$lCei=CipeC%dCyc!Du)F!@F%mFu'G]G*tGul?Je@LaxLea'LiefLyMa(Memb M(dMo=Nd NewNtOp&PairPeatPla)P%tQui*ScueSemb!Si,Sour)Sp#'SultTi*T*atTurnUn]Ve$ViewW?d2Y`m0BBb#CeChDeD+F!GhtGidNgOtPp!SkTu$V$V 5AdA,BotBu,CketM<)OfOkieOmSeTa>UghUndU>Y$5Bb DeGLeNNwayR$:DDd!D}[FeIlLadLm#L#LtLu>MeMp!NdTisfyToshiU)Usa+VeY1A!AnA*Att E}HemeHoolI&)I[%sOrp]OutRapRe&RiptRub1AAr^As#AtC#dC*tCt]Cur.yEdEkGm|Le@~M(?Ni%N'Nt&)RiesRvi)Ss]Tt!TupV&_dowAftAllowA*EdEllEriffIeldIftI}IpIv O{OeOotOpOrtOuld O=RimpRugUff!Y0Bl(gCkDeE+GhtGnL|Lk~yLv Mil?Mp!N)NgR&/ Tua>XZe1A>Et^IIllInIrtUll0AbAmEepEnd I)IdeIghtImOg<OtOwUsh0AllArtI!OkeOo`0A{AkeApIffOw0ApCc Ci$CkDaFtL?Ldi LidLut]L=Me#eNgOnRryRtUlUndUpUr)U`0A)A*Ati$AwnEakEci$EedEllEndH eI)Id IkeInIr.L.OilOns%O#OrtOtRayReadR(gY0Ua*UeezeUir*l_b!AdiumAffA+AirsAmpAndArtA>AyEakEelEmEpE*oI{IllIngO{Oma^O}OolOryO=Ra>gyReetRikeR#gRugg!Ud|UffUmb!Y!0Bje@Bm.BwayC)[ChDd&Ff G?G+,ItMm NNnyN'tP PplyP*meReRfa)R+Rpri'RroundR=ySpe@/a(1AllowAmpApArmE?EetIftImIngIt^Ord1MbolMptomRup/em:B!Ck!GIlL|LkNkPeR+tSk/eTtooXi3A^Am~NN<tNnisNtRm/Xt_nkAtEmeEnE%yE*EyIngIsOughtReeRi=RowUmbUnd 0CketDeG LtMb MeNyPRedSsueT!5A,BaccoDayDdl EGe` I!tK&MatoM%rowNeNgueNightOlO`PP-Pp!R^RnadoRtoi'SsT$Uri,W?dW WnY_{AdeAff-Ag-A(Ansf ApAshA=lAyEatEeEndI$IbeI{Igg ImIpOphyOub!U{UeUlyUmpetU,U`Y2BeIt]Mb!NaN}lRkeyRnRt!1El=EntyI)InI,O1PeP-$:5Ly5B*lla0Ab!Awa*C!Cov D DoFairFoldHappyIf%mIqueItIv 'KnownLo{TilUsu$Veil1Da>GradeHoldOnP Set1B<Ge0A+EEdEfulE![U$0Il.y:C<tCuumGueLidL!yL=NNishP%Rious/Ult3H-!L=tNd%Ntu*NueRbRifyRs]RyS'lT <3Ab!Br<tCiousCt%yDeoEw~a+Nta+Ol(Rtu$RusSaS.Su$T$Vid5C$I)IdLc<oLumeTeYa+:GeG#ItLk~LnutNtRfa*RmRri%ShSp/eT VeY3Al`Ap#ArA'lA` BDd(gEk&dIrdLcome/T_!AtEatEelEnE*IpIsp 0DeD`FeLd~NNdowNeNgNkNn Nt ReSdomSeShT}[5LfM<Nd OdOlRdRkRldRryR`_pE{E,!I,I>Ong::Rd3Ar~ow9UUngU`:3BraRo9NeO","0x3c8acc1e7b08d8e76f9fda015ef48dc8c710a73cb7e0f77b2c18a9b5a7adde60")}static wordlist(){return null==XI&&(XI=new KI),XI}}function YI(t){return(1<<t)-1<<8-t&255}function JI(t){return(1<<t)-1&255}function QI(t,e){x_("NFKD"),null==e&&(e=KI.wordlist());const n=e.split(t);b_(n.length%3==0&&n.length>=12&&n.length<=24,"invalid mnemonic length","mnemonic","[ REDACTED ]");const r=new Uint8Array(Math.ceil(11*n.length/8));let i=0;for(let o=0;o<n.length;o++){let t=e.getWordIndex(n[o].normalize("NFKD"));b_(t>=0,`invalid mnemonic word at index ${o}`,"mnemonic","[ REDACTED ]");for(let e=0;e<11;e++)t&1<<10-e&&(r[i>>3]|=1<<7-i%8),i++}const s=32*n.length/3,a=YI(n.length/3);return b_((S_(xS(r.slice(0,s/8)))[0]&a)===(r[r.length-1]&a),"invalid mnemonic checksum","mnemonic","[ REDACTED ]"),P_(r.slice(0,s/8))}function ZI(t,e){b_(t.length%4==0&&t.length>=16&&t.length<=32,"invalid entropy size","entropy","[ REDACTED ]"),null==e&&(e=KI.wordlist());const n=[0];let r=11;for(let a=0;a<t.length;a++)r>8?(n[n.length-1]<<=8,n[n.length-1]|=t[a],r-=8):(n[n.length-1]<<=r,n[n.length-1]|=t[a]>>8-r,n.push(t[a]&JI(8-r)),r+=3);const i=t.length/4,s=parseInt(xS(t).substring(2,4),16)&YI(i);return n[n.length-1]<<=i,n[n.length-1]|=s>>8-i,e.join(n.map(t=>e.getWord(t)))}const $I={};class tD{phrase;password;wordlist;entropy;constructor(t,e,n,r,i){null==r&&(r=""),null==i&&(i=KI.wordlist()),E_(t,$I,"Mnemonic"),f_(this,{phrase:n,password:r,wordlist:i,entropy:e})}computeSeed(){const t=dx("mnemonic"+this.password,"NFKD");return ZA(dx(this.phrase,"NFKD"),t,2048,64,"sha512")}static fromPhrase(t,e,n){const r=QI(t,n);return t=ZI(S_(r),n),new tD($I,r,t,e,n)}static fromEntropy(t,e,n){const r=S_(t,"entropy"),i=ZI(r,n);return new tD($I,P_(r),i,e,n)}static entropyToPhrase(t,e){return ZI(S_(t,"entropy"),e)}static phraseToEntropy(t,e){return QI(t,e)}static isValidMnemonic(t,e){try{return QI(t,e),!0}catch(n){}return!1}}var eD,nD,rD,iD=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)},sD=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n};const aD={16:10,24:12,32:14},oD=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],lD=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],cD=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],uD=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],hD=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],dD=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],fD=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],pD=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],mD=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],gD=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],vD=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],yD=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],bD=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],wD=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],_D=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function xD(t){const e=[];for(let n=0;n<t.length;n+=4)e.push(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]);return e}class ED{get key(){return iD(this,eD,"f").slice()}constructor(t){if(eD.set(this,void 0),nD.set(this,void 0),rD.set(this,void 0),!(this instanceof ED))throw Error("AES must be instanitated with `new`");sD(this,eD,new Uint8Array(t),"f");const e=aD[this.key.length];if(null==e)throw new TypeError("invalid key size (must be 16, 24 or 32 bytes)");sD(this,rD,[],"f"),sD(this,nD,[],"f");for(let c=0;c<=e;c++)iD(this,rD,"f").push([0,0,0,0]),iD(this,nD,"f").push([0,0,0,0]);const n=4*(e+1),r=this.key.length/4,i=xD(this.key);let s;for(let c=0;c<r;c++)s=c>>2,iD(this,rD,"f")[s][c%4]=i[c],iD(this,nD,"f")[e-s][c%4]=i[c];let a,o=0,l=r;for(;l<n;){if(a=i[r-1],i[0]^=lD[a>>16&255]<<24^lD[a>>8&255]<<16^lD[255&a]<<8^lD[a>>24&255]^oD[o]<<24,o+=1,8!=r)for(let e=1;e<r;e++)i[e]^=i[e-1];else{for(let t=1;t<r/2;t++)i[t]^=i[t-1];a=i[r/2-1],i[r/2]^=lD[255&a]^lD[a>>8&255]<<8^lD[a>>16&255]<<16^lD[a>>24&255]<<24;for(let t=r/2+1;t<r;t++)i[t]^=i[t-1]}let t,s,c=0;for(;c<r&&l<n;)t=l>>2,s=l%4,iD(this,rD,"f")[t][s]=i[c],iD(this,nD,"f")[e-t][s]=i[c++],l++}for(let c=1;c<e;c++)for(let t=0;t<4;t++)a=iD(this,nD,"f")[c][t],iD(this,nD,"f")[c][t]=yD[a>>24&255]^bD[a>>16&255]^wD[a>>8&255]^_D[255&a]}encrypt(t){if(16!=t.length)throw new TypeError("invalid plaintext size (must be 16 bytes)");const e=iD(this,rD,"f").length-1,n=[0,0,0,0];let r=xD(t);for(let a=0;a<4;a++)r[a]^=iD(this,rD,"f")[0][a];for(let a=1;a<e;a++){for(let t=0;t<4;t++)n[t]=uD[r[t]>>24&255]^hD[r[(t+1)%4]>>16&255]^dD[r[(t+2)%4]>>8&255]^fD[255&r[(t+3)%4]]^iD(this,rD,"f")[a][t];r=n.slice()}const i=new Uint8Array(16);let s=0;for(let a=0;a<4;a++)s=iD(this,rD,"f")[e][a],i[4*a]=255&(lD[r[a]>>24&255]^s>>24),i[4*a+1]=255&(lD[r[(a+1)%4]>>16&255]^s>>16),i[4*a+2]=255&(lD[r[(a+2)%4]>>8&255]^s>>8),i[4*a+3]=255&(lD[255&r[(a+3)%4]]^s);return i}decrypt(t){if(16!=t.length)throw new TypeError("invalid ciphertext size (must be 16 bytes)");const e=iD(this,nD,"f").length-1,n=[0,0,0,0];let r=xD(t);for(let a=0;a<4;a++)r[a]^=iD(this,nD,"f")[0][a];for(let a=1;a<e;a++){for(let t=0;t<4;t++)n[t]=pD[r[t]>>24&255]^mD[r[(t+3)%4]>>16&255]^gD[r[(t+2)%4]>>8&255]^vD[255&r[(t+1)%4]]^iD(this,nD,"f")[a][t];r=n.slice()}const i=new Uint8Array(16);let s=0;for(let a=0;a<4;a++)s=iD(this,nD,"f")[e][a],i[4*a]=255&(cD[r[a]>>24&255]^s>>24),i[4*a+1]=255&(cD[r[(a+3)%4]>>16&255]^s>>16),i[4*a+2]=255&(cD[r[(a+2)%4]>>8&255]^s>>8),i[4*a+3]=255&(cD[255&r[(a+1)%4]]^s);return i}}eD=new WeakMap,nD=new WeakMap,rD=new WeakMap;class AD{constructor(t,e,n){if(n&&!(this instanceof n))throw new Error(`${t} must be instantiated with "new"`);Object.defineProperties(this,{aes:{enumerable:!0,value:new ED(e)},name:{enumerable:!0,value:t}})}}var SD,MD,TD=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},RD=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class CD extends AD{constructor(t,e){if(super("ECC",t,CD),SD.set(this,void 0),MD.set(this,void 0),e){if(e.length%16)throw new TypeError("invalid iv size (must be 16 bytes)");TD(this,SD,new Uint8Array(e),"f")}else TD(this,SD,new Uint8Array(16),"f");TD(this,MD,this.iv,"f")}get iv(){return new Uint8Array(RD(this,SD,"f"))}encrypt(t){if(t.length%16)throw new TypeError("invalid plaintext size (must be multiple of 16 bytes)");const e=new Uint8Array(t.length);for(let n=0;n<t.length;n+=16){for(let e=0;e<16;e++)RD(this,MD,"f")[e]^=t[n+e];TD(this,MD,this.aes.encrypt(RD(this,MD,"f")),"f"),e.set(RD(this,MD,"f"),n)}return e}decrypt(t){if(t.length%16)throw new TypeError("invalid ciphertext size (must be multiple of 16 bytes)");const e=new Uint8Array(t.length);for(let n=0;n<t.length;n+=16){const r=this.aes.decrypt(t.subarray(n,n+16));for(let i=0;i<16;i++)e[n+i]=r[i]^RD(this,MD,"f")[i],RD(this,MD,"f")[i]=t[n+i]}return e}}SD=new WeakMap,MD=new WeakMap;var PD,ND,OD,ID=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},DD=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class UD extends AD{constructor(t,e){super("CTR",t,UD),PD.set(this,void 0),ND.set(this,void 0),OD.set(this,void 0),ID(this,OD,new Uint8Array(16),"f"),DD(this,OD,"f").fill(0),ID(this,PD,DD(this,OD,"f"),"f"),ID(this,ND,16,"f"),null==e&&(e=1),"number"==typeof e?this.setCounterValue(e):this.setCounterBytes(e)}get counter(){return new Uint8Array(DD(this,OD,"f"))}setCounterValue(t){if(!Number.isInteger(t)||t<0||t>Number.MAX_SAFE_INTEGER)throw new TypeError("invalid counter initial integer value");for(let e=15;e>=0;--e)DD(this,OD,"f")[e]=t%256,t=Math.floor(t/256)}setCounterBytes(t){if(16!==t.length)throw new TypeError("invalid counter initial Uint8Array value length");DD(this,OD,"f").set(t)}increment(){for(let t=15;t>=0;t--){if(255!==DD(this,OD,"f")[t]){DD(this,OD,"f")[t]++;break}DD(this,OD,"f")[t]=0}}encrypt(t){var e,n;const r=new Uint8Array(t);for(let i=0;i<r.length;i++)16===DD(this,ND,"f")&&(ID(this,PD,this.aes.encrypt(DD(this,OD,"f")),"f"),ID(this,ND,0,"f"),this.increment()),r[i]^=DD(this,PD,"f")[(ID(this,ND,(n=DD(this,ND,"f"),e=n++,n),"f"),e)];return r}decrypt(t){return this.encrypt(t)}}function LD(t){return"string"!=typeof t||t.startsWith("0x")||(t="0x"+t),M_(t)}function FD(t,e){for(t=String(t);t.length<e;)t="0"+t;return t}function kD(t){return"string"==typeof t?dx(t,"NFKC"):M_(t)}function BD(t,e){const n=e.match(/^([a-z0-9$_.-]*)(:([a-z]+))?(!)?$/i);b_(null!=n,"invalid path","path",e);const r=n[1],i=n[3],s="!"===n[4];let a=t;for(const o of r.toLowerCase().split(".")){if(Array.isArray(a)){if(!o.match(/^[0-9]+$/))break;a=a[parseInt(o)]}else if("object"==typeof a){let t=null;for(const e in a)if(e.toLowerCase()===o){t=a[e];break}a=t}else a=null;if(null==a)break}if(b_(!s||null!=a,"missing required value","path",r),i&&null!=a){if("int"===i){if("string"==typeof a&&a.match(/^-?[0-9]+$/))return parseInt(a);if(Number.isSafeInteger(a))return a}if("number"===i&&"string"==typeof a&&a.match(/^-?[0-9.]*$/))return parseFloat(a);if("data"===i&&"string"==typeof a)return LD(a);if("array"===i&&Array.isArray(a))return a;if(i===typeof a)return a;b_(!1,`wrong type found for ${i} `,"path",r)}return a}PD=new WeakMap,ND=new WeakMap,OD=new WeakMap;const zD="m/44'/60'/0'/0/0";function HD(t){try{const e=JSON.parse(t);if(3===(null!=e.version?parseInt(e.version):0))return!0}catch(e){}return!1}function GD(t,e){const n=S_(e),r=BD(t,"crypto.ciphertext:data!");b_(P_(PA(N_([n.slice(16,32),r]))).substring(2)===BD(t,"crypto.mac:string!").toLowerCase(),"incorrect password","password","[ REDACTED ]");const i=function(t,e,n){if("aes-128-ctr"===BD(t,"crypto.cipher:string")){const r=BD(t,"crypto.cipherparams.iv:data!");return P_(new UD(e,r).decrypt(n))}y_(!1,"unsupported cipher","UNSUPPORTED_OPERATION",{operation:"decrypt"})}(t,n.slice(0,16),r),s=DT(i);if(t.address){let e=t.address.toLowerCase();e.startsWith("0x")||(e="0x"+e),b_(eT(e)===s,"keystore address/privateKey mismatch","address",t.address)}const a={address:s,privateKey:i};if("0.1"===BD(t,"x-ethers.version:string")){const e=n.slice(32,64),r=BD(t,"x-ethers.mnemonicCiphertext:data!"),i=BD(t,"x-ethers.mnemonicCounter:data!"),s=new UD(e,i);a.mnemonic={path:BD(t,"x-ethers.path:string")||zD,locale:BD(t,"x-ethers.locale:string")||"en",entropy:P_(S_(s.decrypt(r)))}}return a}function VD(t){const e=BD(t,"crypto.kdf:string");if(e&&"string"==typeof e){if("scrypt"===e.toLowerCase()){const n=BD(t,"crypto.kdfparams.salt:data!"),r=BD(t,"crypto.kdfparams.n:int!"),i=BD(t,"crypto.kdfparams.r:int!"),s=BD(t,"crypto.kdfparams.p:int!");b_(r>0&&!(r&r-1),"invalid kdf.N","kdf.N",r),b_(i>0&&s>0,"invalid kdf","kdf",e);const a=BD(t,"crypto.kdfparams.dklen:int!");return b_(32===a,"invalid kdf.dklen","kdf.dflen",a),{name:"scrypt",salt:n,N:r,r:i,p:s,dkLen:64}}if("pbkdf2"===e.toLowerCase()){const e=BD(t,"crypto.kdfparams.salt:data!"),n=BD(t,"crypto.kdfparams.prf:string!"),r=n.split("-").pop();b_("sha256"===r||"sha512"===r,"invalid kdf.pdf","kdf.pdf",n);const i=BD(t,"crypto.kdfparams.c:int!"),s=BD(t,"crypto.kdfparams.dklen:int!");return b_(32===s,"invalid kdf.dklen","kdf.dklen",s),{name:"pbkdf2",salt:e,count:i,dkLen:s,algorithm:r}}}b_(!1,"unsupported key-derivation function","kdf",e)}function jD(t,e){const n=JSON.parse(t),r=kD(e),i=VD(n);if("pbkdf2"===i.name){const{salt:t,count:e,dkLen:s,algorithm:a}=i;return GD(n,ZA(r,t,e,s,a))}y_("scrypt"===i.name,"cannot be reached","UNKNOWN_ERROR",{params:i});const{salt:s,N:a,r:o,p:l,dkLen:c}=i;return GD(n,mS(r,s,a,o,l,c))}function WD(t){return new Promise(e=>{setTimeout(()=>{e()},t)})}async function qD(t,e,n){const r=JSON.parse(t),i=kD(e),s=VD(r);if("pbkdf2"===s.name){n&&(n(0),await WD(0));const{salt:t,count:e,dkLen:a,algorithm:o}=s,l=ZA(i,t,e,a,o);return n&&(n(1),await WD(0)),GD(r,l)}y_("scrypt"===s.name,"cannot be reached","UNKNOWN_ERROR",{params:s});const{salt:a,N:o,r:l,p:c,dkLen:u}=s;return GD(r,await pS(i,a,o,l,c,u,n))}function XD(t){const e=null!=t.salt?S_(t.salt,"options.salt"):nS(32);let n=1<<17,r=8,i=1;return t.scrypt&&(t.scrypt.N&&(n=t.scrypt.N),t.scrypt.r&&(r=t.scrypt.r),t.scrypt.p&&(i=t.scrypt.p)),b_("number"==typeof n&&n>0&&Number.isSafeInteger(n)&&(BigInt(n)&BigInt(n-1))===BigInt(0),"invalid scrypt N parameter","options.N",n),b_("number"==typeof r&&r>0&&Number.isSafeInteger(r),"invalid scrypt r parameter","options.r",r),b_("number"==typeof i&&i>0&&Number.isSafeInteger(i),"invalid scrypt p parameter","options.p",i),{name:"scrypt",dkLen:32,salt:e,N:n,r:r,p:i}}function KD(t,e,n,r){const i=S_(n.privateKey,"privateKey"),s=null!=r.iv?S_(r.iv,"options.iv"):nS(16);b_(16===s.length,"invalid options.iv length","options.iv",r.iv);const a=null!=r.uuid?S_(r.uuid,"options.uuid"):nS(16);b_(16===a.length,"invalid options.uuid length","options.uuid",r.iv);const o=t.slice(0,16),l=t.slice(16,32),c=S_(new UD(o,s).encrypt(i)),u=PA(N_([l,c])),h={address:n.address.substring(2).toLowerCase(),id:$x(a),version:3,Crypto:{cipher:"aes-128-ctr",cipherparams:{iv:P_(s).substring(2)},ciphertext:P_(c).substring(2),kdf:"scrypt",kdfparams:{salt:P_(e.salt).substring(2),n:e.N,dklen:32,p:e.p,r:e.r},mac:u.substring(2)}};if(n.mnemonic){const e=null!=r.client?r.client:`ethers/${u_}`,i=n.mnemonic.path||zD,s=n.mnemonic.locale||"en",a=t.slice(32,64),o=S_(n.mnemonic.entropy,"account.mnemonic.entropy"),l=nS(16),c=S_(new UD(a,l).encrypt(o)),u=new Date,d="UTC--"+(u.getUTCFullYear()+"-"+FD(u.getUTCMonth()+1,2)+"-"+FD(u.getUTCDate(),2)+"T"+FD(u.getUTCHours(),2)+"-"+FD(u.getUTCMinutes(),2)+"-"+FD(u.getUTCSeconds(),2)+".0Z")+"--"+h.address;h["x-ethers"]={client:e,gethFilename:d,path:i,locale:s,mnemonicCounter:P_(l).substring(2),mnemonicCiphertext:P_(c).substring(2),version:"0.1"}}return JSON.stringify(h)}function YD(t,e,n){null==n&&(n={});const r=kD(e),i=XD(n);return KD(S_(mS(r,i.salt,i.N,i.r,i.p,64)),i,t,n)}async function JD(t,e,n){null==n&&(n={});const r=kD(e),i=XD(n);return KD(S_(await pS(r,i.salt,i.N,i.r,i.p,64,n.progressCallback)),i,t,n)}const QD="m/44'/60'/0'/0/0",ZD=new Uint8Array([66,105,116,99,111,105,110,32,115,101,101,100]),$D=2147483648,tU=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141");function eU(t,e){let n="";for(;t;)n="0123456789abcdef"[t%16]+n,t=Math.trunc(t/16);for(;n.length<2*e;)n="0"+n;return"0x"+n}function nU(t){const e=S_(t);return ix(N_([e,I_(xS(xS(e)),0,4)]))}const rU={};function iU(t,e,n,r){const i=new Uint8Array(37);t&$D?(y_(null!=r,"cannot derive child of neutered node","UNSUPPORTED_OPERATION",{operation:"deriveChild"}),i.set(S_(r),1)):i.set(S_(n));for(let a=24;a>=0;a-=8)i[33+(a>>3)]=t>>24-a&255;const s=S_(hA("sha512",e,i));return{IL:s.slice(0,32),IR:s.slice(32)}}function sU(t,e){const n=e.split("/");b_(n.length>0,"invalid path","path",e),"m"===n[0]&&(b_(0===t.depth,`cannot derive root path (i.e. path starting with "m/") for a node at non-zero depth ${t.depth}`,"path",e),n.shift());let r=t;for(let i=0;i<n.length;i++){const t=n[i];if(t.match(/^[0-9]+'$/)){const e=parseInt(t.substring(0,t.length-1));b_(e<$D,"invalid path index",`path[${i}]`,t),r=r.deriveChild($D+e)}else if(t.match(/^[0-9]+$/)){const e=parseInt(t);b_(e<$D,"invalid path index",`path[${i}]`,t),r=r.deriveChild(e)}else b_(!1,"invalid path component",`path[${i}]`,t)}return r}class aU extends zI{publicKey;fingerprint;parentFingerprint;mnemonic;chainCode;path;index;depth;constructor(t,e,n,r,i,s,a,o,l){super(e,l),E_(t,rU,"HDNodeWallet"),f_(this,{publicKey:e.compressedPublicKey});f_(this,{parentFingerprint:n,fingerprint:I_(KA(xS(this.publicKey)),0,4),chainCode:r,path:i,index:s,depth:a}),f_(this,{mnemonic:o})}connect(t){return new aU(rU,this.signingKey,this.parentFingerprint,this.chainCode,this.path,this.index,this.depth,this.mnemonic,t)}#Ke(){const t={address:this.address,privateKey:this.privateKey},e=this.mnemonic;return this.path&&e&&"en"===e.wordlist.locale&&""===e.password&&(t.mnemonic={path:this.path,locale:"en",entropy:e.entropy}),t}async encrypt(t,e){return await JD(this.#Ke(),t,{progressCallback:e})}encryptSync(t){return YD(this.#Ke(),t)}get extendedKey(){return y_(this.depth<256,"Depth too deep","UNSUPPORTED_OPERATION",{operation:"extendedKey"}),nU(N_(["0x0488ADE4",eU(this.depth,1),this.parentFingerprint,eU(this.index,4),this.chainCode,N_(["0x00",this.privateKey])]))}hasPath(){return null!=this.path}neuter(){return new oU(rU,this.address,this.publicKey,this.parentFingerprint,this.chainCode,this.path,this.index,this.depth,this.provider)}deriveChild(t){const e=K_(t,"index");b_(e<=4294967295,"invalid index","index",e);let n=this.path;n&&(n+="/"+(2147483647&e),e&$D&&(n+="'"));const{IR:r,IL:i}=iU(e,this.chainCode,this.publicKey,this.privateKey),s=new XM(J_((X_(i)+BigInt(this.privateKey))%tU,32));return new aU(rU,s,this.fingerprint,P_(r),n,e,this.depth+1,this.mnemonic,this.provider)}derivePath(t){return sU(this,t)}static#Ye(t,e){b_(R_(t),"invalid seed","seed","[REDACTED]");const n=S_(t,"seed");b_(n.length>=16&&n.length<=64,"invalid seed","seed","[REDACTED]");const r=S_(hA("sha512",ZD,n)),i=new XM(P_(r.slice(0,32)));return new aU(rU,i,"0x00000000",P_(r.slice(32)),"m",0,0,e,null)}static fromExtendedKey(t){const e=Q_(sx(t));b_(82===e.length||nU(e.slice(0,78))===t,"invalid extended key","extendedKey","[ REDACTED ]");const n=e[4],r=P_(e.slice(5,9)),i=parseInt(P_(e.slice(9,13)).substring(2),16),s=P_(e.slice(13,45)),a=e.slice(45,78);switch(P_(e.slice(0,4))){case"0x0488b21e":case"0x043587cf":{const t=P_(a);return new oU(rU,DT(t),t,r,s,null,i,n,null)}case"0x0488ade4":case"0x04358394 ":if(0!==a[0])break;return new aU(rU,new XM(a.slice(1)),r,s,null,i,n,null,null)}b_(!1,"invalid extended key prefix","extendedKey","[ REDACTED ]")}static createRandom(t,e,n){null==t&&(t=""),null==e&&(e=QD),null==n&&(n=KI.wordlist());const r=tD.fromEntropy(nS(16),t,n);return aU.#Ye(r.computeSeed(),r).derivePath(e)}static fromMnemonic(t,e){return e||(e=QD),aU.#Ye(t.computeSeed(),t).derivePath(e)}static fromPhrase(t,e,n,r){null==e&&(e=""),null==n&&(n=QD),null==r&&(r=KI.wordlist());const i=tD.fromPhrase(t,e,r);return aU.#Ye(i.computeSeed(),i).derivePath(n)}static fromSeed(t){return aU.#Ye(t,null)}}class oU extends NO{publicKey;fingerprint;parentFingerprint;chainCode;path;index;depth;constructor(t,e,n,r,i,s,a,o,l){super(e,l),E_(t,rU,"HDNodeVoidWallet"),f_(this,{publicKey:n});f_(this,{publicKey:n,fingerprint:I_(KA(xS(n)),0,4),parentFingerprint:r,chainCode:i,path:s,index:a,depth:o})}connect(t){return new oU(rU,this.address,this.publicKey,this.parentFingerprint,this.chainCode,this.path,this.index,this.depth,t)}get extendedKey(){return y_(this.depth<256,"Depth too deep","UNSUPPORTED_OPERATION",{operation:"extendedKey"}),nU(N_(["0x0488B21E",eU(this.depth,1),this.parentFingerprint,eU(this.index,4),this.chainCode,this.publicKey]))}hasPath(){return null!=this.path}deriveChild(t){const e=K_(t,"index");b_(e<=4294967295,"invalid index","index",e);let n=this.path;n&&(n+="/"+(2147483647&e),e&$D&&(n+="'"));const{IR:r,IL:i}=iU(e,this.chainCode,this.publicKey,null),s=XM.addPoints(i,this.publicKey,!0),a=DT(s);return new oU(rU,a,s,this.fingerprint,P_(r),n,e,this.depth+1,this.provider)}derivePath(t){return sU(this,t)}}function lU(t){const e=K_(t,"index");return b_(e>=0&&e<$D,"invalid account index","index",e),`m/44'/60'/${e}'/0/0`}function cU(t){const e=K_(t,"index");return b_(e>=0&&e<$D,"invalid account index","index",e),`m/44'/60'/0'/0/${e}`}function uU(t){try{if(JSON.parse(t).encseed)return!0}catch(e){}return!1}function hU(t,e){const n=JSON.parse(t),r=kD(e),i=eT(BD(n,"ethaddr:string!")),s=LD(BD(n,"encseed:string!"));b_(s&&s.length%16==0,"invalid encseed","json",t);const a=S_(ZA(r,r,2e3,32,"sha256")).slice(0,16),o=s.slice(0,16),l=s.slice(16),c=function(t){if(t.length<16)throw new TypeError("PKCS#7 invalid length");const e=t[t.length-1];if(e>16)throw new TypeError("PKCS#7 padding byte out of range");const n=t.length-e;for(let r=0;r<e;r++)if(t[n+r]!==e)throw new TypeError("PKCS#7 invalid padding byte");return new Uint8Array(t.subarray(0,n))}(S_(new CD(a,o).decrypt(l)));let u="";for(let h=0;h<c.length;h++)u+=String.fromCharCode(c[h]);return{address:i,privateKey:iR(u)}}function dU(t){return new Promise(e=>{setTimeout(()=>{e()},t)})}class fU extends zI{constructor(t,e){"string"!=typeof t||t.startsWith("0x")||(t="0x"+t),super("string"==typeof t?new XM(t):t,e)}connect(t){return new fU(this.signingKey,t)}async encrypt(t,e){const n={address:this.address,privateKey:this.privateKey};return await JD(n,t,{progressCallback:e})}encryptSync(t){return YD({address:this.address,privateKey:this.privateKey},t)}static#Je(t){if(b_(t,"invalid JSON wallet","json","[ REDACTED ]"),"mnemonic"in t&&t.mnemonic&&"en"===t.mnemonic.locale){const e=tD.fromEntropy(t.mnemonic.entropy),n=aU.fromMnemonic(e,t.mnemonic.path);if(n.address===t.address&&n.privateKey===t.privateKey)return n;console.log("WARNING: JSON mismatch address/privateKey != mnemonic; fallback onto private key")}const e=new fU(t.privateKey);return b_(e.address===t.address,"address/privateKey mismatch","json","[ REDACTED ]"),e}static async fromEncryptedJson(t,e,n){let r=null;return HD(t)?r=await qD(t,e,n):uU(t)&&(n&&(n(0),await dU(0)),r=hU(t,e),n&&(n(1),await dU(0))),fU.#Je(r)}static fromEncryptedJsonSync(t,e){let n=null;return HD(t)?n=jD(t,e):uU(t)?n=hU(t,e):b_(!1,"invalid JSON wallet","json","[ REDACTED ]"),fU.#Je(n)}static createRandom(t){const e=aU.createRandom();return t?e.connect(t):e}static fromPhrase(t,e){const n=aU.fromPhrase(t);return e?n.connect(e):n}}class pU extends qI{#Qe;constructor(t,e,n,r){super(t,e,r),this.#Qe=n}get _accent(){return this.#Qe}_decodeWords(){return function(t,e){let n=jI(t).join(",");return e.split(/,/g).forEach(t=>{const r=t.match(/^([a-z]*)([0-9]+)([0-9])(.*)$/);b_(null!==r,"internal error parsing accents","accents",e);let i=0;const s=function(t,e){const n=(1<<t)-1,r=[];let i=0,s=0,a=0;for(let o=0;o<e.length;o++)for(i=i<<6|")!@#$%^&*(ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".indexOf(e[o]),s+=6;s>=t;){const e=i>>s-t;i&=(1<<s-t)-1,s-=t,0===e?a+=n:(r.push(e+a),a=0)}return r}(parseInt(r[3]),r[4]),a=parseInt(r[2]),o=new RegExp(`([${r[1]}])`,"g");n=n.replace(o,(t,e)=>(0===--s[i]&&(e=String.fromCharCode(e.charCodeAt(0),a),i++),e))}),n.split(",")}(this._data,this._accent)}}const mU={en:KI.wordlist()},gU=Object.freeze(Object.defineProperty({__proto__:null,AbiCoder:LP,AbstractProvider:wO,AbstractSigner:PO,AlchemyProvider:ZO,AnkrProvider:JO,BaseContract:PN,BaseWallet:zI,Block:QP,BlockscoutProvider:LI,BrowserProvider:UI,ChainstackProvider:tI,CloudflareProvider:eI,ConstructorFragment:TP,Contract:NN,ContractEventPayload:lN,ContractFactory:ON,ContractTransactionReceipt:sN,ContractTransactionResponse:aN,ContractUnknownEventPayload:oN,EnsPlugin:QN,EnsResolver:FN,ErrorDescription:HP,ErrorFragment:SP,EtherSymbol:"",EtherscanPlugin:iI,EtherscanProvider:oI,EventFragment:MP,EventLog:rN,EventPayload:lx,FallbackFragment:RP,FallbackProvider:NI,FeeData:YP,FeeDataNetworkPlugin:ZN,FetchCancelSignal:Ax,FetchRequest:Mx,FetchResponse:Tx,FetchUrlFeeDataNetworkPlugin:$N,FixedNumber:kx,Fragment:xP,FunctionFragment:CP,GasCostPlugin:JN,HDNodeVoidWallet:oU,HDNodeWallet:aU,Indexed:GP,InfuraProvider:vI,InfuraWebSocketProvider:gI,Interface:WP,IpcSocketProvider:BI,JsonRpcApiProvider:jO,JsonRpcProvider:qO,JsonRpcSigner:VO,LangEn:KI,Log:ZP,LogDescription:BP,MaxInt256:IM,MaxUint256:NM,MessagePrefix:DM,MinInt256:OM,Mnemonic:tD,MulticoinProviderPlugin:DN,N:CM,NamedFragment:EP,Network:eO,NetworkPlugin:YN,NonceManager:DI,ParamType:_P,PocketProvider:kI,QuickNodeProvider:bI,Result:cE,Signature:qM,SigningKey:XM,SocketBlockSubscriber:uI,SocketEventSubscriber:dI,SocketPendingSubscriber:hI,SocketProvider:fI,SocketSubscriber:cI,StructFragment:PP,Transaction:eR,TransactionDescription:zP,TransactionReceipt:$P,TransactionResponse:tN,Typed:fT,TypedDataEncoder:kC,UndecodedEventLog:iN,UnmanagedSubscriber:mO,Utf8ErrorFuncs:ux,VoidSigner:NO,Wallet:fU,WebSocketProvider:pI,WeiPerEther:PM,Wordlist:WI,WordlistOwl:qI,WordlistOwlA:pU,ZeroAddress:TM,ZeroHash:RM,accessListify:OT,assert:y_,assertArgument:b_,assertArgumentCount:w_,assertNormalize:x_,assertPrivate:E_,authorizationify:IT,checkResultErrors:uE,computeAddress:DT,computeHmac:hA,concat:N_,copyRequest:JP,dataLength:O_,dataSlice:I_,decodeBase58:sx,decodeBase64:ax,decodeBytes32String:kP,decodeRlp:Vx,decryptCrowdsaleJson:hU,decryptKeystoreJson:qD,decryptKeystoreJsonSync:jD,defaultPath:QD,defineProperties:f_,dnsEncode:pC,encodeBase58:ix,encodeBase64:ox,encodeBytes32String:FP,encodeRlp:Xx,encryptKeystoreJson:JD,encryptKeystoreJsonSync:YD,ensNormalize:hC,formatEther:Qx,formatUnits:Yx,fromTwos:H_,getAccountPath:lU,getAddress:eT,getBigInt:j_,getBytes:S_,getBytesCopy:M_,getCreate2Address:iT,getCreateAddress:rT,getDefaultProvider:II,getIcapAddress:nT,getIndexedAccountPath:cU,getNumber:K_,getUint:W_,hashAuthorization:nR,hashMessage:mC,hexlify:P_,id:iR,isAddress:aT,isAddressable:sT,isBytesLike:R_,isCallException:g_,isCrowdsaleJson:uU,isError:m_,isHexString:T_,isKeystoreJson:HD,isValidName:dC,keccak256:PA,lock:KM,makeError:v_,mask:V_,namehash:fC,parseEther:Zx,parseUnits:Jx,pbkdf2:ZA,randomBytes:nS,recoverAddress:UT,resolveAddress:lT,resolveProperties:d_,ripemd160:KA,scrypt:pS,scryptSync:mS,sha256:xS,sha512:ES,showThrottleMessage:IO,solidityPacked:_C,solidityPackedKeccak256:xC,solidityPackedSha256:EC,stripZerosLeft:D_,toBeArray:Q_,toBeHex:J_,toBigInt:X_,toNumber:Y_,toQuantity:Z_,toTwos:G_,toUtf8Bytes:dx,toUtf8CodePoints:px,toUtf8String:fx,uuidV4:$x,verifyAuthorization:rR,verifyMessage:gC,verifyTypedData:BC,version:u_,wordlists:mU,zeroPadBytes:F_,zeroPadValue:L_},Symbol.toStringTag,{value:"Module"})),vU=Object.freeze(Object.defineProperty({__proto__:null,AbiCoder:LP,AbstractProvider:wO,AbstractSigner:PO,AlchemyProvider:ZO,AnkrProvider:JO,BaseContract:PN,BaseWallet:zI,Block:QP,BlockscoutProvider:LI,BrowserProvider:UI,ChainstackProvider:tI,CloudflareProvider:eI,ConstructorFragment:TP,Contract:NN,ContractEventPayload:lN,ContractFactory:ON,ContractTransactionReceipt:sN,ContractTransactionResponse:aN,ContractUnknownEventPayload:oN,EnsPlugin:QN,EnsResolver:FN,ErrorDescription:HP,ErrorFragment:SP,EtherSymbol:"",EtherscanPlugin:iI,EtherscanProvider:oI,EventFragment:MP,EventLog:rN,EventPayload:lx,FallbackFragment:RP,FallbackProvider:NI,FeeData:YP,FeeDataNetworkPlugin:ZN,FetchCancelSignal:Ax,FetchRequest:Mx,FetchResponse:Tx,FetchUrlFeeDataNetworkPlugin:$N,FixedNumber:kx,Fragment:xP,FunctionFragment:CP,GasCostPlugin:JN,HDNodeVoidWallet:oU,HDNodeWallet:aU,Indexed:GP,InfuraProvider:vI,InfuraWebSocketProvider:gI,Interface:WP,IpcSocketProvider:BI,JsonRpcApiProvider:jO,JsonRpcProvider:qO,JsonRpcSigner:VO,LangEn:KI,Log:ZP,LogDescription:BP,MaxInt256:IM,MaxUint256:NM,MessagePrefix:DM,MinInt256:OM,Mnemonic:tD,MulticoinProviderPlugin:DN,N:CM,NamedFragment:EP,Network:eO,NetworkPlugin:YN,NonceManager:DI,ParamType:_P,PocketProvider:kI,QuickNodeProvider:bI,Result:cE,Signature:qM,SigningKey:XM,SocketBlockSubscriber:uI,SocketEventSubscriber:dI,SocketPendingSubscriber:hI,SocketProvider:fI,SocketSubscriber:cI,StructFragment:PP,Transaction:eR,TransactionDescription:zP,TransactionReceipt:$P,TransactionResponse:tN,Typed:fT,TypedDataEncoder:kC,UndecodedEventLog:iN,UnmanagedSubscriber:mO,Utf8ErrorFuncs:ux,VoidSigner:NO,Wallet:fU,WebSocketProvider:pI,WeiPerEther:PM,Wordlist:WI,WordlistOwl:qI,WordlistOwlA:pU,ZeroAddress:TM,ZeroHash:RM,accessListify:OT,assert:y_,assertArgument:b_,assertArgumentCount:w_,assertNormalize:x_,assertPrivate:E_,authorizationify:IT,checkResultErrors:uE,computeAddress:DT,computeHmac:hA,concat:N_,copyRequest:JP,dataLength:O_,dataSlice:I_,decodeBase58:sx,decodeBase64:ax,decodeBytes32String:kP,decodeRlp:Vx,decryptCrowdsaleJson:hU,decryptKeystoreJson:qD,decryptKeystoreJsonSync:jD,defaultPath:QD,defineProperties:f_,dnsEncode:pC,encodeBase58:ix,encodeBase64:ox,encodeBytes32String:FP,encodeRlp:Xx,encryptKeystoreJson:JD,encryptKeystoreJsonSync:YD,ensNormalize:hC,ethers:gU,formatEther:Qx,formatUnits:Yx,fromTwos:H_,getAccountPath:lU,getAddress:eT,getBigInt:j_,getBytes:S_,getBytesCopy:M_,getCreate2Address:iT,getCreateAddress:rT,getDefaultProvider:II,getIcapAddress:nT,getIndexedAccountPath:cU,getNumber:K_,getUint:W_,hashAuthorization:nR,hashMessage:mC,hexlify:P_,id:iR,isAddress:aT,isAddressable:sT,isBytesLike:R_,isCallException:g_,isCrowdsaleJson:uU,isError:m_,isHexString:T_,isKeystoreJson:HD,isValidName:dC,keccak256:PA,lock:KM,makeError:v_,mask:V_,namehash:fC,parseEther:Zx,parseUnits:Jx,pbkdf2:ZA,randomBytes:nS,recoverAddress:UT,resolveAddress:lT,resolveProperties:d_,ripemd160:KA,scrypt:pS,scryptSync:mS,sha256:xS,sha512:ES,showThrottleMessage:IO,solidityPacked:_C,solidityPackedKeccak256:xC,solidityPackedSha256:EC,stripZerosLeft:D_,toBeArray:Q_,toBeHex:J_,toBigInt:X_,toNumber:Y_,toQuantity:Z_,toTwos:G_,toUtf8Bytes:dx,toUtf8CodePoints:px,toUtf8String:fx,uuidV4:$x,verifyAuthorization:rR,verifyMessage:gC,verifyTypedData:BC,version:u_,wordlists:mU,zeroPadBytes:F_,zeroPadValue:L_},Symbol.toStringTag,{value:"Module"}));export{fl as $,wl as A,lf as B,Ds as C,ks as D,Dr as E,zf as F,Hs as G,vn as H,fa as I,$n as J,Ee as K,ee as L,va as M,lr as N,hr as O,Of as P,er as Q,cl as R,Hf as S,is as T,hl as U,ul as V,ov as W,dl as X,Ha as Y,ol as Z,ll as _,Jd as a,c_ as a0,vU as a1,Qf as b,np as c,db as d,ar as e,ir as f,le as g,cr as h,or as i,cs as j,rr as k,fs as l,yn as m,xe as n,mr as o,yr as p,Xn as q,vs as r,br as s,wr as t,xr as u,fe as v,_s as w,Ms as x,Bi as y,Ps as z};
