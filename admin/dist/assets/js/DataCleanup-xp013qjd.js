import{r as a,_ as e,x as l,A as s,o as t,B as r,C as d,ay as i,aI as n,D as o,u as c,O as u,J as p,m as _,M as f,K as m,ap as g}from"./vue-vendor-CCmsYA1Y.js";import{b as w,y as h,m as b,g as v,T as y,I as k,S as z,N as x}from"./element-plus-BZcENYie.js";import{r as C}from"./index-CCj7ctyJ.js";import{bC as D}from"./vendor-BQF3adi-.js";import{_ as S}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-BArJCJm5.js";const L={class:"data-cleanup"},V={class:"stat-card"},U={class:"stat-icon warning"},A={class:"stat-info"},I={class:"stat-value"},$={class:"stat-card"},j={class:"stat-icon danger"},T={class:"stat-info"},F={class:"stat-value"},M={class:"stat-card"},H={class:"stat-icon primary"},K={class:"stat-info"},B={class:"stat-value"},J={class:"card-header"},N={class:"header-actions"},O={class:"wallet-addr"},P={class:"text-success"},W={class:"text-primary"},q={class:"wallet-addr"},E={class:"tx-hash"},G={class:"card-header"},Q={class:"header-actions"},R={class:"wallet-addr"},X={class:"wallet-addr"},Y={class:"pagination-wrap"},Z={class:"card-header"},aa={class:"wallet-addr"},ea={class:"wallet-addr"},la={class:"wallet-addr"},sa=S({__name:"DataCleanup",setup(S){const sa=a("fakeDeposits"),ta=a("balance"),ra=e({detect:!1,referrals:!1,logs:!1}),da=e({fakeAccounts:[],suspiciousDeposits:[],summary:null}),ia=a([]),na=a([]),oa=a([]),ca=e({wallet_address:""}),ua=e({page:1,pageSize:20,total:0}),pa=e({balanceLogs:[],referralLogs:[]}),_a=a=>a?`${a.slice(0,6)}...${a.slice(-4)}`:"-",fa=a=>null==a?"0":parseFloat(a).toLocaleString("en-US",{maximumFractionDigits:2}),ma=a=>a?D(a).format("MM-DD HH:mm"):"-",ga=async a=>{try{await navigator.clipboard.writeText(a),w.success("å·²å¤åˆ¶")}catch{w.error("å¤åˆ¶å¤±è´¥")}},wa=async()=>{ra.detect=!0;try{const a=await C.get("/data-cleanup/fake-deposits");a.success&&(da.fakeAccounts=a.data.fakeAccounts,da.suspiciousDeposits=a.data.suspiciousDeposits,da.summary=a.data.summary)}catch(a){w.error("æ£€æµ‹å¤±è´¥")}finally{ra.detect=!1}},ha=async()=>{if(0!==ia.value.length)try{await x.confirm(`ç¡®å®šæ‰¹é‡æ¸…ç† ${ia.value.length} ä¸ªè´¦æˆ·ï¼Ÿ`,"ç¡®è®¤æ‰¹é‡æ¸…ç†",{type:"warning"});const a=await C.post("/data-cleanup/batch-clear",{wallet_addresses:ia.value.map(a=>a.wallet_address)});a.success?(w.success(a.message),ia.value=[],wa()):w.error(a.message||"æ‰¹é‡æ¸…ç†å¤±è´¥")}catch(a){"cancel"!==a&&w.error("æ‰¹é‡æ¸…ç†å¤±è´¥")}},ba=async()=>{ra.referrals=!0;try{const a={page:ua.page,pageSize:ua.pageSize,...ca},e=await C.get("/data-cleanup/referrals",{params:a});e.success&&(na.value=e.data.referrals,ua.total=e.data.total)}catch(a){}finally{ra.referrals=!1}},va=async()=>{if(0!==oa.value.length)try{await x.confirm(`ç¡®å®šæ‰¹é‡ç§»é™¤ ${oa.value.length} æ¡æŽ¨èå…³ç³»å—ï¼Ÿ`,"ç¡®è®¤æ‰¹é‡ç§»é™¤",{type:"warning"});const a=await C.post("/data-cleanup/batch-remove-referrals",{ids:oa.value.map(a=>a.id)});a.success?(w.success(a.message),oa.value=[],ba()):w.error(a.message||"æ‰¹é‡ç§»é™¤å¤±è´¥")}catch(a){"cancel"!==a&&w.error("æ‰¹é‡ç§»é™¤å¤±è´¥")}},ya=async()=>{ra.logs=!0;try{const a=await C.get("/data-cleanup/logs");a.success&&(pa.balanceLogs=a.data.balanceLogs,pa.referralLogs=a.data.referralLogs)}catch(a){}finally{ra.logs=!1}},ka=a=>{ia.value=a},za=a=>{oa.value=a};return l(()=>{wa(),ba(),ya()}),(a,e)=>{const l=i("el-icon"),D=i("el-col"),S=i("el-row"),xa=i("el-button"),Ca=i("el-table-column"),Da=i("el-tag"),Sa=i("el-table"),La=i("el-card"),Va=i("el-tooltip"),Ua=i("el-tab-pane"),Aa=i("el-input"),Ia=i("el-pagination"),$a=i("el-tabs"),ja=n("loading");return t(),s("div",L,[r($a,{modelValue:sa.value,"onUpdate:modelValue":e[4]||(e[4]=a=>sa.value=a),class:"main-tabs"},{default:d(()=>[r(Ua,{label:"è™šå‡å……å€¼æ£€æµ‹",name:"fakeDeposits"},{default:d(()=>[r(S,{gutter:16,class:"stat-row"},{default:d(()=>[r(D,{xs:24,sm:8},{default:d(()=>{var a;return[o("div",V,[o("div",U,[r(l,null,{default:d(()=>[r(c(h))]),_:1})]),o("div",A,[o("div",I,u((null==(a=da.summary)?void 0:a.fakeAccountCount)||0),1),e[5]||(e[5]=o("div",{class:"stat-label"},"å¯ç–‘è´¦æˆ·",-1))])])]}),_:1}),r(D,{xs:24,sm:8},{default:d(()=>{var a;return[o("div",$,[o("div",j,[r(l,null,{default:d(()=>[r(c(b))]),_:1})]),o("div",T,[o("div",F,u((null==(a=da.summary)?void 0:a.suspiciousDepositCount)||0),1),e[6]||(e[6]=o("div",{class:"stat-label"},"å¯ç–‘å……å€¼è®°å½•",-1))])])]}),_:1}),r(D,{xs:24,sm:8},{default:d(()=>{var a;return[o("div",M,[o("div",H,[r(l,null,{default:d(()=>[r(c(v))]),_:1})]),o("div",K,[o("div",B,u(fa((null==(a=da.summary)?void 0:a.totalFakeAmount)||0)),1),e[7]||(e[7]=o("div",{class:"stat-label"},"è™šå‡é‡‘é¢(USDT)",-1))])])]}),_:1})]),_:1}),r(La,{shadow:"hover",class:"table-card"},{header:d(()=>[o("div",J,[e[9]||(e[9]=o("span",null,"âš ï¸ è™šå‡ä½™é¢è´¦æˆ·",-1)),o("div",N,[ia.value.length>0?(t(),_(xa,{key:0,type:"danger",size:"small",onClick:ha},{default:d(()=>[f(" æ‰¹é‡æ¸…ç† ("+u(ia.value.length)+") ",1)]),_:1})):m("",!0),r(xa,{type:"primary",size:"small",onClick:wa,loading:ra.detect},{default:d(()=>[r(l,null,{default:d(()=>[r(c(k))]),_:1}),e[8]||(e[8]=f(" æ£€æµ‹ ",-1))]),_:1},8,["loading"])])])]),default:d(()=>[p((t(),_(Sa,{data:da.fakeAccounts,stripe:"",size:"small",onSelectionChange:ka,"max-height":300},{default:d(()=>[r(Ca,{type:"selection",width:"40"}),r(Ca,{prop:"wallet_address",label:"é’±åŒ…åœ°å€","min-width":"160"},{default:d(({row:a})=>[o("span",O,u(_a(a.wallet_address)),1),r(xa,{link:"",type:"primary",size:"small",onClick:e=>ga(a.wallet_address)},{default:d(()=>[r(l,{size:"12"},{default:d(()=>[r(c(y))]),_:1})]),_:1},8,["onClick"])]),_:1}),r(Ca,{prop:"usdt_balance",label:"å½“å‰ä½™é¢",width:"120",align:"right"},{default:d(({row:a})=>[o("span",P,u(fa(a.usdt_balance)),1)]),_:1}),r(Ca,{prop:"actual_deposit",label:"çœŸå®žå……å€¼",width:"120",align:"right"},{default:d(({row:a})=>[o("span",W,u(fa(a.actual_deposit)),1)]),_:1}),r(Ca,{prop:"fake_amount",label:"è™šå‡é‡‘é¢",width:"120",align:"right"},{default:d(({row:a})=>[r(Da,{type:"danger",size:"small"},{default:d(()=>[f(u(fa(a.fake_amount)),1)]),_:2},1024)]),_:1}),r(Ca,{label:"æ“ä½œ",width:"80",align:"center",fixed:"right"},{default:d(({row:a})=>[r(xa,{type:"danger",size:"small",link:"",onClick:e=>(async a=>{try{await x.confirm(`ç¡®å®šæ¸…ç† ${_a(a.wallet_address)} çš„è™šå‡ä½™é¢å—ï¼Ÿ`,"ç¡®è®¤æ¸…ç†",{type:"warning"});const e=await C.post("/data-cleanup/clear-fake-balance",{wallet_address:a.wallet_address,keep_real_deposit:!0});e.success?(w.success(e.message),wa()):w.error(e.message||"æ¸…ç†å¤±è´¥")}catch(e){"cancel"!==e&&w.error("æ¸…ç†å¤±è´¥")}})(a)},{default:d(()=>[...e[10]||(e[10]=[f("æ¸…ç†",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ja,ra.detect]])]),_:1}),r(La,{shadow:"hover",class:"table-card"},{header:d(()=>[...e[11]||(e[11]=[o("div",{class:"card-header"},[o("span",null,"ðŸ” å¯ç–‘å……å€¼è®°å½•")],-1)])]),default:d(()=>[p((t(),_(Sa,{data:da.suspiciousDeposits,stripe:"",size:"small","max-height":250},{default:d(()=>[r(Ca,{prop:"id",label:"ID",width:"60"}),r(Ca,{prop:"wallet_address",label:"é’±åŒ…åœ°å€","min-width":"140"},{default:d(({row:a})=>[o("span",q,u(_a(a.wallet_address)),1)]),_:1}),r(Ca,{prop:"amount",label:"é‡‘é¢",width:"100",align:"right"},{default:d(({row:a})=>[f(u(fa(a.amount)),1)]),_:1}),r(Ca,{prop:"tx_hash",label:"äº¤æ˜“å“ˆå¸Œ","min-width":"160"},{default:d(({row:a})=>[r(Va,{content:a.tx_hash,placement:"top"},{default:d(()=>{var e;return[o("span",E,u(null==(e=a.tx_hash)?void 0:e.slice(0,16))+"...",1)]}),_:2},1032,["content"])]),_:1}),r(Ca,{prop:"validity",label:"çŠ¶æ€",width:"80",align:"center"},{default:d(({row:a})=>[r(Da,{type:"valid"===a.validity?"success":"danger",size:"small"},{default:d(()=>[f(u("incomplete"===a.validity?"ä¸å®Œæ•´":"å¯ç–‘"),1)]),_:2},1032,["type"])]),_:1}),r(Ca,{prop:"created_at",label:"æ—¶é—´",width:"140"},{default:d(({row:a})=>[f(u(ma(a.created_at)),1)]),_:1}),r(Ca,{label:"æ“ä½œ",width:"70",align:"center",fixed:"right"},{default:d(({row:a})=>[r(xa,{type:"danger",size:"small",link:"",onClick:e=>(async a=>{try{await x.confirm("ç¡®å®šåˆ é™¤è¿™æ¡å¯ç–‘å……å€¼è®°å½•å—ï¼Ÿ","ç¡®è®¤åˆ é™¤",{type:"warning"});const e=await C.delete(`/data-cleanup/suspicious-deposit/${a}`);e.success?(w.success("åˆ é™¤æˆåŠŸ"),wa()):w.error(e.message||"åˆ é™¤å¤±è´¥")}catch(e){"cancel"!==e&&w.error("åˆ é™¤å¤±è´¥")}})(a.id)},{default:d(()=>[...e[12]||(e[12]=[f("åˆ é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ja,ra.detect]])]),_:1})]),_:1}),r(Ua,{label:"æŽ¨èå…³ç³»ç®¡ç†",name:"referrals"},{default:d(()=>[r(La,{shadow:"hover",class:"table-card"},{header:d(()=>[o("div",G,[e[14]||(e[14]=o("span",null,"ðŸ‘¥ æŽ¨èå…³ç³»åˆ—è¡¨",-1)),o("div",Q,[r(Aa,{modelValue:ca.wallet_address,"onUpdate:modelValue":e[0]||(e[0]=a=>ca.wallet_address=a),placeholder:"æœç´¢é’±åŒ…åœ°å€...",clearable:"",size:"small",style:{width:"200px"},onKeyup:g(ba,["enter"])},{prefix:d(()=>[r(l,null,{default:d(()=>[r(c(z))]),_:1})]),_:1},8,["modelValue"]),oa.value.length>0?(t(),_(xa,{key:0,type:"danger",size:"small",onClick:va},{default:d(()=>[f(" æ‰¹é‡ç§»é™¤ ("+u(oa.value.length)+") ",1)]),_:1})):m("",!0),r(xa,{type:"primary",size:"small",onClick:ba,loading:ra.referrals},{default:d(()=>[r(l,null,{default:d(()=>[r(c(k))]),_:1}),e[13]||(e[13]=f(" åˆ·æ–° ",-1))]),_:1},8,["loading"])])])]),default:d(()=>[p((t(),_(Sa,{data:na.value,stripe:"",size:"small",onSelectionChange:za},{default:d(()=>[r(Ca,{type:"selection",width:"40"}),r(Ca,{prop:"id",label:"ID",width:"60"}),r(Ca,{prop:"user_address",label:"ç”¨æˆ·åœ°å€","min-width":"160"},{default:d(({row:a})=>[o("span",R,u(_a(a.user_address)),1),r(xa,{link:"",type:"primary",size:"small",onClick:e=>ga(a.user_address)},{default:d(()=>[r(l,{size:"12"},{default:d(()=>[r(c(y))]),_:1})]),_:1},8,["onClick"])]),_:1}),r(Ca,{prop:"referrer_address",label:"æŽ¨èäººåœ°å€","min-width":"160"},{default:d(({row:a})=>[o("span",X,u(_a(a.referrer_address)),1),r(xa,{link:"",type:"primary",size:"small",onClick:e=>ga(a.referrer_address)},{default:d(()=>[r(l,{size:"12"},{default:d(()=>[r(c(y))]),_:1})]),_:1},8,["onClick"])]),_:1}),r(Ca,{prop:"user_deposit",label:"ç”¨æˆ·å……å€¼",width:"100",align:"right"},{default:d(({row:a})=>[f(u(fa(a.user_deposit)),1)]),_:1}),r(Ca,{prop:"user_balance",label:"ç”¨æˆ·ä½™é¢",width:"100",align:"right"},{default:d(({row:a})=>[f(u(fa(a.user_balance)),1)]),_:1}),r(Ca,{prop:"created_at",label:"ç»‘å®šæ—¶é—´",width:"140"},{default:d(({row:a})=>[f(u(ma(a.created_at)),1)]),_:1}),r(Ca,{label:"æ“ä½œ",width:"70",align:"center",fixed:"right"},{default:d(({row:a})=>[r(xa,{type:"danger",size:"small",link:"",onClick:e=>(async a=>{try{await x.confirm("ç¡®å®šç§»é™¤è¿™æ¡æŽ¨èå…³ç³»å—ï¼Ÿ","ç¡®è®¤ç§»é™¤",{type:"warning"});const e=await C.delete(`/data-cleanup/referral/${a}`);e.success?(w.success("ç§»é™¤æˆåŠŸ"),ba()):w.error(e.message||"ç§»é™¤å¤±è´¥")}catch(e){"cancel"!==e&&w.error("ç§»é™¤å¤±è´¥")}})(a.id)},{default:d(()=>[...e[15]||(e[15]=[f("ç§»é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ja,ra.referrals]]),o("div",Y,[r(Ia,{"current-page":ua.page,"onUpdate:currentPage":e[1]||(e[1]=a=>ua.page=a),"page-size":ua.pageSize,"onUpdate:pageSize":e[2]||(e[2]=a=>ua.pageSize=a),total:ua.total,"page-sizes":[20,50,100],layout:"total, sizes, prev, pager, next",size:"small",onCurrentChange:ba,onSizeChange:ba},null,8,["current-page","page-size","total"])])]),_:1})]),_:1}),r(Ua,{label:"æ¸…ç†æ—¥å¿—",name:"logs"},{default:d(()=>[r(La,{shadow:"hover",class:"table-card"},{header:d(()=>[o("div",Z,[e[17]||(e[17]=o("span",null,"ðŸ“‹ æ“ä½œæ—¥å¿—",-1)),r(xa,{type:"primary",size:"small",onClick:ya,loading:ra.logs},{default:d(()=>[r(l,null,{default:d(()=>[r(c(k))]),_:1}),e[16]||(e[16]=f(" åˆ·æ–° ",-1))]),_:1},8,["loading"])])]),default:d(()=>[r($a,{modelValue:ta.value,"onUpdate:modelValue":e[3]||(e[3]=a=>ta.value=a),class:"inner-tabs"},{default:d(()=>[r(Ua,{label:"ä½™é¢æ¸…ç†",name:"balance"},{default:d(()=>[p((t(),_(Sa,{data:pa.balanceLogs,stripe:"",size:"small","max-height":400},{default:d(()=>[r(Ca,{prop:"id",label:"ID",width:"60"}),r(Ca,{prop:"wallet_address",label:"é’±åŒ…åœ°å€","min-width":"150"},{default:d(({row:a})=>[o("span",aa,u(_a(a.wallet_address)),1)]),_:1}),r(Ca,{prop:"usdt_balance_before",label:"æ¸…ç†å‰USDT",width:"120",align:"right"},{default:d(({row:a})=>[f(u(fa(a.usdt_balance_before)),1)]),_:1}),r(Ca,{prop:"wld_balance_before",label:"æ¸…ç†å‰WLD",width:"120",align:"right"},{default:d(({row:a})=>[f(u(fa(a.wld_balance_before)),1)]),_:1}),r(Ca,{prop:"action",label:"ç±»åž‹",width:"100"},{default:d(({row:a})=>[r(Da,{size:"small"},{default:d(()=>[f(u(a.action),1)]),_:2},1024)]),_:1}),r(Ca,{prop:"admin_user",label:"æ“ä½œäºº",width:"80"}),r(Ca,{prop:"created_at",label:"æ—¶é—´",width:"140"},{default:d(({row:a})=>[f(u(ma(a.created_at)),1)]),_:1})]),_:1},8,["data"])),[[ja,ra.logs]])]),_:1}),r(Ua,{label:"æŽ¨èå…³ç³»æ¸…ç†",name:"referral"},{default:d(()=>[p((t(),_(Sa,{data:pa.referralLogs,stripe:"",size:"small","max-height":400},{default:d(()=>[r(Ca,{prop:"id",label:"ID",width:"60"}),r(Ca,{prop:"user_address",label:"ç”¨æˆ·åœ°å€","min-width":"150"},{default:d(({row:a})=>[o("span",ea,u(_a(a.user_address)),1)]),_:1}),r(Ca,{prop:"referrer_address",label:"æŽ¨èäººåœ°å€","min-width":"150"},{default:d(({row:a})=>[o("span",la,u(_a(a.referrer_address)),1)]),_:1}),r(Ca,{prop:"admin_user",label:"æ“ä½œäºº",width:"80"}),r(Ca,{prop:"created_at",label:"æ—¶é—´",width:"140"},{default:d(({row:a})=>[f(u(ma(a.created_at)),1)]),_:1})]),_:1},8,["data"])),[[ja,ra.logs]])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-56ead164"]]);export{sa as default};
