import{r as a,_ as e,x as t,A as l,o as s,D as r,B as o,J as d,M as i,C as n,ay as u,Y as p,aI as c,m as f,u as _,O as w,F as g}from"./vue-vendor-CCmsYA1Y.js";import{l as m,d as v,e as b,Q as y,S as h,I as x,T as k,b as S}from"./element-plus-BZcENYie.js";import{bC as C}from"./vendor-BQF3adi-.js";import{r as M}from"./index-CQDoFXMh.js";import{_ as z}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-Gc17XYwO.js";const D={class:"page-container"},U={class:"page-header"},V={class:"stat-card"},Y={class:"stat-icon primary"},j={class:"stat-info"},I={class:"stat-value"},T={class:"stat-card"},F={class:"stat-icon success"},R={class:"stat-info"},q={class:"stat-value"},O={class:"stat-card"},$={class:"stat-icon danger"},A={class:"stat-info"},H={class:"stat-value"},B={class:"stat-card"},J={class:"stat-icon warning"},P={class:"stat-info"},Q={class:"stat-value"},X={class:"search-area"},E={class:"tx-id"},G=["onClick"],K={class:"amount"},L={class:"remark"},N={key:1,class:"remark"},W={class:"pagination-wrapper"},Z=z({__name:"Transactions",setup(z){const Z=a(!1),aa=e({totalCount:0,totalIn:0,totalOut:0,todayCount:0}),ea=a([]),ta=e({wallet_address:"",type:"",dateRange:null}),la=e({page:1,pageSize:10,total:0}),sa=async()=>{Z.value=!0;try{const a={page:la.page,pageSize:la.pageSize,wallet_address:ta.wallet_address||void 0,type:ta.type||void 0};ta.dateRange&&(a.start_date=ta.dateRange[0],a.end_date=ta.dateRange[1]);const e=await M.get("/transactions",{params:a});e.success&&(ea.value=e.data.list||[],la.total=e.data.total||0)}catch(a){ea.value=ra(),la.total=100}finally{Z.value=!1}},ra=()=>{const a=["deposit","withdraw","robot_buy","pledge","pledge_reward","follow","follow_profit","referral_reward","quantify_profit"],e={deposit:"in",withdraw:"out",robot_buy:"out",pledge:"out",pledge_reward:"in",follow:"out",follow_profit:"in",referral_reward:"in",quantify_profit:"in"};let t=1e4;return Array.from({length:10},(l,s)=>{const r=a[Math.floor(Math.random()*a.length)],o=e[r],d=(1e3*Math.random()+10).toFixed(2);return"in"===o?t+=parseFloat(d):t-=parseFloat(d),{id:s+1,tx_id:`TX${Date.now()}${s}`.slice(0,14),wallet_address:`0x${Math.random().toString(16).slice(2,10)}...${Math.random().toString(16).slice(2,6)}`,type:r,direction:o,amount:d,token:"USDT",balance_after:t.toFixed(2),remark:oa(r),created_at:C().subtract(Math.floor(30*Math.random()),"day").subtract(Math.floor(24*Math.random()),"hour").toISOString()}})},oa=a=>({deposit:"用户充值",withdraw:"用户提款",robot_buy:"购买量化机器人",pledge:"质押锁仓",pledge_reward:"质押收益发放",follow:"跟单投资",follow_profit:"跟单收益结算",referral_reward:"推荐奖励",quantify_profit:"量化收益发放"}[a]||""),da=()=>{la.page=1,sa()},ia=()=>{ta.wallet_address="",ta.type="",ta.dateRange=null,la.page=1,sa()},na=()=>{S.success("导出功能开发中")},ua=()=>{la.page=1,sa()},pa=()=>{sa()},ca=a=>parseFloat(a||0).toFixed(2),fa=a=>({deposit:"充值",withdraw:"提款",robot_buy:"购买机器人",pledge:"质押",pledge_reward:"质押收益",follow:"跟单",follow_profit:"跟单收益",referral_reward:"推荐奖励",quantify_profit:"量化收益"}[a]||a);return t(()=>{(async()=>{try{const a=await M.get("/transactions/stats");a.success&&a.data&&Object.assign(aa,a.data)}catch(a){aa.totalCount=12568,aa.totalIn=568900.45,aa.totalOut=234560.78,aa.todayCount=128}})(),sa()}),(a,e)=>{const t=u("el-icon"),M=u("el-col"),z=u("el-row"),sa=u("el-input"),ra=u("el-form-item"),oa=u("el-option"),_a=u("el-select"),wa=u("el-date-picker"),ga=u("el-button"),ma=u("el-form"),va=u("el-table-column"),ba=u("el-tag"),ya=u("el-tooltip"),ha=u("el-table"),xa=u("el-pagination"),ka=c("loading");return s(),l("div",D,[r("div",U,[r("h2",null,[o(t,null,{default:n(()=>[o(_(m))]),_:1}),e[5]||(e[5]=i(" 交易记录 ",-1))]),e[6]||(e[6]=r("p",{class:"description"},"查看平台所有交易流水记录",-1))]),o(z,{gutter:20,class:"stats-row"},{default:n(()=>[o(M,{xs:24,sm:12,md:6},{default:n(()=>[r("div",V,[r("div",Y,[o(t,null,{default:n(()=>[o(_(m))]),_:1})]),r("div",j,[r("div",I,w(aa.totalCount),1),e[7]||(e[7]=r("div",{class:"stat-label"},"总交易数",-1))])])]),_:1}),o(M,{xs:24,sm:12,md:6},{default:n(()=>[r("div",T,[r("div",F,[o(t,null,{default:n(()=>[o(_(v))]),_:1})]),r("div",R,[r("div",q,w(ca(aa.totalIn)),1),e[8]||(e[8]=r("div",{class:"stat-label"},"总入账 (USDT)",-1))])])]),_:1}),o(M,{xs:24,sm:12,md:6},{default:n(()=>[r("div",O,[r("div",$,[o(t,null,{default:n(()=>[o(_(b))]),_:1})]),r("div",A,[r("div",H,w(ca(aa.totalOut)),1),e[9]||(e[9]=r("div",{class:"stat-label"},"总出账 (USDT)",-1))])])]),_:1}),o(M,{xs:24,sm:12,md:6},{default:n(()=>[r("div",B,[r("div",J,[o(t,null,{default:n(()=>[o(_(y))]),_:1})]),r("div",P,[r("div",Q,w(aa.todayCount),1),e[10]||(e[10]=r("div",{class:"stat-label"},"今日交易",-1))])])]),_:1})]),_:1}),r("div",X,[o(ma,{inline:!0,model:ta,onSubmit:p(da,["prevent"])},{default:n(()=>[o(ra,{label:"钱包地址"},{default:n(()=>[o(sa,{modelValue:ta.wallet_address,"onUpdate:modelValue":e[0]||(e[0]=a=>ta.wallet_address=a),placeholder:"请输入钱包地址",clearable:"",style:{width:"280px"}},null,8,["modelValue"])]),_:1}),o(ra,{label:"交易类型"},{default:n(()=>[o(_a,{modelValue:ta.type,"onUpdate:modelValue":e[1]||(e[1]=a=>ta.type=a),placeholder:"全部",clearable:"",style:{width:"140px"}},{default:n(()=>[o(oa,{label:"充值",value:"deposit"}),o(oa,{label:"提款",value:"withdraw"}),o(oa,{label:"购买机器人",value:"robot_buy"}),o(oa,{label:"质押",value:"pledge"}),o(oa,{label:"质押收益",value:"pledge_reward"}),o(oa,{label:"跟单",value:"follow"}),o(oa,{label:"跟单收益",value:"follow_profit"}),o(oa,{label:"推荐奖励",value:"referral_reward"}),o(oa,{label:"量化收益",value:"quantify_profit"})]),_:1},8,["modelValue"])]),_:1}),o(ra,{label:"时间范围"},{default:n(()=>[o(wa,{modelValue:ta.dateRange,"onUpdate:modelValue":e[2]||(e[2]=a=>ta.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",style:{width:"260px"}},null,8,["modelValue"])]),_:1}),o(ra,null,{default:n(()=>[o(ga,{type:"primary",onClick:da},{default:n(()=>[o(t,null,{default:n(()=>[o(_(h))]),_:1}),e[11]||(e[11]=i(" 搜索 ",-1))]),_:1}),o(ga,{onClick:ia},{default:n(()=>[o(t,null,{default:n(()=>[o(_(x))]),_:1}),e[12]||(e[12]=i(" 重置 ",-1))]),_:1}),o(ga,{type:"success",onClick:na},{default:n(()=>[o(t,null,{default:n(()=>[o(_(v))]),_:1}),e[13]||(e[13]=i(" 导出 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),d((s(),f(ha,{data:ea.value,stripe:"",border:"",style:{width:"100%"}},{default:n(()=>[o(va,{type:"index",label:"序号",width:"60",align:"center"}),o(va,{prop:"tx_id",label:"交易ID",width:"140"},{default:n(({row:a})=>[r("span",E,w(a.tx_id),1)]),_:1}),o(va,{prop:"wallet_address",label:"钱包地址","min-width":"180"},{default:n(({row:a})=>{return[r("div",{class:"wallet-address",onClick:e=>{return t=a.wallet_address,navigator.clipboard.writeText(t),void S.success("已复制");var t}},[i(w((e=a.wallet_address,e?e.length<=20?e:`${e.slice(0,10)}...${e.slice(-8)}`:""))+" ",1),o(t,null,{default:n(()=>[o(_(k))]),_:1})],8,G)];var e}),_:1}),o(va,{prop:"type",label:"交易类型",width:"120"},{default:n(({row:a})=>{return[o(ba,{type:(e=a.type,{deposit:"success",withdraw:"danger",robot_buy:"primary",pledge:"warning",pledge_reward:"success",follow:"primary",follow_profit:"success",referral_reward:"success",quantify_profit:"success"}[e]||"info"),size:"small"},{default:n(()=>[i(w(fa(a.type)),1)]),_:2},1032,["type"])];var e}),_:1}),o(va,{prop:"direction",label:"方向",width:"80",align:"center"},{default:n(({row:a})=>[r("span",{class:g(["direction",a.direction])},w("in"===a.direction?"收入":"支出"),3)]),_:1}),o(va,{prop:"amount",label:"金额",width:"140",align:"right"},{default:n(({row:a})=>[r("span",{class:g(["amount","in"===a.direction?"positive":"negative"])},w("in"===a.direction?"+":"-")+w(ca(a.amount))+" "+w(a.token),3)]),_:1}),o(va,{prop:"balance_after",label:"交易后余额",width:"140",align:"right"},{default:n(({row:a})=>[r("span",K,w(ca(a.balance_after))+" USDT",1)]),_:1}),o(va,{prop:"remark",label:"备注","min-width":"150"},{default:n(({row:a})=>[a.remark&&a.remark.length>20?(s(),f(ya,{key:0,content:a.remark,placement:"top"},{default:n(()=>[r("span",L,w(a.remark.slice(0,20))+"...",1)]),_:2},1032,["content"])):(s(),l("span",N,w(a.remark||"-"),1))]),_:1}),o(va,{prop:"created_at",label:"交易时间",width:"170"},{default:n(({row:a})=>{return[i(w((e=a.created_at,C(e).format("YYYY-MM-DD HH:mm:ss"))),1)];var e}),_:1})]),_:1},8,["data"])),[[ka,Z.value]]),r("div",W,[o(xa,{"current-page":la.page,"onUpdate:currentPage":e[3]||(e[3]=a=>la.page=a),"page-size":la.pageSize,"onUpdate:pageSize":e[4]||(e[4]=a=>la.pageSize=a),"page-sizes":[10,20,50,100],total:la.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ua,onCurrentChange:pa},null,8,["current-page","page-size","total"])])])}}},[["__scopeId","data-v-f7d76599"]]);export{Z as default};
