import{b as e,m as s,e as a,a4 as l,aa as t}from"./element-plus-BZcENYie.js";import{A as p}from"./index-DcuAk0vn.js";import{_ as i}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{_ as r,r as c,c as n,x as u,A as o,o as d,D as m,B as _,C as f,ay as g,P as y,u as v,O as w,M as h}from"./vue-vendor-CCmsYA1Y.js";import"./vendor-BQF3adi-.js";import"./index-BxKU4Ero.js";const b={class:"documents-container"},k={class:"documents-grid"},P={class:"card-header"},D={class:"title"},j={class:"doc-content"},x=["src"],B={class:"gallery-badge"},F=["src"],M={class:"doc-info"},z={class:"url-text"},S={class:"card-header"},I={class:"title"},C={class:"doc-content"},$=["src"],A={class:"doc-info"},V={class:"url-text"},L={class:"card-header"},O={class:"title"},W={class:"doc-content"},G=["src"],U={class:"doc-info"},q={class:"url-text"},E={class:"preview-container"},H=["src"],J=["src"],K=i({__name:"Documents",setup(i){const K=r({whitepaper_url:"/static/documents/whitepaper.pdf",whitepaper_type:"pdf",whitepaper_pages:26,msb_url:"/static/documents/MSB.png",msb_type:"image",business_license_url:"/static/documents/license.png",business_license_type:"image"}),N=c(!1),Q=c(""),R=c(""),T=c("image"),X=n(()=>({Authorization:`Bearer ${localStorage.getItem("admin_token")||""}`})),Y=e=>`/api/admin/documents/${e}`,Z=async()=>{try{const e=await p();e.success&&e.data&&Object.assign(K,e.data)}catch(s){e.error("加载资质文件配置失败")}},ee=(s,a)=>{if(s.size>31457280)return e.error("文件大小不能超过 30MB"),!1;if("pdf"===a){if("application/pdf"!==s.type)return e.error("只支持 PDF 格式"),!1}else if("document"===a){if(!["application/pdf","image/jpeg","image/png","image/gif","image/webp"].includes(s.type))return e.error("只支持 PDF 和图片格式"),!1}return!0},se=(s,a)=>{s.success?(e.success(s.message||"上传成功"),Z()):e.error(s.message||"上传失败")},ae=s=>{e.error("上传失败，请重试")},le=e=>{let s="",a="",l="image";switch(e){case"whitepaper":"gallery"===K.whitepaper_type?(s=`${K.whitepaper_url}/page-01.png`,l="image"):(s=K.whitepaper_url,l=K.whitepaper_type),a="白皮书预览";break;case"msb":s=K.msb_url,a="MSB 许可证预览",l=K.msb_type;break;case"license":s=K.business_license_url,a="营业执照预览",l=K.business_license_type}R.value=s,Q.value=a,T.value=l,N.value=!0};return u(()=>{Z()}),(e,p)=>{const i=g("el-icon"),r=g("el-tag"),c=g("el-tooltip"),n=g("el-button"),u=g("el-upload"),Z=g("el-card"),te=g("el-dialog");return d(),o("div",b,[p[19]||(p[19]=m("div",{class:"page-header"},[m("h1",null,"资质文件管理"),m("p",{class:"subtitle"},"管理平台的白皮书、MSB许可证和营业执照等资质文件")],-1)),m("div",k,[_(Z,{class:"doc-card"},{header:f(()=>[m("div",P,[m("span",D,[_(i,null,{default:f(()=>[_(v(s))]),_:1}),p[4]||(p[4]=h(" 白皮书 ",-1))]),_(r,{type:"pdf"===K.whitepaper_type?"primary":"gallery"===K.whitepaper_type?"warning":"success",size:"small"},{default:f(()=>[h(w("pdf"===K.whitepaper_type?"PDF":"gallery"===K.whitepaper_type?"Gallery":"Image"),1)]),_:1},8,["type"])])]),default:f(()=>[m("div",j,[m("div",{class:"preview-area",onClick:p[0]||(p[0]=e=>le("whitepaper"))},["pdf"===K.whitepaper_type?(d(),o(y,{key:0},[_(i,{class:"preview-icon"},{default:f(()=>[_(v(s))]),_:1}),p[5]||(p[5]=m("span",{class:"preview-text"},"PDF 文档",-1))],64)):"gallery"===K.whitepaper_type?(d(),o(y,{key:1},[m("img",{src:"gallery"===K.whitepaper_type?`${K.whitepaper_url}/page-01.png`:K.whitepaper_url,alt:"White Paper",class:"preview-image"},null,8,x),m("span",B,w(K.whitepaper_pages||26)+" 页",1)],64)):(d(),o("img",{key:2,src:K.whitepaper_url,alt:"White Paper",class:"preview-image"},null,8,F))]),m("div",M,[p[6]||(p[6]=m("p",null,[m("strong",null,"当前文件：")],-1)),_(c,{content:K.whitepaper_url,placement:"top"},{default:f(()=>[m("span",z,w(K.whitepaper_url),1)]),_:1},8,["content"])]),_(u,{class:"upload-area",action:Y("whitepaper"),headers:X.value,"on-success":e=>se(e),"on-error":ae,"before-upload":e=>ee(e,"pdf"),accept:".pdf","show-file-list":!1},{tip:f(()=>[...p[8]||(p[8]=[m("div",{class:"upload-tip"},"支持 PDF 格式，最大 30MB",-1)])]),default:f(()=>[_(n,{type:"primary",icon:v(a)},{default:f(()=>[...p[7]||(p[7]=[h("上传新白皮书",-1)])]),_:1},8,["icon"])]),_:1},8,["action","headers","on-success","before-upload"])])]),_:1}),_(Z,{class:"doc-card"},{header:f(()=>[m("div",S,[m("span",I,[_(i,null,{default:f(()=>[_(v(l))]),_:1}),p[9]||(p[9]=h(" MSB 许可证 ",-1))]),_(r,{type:"pdf"===K.msb_type?"primary":"success",size:"small"},{default:f(()=>[h(w("pdf"===K.msb_type?"PDF":"Image"),1)]),_:1},8,["type"])])]),default:f(()=>[m("div",C,[m("div",{class:"preview-area",onClick:p[1]||(p[1]=e=>le("msb"))},["pdf"===K.msb_type?(d(),o(y,{key:0},[_(i,{class:"preview-icon"},{default:f(()=>[_(v(s))]),_:1}),p[10]||(p[10]=m("span",{class:"preview-text"},"PDF 文档",-1))],64)):(d(),o("img",{key:1,src:K.msb_url,alt:"MSB License",class:"preview-image"},null,8,$))]),m("div",A,[p[11]||(p[11]=m("p",null,[m("strong",null,"当前文件：")],-1)),_(c,{content:K.msb_url,placement:"top"},{default:f(()=>[m("span",V,w(K.msb_url),1)]),_:1},8,["content"])]),_(u,{class:"upload-area",action:Y("msb"),headers:X.value,"on-success":e=>se(e),"on-error":ae,"before-upload":e=>ee(e,"document"),accept:".pdf,.jpg,.jpeg,.png,.gif,.webp","show-file-list":!1},{tip:f(()=>[...p[13]||(p[13]=[m("div",{class:"upload-tip"},"支持 PDF 和图片格式，最大 30MB",-1)])]),default:f(()=>[_(n,{type:"primary",icon:v(a)},{default:f(()=>[...p[12]||(p[12]=[h("上传新许可证",-1)])]),_:1},8,["icon"])]),_:1},8,["action","headers","on-success","before-upload"])])]),_:1}),_(Z,{class:"doc-card"},{header:f(()=>[m("div",L,[m("span",O,[_(i,null,{default:f(()=>[_(v(t))]),_:1}),p[14]||(p[14]=h(" 营业执照 ",-1))]),_(r,{type:"pdf"===K.business_license_type?"primary":"success",size:"small"},{default:f(()=>[h(w("pdf"===K.business_license_type?"PDF":"Image"),1)]),_:1},8,["type"])])]),default:f(()=>[m("div",W,[m("div",{class:"preview-area",onClick:p[2]||(p[2]=e=>le("license"))},["pdf"===K.business_license_type?(d(),o(y,{key:0},[_(i,{class:"preview-icon"},{default:f(()=>[_(v(s))]),_:1}),p[15]||(p[15]=m("span",{class:"preview-text"},"PDF 文档",-1))],64)):(d(),o("img",{key:1,src:K.business_license_url,alt:"Business License",class:"preview-image"},null,8,G))]),m("div",U,[p[16]||(p[16]=m("p",null,[m("strong",null,"当前文件：")],-1)),_(c,{content:K.business_license_url,placement:"top"},{default:f(()=>[m("span",q,w(K.business_license_url),1)]),_:1},8,["content"])]),_(u,{class:"upload-area",action:Y("business-license"),headers:X.value,"on-success":e=>se(e),"on-error":ae,"before-upload":e=>ee(e,"document"),accept:".pdf,.jpg,.jpeg,.png,.gif,.webp","show-file-list":!1},{tip:f(()=>[...p[18]||(p[18]=[m("div",{class:"upload-tip"},"支持 PDF 和图片格式，最大 30MB",-1)])]),default:f(()=>[_(n,{type:"primary",icon:v(a)},{default:f(()=>[...p[17]||(p[17]=[h("上传新执照",-1)])]),_:1},8,["icon"])]),_:1},8,["action","headers","on-success","before-upload"])])]),_:1})]),_(te,{modelValue:N.value,"onUpdate:modelValue":p[3]||(p[3]=e=>N.value=e),title:Q.value,width:"80%",class:"preview-dialog","destroy-on-close":""},{default:f(()=>[m("div",E,["pdf"===T.value?(d(),o("iframe",{key:0,src:R.value,class:"pdf-frame"},null,8,H)):(d(),o("img",{key:1,src:R.value,alt:"Document Preview",class:"preview-full-image"},null,8,J))])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-0a76f7e2"]]);export{K as default};
