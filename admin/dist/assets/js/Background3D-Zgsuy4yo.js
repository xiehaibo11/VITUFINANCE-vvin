import{S as e,F as t,P as a,W as n,B as o,a as i,b as r,A as s,c as l}from"./three-zurYmXlw.js";import{u as d,s as c,i as m,g as p,a as u}from"./index-BArJCJm5.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{r as y,c as h,v as f,x as v,Z as g,A as b,o as M,D as x,P as A,ac as k,F as z,E as F}from"./vue-vendor-CCmsYA1Y.js";const H={class:"particles-static"},E=w({__name:"Background3D",setup(w){const E=d(),_=y(null),W=y(c()),I=h(()=>"dark"===E.theme),P=h(()=>({background:I.value?"radial-gradient(circle at center, #1b2735 0%, #090a0f 100%)":"radial-gradient(circle at center, #e6f7ff 0%, #f0f2f5 100%)"})),j=e=>{const t=137.508*e;return{left:t%100+"%",top:1.618*t%100+"%",animationDelay:.3*e+"s",opacity:.3+e%5*.1}};let L,U,B,C,D,S,q=0,R=0,X=0,Y=window.innerWidth/2,Z=window.innerHeight/2,G=null,J=!1;const K=m(),N=K?25:50,O=K?25:50,Q=p(200),T=p(200),V=K?30:100,$=[];f(()=>E.theme,e=>{ee(e)});const ee=e=>{if(!L||!C||!D)return;const t="dark"===e;L.fog.color.setHex(t?328965:15790837),L.fog.density=.002,C.material.color.setHex(t?4235007:1609983),C.material.opacity=t?.8:.6,D.material.color.setHex(t?10930431:4235007),S.material.opacity=1},te=()=>{const e=new o,t=new Float32Array(N*O*3);let a=0;for(let o=0;o<N;o++)for(let e=0;e<O;e++)t[a]=80*o-2e3,t[a+1]=0,t[a+2]=80*e-2e3,a+=3;e.setAttribute("position",new i(t,3));const n=new r({color:4235007,size:4,transparent:!0,opacity:.8,blending:s,sizeAttenuation:!0});C=new l(e,n),L.add(C)},ae=()=>{const e=new o,t=new Float32Array(3*Q),a=new Float32Array(Q);for(let o=0;o<Q;o++)t[3*o]=4e3*(Math.random()-.5),t[3*o+1]=2e3*Math.random()+500,t[3*o+2]=4e3*(Math.random()-.5),a[o]=10*Math.random()+20;e.setAttribute("position",new i(t,3)),e.setAttribute("velocity",new i(a,1));const n=new r({color:10930431,size:3,transparent:!0,opacity:.6,blending:s});D=new l(e,n),L.add(D)},ne=()=>{const e=new o,t=T*V,a=new Float32Array(3*t),n=new Float32Array(3*t);for(let o=0;o<t;o++)a[3*o+1]=-1e4,n[3*o]=1,n[3*o+1]=1,n[3*o+2]=1;e.setAttribute("position",new i(a,3)),e.setAttribute("color",new i(n,3));const d=new r({size:4,vertexColors:!0,transparent:!0,opacity:1,blending:s});S=new l(e,d),L.add(S);for(let o=0;o<V;o++)$.push({active:!1,startIndex:o*T,age:0,positions:[],velocities:[]})},oe=(e,t,a)=>{const n=$.find(e=>!e.active);if(!n)return;n.active=!0,n.age=0;const o=S.geometry.attributes.position.array,i=S.geometry.attributes.color.array;for(let r=0;r<T;r++){const s=n.startIndex+r;o[3*s]=e,o[3*s+1]=t,o[3*s+2]=a;const l=Math.random()*Math.PI*2,d=8*Math.random()+4,c=12*Math.random()+8;n.velocities[r]={x:Math.cos(l)*d,y:c,z:Math.sin(l)*d},i[3*s]=.4+.4*Math.random(),i[3*s+1]=.8+.2*Math.random(),i[3*s+2]=1}S.geometry.attributes.position.needsUpdate=!0,S.geometry.attributes.color.needsUpdate=!0},ie=e=>{R=e.clientX-Y,X=e.clientY-Z},re=()=>{Y=window.innerWidth/2,Z=window.innerHeight/2,U.aspect=window.innerWidth/window.innerHeight,U.updateProjectionMatrix(),B.setSize(window.innerWidth,window.innerHeight)};let se=0;const le=1e3/(K?30:60),de=e=>{if(!J)return;G=requestAnimationFrame(de);const t=e-se;t<le||(se=e-t%le,me())},ce=(e,t,a)=>{const n=(e+2e3)/80,o=(t+2e3)/80;return 50*Math.sin(.3*(n+a))+50*Math.sin(.5*(o+a))+20*Math.sin(.2*(n+o+a))},me=()=>{U.position.x+=.02*(R-U.position.x),U.position.y+=.02*(200-X-U.position.y),U.lookAt(L.position);const e=C.geometry.attributes.position.array;let t=0;for(let i=0;i<N;i++)for(let a=0;a<O;a++)e[t],e[t+2],e[t+1]=50*Math.sin(.3*(i+q))+50*Math.sin(.5*(a+q))+20*Math.sin(.2*(i+a+q)),t+=3;C.geometry.attributes.position.needsUpdate=!0,q+=.05;const a=D.geometry.attributes.position.array,n=D.geometry.attributes.velocity.array;for(let i=0;i<Q;i++){a[3*i+1]-=n[i];const e=a[3*i],t=a[3*i+2],o=ce(e,t,q);a[3*i+1]<o&&(oe(e,o,t),a[3*i]=4e3*(Math.random()-.5),a[3*i+1]=1e3*Math.random()+1e3,a[3*i+2]=4e3*(Math.random()-.5))}D.geometry.attributes.position.needsUpdate=!0;const o=S.geometry.attributes.position.array;$.forEach(e=>{if(e.active)if(e.age++,e.age>40){e.active=!1;for(let t=0;t<T;t++)o[3*(e.startIndex+t)+1]=-1e4}else for(let t=0;t<T;t++){const a=e.startIndex+t,n=e.velocities[t];o[3*a]+=n.x,o[3*a+1]+=n.y,o[3*a+2]+=n.z,n.y-=.5}}),S.geometry.attributes.position.needsUpdate=!0,B.render(L,U)};return v(()=>{W.value&&((()=>{if(!W.value||!_.value)return;const o="dark"===E.theme;L=new e,L.fog=new t(o?328965:15790837,.002),U=new a(75,window.innerWidth/window.innerHeight,1,3e3),U.position.z=1e3,U.position.y=200,B=new n({alpha:!0,antialias:!K,powerPreference:"low-power"}),B.setPixelRatio(u()),B.setSize(window.innerWidth,window.innerHeight),_.value.appendChild(B.domElement),te(),ae(),ne(),ee(E.theme),document.addEventListener("mousemove",ie),window.addEventListener("resize",re)})(),J=!0,de(performance.now()))}),g(()=>{J=!1,G&&(cancelAnimationFrame(G),G=null),document.removeEventListener("mousemove",ie),window.removeEventListener("resize",re),B&&(B.dispose(),B.forceContextLoss(),B=null),L&&(L.traverse(e=>{e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(e=>e.dispose()):e.material.dispose())}),L=null),U=null,C=null,D=null,S=null}),(e,t)=>W.value?(M(),b("div",{key:1,ref_key:"container",ref:_,class:"three-container",style:F(P.value)},null,4)):(M(),b("div",{key:0,class:z(["fallback-container",{"is-dark":I.value}])},[t[0]||(t[0]=x("div",{class:"gradient-bg"},null,-1)),x("div",H,[(M(),b(A,null,k(20,e=>x("div",{key:e,class:"particle",style:F(j(e))},null,4)),64))])],2))}},[["__scopeId","data-v-8113f9aa"]]);export{E as B};
